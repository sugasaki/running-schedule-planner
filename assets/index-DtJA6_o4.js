var wK=Object.defineProperty;var yK=(t,e,n)=>e in t?wK(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var CK=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ww=(t,e,n)=>yK(t,typeof e!="symbol"?e+"":e,n);var kSe=CK((nRe,_C)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var oL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var O0={exports:{}},xg={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sL;function bK(){if(sL)return xg;sL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,r,o){var a=null;if(o!==void 0&&(a=""+o),r.key!==void 0&&(a=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:t,type:i,key:a,ref:r!==void 0?r:null,props:o}}return xg.Fragment=e,xg.jsx=n,xg.jsxs=n,xg}var aL;function SK(){return aL||(aL=1,O0.exports=bK()),O0.exports}var Re=SK(),x0={exports:{}},at={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lL;function RK(){if(lL)return at;lL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function w(B){return B===null||typeof B!="object"?null:(B=p&&B[p]||B["@@iterator"],typeof B=="function"?B:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function M(B,ue,C){this.props=B,this.context=ue,this.refs=T,this.updater=C||y}M.prototype.isReactComponent={},M.prototype.setState=function(B,ue){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,ue,"setState")},M.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function I(){}I.prototype=M.prototype;function _(B,ue,C){this.props=B,this.context=ue,this.refs=T,this.updater=C||y}var N=_.prototype=new I;N.constructor=_,b(N,M.prototype),N.isPureReactComponent=!0;var k=Array.isArray,$={H:null,A:null,T:null,S:null,V:null},L=Object.prototype.hasOwnProperty;function F(B,ue,C,S,R,P){return C=P.ref,{$$typeof:t,type:B,key:ue,ref:C!==void 0?C:null,props:P}}function he(B,ue){return F(B.type,ue,void 0,void 0,void 0,B.props)}function le(B){return typeof B=="object"&&B!==null&&B.$$typeof===t}function G(B){var ue={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(C){return ue[C]})}var ye=/\/+/g;function we(B,ue){return typeof B=="object"&&B!==null&&B.key!=null?G(""+B.key):ue.toString(36)}function Me(){}function Ee(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(Me,Me):(B.status="pending",B.then(function(ue){B.status==="pending"&&(B.status="fulfilled",B.value=ue)},function(ue){B.status==="pending"&&(B.status="rejected",B.reason=ue)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function _e(B,ue,C,S,R){var P=typeof B;(P==="undefined"||P==="boolean")&&(B=null);var V=!1;if(B===null)V=!0;else switch(P){case"bigint":case"string":case"number":V=!0;break;case"object":switch(B.$$typeof){case t:case e:V=!0;break;case g:return V=B._init,_e(V(B._payload),ue,C,S,R)}}if(V)return R=R(B),V=S===""?"."+we(B,0):S,k(R)?(C="",V!=null&&(C=V.replace(ye,"$&/")+"/"),_e(R,ue,C,"",function(ge){return ge})):R!=null&&(le(R)&&(R=he(R,C+(R.key==null||B&&B.key===R.key?"":(""+R.key).replace(ye,"$&/")+"/")+V)),ue.push(R)),1;V=0;var J=S===""?".":S+":";if(k(B))for(var ae=0;ae<B.length;ae++)S=B[ae],P=J+we(S,ae),V+=_e(S,ue,C,P,R);else if(ae=w(B),typeof ae=="function")for(B=ae.call(B),ae=0;!(S=B.next()).done;)S=S.value,P=J+we(S,ae++),V+=_e(S,ue,C,P,R);else if(P==="object"){if(typeof B.then=="function")return _e(Ee(B),ue,C,S,R);throw ue=String(B),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return V}function se(B,ue,C){if(B==null)return B;var S=[],R=0;return _e(B,S,"","",function(P){return ue.call(C,P,R++)}),S}function fe(B){if(B._status===-1){var ue=B._result;ue=ue(),ue.then(function(C){(B._status===0||B._status===-1)&&(B._status=1,B._result=C)},function(C){(B._status===0||B._status===-1)&&(B._status=2,B._result=C)}),B._status===-1&&(B._status=0,B._result=ue)}if(B._status===1)return B._result.default;throw B._result}var Te=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)};function Ge(){}return at.Children={map:se,forEach:function(B,ue,C){se(B,function(){ue.apply(this,arguments)},C)},count:function(B){var ue=0;return se(B,function(){ue++}),ue},toArray:function(B){return se(B,function(ue){return ue})||[]},only:function(B){if(!le(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},at.Component=M,at.Fragment=n,at.Profiler=r,at.PureComponent=_,at.StrictMode=i,at.Suspense=h,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,at.__COMPILER_RUNTIME={__proto__:null,c:function(B){return $.H.useMemoCache(B)}},at.cache=function(B){return function(){return B.apply(null,arguments)}},at.cloneElement=function(B,ue,C){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var S=b({},B.props),R=B.key,P=void 0;if(ue!=null)for(V in ue.ref!==void 0&&(P=void 0),ue.key!==void 0&&(R=""+ue.key),ue)!L.call(ue,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&ue.ref===void 0||(S[V]=ue[V]);var V=arguments.length-2;if(V===1)S.children=C;else if(1<V){for(var J=Array(V),ae=0;ae<V;ae++)J[ae]=arguments[ae+2];S.children=J}return F(B.type,R,void 0,void 0,P,S)},at.createContext=function(B){return B={$$typeof:a,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:o,_context:B},B},at.createElement=function(B,ue,C){var S,R={},P=null;if(ue!=null)for(S in ue.key!==void 0&&(P=""+ue.key),ue)L.call(ue,S)&&S!=="key"&&S!=="__self"&&S!=="__source"&&(R[S]=ue[S]);var V=arguments.length-2;if(V===1)R.children=C;else if(1<V){for(var J=Array(V),ae=0;ae<V;ae++)J[ae]=arguments[ae+2];R.children=J}if(B&&B.defaultProps)for(S in V=B.defaultProps,V)R[S]===void 0&&(R[S]=V[S]);return F(B,P,void 0,void 0,null,R)},at.createRef=function(){return{current:null}},at.forwardRef=function(B){return{$$typeof:u,render:B}},at.isValidElement=le,at.lazy=function(B){return{$$typeof:g,_payload:{_status:-1,_result:B},_init:fe}},at.memo=function(B,ue){return{$$typeof:d,type:B,compare:ue===void 0?null:ue}},at.startTransition=function(B){var ue=$.T,C={};$.T=C;try{var S=B(),R=$.S;R!==null&&R(C,S),typeof S=="object"&&S!==null&&typeof S.then=="function"&&S.then(Ge,Te)}catch(P){Te(P)}finally{$.T=ue}},at.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},at.use=function(B){return $.H.use(B)},at.useActionState=function(B,ue,C){return $.H.useActionState(B,ue,C)},at.useCallback=function(B,ue){return $.H.useCallback(B,ue)},at.useContext=function(B){return $.H.useContext(B)},at.useDebugValue=function(){},at.useDeferredValue=function(B,ue){return $.H.useDeferredValue(B,ue)},at.useEffect=function(B,ue,C){var S=$.H;if(typeof C=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return S.useEffect(B,ue)},at.useId=function(){return $.H.useId()},at.useImperativeHandle=function(B,ue,C){return $.H.useImperativeHandle(B,ue,C)},at.useInsertionEffect=function(B,ue){return $.H.useInsertionEffect(B,ue)},at.useLayoutEffect=function(B,ue){return $.H.useLayoutEffect(B,ue)},at.useMemo=function(B,ue){return $.H.useMemo(B,ue)},at.useOptimistic=function(B,ue){return $.H.useOptimistic(B,ue)},at.useReducer=function(B,ue,C){return $.H.useReducer(B,ue,C)},at.useRef=function(B){return $.H.useRef(B)},at.useState=function(B){return $.H.useState(B)},at.useSyncExternalStore=function(B,ue,C){return $.H.useSyncExternalStore(B,ue,C)},at.useTransition=function(){return $.H.useTransition()},at.version="19.1.0",at}var uL;function $O(){return uL||(uL=1,x0.exports=RK()),x0.exports}var un=$O();const _n=M2(un);var A0={exports:{}},Ag={},H0={exports:{}},I0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cL;function EK(){return cL||(cL=1,function(t){function e(se,fe){var Te=se.length;se.push(fe);e:for(;0<Te;){var Ge=Te-1>>>1,B=se[Ge];if(0<r(B,fe))se[Ge]=fe,se[Te]=B,Te=Ge;else break e}}function n(se){return se.length===0?null:se[0]}function i(se){if(se.length===0)return null;var fe=se[0],Te=se.pop();if(Te!==fe){se[0]=Te;e:for(var Ge=0,B=se.length,ue=B>>>1;Ge<ue;){var C=2*(Ge+1)-1,S=se[C],R=C+1,P=se[R];if(0>r(S,Te))R<B&&0>r(P,S)?(se[Ge]=P,se[R]=Te,Ge=R):(se[Ge]=S,se[C]=Te,Ge=C);else if(R<B&&0>r(P,Te))se[Ge]=P,se[R]=Te,Ge=R;else break e}}return fe}function r(se,fe){var Te=se.sortIndex-fe.sortIndex;return Te!==0?Te:se.id-fe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],d=[],g=1,p=null,w=3,y=!1,b=!1,T=!1,M=!1,I=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function k(se){for(var fe=n(d);fe!==null;){if(fe.callback===null)i(d);else if(fe.startTime<=se)i(d),fe.sortIndex=fe.expirationTime,e(h,fe);else break;fe=n(d)}}function $(se){if(T=!1,k(se),!b)if(n(h)!==null)b=!0,L||(L=!0,we());else{var fe=n(d);fe!==null&&_e($,fe.startTime-se)}}var L=!1,F=-1,he=5,le=-1;function G(){return M?!0:!(t.unstable_now()-le<he)}function ye(){if(M=!1,L){var se=t.unstable_now();le=se;var fe=!0;try{e:{b=!1,T&&(T=!1,_(F),F=-1),y=!0;var Te=w;try{t:{for(k(se),p=n(h);p!==null&&!(p.expirationTime>se&&G());){var Ge=p.callback;if(typeof Ge=="function"){p.callback=null,w=p.priorityLevel;var B=Ge(p.expirationTime<=se);if(se=t.unstable_now(),typeof B=="function"){p.callback=B,k(se),fe=!0;break t}p===n(h)&&i(h),k(se)}else i(h);p=n(h)}if(p!==null)fe=!0;else{var ue=n(d);ue!==null&&_e($,ue.startTime-se),fe=!1}}break e}finally{p=null,w=Te,y=!1}fe=void 0}}finally{fe?we():L=!1}}}var we;if(typeof N=="function")we=function(){N(ye)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,Ee=Me.port2;Me.port1.onmessage=ye,we=function(){Ee.postMessage(null)}}else we=function(){I(ye,0)};function _e(se,fe){F=I(function(){se(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):he=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_next=function(se){switch(w){case 1:case 2:case 3:var fe=3;break;default:fe=w}var Te=w;w=fe;try{return se()}finally{w=Te}},t.unstable_requestPaint=function(){M=!0},t.unstable_runWithPriority=function(se,fe){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Te=w;w=se;try{return fe()}finally{w=Te}},t.unstable_scheduleCallback=function(se,fe,Te){var Ge=t.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Ge+Te:Ge):Te=Ge,se){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Te+B,se={id:g++,callback:fe,priorityLevel:se,startTime:Te,expirationTime:B,sortIndex:-1},Te>Ge?(se.sortIndex=Te,e(d,se),n(h)===null&&se===n(d)&&(T?(_(F),F=-1):T=!0,_e($,Te-Ge))):(se.sortIndex=B,e(h,se),b||y||(b=!0,L||(L=!0,we()))),se},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(se){var fe=w;return function(){var Te=w;w=fe;try{return se.apply(this,arguments)}finally{w=Te}}}}(I0)),I0}var hL;function TK(){return hL||(hL=1,H0.exports=EK()),H0.exports}var P0={exports:{}},Ni={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dL;function _K(){if(dL)return Ni;dL=1;var t=$O();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,d,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:h,containerInfo:d,implementation:g}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ni.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ni.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,g)},Ni.flushSync=function(h){var d=a.T,g=i.p;try{if(a.T=null,i.p=2,h)return h()}finally{a.T=d,i.p=g,i.d.f()}},Ni.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},Ni.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Ni.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin),w=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:w,fetchPriority:y}):g==="script"&&i.d.X(h,{crossOrigin:p,integrity:w,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ni.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},Ni.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,p=u(g,d.crossOrigin);i.d.L(h,g,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ni.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},Ni.requestFormReset=function(h){i.d.r(h)},Ni.unstable_batchedUpdates=function(h,d){return h(d)},Ni.useFormState=function(h,d,g){return a.H.useFormState(h,d,g)},Ni.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ni.version="19.1.0",Ni}var fL;function O2(){if(fL)return P0.exports;fL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),P0.exports=_K(),P0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gL;function MK(){if(gL)return Ag;gL=1;var t=TK(),e=$O(),n=O2();function i(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function a(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(o(s)!==s)throw Error(i(188))}function h(s){var l=s.alternate;if(!l){if(l=o(s),l===null)throw Error(i(188));return l!==s?null:s}for(var c=s,f=l;;){var m=c.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===c)return u(m),s;if(v===f)return u(m),l;v=v.sibling}throw Error(i(188))}if(c.return!==f.return)c=m,f=v;else{for(var E=!1,x=m.child;x;){if(x===c){E=!0,c=m,f=v;break}if(x===f){E=!0,f=m,c=v;break}x=x.sibling}if(!E){for(x=v.child;x;){if(x===c){E=!0,c=v,f=m;break}if(x===f){E=!0,f=v,c=m;break}x=x.sibling}if(!E)throw Error(i(189))}}if(c.alternate!==f)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?s:l}function d(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=d(s),l!==null)return l;s=s.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),N=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),le=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),ye=Symbol.iterator;function we(s){return s===null||typeof s!="object"?null:(s=ye&&s[ye]||s["@@iterator"],typeof s=="function"?s:null)}var Me=Symbol.for("react.client.reference");function Ee(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Me?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case M:return"Profiler";case T:return"StrictMode";case $:return"Suspense";case L:return"SuspenseList";case le:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case N:return(s.displayName||"Context")+".Provider";case _:return(s._context.displayName||"Context")+".Consumer";case k:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return l=s.displayName||null,l!==null?l:Ee(s.type)||"Memo";case he:l=s._payload,s=s._init;try{return Ee(s(l))}catch{}}return null}var _e=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Ge=[],B=-1;function ue(s){return{current:s}}function C(s){0>B||(s.current=Ge[B],Ge[B]=null,B--)}function S(s,l){B++,Ge[B]=s.current,s.current=l}var R=ue(null),P=ue(null),V=ue(null),J=ue(null);function ae(s,l){switch(S(V,l),S(P,s),S(R,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?PD(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=PD(l),s=ND(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}C(R),S(R,s)}function ge(){C(R),C(P),C(V)}function O(s){s.memoizedState!==null&&S(J,s);var l=R.current,c=ND(l,s.type);l!==c&&(S(P,s),S(R,c))}function H(s){P.current===s&&(C(R),C(P)),J.current===s&&(C(J),Eg._currentValue=Te)}var A=Object.prototype.hasOwnProperty,q=t.unstable_scheduleCallback,j=t.unstable_cancelCallback,K=t.unstable_shouldYield,ie=t.unstable_requestPaint,W=t.unstable_now,X=t.unstable_getCurrentPriorityLevel,te=t.unstable_ImmediatePriority,Z=t.unstable_UserBlockingPriority,ce=t.unstable_NormalPriority,He=t.unstable_LowPriority,Ie=t.unstable_IdlePriority,Qe=t.log,st=t.unstable_setDisableYieldValue,ot=null,Be=null;function Je(s){if(typeof Qe=="function"&&st(s),Be&&typeof Be.setStrictMode=="function")try{Be.setStrictMode(ot,s)}catch{}}var gt=Math.clz32?Math.clz32:or,Ar=Math.log,Lo=Math.LN2;function or(s){return s>>>=0,s===0?32:31-(Ar(s)/Lo|0)|0}var Bt=256,cn=4194304;function Tt(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ft(s,l,c){var f=s.pendingLanes;if(f===0)return 0;var m=0,v=s.suspendedLanes,E=s.pingedLanes;s=s.warmLanes;var x=f&134217727;return x!==0?(f=x&~v,f!==0?m=Tt(f):(E&=x,E!==0?m=Tt(E):c||(c=x&~s,c!==0&&(m=Tt(c))))):(x=f&~v,x!==0?m=Tt(x):E!==0?m=Tt(E):c||(c=f&~s,c!==0&&(m=Tt(c)))),m===0?0:l!==0&&l!==m&&(l&v)===0&&(v=m&-m,c=l&-l,v>=c||v===32&&(c&4194048)!==0)?l:m}function it(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function sr(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ws(){var s=Bt;return Bt<<=1,(Bt&4194048)===0&&(Bt=256),s}function ys(){var s=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),s}function If(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function ko(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function SS(s,l,c,f,m,v){var E=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var x=s.entanglements,D=s.expirationTimes,ne=s.hiddenUpdates;for(c=E&~c;0<c;){var de=31-gt(c),ve=1<<de;x[de]=0,D[de]=-1;var re=ne[de];if(re!==null)for(ne[de]=null,de=0;de<re.length;de++){var oe=re[de];oe!==null&&(oe.lane&=-536870913)}c&=~ve}f!==0&&av(s,f,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(E&~l))}function av(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var f=31-gt(l);s.entangledLanes|=l,s.entanglements[f]=s.entanglements[f]|1073741824|c&4194090}function Bn(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var f=31-gt(c),m=1<<f;m&l|s[f]&l&&(s[f]|=l),c&=~m}}function Cs(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Pf(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Nf(){var s=fe.p;return s!==0?s:(s=window.event,s===void 0?32:JD(s.type))}function Df(s,l){var c=fe.p;try{return fe.p=s,l()}finally{fe.p=c}}var Vo=Math.random().toString(36).slice(2),li="__reactFiber$"+Vo,Hi="__reactProps$"+Vo,Ei="__reactContainer$"+Vo,bs="__reactEvents$"+Vo,lv="__reactListeners$"+Vo,uv="__reactHandles$"+Vo,vh="__reactResources$"+Vo,Cl="__reactMarker$"+Vo;function Hr(s){delete s[li],delete s[Hi],delete s[bs],delete s[lv],delete s[uv]}function ca(s){var l=s[li];if(l)return l;for(var c=s.parentNode;c;){if(l=c[Ei]||c[li]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=VD(s);s!==null;){if(c=s[li])return c;s=VD(s)}return l}s=c,c=s.parentNode}return null}function ha(s){if(s=s[li]||s[Ei]){var l=s.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return s}return null}function bl(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(i(33))}function da(s){var l=s[vh];return l||(l=s[vh]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function qn(s){s[Cl]=!0}var Fe=new Set,Y={};function be(s,l){Pe(s,l),Pe(s+"Capture",l)}function Pe(s,l){for(Y[s]=l,s=0;s<l.length;s++)Fe.add(l[s])}var on=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ui={},An={};function Ii(s){return A.call(An,s)?!0:A.call(ui,s)?!1:on.test(s)?An[s]=!0:(ui[s]=!0,!1)}function ar(s,l,c){if(Ii(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function Ss(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Ir(s,l,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+f)}}var Kn,Lf;function fa(s){if(Kn===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);Kn=l&&l[1]||"",Lf=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kn+s+Lf}var RS=!1;function ES(s,l){if(!s||RS)return"";RS=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(oe){var re=oe}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(oe){re=oe}s.call(ve.prototype)}}else{try{throw Error()}catch(oe){re=oe}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(oe){if(oe&&re&&typeof oe.stack=="string")return[oe.stack,re.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),E=v[0],x=v[1];if(E&&x){var D=E.split(`
`),ne=x.split(`
`);for(m=f=0;f<D.length&&!D[f].includes("DetermineComponentFrameRoot");)f++;for(;m<ne.length&&!ne[m].includes("DetermineComponentFrameRoot");)m++;if(f===D.length||m===ne.length)for(f=D.length-1,m=ne.length-1;1<=f&&0<=m&&D[f]!==ne[m];)m--;for(;1<=f&&0<=m;f--,m--)if(D[f]!==ne[m]){if(f!==1||m!==1)do if(f--,m--,0>m||D[f]!==ne[m]){var de=`
`+D[f].replace(" at new "," at ");return s.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",s.displayName)),de}while(1<=f&&0<=m);break}}}finally{RS=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?fa(c):""}function dq(s){switch(s.tag){case 26:case 27:case 5:return fa(s.type);case 16:return fa("Lazy");case 13:return fa("Suspense");case 19:return fa("SuspenseList");case 0:case 15:return ES(s.type,!1);case 11:return ES(s.type.render,!1);case 1:return ES(s.type,!0);case 31:return fa("Activity");default:return""}}function MI(s){try{var l="";do l+=dq(s),s=s.return;while(s);return l}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function no(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function OI(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function fq(s){var l=OI(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),f=""+s[l];if(!s.hasOwnProperty(l)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,v=c.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return m.call(this)},set:function(E){f=""+E,v.call(this,E)}}),Object.defineProperty(s,l,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(E){f=""+E},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function cv(s){s._valueTracker||(s._valueTracker=fq(s))}function xI(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return s&&(f=OI(s)?s.checked?"true":"false":s.value),s=f,s!==c?(l.setValue(s),!0):!1}function hv(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var gq=/[\n"\\]/g;function io(s){return s.replace(gq,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function TS(s,l,c,f,m,v,E,x){s.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.type=E:s.removeAttribute("type"),l!=null?E==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+no(l)):s.value!==""+no(l)&&(s.value=""+no(l)):E!=="submit"&&E!=="reset"||s.removeAttribute("value"),l!=null?_S(s,E,no(l)):c!=null?_S(s,E,no(c)):f!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.name=""+no(x):s.removeAttribute("name")}function AI(s,l,c,f,m,v,E,x){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),l!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||l!=null))return;c=c!=null?""+no(c):"",l=l!=null?""+no(l):c,x||l===s.value||(s.value=l),s.defaultValue=l}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=x?s.checked:!!f,s.defaultChecked=!!f,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.name=E)}function _S(s,l,c){l==="number"&&hv(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function wh(s,l,c,f){if(s=s.options,l){l={};for(var m=0;m<c.length;m++)l["$"+c[m]]=!0;for(c=0;c<s.length;c++)m=l.hasOwnProperty("$"+s[c].value),s[c].selected!==m&&(s[c].selected=m),m&&f&&(s[c].defaultSelected=!0)}else{for(c=""+no(c),l=null,m=0;m<s.length;m++){if(s[m].value===c){s[m].selected=!0,f&&(s[m].defaultSelected=!0);return}l!==null||s[m].disabled||(l=s[m])}l!==null&&(l.selected=!0)}}function HI(s,l,c){if(l!=null&&(l=""+no(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+no(c):""}function II(s,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(i(92));if(_e(f)){if(1<f.length)throw Error(i(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=no(l),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f)}function yh(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var mq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function PI(s,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":f?s.setProperty(l,c):typeof c!="number"||c===0||mq.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function NI(s,l,c){if(l!=null&&typeof l!="object")throw Error(i(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var m in l)f=l[m],l.hasOwnProperty(m)&&c[m]!==f&&PI(s,m,f)}else for(var v in l)l.hasOwnProperty(v)&&PI(s,v,l[v])}function MS(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dv(s){return vq.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var OS=null;function xS(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ch=null,bh=null;function DI(s){var l=ha(s);if(l&&(s=l.stateNode)){var c=s[Hi]||null;e:switch(s=l.stateNode,l.type){case"input":if(TS(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+io(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==s&&f.form===s.form){var m=f[Hi]||null;if(!m)throw Error(i(90));TS(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===s.form&&xI(f)}break e;case"textarea":HI(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&wh(s,!!c.multiple,l,!1)}}}var AS=!1;function LI(s,l,c){if(AS)return s(l,c);AS=!0;try{var f=s(l);return f}finally{if(AS=!1,(Ch!==null||bh!==null)&&(Zv(),Ch&&(l=Ch,s=bh,bh=Ch=null,DI(l),s)))for(l=0;l<s.length;l++)DI(s[l])}}function kf(s,l){var c=s.stateNode;if(c===null)return null;var f=c[Hi]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(i(231,l,typeof c));return c}var ga=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),HS=!1;if(ga)try{var Vf={};Object.defineProperty(Vf,"passive",{get:function(){HS=!0}}),window.addEventListener("test",Vf,Vf),window.removeEventListener("test",Vf,Vf)}catch{HS=!1}var Sl=null,IS=null,fv=null;function kI(){if(fv)return fv;var s,l=IS,c=l.length,f,m="value"in Sl?Sl.value:Sl.textContent,v=m.length;for(s=0;s<c&&l[s]===m[s];s++);var E=c-s;for(f=1;f<=E&&l[c-f]===m[v-f];f++);return fv=m.slice(s,1<f?1-f:void 0)}function gv(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function mv(){return!0}function VI(){return!1}function lr(s){function l(c,f,m,v,E){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var x in s)s.hasOwnProperty(x)&&(c=s[x],this[x]=c?c(v):v[x]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?mv:VI,this.isPropagationStopped=VI,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=mv)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=mv)},persist:function(){},isPersistent:mv}),l}var Nu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pv=lr(Nu),$f=g({},Nu,{view:0,detail:0}),wq=lr($f),PS,NS,Bf,vv=g({},$f,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:LS,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Bf&&(Bf&&s.type==="mousemove"?(PS=s.screenX-Bf.screenX,NS=s.screenY-Bf.screenY):NS=PS=0,Bf=s),PS)},movementY:function(s){return"movementY"in s?s.movementY:NS}}),$I=lr(vv),yq=g({},vv,{dataTransfer:0}),Cq=lr(yq),bq=g({},$f,{relatedTarget:0}),DS=lr(bq),Sq=g({},Nu,{animationName:0,elapsedTime:0,pseudoElement:0}),Rq=lr(Sq),Eq=g({},Nu,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Tq=lr(Eq),_q=g({},Nu,{data:0}),BI=lr(_q),Mq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Oq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Aq(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=xq[s])?!!l[s]:!1}function LS(){return Aq}var Hq=g({},$f,{key:function(s){if(s.key){var l=Mq[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=gv(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Oq[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:LS,charCode:function(s){return s.type==="keypress"?gv(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?gv(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Iq=lr(Hq),Pq=g({},vv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FI=lr(Pq),Nq=g({},$f,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:LS}),Dq=lr(Nq),Lq=g({},Nu,{propertyName:0,elapsedTime:0,pseudoElement:0}),kq=lr(Lq),Vq=g({},vv,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),$q=lr(Vq),Bq=g({},Nu,{newState:0,oldState:0}),Fq=lr(Bq),Wq=[9,13,27,32],kS=ga&&"CompositionEvent"in window,Ff=null;ga&&"documentMode"in document&&(Ff=document.documentMode);var jq=ga&&"TextEvent"in window&&!Ff,WI=ga&&(!kS||Ff&&8<Ff&&11>=Ff),jI=" ",UI=!1;function zI(s,l){switch(s){case"keyup":return Wq.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function YI(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Sh=!1;function Uq(s,l){switch(s){case"compositionend":return YI(l);case"keypress":return l.which!==32?null:(UI=!0,jI);case"textInput":return s=l.data,s===jI&&UI?null:s;default:return null}}function zq(s,l){if(Sh)return s==="compositionend"||!kS&&zI(s,l)?(s=kI(),fv=IS=Sl=null,Sh=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return WI&&l.locale!=="ko"?null:l.data;default:return null}}var Yq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function GI(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!Yq[s.type]:l==="textarea"}function qI(s,l,c,f){Ch?bh?bh.push(f):bh=[f]:Ch=f,l=iw(l,"onChange"),0<l.length&&(c=new pv("onChange","change",null,c,f),s.push({event:c,listeners:l}))}var Wf=null,jf=null;function Gq(s){OD(s,0)}function wv(s){var l=bl(s);if(xI(l))return s}function KI(s,l){if(s==="change")return l}var XI=!1;if(ga){var VS;if(ga){var $S="oninput"in document;if(!$S){var ZI=document.createElement("div");ZI.setAttribute("oninput","return;"),$S=typeof ZI.oninput=="function"}VS=$S}else VS=!1;XI=VS&&(!document.documentMode||9<document.documentMode)}function QI(){Wf&&(Wf.detachEvent("onpropertychange",JI),jf=Wf=null)}function JI(s){if(s.propertyName==="value"&&wv(jf)){var l=[];qI(l,jf,s,xS(s)),LI(Gq,l)}}function qq(s,l,c){s==="focusin"?(QI(),Wf=l,jf=c,Wf.attachEvent("onpropertychange",JI)):s==="focusout"&&QI()}function Kq(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return wv(jf)}function Xq(s,l){if(s==="click")return wv(l)}function Zq(s,l){if(s==="input"||s==="change")return wv(l)}function Qq(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Pr=typeof Object.is=="function"?Object.is:Qq;function Uf(s,l){if(Pr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!A.call(l,m)||!Pr(s[m],l[m]))return!1}return!0}function eP(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function tP(s,l){var c=eP(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=l&&f>=l)return{node:c,offset:l-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=eP(c)}}function nP(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?nP(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function iP(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=hv(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=hv(s.document)}return l}function BS(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Jq=ga&&"documentMode"in document&&11>=document.documentMode,Rh=null,FS=null,zf=null,WS=!1;function rP(s,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;WS||Rh==null||Rh!==hv(f)||(f=Rh,"selectionStart"in f&&BS(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),zf&&Uf(zf,f)||(zf=f,f=iw(FS,"onSelect"),0<f.length&&(l=new pv("onSelect","select",null,l,c),s.push({event:l,listeners:f}),l.target=Rh)))}function Du(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var Eh={animationend:Du("Animation","AnimationEnd"),animationiteration:Du("Animation","AnimationIteration"),animationstart:Du("Animation","AnimationStart"),transitionrun:Du("Transition","TransitionRun"),transitionstart:Du("Transition","TransitionStart"),transitioncancel:Du("Transition","TransitionCancel"),transitionend:Du("Transition","TransitionEnd")},jS={},oP={};ga&&(oP=document.createElement("div").style,"AnimationEvent"in window||(delete Eh.animationend.animation,delete Eh.animationiteration.animation,delete Eh.animationstart.animation),"TransitionEvent"in window||delete Eh.transitionend.transition);function Lu(s){if(jS[s])return jS[s];if(!Eh[s])return s;var l=Eh[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in oP)return jS[s]=l[c];return s}var sP=Lu("animationend"),aP=Lu("animationiteration"),lP=Lu("animationstart"),e4=Lu("transitionrun"),t4=Lu("transitionstart"),n4=Lu("transitioncancel"),uP=Lu("transitionend"),cP=new Map,US="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");US.push("scrollEnd");function $o(s,l){cP.set(s,l),be(l,[s])}var hP=new WeakMap;function ro(s,l){if(typeof s=="object"&&s!==null){var c=hP.get(s);return c!==void 0?c:(l={value:s,source:l,stack:MI(l)},hP.set(s,l),l)}return{value:s,source:l,stack:MI(l)}}var oo=[],Th=0,zS=0;function yv(){for(var s=Th,l=zS=Th=0;l<s;){var c=oo[l];oo[l++]=null;var f=oo[l];oo[l++]=null;var m=oo[l];oo[l++]=null;var v=oo[l];if(oo[l++]=null,f!==null&&m!==null){var E=f.pending;E===null?m.next=m:(m.next=E.next,E.next=m),f.pending=m}v!==0&&dP(c,m,v)}}function Cv(s,l,c,f){oo[Th++]=s,oo[Th++]=l,oo[Th++]=c,oo[Th++]=f,zS|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function YS(s,l,c,f){return Cv(s,l,c,f),bv(s)}function _h(s,l){return Cv(s,null,null,l),bv(s)}function dP(s,l,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var m=!1,v=s.return;v!==null;)v.childLanes|=c,f=v.alternate,f!==null&&(f.childLanes|=c),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&l!==null&&(m=31-gt(c),s=v.hiddenUpdates,f=s[m],f===null?s[m]=[l]:f.push(l),l.lane=c|536870912),v):null}function bv(s){if(50<pg)throw pg=0,QR=null,Error(i(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Mh={};function i4(s,l,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(s,l,c,f){return new i4(s,l,c,f)}function GS(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ma(s,l){var c=s.alternate;return c===null?(c=Nr(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function fP(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Sv(s,l,c,f,m,v){var E=0;if(f=s,typeof s=="function")GS(s)&&(E=1);else if(typeof s=="string")E=oK(s,c,R.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case le:return s=Nr(31,c,l,m),s.elementType=le,s.lanes=v,s;case b:return ku(c.children,m,v,l);case T:E=8,m|=24;break;case M:return s=Nr(12,c,l,m|2),s.elementType=M,s.lanes=v,s;case $:return s=Nr(13,c,l,m),s.elementType=$,s.lanes=v,s;case L:return s=Nr(19,c,l,m),s.elementType=L,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case I:case N:E=10;break e;case _:E=9;break e;case k:E=11;break e;case F:E=14;break e;case he:E=16,f=null;break e}E=29,c=Error(i(130,s===null?"null":typeof s,"")),f=null}return l=Nr(E,c,l,m),l.elementType=s,l.type=f,l.lanes=v,l}function ku(s,l,c,f){return s=Nr(7,s,f,l),s.lanes=c,s}function qS(s,l,c){return s=Nr(6,s,null,l),s.lanes=c,s}function KS(s,l,c){return l=Nr(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Oh=[],xh=0,Rv=null,Ev=0,so=[],ao=0,Vu=null,pa=1,va="";function $u(s,l){Oh[xh++]=Ev,Oh[xh++]=Rv,Rv=s,Ev=l}function gP(s,l,c){so[ao++]=pa,so[ao++]=va,so[ao++]=Vu,Vu=s;var f=pa;s=va;var m=32-gt(f)-1;f&=~(1<<m),c+=1;var v=32-gt(l)+m;if(30<v){var E=m-m%5;v=(f&(1<<E)-1).toString(32),f>>=E,m-=E,pa=1<<32-gt(l)+m|c<<m|f,va=v+s}else pa=1<<v|c<<m|f,va=s}function XS(s){s.return!==null&&($u(s,1),gP(s,1,0))}function ZS(s){for(;s===Rv;)Rv=Oh[--xh],Oh[xh]=null,Ev=Oh[--xh],Oh[xh]=null;for(;s===Vu;)Vu=so[--ao],so[ao]=null,va=so[--ao],so[ao]=null,pa=so[--ao],so[ao]=null}var Ui=null,Hn=null,kt=!1,Bu=null,Rs=!1,QS=Error(i(519));function Fu(s){var l=Error(i(418,""));throw qf(ro(l,s)),QS}function mP(s){var l=s.stateNode,c=s.type,f=s.memoizedProps;switch(l[li]=s,l[Hi]=f,c){case"dialog":yt("cancel",l),yt("close",l);break;case"iframe":case"object":case"embed":yt("load",l);break;case"video":case"audio":for(c=0;c<wg.length;c++)yt(wg[c],l);break;case"source":yt("error",l);break;case"img":case"image":case"link":yt("error",l),yt("load",l);break;case"details":yt("toggle",l);break;case"input":yt("invalid",l),AI(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),cv(l);break;case"select":yt("invalid",l);break;case"textarea":yt("invalid",l),II(l,f.value,f.defaultValue,f.children),cv(l)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||ID(l.textContent,c)?(f.popover!=null&&(yt("beforetoggle",l),yt("toggle",l)),f.onScroll!=null&&yt("scroll",l),f.onScrollEnd!=null&&yt("scrollend",l),f.onClick!=null&&(l.onclick=rw),l=!0):l=!1,l||Fu(s)}function pP(s){for(Ui=s.return;Ui;)switch(Ui.tag){case 5:case 13:Rs=!1;return;case 27:case 3:Rs=!0;return;default:Ui=Ui.return}}function Yf(s){if(s!==Ui)return!1;if(!kt)return pP(s),kt=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||g0(s.type,s.memoizedProps)),c=!c),c&&Hn&&Fu(s),pP(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(l===0){Hn=Fo(s.nextSibling);break e}l--}else c!=="$"&&c!=="$!"&&c!=="$?"||l++;s=s.nextSibling}Hn=null}}else l===27?(l=Hn,Vl(s.type)?(s=w0,w0=null,Hn=s):Hn=l):Hn=Ui?Fo(s.stateNode.nextSibling):null;return!0}function Gf(){Hn=Ui=null,kt=!1}function vP(){var s=Bu;return s!==null&&(hr===null?hr=s:hr.push.apply(hr,s),Bu=null),s}function qf(s){Bu===null?Bu=[s]:Bu.push(s)}var JS=ue(null),Wu=null,wa=null;function Rl(s,l,c){S(JS,l._currentValue),l._currentValue=c}function ya(s){s._currentValue=JS.current,C(JS)}function eR(s,l,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),s===c)break;s=s.return}}function tR(s,l,c,f){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var E=m.child;v=v.firstContext;e:for(;v!==null;){var x=v;v=m;for(var D=0;D<l.length;D++)if(x.context===l[D]){v.lanes|=c,x=v.alternate,x!==null&&(x.lanes|=c),eR(v.return,c,s),f||(E=null);break e}v=x.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(i(341));E.lanes|=c,v=E.alternate,v!==null&&(v.lanes|=c),eR(E,c,s),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===s){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function Kf(s,l,c,f){s=null;for(var m=l,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var x=m.type;Pr(m.pendingProps.value,E.value)||(s!==null?s.push(x):s=[x])}}else if(m===J.current){if(E=m.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Eg):s=[Eg])}m=m.return}s!==null&&tR(l,s,c,f),l.flags|=262144}function Tv(s){for(s=s.firstContext;s!==null;){if(!Pr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ju(s){Wu=s,wa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Pi(s){return wP(Wu,s)}function _v(s,l){return Wu===null&&ju(s),wP(s,l)}function wP(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},wa===null){if(s===null)throw Error(i(308));wa=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else wa=wa.next=l;return c}var r4=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},o4=t.unstable_scheduleCallback,s4=t.unstable_NormalPriority,ci={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nR(){return{controller:new r4,data:new Map,refCount:0}}function Xf(s){s.refCount--,s.refCount===0&&o4(s4,function(){s.controller.abort()})}var Zf=null,iR=0,Ah=0,Hh=null;function a4(s,l){if(Zf===null){var c=Zf=[];iR=0,Ah=o0(),Hh={status:"pending",value:void 0,then:function(f){c.push(f)}}}return iR++,l.then(yP,yP),l}function yP(){if(--iR===0&&Zf!==null){Hh!==null&&(Hh.status="fulfilled");var s=Zf;Zf=null,Ah=0,Hh=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function l4(s,l){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return s.then(function(){f.status="fulfilled",f.value=l;for(var m=0;m<c.length;m++)(0,c[m])(l)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var CP=se.S;se.S=function(s,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&a4(s,l),CP!==null&&CP(s,l)};var Uu=ue(null);function rR(){var s=Uu.current;return s!==null?s:sn.pooledCache}function Mv(s,l){l===null?S(Uu,Uu.current):S(Uu,l.pool)}function bP(){var s=rR();return s===null?null:{parent:ci._currentValue,pool:s}}var Qf=Error(i(460)),SP=Error(i(474)),Ov=Error(i(542)),oR={then:function(){}};function RP(s){return s=s.status,s==="fulfilled"||s==="rejected"}function xv(){}function EP(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(xv,xv),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,_P(s),s;default:if(typeof l.status=="string")l.then(xv,xv);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=l,s.status="pending",s.then(function(f){if(l.status==="pending"){var m=l;m.status="fulfilled",m.value=f}},function(f){if(l.status==="pending"){var m=l;m.status="rejected",m.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,_P(s),s}throw Jf=l,Qf}}var Jf=null;function TP(){if(Jf===null)throw Error(i(459));var s=Jf;return Jf=null,s}function _P(s){if(s===Qf||s===Ov)throw Error(i(483))}var El=!1;function sR(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function aR(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Tl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function _l(s,l,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Yt&2)!==0){var m=f.pending;return m===null?l.next=l:(l.next=m.next,m.next=l),f.pending=l,l=bv(s),dP(s,null,c),l}return Cv(s,f,l,c),bv(s)}function eg(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Bn(s,c)}}function lR(s,l){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var E={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?m=v=E:v=v.next=E,c=c.next}while(c!==null);v===null?m=v=l:v=v.next=l}else m=v=l;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var uR=!1;function tg(){if(uR){var s=Hh;if(s!==null)throw s}}function ng(s,l,c,f){uR=!1;var m=s.updateQueue;El=!1;var v=m.firstBaseUpdate,E=m.lastBaseUpdate,x=m.shared.pending;if(x!==null){m.shared.pending=null;var D=x,ne=D.next;D.next=null,E===null?v=ne:E.next=ne,E=D;var de=s.alternate;de!==null&&(de=de.updateQueue,x=de.lastBaseUpdate,x!==E&&(x===null?de.firstBaseUpdate=ne:x.next=ne,de.lastBaseUpdate=D))}if(v!==null){var ve=m.baseState;E=0,de=ne=D=null,x=v;do{var re=x.lane&-536870913,oe=re!==x.lane;if(oe?(_t&re)===re:(f&re)===re){re!==0&&re===Ah&&(uR=!0),de!==null&&(de=de.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var Ze=s,Ke=x;re=l;var Jt=c;switch(Ke.tag){case 1:if(Ze=Ke.payload,typeof Ze=="function"){ve=Ze.call(Jt,ve,re);break e}ve=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Ke.payload,re=typeof Ze=="function"?Ze.call(Jt,ve,re):Ze,re==null)break e;ve=g({},ve,re);break e;case 2:El=!0}}re=x.callback,re!==null&&(s.flags|=64,oe&&(s.flags|=8192),oe=m.callbacks,oe===null?m.callbacks=[re]:oe.push(re))}else oe={lane:re,tag:x.tag,payload:x.payload,callback:x.callback,next:null},de===null?(ne=de=oe,D=ve):de=de.next=oe,E|=re;if(x=x.next,x===null){if(x=m.shared.pending,x===null)break;oe=x,x=oe.next,oe.next=null,m.lastBaseUpdate=oe,m.shared.pending=null}}while(!0);de===null&&(D=ve),m.baseState=D,m.firstBaseUpdate=ne,m.lastBaseUpdate=de,v===null&&(m.shared.lanes=0),Nl|=E,s.lanes=E,s.memoizedState=ve}}function MP(s,l){if(typeof s!="function")throw Error(i(191,s));s.call(l)}function OP(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)MP(c[s],l)}var Ih=ue(null),Av=ue(0);function xP(s,l){s=_a,S(Av,s),S(Ih,l),_a=s|l.baseLanes}function cR(){S(Av,_a),S(Ih,Ih.current)}function hR(){_a=Av.current,C(Ih),C(Av)}var Ml=0,mt=null,Zt=null,Xn=null,Hv=!1,Ph=!1,zu=!1,Iv=0,ig=0,Nh=null,u4=0;function Fn(){throw Error(i(321))}function dR(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!Pr(s[c],l[c]))return!1;return!0}function fR(s,l,c,f,m,v){return Ml=v,mt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,se.H=s===null||s.memoizedState===null?dN:fN,zu=!1,v=c(f,m),zu=!1,Ph&&(v=HP(l,c,f,m)),AP(s),v}function AP(s){se.H=Vv;var l=Zt!==null&&Zt.next!==null;if(Ml=0,Xn=Zt=mt=null,Hv=!1,ig=0,Nh=null,l)throw Error(i(300));s===null||pi||(s=s.dependencies,s!==null&&Tv(s)&&(pi=!0))}function HP(s,l,c,f){mt=s;var m=0;do{if(Ph&&(Nh=null),ig=0,Ph=!1,25<=m)throw Error(i(301));if(m+=1,Xn=Zt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}se.H=p4,v=l(c,f)}while(Ph);return v}function c4(){var s=se.H,l=s.useState()[0];return l=typeof l.then=="function"?rg(l):l,s=s.useState()[0],(Zt!==null?Zt.memoizedState:null)!==s&&(mt.flags|=1024),l}function gR(){var s=Iv!==0;return Iv=0,s}function mR(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function pR(s){if(Hv){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Hv=!1}Ml=0,Xn=Zt=mt=null,Ph=!1,ig=Iv=0,Nh=null}function ur(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?mt.memoizedState=Xn=s:Xn=Xn.next=s,Xn}function Zn(){if(Zt===null){var s=mt.alternate;s=s!==null?s.memoizedState:null}else s=Zt.next;var l=Xn===null?mt.memoizedState:Xn.next;if(l!==null)Xn=l,Zt=s;else{if(s===null)throw mt.alternate===null?Error(i(467)):Error(i(310));Zt=s,s={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},Xn===null?mt.memoizedState=Xn=s:Xn=Xn.next=s}return Xn}function vR(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rg(s){var l=ig;return ig+=1,Nh===null&&(Nh=[]),s=EP(Nh,s,l),l=mt,(Xn===null?l.memoizedState:Xn.next)===null&&(l=l.alternate,se.H=l===null||l.memoizedState===null?dN:fN),s}function Pv(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return rg(s);if(s.$$typeof===N)return Pi(s)}throw Error(i(438,String(s)))}function wR(s){var l=null,c=mt.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=mt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(m){return m.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=vR(),mt.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),f=0;f<s;f++)c[f]=G;return l.index++,c}function Ca(s,l){return typeof l=="function"?l(s):l}function Nv(s){var l=Zn();return yR(l,Zt,s)}function yR(s,l,c){var f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=c;var m=s.baseQueue,v=f.pending;if(v!==null){if(m!==null){var E=m.next;m.next=v.next,v.next=E}l.baseQueue=m=v,f.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{l=m.next;var x=E=null,D=null,ne=l,de=!1;do{var ve=ne.lane&-536870913;if(ve!==ne.lane?(_t&ve)===ve:(Ml&ve)===ve){var re=ne.revertLane;if(re===0)D!==null&&(D=D.next={lane:0,revertLane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ve===Ah&&(de=!0);else if((Ml&re)===re){ne=ne.next,re===Ah&&(de=!0);continue}else ve={lane:0,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},D===null?(x=D=ve,E=v):D=D.next=ve,mt.lanes|=re,Nl|=re;ve=ne.action,zu&&c(v,ve),v=ne.hasEagerState?ne.eagerState:c(v,ve)}else re={lane:ve,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},D===null?(x=D=re,E=v):D=D.next=re,mt.lanes|=ve,Nl|=ve;ne=ne.next}while(ne!==null&&ne!==l);if(D===null?E=v:D.next=x,!Pr(v,s.memoizedState)&&(pi=!0,de&&(c=Hh,c!==null)))throw c;s.memoizedState=v,s.baseState=E,s.baseQueue=D,f.lastRenderedState=v}return m===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function CR(s){var l=Zn(),c=l.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=s;var f=c.dispatch,m=c.pending,v=l.memoizedState;if(m!==null){c.pending=null;var E=m=m.next;do v=s(v,E.action),E=E.next;while(E!==m);Pr(v,l.memoizedState)||(pi=!0),l.memoizedState=v,l.baseQueue===null&&(l.baseState=v),c.lastRenderedState=v}return[v,f]}function IP(s,l,c){var f=mt,m=Zn(),v=kt;if(v){if(c===void 0)throw Error(i(407));c=c()}else c=l();var E=!Pr((Zt||m).memoizedState,c);E&&(m.memoizedState=c,pi=!0),m=m.queue;var x=DP.bind(null,f,m,s);if(og(2048,8,x,[s]),m.getSnapshot!==l||E||Xn!==null&&Xn.memoizedState.tag&1){if(f.flags|=2048,Dh(9,Dv(),NP.bind(null,f,m,c,l),null),sn===null)throw Error(i(349));v||(Ml&124)!==0||PP(f,l,c)}return c}function PP(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=mt.updateQueue,l===null?(l=vR(),mt.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function NP(s,l,c,f){l.value=c,l.getSnapshot=f,LP(l)&&kP(s)}function DP(s,l,c){return c(function(){LP(l)&&kP(s)})}function LP(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!Pr(s,c)}catch{return!0}}function kP(s){var l=_h(s,2);l!==null&&$r(l,s,2)}function bR(s){var l=ur();if(typeof s=="function"){var c=s;if(s=c(),zu){Je(!0);try{c()}finally{Je(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:s},l}function VP(s,l,c,f){return s.baseState=c,yR(s,Zt,typeof f=="function"?f:Ca)}function h4(s,l,c,f,m){if(kv(s))throw Error(i(485));if(s=l.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};se.T!==null?c(!0):v.isTransition=!1,f(v),c=l.pending,c===null?(v.next=l.pending=v,$P(l,v)):(v.next=c.next,l.pending=c.next=v)}}function $P(s,l){var c=l.action,f=l.payload,m=s.state;if(l.isTransition){var v=se.T,E={};se.T=E;try{var x=c(m,f),D=se.S;D!==null&&D(E,x),BP(s,l,x)}catch(ne){SR(s,l,ne)}finally{se.T=v}}else try{v=c(m,f),BP(s,l,v)}catch(ne){SR(s,l,ne)}}function BP(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){FP(s,l,f)},function(f){return SR(s,l,f)}):FP(s,l,c)}function FP(s,l,c){l.status="fulfilled",l.value=c,WP(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,$P(s,c)))}function SR(s,l,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,WP(l),l=l.next;while(l!==f)}s.action=null}function WP(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function jP(s,l){return l}function UP(s,l){if(kt){var c=sn.formState;if(c!==null){e:{var f=mt;if(kt){if(Hn){t:{for(var m=Hn,v=Rs;m.nodeType!==8;){if(!v){m=null;break t}if(m=Fo(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Hn=Fo(m.nextSibling),f=m.data==="F!";break e}}Fu(f)}f=!1}f&&(l=c[0])}}return c=ur(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jP,lastRenderedState:l},c.queue=f,c=uN.bind(null,mt,f),f.dispatch=c,f=bR(!1),v=MR.bind(null,mt,!1,f.queue),f=ur(),m={state:l,dispatch:null,action:s,pending:null},f.queue=m,c=h4.bind(null,mt,m,v,c),m.dispatch=c,f.memoizedState=s,[l,c,!1]}function zP(s){var l=Zn();return YP(l,Zt,s)}function YP(s,l,c){if(l=yR(s,l,jP)[0],s=Nv(Ca)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=rg(l)}catch(E){throw E===Qf?Ov:E}else f=l;l=Zn();var m=l.queue,v=m.dispatch;return c!==l.memoizedState&&(mt.flags|=2048,Dh(9,Dv(),d4.bind(null,m,c),null)),[f,v,s]}function d4(s,l){s.action=l}function GP(s){var l=Zn(),c=Zt;if(c!==null)return YP(l,c,s);Zn(),l=l.memoizedState,c=Zn();var f=c.queue.dispatch;return c.memoizedState=s,[l,f,!1]}function Dh(s,l,c,f){return s={tag:s,create:c,deps:f,inst:l,next:null},l=mt.updateQueue,l===null&&(l=vR(),mt.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,l.lastEffect=s),s}function Dv(){return{destroy:void 0,resource:void 0}}function qP(){return Zn().memoizedState}function Lv(s,l,c,f){var m=ur();f=f===void 0?null:f,mt.flags|=s,m.memoizedState=Dh(1|l,Dv(),c,f)}function og(s,l,c,f){var m=Zn();f=f===void 0?null:f;var v=m.memoizedState.inst;Zt!==null&&f!==null&&dR(f,Zt.memoizedState.deps)?m.memoizedState=Dh(l,v,c,f):(mt.flags|=s,m.memoizedState=Dh(1|l,v,c,f))}function KP(s,l){Lv(8390656,8,s,l)}function XP(s,l){og(2048,8,s,l)}function ZP(s,l){return og(4,2,s,l)}function QP(s,l){return og(4,4,s,l)}function JP(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function eN(s,l,c){c=c!=null?c.concat([s]):null,og(4,4,JP.bind(null,l,s),c)}function RR(){}function tN(s,l){var c=Zn();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&dR(l,f[1])?f[0]:(c.memoizedState=[s,l],s)}function nN(s,l){var c=Zn();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&dR(l,f[1]))return f[0];if(f=s(),zu){Je(!0);try{s()}finally{Je(!1)}}return c.memoizedState=[f,l],f}function ER(s,l,c){return c===void 0||(Ml&1073741824)!==0?s.memoizedState=l:(s.memoizedState=c,s=oD(),mt.lanes|=s,Nl|=s,c)}function iN(s,l,c,f){return Pr(c,l)?c:Ih.current!==null?(s=ER(s,c,f),Pr(s,l)||(pi=!0),s):(Ml&42)===0?(pi=!0,s.memoizedState=c):(s=oD(),mt.lanes|=s,Nl|=s,l)}function rN(s,l,c,f,m){var v=fe.p;fe.p=v!==0&&8>v?v:8;var E=se.T,x={};se.T=x,MR(s,!1,l,c);try{var D=m(),ne=se.S;if(ne!==null&&ne(x,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var de=l4(D,f);sg(s,l,de,Vr(s))}else sg(s,l,f,Vr(s))}catch(ve){sg(s,l,{then:function(){},status:"rejected",reason:ve},Vr())}finally{fe.p=v,se.T=E}}function f4(){}function TR(s,l,c,f){if(s.tag!==5)throw Error(i(476));var m=oN(s).queue;rN(s,m,l,Te,c===null?f4:function(){return sN(s),c(f)})}function oN(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:Te},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function sN(s){var l=oN(s).next.queue;sg(s,l,{},Vr())}function _R(){return Pi(Eg)}function aN(){return Zn().memoizedState}function lN(){return Zn().memoizedState}function g4(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=Vr();s=Tl(c);var f=_l(l,s,c);f!==null&&($r(f,l,c),eg(f,l,c)),l={cache:nR()},s.payload=l;return}l=l.return}}function m4(s,l,c){var f=Vr();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},kv(s)?cN(l,c):(c=YS(s,l,c,f),c!==null&&($r(c,s,f),hN(c,l,f)))}function uN(s,l,c){var f=Vr();sg(s,l,c,f)}function sg(s,l,c,f){var m={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(kv(s))cN(l,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=l.lastRenderedReducer,v!==null))try{var E=l.lastRenderedState,x=v(E,c);if(m.hasEagerState=!0,m.eagerState=x,Pr(x,E))return Cv(s,l,m,0),sn===null&&yv(),!1}catch{}finally{}if(c=YS(s,l,m,f),c!==null)return $r(c,s,f),hN(c,l,f),!0}return!1}function MR(s,l,c,f){if(f={lane:2,revertLane:o0(),action:f,hasEagerState:!1,eagerState:null,next:null},kv(s)){if(l)throw Error(i(479))}else l=YS(s,c,f,2),l!==null&&$r(l,s,2)}function kv(s){var l=s.alternate;return s===mt||l!==null&&l===mt}function cN(s,l){Ph=Hv=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function hN(s,l,c){if((c&4194048)!==0){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Bn(s,c)}}var Vv={readContext:Pi,use:Pv,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn,useHostTransitionStatus:Fn,useFormState:Fn,useActionState:Fn,useOptimistic:Fn,useMemoCache:Fn,useCacheRefresh:Fn},dN={readContext:Pi,use:Pv,useCallback:function(s,l){return ur().memoizedState=[s,l===void 0?null:l],s},useContext:Pi,useEffect:KP,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Lv(4194308,4,JP.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Lv(4194308,4,s,l)},useInsertionEffect:function(s,l){Lv(4,2,s,l)},useMemo:function(s,l){var c=ur();l=l===void 0?null:l;var f=s();if(zu){Je(!0);try{s()}finally{Je(!1)}}return c.memoizedState=[f,l],f},useReducer:function(s,l,c){var f=ur();if(c!==void 0){var m=c(l);if(zu){Je(!0);try{c(l)}finally{Je(!1)}}}else m=l;return f.memoizedState=f.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},f.queue=s,s=s.dispatch=m4.bind(null,mt,s),[f.memoizedState,s]},useRef:function(s){var l=ur();return s={current:s},l.memoizedState=s},useState:function(s){s=bR(s);var l=s.queue,c=uN.bind(null,mt,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:RR,useDeferredValue:function(s,l){var c=ur();return ER(c,s,l)},useTransition:function(){var s=bR(!1);return s=rN.bind(null,mt,s.queue,!0,!1),ur().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var f=mt,m=ur();if(kt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=l(),sn===null)throw Error(i(349));(_t&124)!==0||PP(f,l,c)}m.memoizedState=c;var v={value:c,getSnapshot:l};return m.queue=v,KP(DP.bind(null,f,v,s),[s]),f.flags|=2048,Dh(9,Dv(),NP.bind(null,f,v,c,l),null),c},useId:function(){var s=ur(),l=sn.identifierPrefix;if(kt){var c=va,f=pa;c=(f&~(1<<32-gt(f)-1)).toString(32)+c,l="«"+l+"R"+c,c=Iv++,0<c&&(l+="H"+c.toString(32)),l+="»"}else c=u4++,l="«"+l+"r"+c.toString(32)+"»";return s.memoizedState=l},useHostTransitionStatus:_R,useFormState:UP,useActionState:UP,useOptimistic:function(s){var l=ur();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=MR.bind(null,mt,!0,c),c.dispatch=l,[s,l]},useMemoCache:wR,useCacheRefresh:function(){return ur().memoizedState=g4.bind(null,mt)}},fN={readContext:Pi,use:Pv,useCallback:tN,useContext:Pi,useEffect:XP,useImperativeHandle:eN,useInsertionEffect:ZP,useLayoutEffect:QP,useMemo:nN,useReducer:Nv,useRef:qP,useState:function(){return Nv(Ca)},useDebugValue:RR,useDeferredValue:function(s,l){var c=Zn();return iN(c,Zt.memoizedState,s,l)},useTransition:function(){var s=Nv(Ca)[0],l=Zn().memoizedState;return[typeof s=="boolean"?s:rg(s),l]},useSyncExternalStore:IP,useId:aN,useHostTransitionStatus:_R,useFormState:zP,useActionState:zP,useOptimistic:function(s,l){var c=Zn();return VP(c,Zt,s,l)},useMemoCache:wR,useCacheRefresh:lN},p4={readContext:Pi,use:Pv,useCallback:tN,useContext:Pi,useEffect:XP,useImperativeHandle:eN,useInsertionEffect:ZP,useLayoutEffect:QP,useMemo:nN,useReducer:CR,useRef:qP,useState:function(){return CR(Ca)},useDebugValue:RR,useDeferredValue:function(s,l){var c=Zn();return Zt===null?ER(c,s,l):iN(c,Zt.memoizedState,s,l)},useTransition:function(){var s=CR(Ca)[0],l=Zn().memoizedState;return[typeof s=="boolean"?s:rg(s),l]},useSyncExternalStore:IP,useId:aN,useHostTransitionStatus:_R,useFormState:GP,useActionState:GP,useOptimistic:function(s,l){var c=Zn();return Zt!==null?VP(c,Zt,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:wR,useCacheRefresh:lN},Lh=null,ag=0;function $v(s){var l=ag;return ag+=1,Lh===null&&(Lh=[]),EP(Lh,s,l)}function lg(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Bv(s,l){throw l.$$typeof===p?Error(i(525)):(s=Object.prototype.toString.call(l),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function gN(s){var l=s._init;return l(s._payload)}function mN(s){function l(Q,z){if(s){var ee=Q.deletions;ee===null?(Q.deletions=[z],Q.flags|=16):ee.push(z)}}function c(Q,z){if(!s)return null;for(;z!==null;)l(Q,z),z=z.sibling;return null}function f(Q){for(var z=new Map;Q!==null;)Q.key!==null?z.set(Q.key,Q):z.set(Q.index,Q),Q=Q.sibling;return z}function m(Q,z){return Q=ma(Q,z),Q.index=0,Q.sibling=null,Q}function v(Q,z,ee){return Q.index=ee,s?(ee=Q.alternate,ee!==null?(ee=ee.index,ee<z?(Q.flags|=67108866,z):ee):(Q.flags|=67108866,z)):(Q.flags|=1048576,z)}function E(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function x(Q,z,ee,me){return z===null||z.tag!==6?(z=qS(ee,Q.mode,me),z.return=Q,z):(z=m(z,ee),z.return=Q,z)}function D(Q,z,ee,me){var ke=ee.type;return ke===b?de(Q,z,ee.props.children,me,ee.key):z!==null&&(z.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===he&&gN(ke)===z.type)?(z=m(z,ee.props),lg(z,ee),z.return=Q,z):(z=Sv(ee.type,ee.key,ee.props,null,Q.mode,me),lg(z,ee),z.return=Q,z)}function ne(Q,z,ee,me){return z===null||z.tag!==4||z.stateNode.containerInfo!==ee.containerInfo||z.stateNode.implementation!==ee.implementation?(z=KS(ee,Q.mode,me),z.return=Q,z):(z=m(z,ee.children||[]),z.return=Q,z)}function de(Q,z,ee,me,ke){return z===null||z.tag!==7?(z=ku(ee,Q.mode,me,ke),z.return=Q,z):(z=m(z,ee),z.return=Q,z)}function ve(Q,z,ee){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=qS(""+z,Q.mode,ee),z.return=Q,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case w:return ee=Sv(z.type,z.key,z.props,null,Q.mode,ee),lg(ee,z),ee.return=Q,ee;case y:return z=KS(z,Q.mode,ee),z.return=Q,z;case he:var me=z._init;return z=me(z._payload),ve(Q,z,ee)}if(_e(z)||we(z))return z=ku(z,Q.mode,ee,null),z.return=Q,z;if(typeof z.then=="function")return ve(Q,$v(z),ee);if(z.$$typeof===N)return ve(Q,_v(Q,z),ee);Bv(Q,z)}return null}function re(Q,z,ee,me){var ke=z!==null?z.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ke!==null?null:x(Q,z,""+ee,me);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:return ee.key===ke?D(Q,z,ee,me):null;case y:return ee.key===ke?ne(Q,z,ee,me):null;case he:return ke=ee._init,ee=ke(ee._payload),re(Q,z,ee,me)}if(_e(ee)||we(ee))return ke!==null?null:de(Q,z,ee,me,null);if(typeof ee.then=="function")return re(Q,z,$v(ee),me);if(ee.$$typeof===N)return re(Q,z,_v(Q,ee),me);Bv(Q,ee)}return null}function oe(Q,z,ee,me,ke){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Q=Q.get(ee)||null,x(z,Q,""+me,ke);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case w:return Q=Q.get(me.key===null?ee:me.key)||null,D(z,Q,me,ke);case y:return Q=Q.get(me.key===null?ee:me.key)||null,ne(z,Q,me,ke);case he:var pt=me._init;return me=pt(me._payload),oe(Q,z,ee,me,ke)}if(_e(me)||we(me))return Q=Q.get(ee)||null,de(z,Q,me,ke,null);if(typeof me.then=="function")return oe(Q,z,ee,$v(me),ke);if(me.$$typeof===N)return oe(Q,z,ee,_v(z,me),ke);Bv(z,me)}return null}function Ze(Q,z,ee,me){for(var ke=null,pt=null,je=z,Xe=z=0,wi=null;je!==null&&Xe<ee.length;Xe++){je.index>Xe?(wi=je,je=null):wi=je.sibling;var Pt=re(Q,je,ee[Xe],me);if(Pt===null){je===null&&(je=wi);break}s&&je&&Pt.alternate===null&&l(Q,je),z=v(Pt,z,Xe),pt===null?ke=Pt:pt.sibling=Pt,pt=Pt,je=wi}if(Xe===ee.length)return c(Q,je),kt&&$u(Q,Xe),ke;if(je===null){for(;Xe<ee.length;Xe++)je=ve(Q,ee[Xe],me),je!==null&&(z=v(je,z,Xe),pt===null?ke=je:pt.sibling=je,pt=je);return kt&&$u(Q,Xe),ke}for(je=f(je);Xe<ee.length;Xe++)wi=oe(je,Q,Xe,ee[Xe],me),wi!==null&&(s&&wi.alternate!==null&&je.delete(wi.key===null?Xe:wi.key),z=v(wi,z,Xe),pt===null?ke=wi:pt.sibling=wi,pt=wi);return s&&je.forEach(function(jl){return l(Q,jl)}),kt&&$u(Q,Xe),ke}function Ke(Q,z,ee,me){if(ee==null)throw Error(i(151));for(var ke=null,pt=null,je=z,Xe=z=0,wi=null,Pt=ee.next();je!==null&&!Pt.done;Xe++,Pt=ee.next()){je.index>Xe?(wi=je,je=null):wi=je.sibling;var jl=re(Q,je,Pt.value,me);if(jl===null){je===null&&(je=wi);break}s&&je&&jl.alternate===null&&l(Q,je),z=v(jl,z,Xe),pt===null?ke=jl:pt.sibling=jl,pt=jl,je=wi}if(Pt.done)return c(Q,je),kt&&$u(Q,Xe),ke;if(je===null){for(;!Pt.done;Xe++,Pt=ee.next())Pt=ve(Q,Pt.value,me),Pt!==null&&(z=v(Pt,z,Xe),pt===null?ke=Pt:pt.sibling=Pt,pt=Pt);return kt&&$u(Q,Xe),ke}for(je=f(je);!Pt.done;Xe++,Pt=ee.next())Pt=oe(je,Q,Xe,Pt.value,me),Pt!==null&&(s&&Pt.alternate!==null&&je.delete(Pt.key===null?Xe:Pt.key),z=v(Pt,z,Xe),pt===null?ke=Pt:pt.sibling=Pt,pt=Pt);return s&&je.forEach(function(vK){return l(Q,vK)}),kt&&$u(Q,Xe),ke}function Jt(Q,z,ee,me){if(typeof ee=="object"&&ee!==null&&ee.type===b&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:e:{for(var ke=ee.key;z!==null;){if(z.key===ke){if(ke=ee.type,ke===b){if(z.tag===7){c(Q,z.sibling),me=m(z,ee.props.children),me.return=Q,Q=me;break e}}else if(z.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===he&&gN(ke)===z.type){c(Q,z.sibling),me=m(z,ee.props),lg(me,ee),me.return=Q,Q=me;break e}c(Q,z);break}else l(Q,z);z=z.sibling}ee.type===b?(me=ku(ee.props.children,Q.mode,me,ee.key),me.return=Q,Q=me):(me=Sv(ee.type,ee.key,ee.props,null,Q.mode,me),lg(me,ee),me.return=Q,Q=me)}return E(Q);case y:e:{for(ke=ee.key;z!==null;){if(z.key===ke)if(z.tag===4&&z.stateNode.containerInfo===ee.containerInfo&&z.stateNode.implementation===ee.implementation){c(Q,z.sibling),me=m(z,ee.children||[]),me.return=Q,Q=me;break e}else{c(Q,z);break}else l(Q,z);z=z.sibling}me=KS(ee,Q.mode,me),me.return=Q,Q=me}return E(Q);case he:return ke=ee._init,ee=ke(ee._payload),Jt(Q,z,ee,me)}if(_e(ee))return Ze(Q,z,ee,me);if(we(ee)){if(ke=we(ee),typeof ke!="function")throw Error(i(150));return ee=ke.call(ee),Ke(Q,z,ee,me)}if(typeof ee.then=="function")return Jt(Q,z,$v(ee),me);if(ee.$$typeof===N)return Jt(Q,z,_v(Q,ee),me);Bv(Q,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,z!==null&&z.tag===6?(c(Q,z.sibling),me=m(z,ee),me.return=Q,Q=me):(c(Q,z),me=qS(ee,Q.mode,me),me.return=Q,Q=me),E(Q)):c(Q,z)}return function(Q,z,ee,me){try{ag=0;var ke=Jt(Q,z,ee,me);return Lh=null,ke}catch(je){if(je===Qf||je===Ov)throw je;var pt=Nr(29,je,null,Q.mode);return pt.lanes=me,pt.return=Q,pt}finally{}}}var kh=mN(!0),pN=mN(!1),lo=ue(null),Es=null;function Ol(s){var l=s.alternate;S(hi,hi.current&1),S(lo,s),Es===null&&(l===null||Ih.current!==null||l.memoizedState!==null)&&(Es=s)}function vN(s){if(s.tag===22){if(S(hi,hi.current),S(lo,s),Es===null){var l=s.alternate;l!==null&&l.memoizedState!==null&&(Es=s)}}else xl()}function xl(){S(hi,hi.current),S(lo,lo.current)}function ba(s){C(lo),Es===s&&(Es=null),C(hi)}var hi=ue(0);function Fv(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||v0(c)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}function OR(s,l,c,f){l=s.memoizedState,c=c(f,l),c=c==null?l:g({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var xR={enqueueSetState:function(s,l,c){s=s._reactInternals;var f=Vr(),m=Tl(f);m.payload=l,c!=null&&(m.callback=c),l=_l(s,m,f),l!==null&&($r(l,s,f),eg(l,s,f))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var f=Vr(),m=Tl(f);m.tag=1,m.payload=l,c!=null&&(m.callback=c),l=_l(s,m,f),l!==null&&($r(l,s,f),eg(l,s,f))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=Vr(),f=Tl(c);f.tag=2,l!=null&&(f.callback=l),l=_l(s,f,c),l!==null&&($r(l,s,c),eg(l,s,c))}};function wN(s,l,c,f,m,v,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,E):l.prototype&&l.prototype.isPureReactComponent?!Uf(c,f)||!Uf(m,v):!0}function yN(s,l,c,f){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==s&&xR.enqueueReplaceState(l,l.state,null)}function Yu(s,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(s=s.defaultProps){c===l&&(c=g({},c));for(var m in s)c[m]===void 0&&(c[m]=s[m])}return c}var Wv=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function CN(s){Wv(s)}function bN(s){console.error(s)}function SN(s){Wv(s)}function jv(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function RN(s,l,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function AR(s,l,c){return c=Tl(c),c.tag=3,c.payload={element:null},c.callback=function(){jv(s,l)},c}function EN(s){return s=Tl(s),s.tag=3,s}function TN(s,l,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var v=f.value;s.payload=function(){return m(v)},s.callback=function(){RN(l,c,f)}}var E=c.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(s.callback=function(){RN(l,c,f),typeof m!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var x=f.stack;this.componentDidCatch(f.value,{componentStack:x!==null?x:""})})}function v4(s,l,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&Kf(l,c,m,!0),c=lo.current,c!==null){switch(c.tag){case 13:return Es===null?e0():c.alternate===null&&In===0&&(In=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===oR?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),n0(s,f,m)),!1;case 22:return c.flags|=65536,f===oR?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),n0(s,f,m)),!1}throw Error(i(435,c.tag))}return n0(s,f,m),e0(),!1}if(kt)return l=lo.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=m,f!==QS&&(s=Error(i(422),{cause:f}),qf(ro(s,c)))):(f!==QS&&(l=Error(i(423),{cause:f}),qf(ro(l,c))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,f=ro(f,c),m=AR(s.stateNode,f,m),lR(s,m),In!==4&&(In=2)),!1;var v=Error(i(520),{cause:f});if(v=ro(v,c),mg===null?mg=[v]:mg.push(v),In!==4&&(In=2),l===null)return!0;f=ro(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=m&-m,c.lanes|=s,s=AR(c.stateNode,f,s),lR(c,s),!1;case 1:if(l=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Dl===null||!Dl.has(v))))return c.flags|=65536,m&=-m,c.lanes|=m,m=EN(m),TN(m,s,c,f),lR(c,m),!1}c=c.return}while(c!==null);return!1}var _N=Error(i(461)),pi=!1;function Ti(s,l,c,f){l.child=s===null?pN(l,null,c,f):kh(l,s.child,c,f)}function MN(s,l,c,f,m){c=c.render;var v=l.ref;if("ref"in f){var E={};for(var x in f)x!=="ref"&&(E[x]=f[x])}else E=f;return ju(l),f=fR(s,l,c,E,v,m),x=gR(),s!==null&&!pi?(mR(s,l,m),Sa(s,l,m)):(kt&&x&&XS(l),l.flags|=1,Ti(s,l,f,m),l.child)}function ON(s,l,c,f,m){if(s===null){var v=c.type;return typeof v=="function"&&!GS(v)&&v.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=v,xN(s,l,v,f,m)):(s=Sv(c.type,null,f,l,l.mode,m),s.ref=l.ref,s.return=l,l.child=s)}if(v=s.child,!VR(s,m)){var E=v.memoizedProps;if(c=c.compare,c=c!==null?c:Uf,c(E,f)&&s.ref===l.ref)return Sa(s,l,m)}return l.flags|=1,s=ma(v,f),s.ref=l.ref,s.return=l,l.child=s}function xN(s,l,c,f,m){if(s!==null){var v=s.memoizedProps;if(Uf(v,f)&&s.ref===l.ref)if(pi=!1,l.pendingProps=f=v,VR(s,m))(s.flags&131072)!==0&&(pi=!0);else return l.lanes=s.lanes,Sa(s,l,m)}return HR(s,l,c,f,m)}function AN(s,l,c){var f=l.pendingProps,m=f.children,v=s!==null?s.memoizedState:null;if(f.mode==="hidden"){if((l.flags&128)!==0){if(f=v!==null?v.baseLanes|c:c,s!==null){for(m=l.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;l.childLanes=v&~f}else l.childLanes=0,l.child=null;return HN(s,l,f,c)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Mv(l,v!==null?v.cachePool:null),v!==null?xP(l,v):cR(),vN(l);else return l.lanes=l.childLanes=536870912,HN(s,l,v!==null?v.baseLanes|c:c,c)}else v!==null?(Mv(l,v.cachePool),xP(l,v),xl(),l.memoizedState=null):(s!==null&&Mv(l,null),cR(),xl());return Ti(s,l,m,c),l.child}function HN(s,l,c,f){var m=rR();return m=m===null?null:{parent:ci._currentValue,pool:m},l.memoizedState={baseLanes:c,cachePool:m},s!==null&&Mv(l,null),cR(),vN(l),s!==null&&Kf(s,l,f,!0),null}function Uv(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function HR(s,l,c,f,m){return ju(l),c=fR(s,l,c,f,void 0,m),f=gR(),s!==null&&!pi?(mR(s,l,m),Sa(s,l,m)):(kt&&f&&XS(l),l.flags|=1,Ti(s,l,c,m),l.child)}function IN(s,l,c,f,m,v){return ju(l),l.updateQueue=null,c=HP(l,f,c,m),AP(s),f=gR(),s!==null&&!pi?(mR(s,l,v),Sa(s,l,v)):(kt&&f&&XS(l),l.flags|=1,Ti(s,l,c,v),l.child)}function PN(s,l,c,f,m){if(ju(l),l.stateNode===null){var v=Mh,E=c.contextType;typeof E=="object"&&E!==null&&(v=Pi(E)),v=new c(f,v),l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=xR,l.stateNode=v,v._reactInternals=l,v=l.stateNode,v.props=f,v.state=l.memoizedState,v.refs={},sR(l),E=c.contextType,v.context=typeof E=="object"&&E!==null?Pi(E):Mh,v.state=l.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(OR(l,c,E,f),v.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&xR.enqueueReplaceState(v,v.state,null),ng(l,f,v,m),tg(),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(s===null){v=l.stateNode;var x=l.memoizedProps,D=Yu(c,x);v.props=D;var ne=v.context,de=c.contextType;E=Mh,typeof de=="object"&&de!==null&&(E=Pi(de));var ve=c.getDerivedStateFromProps;de=typeof ve=="function"||typeof v.getSnapshotBeforeUpdate=="function",x=l.pendingProps!==x,de||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(x||ne!==E)&&yN(l,v,f,E),El=!1;var re=l.memoizedState;v.state=re,ng(l,f,v,m),tg(),ne=l.memoizedState,x||re!==ne||El?(typeof ve=="function"&&(OR(l,c,ve,f),ne=l.memoizedState),(D=El||wN(l,c,D,f,re,ne,E))?(de||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(l.flags|=4194308)):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=ne),v.props=f,v.state=ne,v.context=E,f=D):(typeof v.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{v=l.stateNode,aR(s,l),E=l.memoizedProps,de=Yu(c,E),v.props=de,ve=l.pendingProps,re=v.context,ne=c.contextType,D=Mh,typeof ne=="object"&&ne!==null&&(D=Pi(ne)),x=c.getDerivedStateFromProps,(ne=typeof x=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==ve||re!==D)&&yN(l,v,f,D),El=!1,re=l.memoizedState,v.state=re,ng(l,f,v,m),tg();var oe=l.memoizedState;E!==ve||re!==oe||El||s!==null&&s.dependencies!==null&&Tv(s.dependencies)?(typeof x=="function"&&(OR(l,c,x,f),oe=l.memoizedState),(de=El||wN(l,c,de,f,re,oe,D)||s!==null&&s.dependencies!==null&&Tv(s.dependencies))?(ne||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,oe,D),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,oe,D)),typeof v.componentDidUpdate=="function"&&(l.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&re===s.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&re===s.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=oe),v.props=f,v.state=oe,v.context=D,f=de):(typeof v.componentDidUpdate!="function"||E===s.memoizedProps&&re===s.memoizedState||(l.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===s.memoizedProps&&re===s.memoizedState||(l.flags|=1024),f=!1)}return v=f,Uv(s,l),f=(l.flags&128)!==0,v||f?(v=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:v.render(),l.flags|=1,s!==null&&f?(l.child=kh(l,s.child,null,m),l.child=kh(l,null,c,m)):Ti(s,l,c,m),l.memoizedState=v.state,s=l.child):s=Sa(s,l,m),s}function NN(s,l,c,f){return Gf(),l.flags|=256,Ti(s,l,c,f),l.child}var IR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function PR(s){return{baseLanes:s,cachePool:bP()}}function NR(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=uo),s}function DN(s,l,c){var f=l.pendingProps,m=!1,v=(l.flags&128)!==0,E;if((E=v)||(E=s!==null&&s.memoizedState===null?!1:(hi.current&2)!==0),E&&(m=!0,l.flags&=-129),E=(l.flags&32)!==0,l.flags&=-33,s===null){if(kt){if(m?Ol(l):xl(),kt){var x=Hn,D;if(D=x){e:{for(D=x,x=Rs;D.nodeType!==8;){if(!x){x=null;break e}if(D=Fo(D.nextSibling),D===null){x=null;break e}}x=D}x!==null?(l.memoizedState={dehydrated:x,treeContext:Vu!==null?{id:pa,overflow:va}:null,retryLane:536870912,hydrationErrors:null},D=Nr(18,null,null,0),D.stateNode=x,D.return=l,l.child=D,Ui=l,Hn=null,D=!0):D=!1}D||Fu(l)}if(x=l.memoizedState,x!==null&&(x=x.dehydrated,x!==null))return v0(x)?l.lanes=32:l.lanes=536870912,null;ba(l)}return x=f.children,f=f.fallback,m?(xl(),m=l.mode,x=zv({mode:"hidden",children:x},m),f=ku(f,m,c,null),x.return=l,f.return=l,x.sibling=f,l.child=x,m=l.child,m.memoizedState=PR(c),m.childLanes=NR(s,E,c),l.memoizedState=IR,f):(Ol(l),DR(l,x))}if(D=s.memoizedState,D!==null&&(x=D.dehydrated,x!==null)){if(v)l.flags&256?(Ol(l),l.flags&=-257,l=LR(s,l,c)):l.memoizedState!==null?(xl(),l.child=s.child,l.flags|=128,l=null):(xl(),m=f.fallback,x=l.mode,f=zv({mode:"visible",children:f.children},x),m=ku(m,x,c,null),m.flags|=2,f.return=l,m.return=l,f.sibling=m,l.child=f,kh(l,s.child,null,c),f=l.child,f.memoizedState=PR(c),f.childLanes=NR(s,E,c),l.memoizedState=IR,l=m);else if(Ol(l),v0(x)){if(E=x.nextSibling&&x.nextSibling.dataset,E)var ne=E.dgst;E=ne,f=Error(i(419)),f.stack="",f.digest=E,qf({value:f,source:null,stack:null}),l=LR(s,l,c)}else if(pi||Kf(s,l,c,!1),E=(c&s.childLanes)!==0,pi||E){if(E=sn,E!==null&&(f=c&-c,f=(f&42)!==0?1:Cs(f),f=(f&(E.suspendedLanes|c))!==0?0:f,f!==0&&f!==D.retryLane))throw D.retryLane=f,_h(s,f),$r(E,s,f),_N;x.data==="$?"||e0(),l=LR(s,l,c)}else x.data==="$?"?(l.flags|=192,l.child=s.child,l=null):(s=D.treeContext,Hn=Fo(x.nextSibling),Ui=l,kt=!0,Bu=null,Rs=!1,s!==null&&(so[ao++]=pa,so[ao++]=va,so[ao++]=Vu,pa=s.id,va=s.overflow,Vu=l),l=DR(l,f.children),l.flags|=4096);return l}return m?(xl(),m=f.fallback,x=l.mode,D=s.child,ne=D.sibling,f=ma(D,{mode:"hidden",children:f.children}),f.subtreeFlags=D.subtreeFlags&65011712,ne!==null?m=ma(ne,m):(m=ku(m,x,c,null),m.flags|=2),m.return=l,f.return=l,f.sibling=m,l.child=f,f=m,m=l.child,x=s.child.memoizedState,x===null?x=PR(c):(D=x.cachePool,D!==null?(ne=ci._currentValue,D=D.parent!==ne?{parent:ne,pool:ne}:D):D=bP(),x={baseLanes:x.baseLanes|c,cachePool:D}),m.memoizedState=x,m.childLanes=NR(s,E,c),l.memoizedState=IR,f):(Ol(l),c=s.child,s=c.sibling,c=ma(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,s!==null&&(E=l.deletions,E===null?(l.deletions=[s],l.flags|=16):E.push(s)),l.child=c,l.memoizedState=null,c)}function DR(s,l){return l=zv({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function zv(s,l){return s=Nr(22,s,null,l),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function LR(s,l,c){return kh(l,s.child,null,c),s=DR(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function LN(s,l,c){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l),eR(s.return,l,c)}function kR(s,l,c,f,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(v.isBackwards=l,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=c,v.tailMode=m)}function kN(s,l,c){var f=l.pendingProps,m=f.revealOrder,v=f.tail;if(Ti(s,l,f.children,c),f=hi.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&LN(s,c,l);else if(s.tag===19)LN(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}switch(S(hi,f),m){case"forwards":for(c=l.child,m=null;c!==null;)s=c.alternate,s!==null&&Fv(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=l.child,l.child=null):(m=c.sibling,c.sibling=null),kR(l,!1,m,c,v);break;case"backwards":for(c=null,m=l.child,l.child=null;m!==null;){if(s=m.alternate,s!==null&&Fv(s)===null){l.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}kR(l,!0,c,null,v);break;case"together":kR(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Sa(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),Nl|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(Kf(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(i(153));if(l.child!==null){for(s=l.child,c=ma(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=ma(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function VR(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Tv(s)))}function w4(s,l,c){switch(l.tag){case 3:ae(l,l.stateNode.containerInfo),Rl(l,ci,s.memoizedState.cache),Gf();break;case 27:case 5:O(l);break;case 4:ae(l,l.stateNode.containerInfo);break;case 10:Rl(l,l.type,l.memoizedProps.value);break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Ol(l),l.flags|=128,null):(c&l.child.childLanes)!==0?DN(s,l,c):(Ol(l),s=Sa(s,l,c),s!==null?s.sibling:null);Ol(l);break;case 19:var m=(s.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(Kf(s,l,c,!1),f=(c&l.childLanes)!==0),m){if(f)return kN(s,l,c);l.flags|=128}if(m=l.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),S(hi,hi.current),f)break;return null;case 22:case 23:return l.lanes=0,AN(s,l,c);case 24:Rl(l,ci,s.memoizedState.cache)}return Sa(s,l,c)}function VN(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)pi=!0;else{if(!VR(s,c)&&(l.flags&128)===0)return pi=!1,w4(s,l,c);pi=(s.flags&131072)!==0}else pi=!1,kt&&(l.flags&1048576)!==0&&gP(l,Ev,l.index);switch(l.lanes=0,l.tag){case 16:e:{s=l.pendingProps;var f=l.elementType,m=f._init;if(f=m(f._payload),l.type=f,typeof f=="function")GS(f)?(s=Yu(f,s),l.tag=1,l=PN(null,l,f,s,c)):(l.tag=0,l=HR(null,l,f,s,c));else{if(f!=null){if(m=f.$$typeof,m===k){l.tag=11,l=MN(null,l,f,s,c);break e}else if(m===F){l.tag=14,l=ON(null,l,f,s,c);break e}}throw l=Ee(f)||f,Error(i(306,l,""))}}return l;case 0:return HR(s,l,l.type,l.pendingProps,c);case 1:return f=l.type,m=Yu(f,l.pendingProps),PN(s,l,f,m,c);case 3:e:{if(ae(l,l.stateNode.containerInfo),s===null)throw Error(i(387));f=l.pendingProps;var v=l.memoizedState;m=v.element,aR(s,l),ng(l,f,null,c);var E=l.memoizedState;if(f=E.cache,Rl(l,ci,f),f!==v.cache&&tR(l,[ci],c,!0),tg(),f=E.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:E.cache},l.updateQueue.baseState=v,l.memoizedState=v,l.flags&256){l=NN(s,l,f,c);break e}else if(f!==m){m=ro(Error(i(424)),l),qf(m),l=NN(s,l,f,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Hn=Fo(s.firstChild),Ui=l,kt=!0,Bu=null,Rs=!0,c=pN(l,null,f,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Gf(),f===m){l=Sa(s,l,c);break e}Ti(s,l,f,c)}l=l.child}return l;case 26:return Uv(s,l),s===null?(c=WD(l.type,null,l.pendingProps,null))?l.memoizedState=c:kt||(c=l.type,s=l.pendingProps,f=ow(V.current).createElement(c),f[li]=l,f[Hi]=s,Mi(f,c,s),qn(f),l.stateNode=f):l.memoizedState=WD(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return O(l),s===null&&kt&&(f=l.stateNode=$D(l.type,l.pendingProps,V.current),Ui=l,Rs=!0,m=Hn,Vl(l.type)?(w0=m,Hn=Fo(f.firstChild)):Hn=m),Ti(s,l,l.pendingProps.children,c),Uv(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&kt&&((m=f=Hn)&&(f=Y4(f,l.type,l.pendingProps,Rs),f!==null?(l.stateNode=f,Ui=l,Hn=Fo(f.firstChild),Rs=!1,m=!0):m=!1),m||Fu(l)),O(l),m=l.type,v=l.pendingProps,E=s!==null?s.memoizedProps:null,f=v.children,g0(m,v)?f=null:E!==null&&g0(m,E)&&(l.flags|=32),l.memoizedState!==null&&(m=fR(s,l,c4,null,null,c),Eg._currentValue=m),Uv(s,l),Ti(s,l,f,c),l.child;case 6:return s===null&&kt&&((s=c=Hn)&&(c=G4(c,l.pendingProps,Rs),c!==null?(l.stateNode=c,Ui=l,Hn=null,s=!0):s=!1),s||Fu(l)),null;case 13:return DN(s,l,c);case 4:return ae(l,l.stateNode.containerInfo),f=l.pendingProps,s===null?l.child=kh(l,null,f,c):Ti(s,l,f,c),l.child;case 11:return MN(s,l,l.type,l.pendingProps,c);case 7:return Ti(s,l,l.pendingProps,c),l.child;case 8:return Ti(s,l,l.pendingProps.children,c),l.child;case 12:return Ti(s,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,Rl(l,l.type,f.value),Ti(s,l,f.children,c),l.child;case 9:return m=l.type._context,f=l.pendingProps.children,ju(l),m=Pi(m),f=f(m),l.flags|=1,Ti(s,l,f,c),l.child;case 14:return ON(s,l,l.type,l.pendingProps,c);case 15:return xN(s,l,l.type,l.pendingProps,c);case 19:return kN(s,l,c);case 31:return f=l.pendingProps,c=l.mode,f={mode:f.mode,children:f.children},s===null?(c=zv(f,c),c.ref=l.ref,l.child=c,c.return=l,l=c):(c=ma(s.child,f),c.ref=l.ref,l.child=c,c.return=l,l=c),l;case 22:return AN(s,l,c);case 24:return ju(l),f=Pi(ci),s===null?(m=rR(),m===null&&(m=sn,v=nR(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=c),m=v),l.memoizedState={parent:f,cache:m},sR(l),Rl(l,ci,m)):((s.lanes&c)!==0&&(aR(s,l),ng(l,null,null,c),tg()),m=s.memoizedState,v=l.memoizedState,m.parent!==f?(m={parent:f,cache:f},l.memoizedState=m,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=m),Rl(l,ci,f)):(f=v.cache,Rl(l,ci,f),f!==m.cache&&tR(l,[ci],c,!0))),Ti(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}function Ra(s){s.flags|=4}function $N(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!GD(l)){if(l=lo.current,l!==null&&((_t&4194048)===_t?Es!==null:(_t&62914560)!==_t&&(_t&536870912)===0||l!==Es))throw Jf=oR,SP;s.flags|=8192}}function Yv(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?ys():536870912,s.lanes|=l,Fh|=l)}function ug(s,l){if(!kt)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Cn(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(l)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=f,s.childLanes=c,l}function y4(s,l,c){var f=l.pendingProps;switch(ZS(l),l.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(l),null;case 1:return Cn(l),null;case 3:return c=l.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ya(ci),ge(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Yf(l)?Ra(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,vP())),Cn(l),null;case 26:return c=l.memoizedState,s===null?(Ra(l),c!==null?(Cn(l),$N(l,c)):(Cn(l),l.flags&=-16777217)):c?c!==s.memoizedState?(Ra(l),Cn(l),$N(l,c)):(Cn(l),l.flags&=-16777217):(s.memoizedProps!==f&&Ra(l),Cn(l),l.flags&=-16777217),null;case 27:H(l),c=V.current;var m=l.type;if(s!==null&&l.stateNode!=null)s.memoizedProps!==f&&Ra(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return Cn(l),null}s=R.current,Yf(l)?mP(l):(s=$D(m,f,c),l.stateNode=s,Ra(l))}return Cn(l),null;case 5:if(H(l),c=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==f&&Ra(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return Cn(l),null}if(s=R.current,Yf(l))mP(l);else{switch(m=ow(V.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?s.multiple=!0:f.size&&(s.size=f.size);break;default:s=typeof f.is=="string"?m.createElement(c,{is:f.is}):m.createElement(c)}}s[li]=l,s[Hi]=f;e:for(m=l.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===l)break e;for(;m.sibling===null;){if(m.return===null||m.return===l)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}l.stateNode=s;e:switch(Mi(s,c,f),c){case"button":case"input":case"select":case"textarea":s=!!f.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ra(l)}}return Cn(l),l.flags&=-16777217,null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==f&&Ra(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(i(166));if(s=V.current,Yf(l)){if(s=l.stateNode,c=l.memoizedProps,f=null,m=Ui,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}s[li]=l,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||ID(s.nodeValue,c)),s||Fu(l)}else s=ow(s).createTextNode(f),s[li]=l,l.stateNode=s}return Cn(l),null;case 13:if(f=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Yf(l),f!==null&&f.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=l.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[li]=l}else Gf(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Cn(l),m=!1}else m=vP(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return l.flags&256?(ba(l),l):(ba(l),null)}if(ba(l),(l.flags&128)!==0)return l.lanes=c,l;if(c=f!==null,s=s!==null&&s.memoizedState!==null,c){f=l.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==m&&(f.flags|=2048)}return c!==s&&c&&(l.child.flags|=8192),Yv(l,l.updateQueue),Cn(l),null;case 4:return ge(),s===null&&u0(l.stateNode.containerInfo),Cn(l),null;case 10:return ya(l.type),Cn(l),null;case 19:if(C(hi),m=l.memoizedState,m===null)return Cn(l),null;if(f=(l.flags&128)!==0,v=m.rendering,v===null)if(f)ug(m,!1);else{if(In!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(v=Fv(s),v!==null){for(l.flags|=128,ug(m,!1),s=v.updateQueue,l.updateQueue=s,Yv(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)fP(c,s),c=c.sibling;return S(hi,hi.current&1|2),l.child}s=s.sibling}m.tail!==null&&W()>Kv&&(l.flags|=128,f=!0,ug(m,!1),l.lanes=4194304)}else{if(!f)if(s=Fv(v),s!==null){if(l.flags|=128,f=!0,s=s.updateQueue,l.updateQueue=s,Yv(l,s),ug(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!kt)return Cn(l),null}else 2*W()-m.renderingStartTime>Kv&&c!==536870912&&(l.flags|=128,f=!0,ug(m,!1),l.lanes=4194304);m.isBackwards?(v.sibling=l.child,l.child=v):(s=m.last,s!==null?s.sibling=v:l.child=v,m.last=v)}return m.tail!==null?(l=m.tail,m.rendering=l,m.tail=l.sibling,m.renderingStartTime=W(),l.sibling=null,s=hi.current,S(hi,f?s&1|2:s&1),l):(Cn(l),null);case 22:case 23:return ba(l),hR(),f=l.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(Cn(l),l.subtreeFlags&6&&(l.flags|=8192)):Cn(l),c=l.updateQueue,c!==null&&Yv(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),s!==null&&C(Uu),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),ya(ci),Cn(l),null;case 25:return null;case 30:return null}throw Error(i(156,l.tag))}function C4(s,l){switch(ZS(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return ya(ci),ge(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return H(l),null;case 13:if(ba(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(i(340));Gf()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return C(hi),null;case 4:return ge(),null;case 10:return ya(l.type),null;case 22:case 23:return ba(l),hR(),s!==null&&C(Uu),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return ya(ci),null;case 25:return null;default:return null}}function BN(s,l){switch(ZS(l),l.tag){case 3:ya(ci),ge();break;case 26:case 27:case 5:H(l);break;case 4:ge();break;case 13:ba(l);break;case 19:C(hi);break;case 10:ya(l.type);break;case 22:case 23:ba(l),hR(),s!==null&&C(Uu);break;case 24:ya(ci)}}function cg(s,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&s)===s){f=void 0;var v=c.create,E=c.inst;f=v(),E.destroy=f}c=c.next}while(c!==m)}}catch(x){tn(l,l.return,x)}}function Al(s,l,c){try{var f=l.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var v=m.next;f=v;do{if((f.tag&s)===s){var E=f.inst,x=E.destroy;if(x!==void 0){E.destroy=void 0,m=l;var D=c,ne=x;try{ne()}catch(de){tn(m,D,de)}}}f=f.next}while(f!==v)}}catch(de){tn(l,l.return,de)}}function FN(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{OP(l,c)}catch(f){tn(s,s.return,f)}}}function WN(s,l,c){c.props=Yu(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){tn(s,l,f)}}function hg(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(m){tn(s,l,m)}}function Ts(s,l){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){tn(s,l,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){tn(s,l,m)}else c.current=null}function jN(s){var l=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){tn(s,s.return,m)}}function $R(s,l,c){try{var f=s.stateNode;F4(f,s.type,c,l),f[Hi]=l}catch(m){tn(s,s.return,m)}}function UN(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Vl(s.type)||s.tag===4}function BR(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||UN(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Vl(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function FR(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=rw));else if(f!==4&&(f===27&&Vl(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(FR(s,l,c),s=s.sibling;s!==null;)FR(s,l,c),s=s.sibling}function Gv(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(f!==4&&(f===27&&Vl(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(Gv(s,l,c),s=s.sibling;s!==null;)Gv(s,l,c),s=s.sibling}function zN(s){var l=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,m=l.attributes;m.length;)l.removeAttributeNode(m[0]);Mi(l,f,c),l[li]=s,l[Hi]=c}catch(v){tn(s,s.return,v)}}var Ea=!1,Wn=!1,WR=!1,YN=typeof WeakSet=="function"?WeakSet:Set,vi=null;function b4(s,l){if(s=s.containerInfo,d0=hw,s=iP(s),BS(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var E=0,x=-1,D=-1,ne=0,de=0,ve=s,re=null;t:for(;;){for(var oe;ve!==c||m!==0&&ve.nodeType!==3||(x=E+m),ve!==v||f!==0&&ve.nodeType!==3||(D=E+f),ve.nodeType===3&&(E+=ve.nodeValue.length),(oe=ve.firstChild)!==null;)re=ve,ve=oe;for(;;){if(ve===s)break t;if(re===c&&++ne===m&&(x=E),re===v&&++de===f&&(D=E),(oe=ve.nextSibling)!==null)break;ve=re,re=ve.parentNode}ve=oe}c=x===-1||D===-1?null:{start:x,end:D}}else c=null}c=c||{start:0,end:0}}else c=null;for(f0={focusedElem:s,selectionRange:c},hw=!1,vi=l;vi!==null;)if(l=vi,s=l.child,(l.subtreeFlags&1024)!==0&&s!==null)s.return=l,vi=s;else for(;vi!==null;){switch(l=vi,v=l.alternate,s=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,c=l,m=v.memoizedProps,v=v.memoizedState,f=c.stateNode;try{var Ze=Yu(c.type,m,c.elementType===c.type);s=f.getSnapshotBeforeUpdate(Ze,v),f.__reactInternalSnapshotBeforeUpdate=s}catch(Ke){tn(c,c.return,Ke)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)p0(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":p0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=l.sibling,s!==null){s.return=l.return,vi=s;break}vi=l.return}}function GN(s,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Hl(s,c),f&4&&cg(5,c);break;case 1:if(Hl(s,c),f&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(E){tn(c,c.return,E)}else{var m=Yu(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(m,l,s.__reactInternalSnapshotBeforeUpdate)}catch(E){tn(c,c.return,E)}}f&64&&FN(c),f&512&&hg(c,c.return);break;case 3:if(Hl(s,c),f&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{OP(s,l)}catch(E){tn(c,c.return,E)}}break;case 27:l===null&&f&4&&zN(c);case 26:case 5:Hl(s,c),l===null&&f&4&&jN(c),f&512&&hg(c,c.return);break;case 12:Hl(s,c);break;case 13:Hl(s,c),f&4&&XN(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=A4.bind(null,c),q4(s,c))));break;case 22:if(f=c.memoizedState!==null||Ea,!f){l=l!==null&&l.memoizedState!==null||Wn,m=Ea;var v=Wn;Ea=f,(Wn=l)&&!v?Il(s,c,(c.subtreeFlags&8772)!==0):Hl(s,c),Ea=m,Wn=v}break;case 30:break;default:Hl(s,c)}}function qN(s){var l=s.alternate;l!==null&&(s.alternate=null,qN(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Hr(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,cr=!1;function Ta(s,l,c){for(c=c.child;c!==null;)KN(s,l,c),c=c.sibling}function KN(s,l,c){if(Be&&typeof Be.onCommitFiberUnmount=="function")try{Be.onCommitFiberUnmount(ot,c)}catch{}switch(c.tag){case 26:Wn||Ts(c,l),Ta(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Wn||Ts(c,l);var f=pn,m=cr;Vl(c.type)&&(pn=c.stateNode,cr=!1),Ta(s,l,c),Cg(c.stateNode),pn=f,cr=m;break;case 5:Wn||Ts(c,l);case 6:if(f=pn,m=cr,pn=null,Ta(s,l,c),pn=f,cr=m,pn!==null)if(cr)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(c.stateNode)}catch(v){tn(c,l,v)}else try{pn.removeChild(c.stateNode)}catch(v){tn(c,l,v)}break;case 18:pn!==null&&(cr?(s=pn,kD(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Og(s)):kD(pn,c.stateNode));break;case 4:f=pn,m=cr,pn=c.stateNode.containerInfo,cr=!0,Ta(s,l,c),pn=f,cr=m;break;case 0:case 11:case 14:case 15:Wn||Al(2,c,l),Wn||Al(4,c,l),Ta(s,l,c);break;case 1:Wn||(Ts(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&WN(c,l,f)),Ta(s,l,c);break;case 21:Ta(s,l,c);break;case 22:Wn=(f=Wn)||c.memoizedState!==null,Ta(s,l,c),Wn=f;break;default:Ta(s,l,c)}}function XN(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Og(s)}catch(c){tn(l,l.return,c)}}function S4(s){switch(s.tag){case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new YN),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new YN),l;default:throw Error(i(435,s.tag))}}function jR(s,l){var c=S4(s);l.forEach(function(f){var m=H4.bind(null,s,f);c.has(f)||(c.add(f),f.then(m,m))})}function Dr(s,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],v=s,E=l,x=E;e:for(;x!==null;){switch(x.tag){case 27:if(Vl(x.type)){pn=x.stateNode,cr=!1;break e}break;case 5:pn=x.stateNode,cr=!1;break e;case 3:case 4:pn=x.stateNode.containerInfo,cr=!0;break e}x=x.return}if(pn===null)throw Error(i(160));KN(v,E,m),pn=null,cr=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)ZN(l,s),l=l.sibling}var Bo=null;function ZN(s,l){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Dr(l,s),Lr(s),f&4&&(Al(3,s,s.return),cg(3,s),Al(5,s,s.return));break;case 1:Dr(l,s),Lr(s),f&512&&(Wn||c===null||Ts(c,c.return)),f&64&&Ea&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=Bo;if(Dr(l,s),Lr(s),f&512&&(Wn||c===null||Ts(c,c.return)),f&4){var v=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":v=m.getElementsByTagName("title")[0],(!v||v[Cl]||v[li]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(f),m.head.insertBefore(v,m.querySelector("head > title"))),Mi(v,f,c),v[li]=s,qn(v),f=v;break e;case"link":var E=zD("link","href",m).get(f+(c.href||""));if(E){for(var x=0;x<E.length;x++)if(v=E[x],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){E.splice(x,1);break t}}v=m.createElement(f),Mi(v,f,c),m.head.appendChild(v);break;case"meta":if(E=zD("meta","content",m).get(f+(c.content||""))){for(x=0;x<E.length;x++)if(v=E[x],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){E.splice(x,1);break t}}v=m.createElement(f),Mi(v,f,c),m.head.appendChild(v);break;default:throw Error(i(468,f))}v[li]=s,qn(v),f=v}s.stateNode=f}else YD(m,s.type,s.stateNode);else s.stateNode=UD(m,f,s.memoizedProps);else v!==f?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,f===null?YD(m,s.type,s.stateNode):UD(m,f,s.memoizedProps)):f===null&&s.stateNode!==null&&$R(s,s.memoizedProps,c.memoizedProps)}break;case 27:Dr(l,s),Lr(s),f&512&&(Wn||c===null||Ts(c,c.return)),c!==null&&f&4&&$R(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Dr(l,s),Lr(s),f&512&&(Wn||c===null||Ts(c,c.return)),s.flags&32){m=s.stateNode;try{yh(m,"")}catch(oe){tn(s,s.return,oe)}}f&4&&s.stateNode!=null&&(m=s.memoizedProps,$R(s,m,c!==null?c.memoizedProps:m)),f&1024&&(WR=!0);break;case 6:if(Dr(l,s),Lr(s),f&4){if(s.stateNode===null)throw Error(i(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(oe){tn(s,s.return,oe)}}break;case 3:if(lw=null,m=Bo,Bo=sw(l.containerInfo),Dr(l,s),Bo=m,Lr(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Og(l.containerInfo)}catch(oe){tn(s,s.return,oe)}WR&&(WR=!1,QN(s));break;case 4:f=Bo,Bo=sw(s.stateNode.containerInfo),Dr(l,s),Lr(s),Bo=f;break;case 12:Dr(l,s),Lr(s);break;case 13:Dr(l,s),Lr(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(KR=W()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,jR(s,f)));break;case 22:m=s.memoizedState!==null;var D=c!==null&&c.memoizedState!==null,ne=Ea,de=Wn;if(Ea=ne||m,Wn=de||D,Dr(l,s),Wn=de,Ea=ne,Lr(s),f&8192)e:for(l=s.stateNode,l._visibility=m?l._visibility&-2:l._visibility|1,m&&(c===null||D||Ea||Wn||Gu(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){D=c=l;try{if(v=D.stateNode,m)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{x=D.stateNode;var ve=D.memoizedProps.style,re=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;x.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(oe){tn(D,D.return,oe)}}}else if(l.tag===6){if(c===null){D=l;try{D.stateNode.nodeValue=m?"":D.memoizedProps}catch(oe){tn(D,D.return,oe)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,jR(s,c))));break;case 19:Dr(l,s),Lr(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,jR(s,f)));break;case 30:break;case 21:break;default:Dr(l,s),Lr(s)}}function Lr(s){var l=s.flags;if(l&2){try{for(var c,f=s.return;f!==null;){if(UN(f)){c=f;break}f=f.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var m=c.stateNode,v=BR(s);Gv(s,v,m);break;case 5:var E=c.stateNode;c.flags&32&&(yh(E,""),c.flags&=-33);var x=BR(s);Gv(s,x,E);break;case 3:case 4:var D=c.stateNode.containerInfo,ne=BR(s);FR(s,ne,D);break;default:throw Error(i(161))}}catch(de){tn(s,s.return,de)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function QN(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;QN(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Hl(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)GN(s,l.alternate,l),l=l.sibling}function Gu(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Al(4,l,l.return),Gu(l);break;case 1:Ts(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&WN(l,l.return,c),Gu(l);break;case 27:Cg(l.stateNode);case 26:case 5:Ts(l,l.return),Gu(l);break;case 22:l.memoizedState===null&&Gu(l);break;case 30:Gu(l);break;default:Gu(l)}s=s.sibling}}function Il(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,m=s,v=l,E=v.flags;switch(v.tag){case 0:case 11:case 15:Il(m,v,c),cg(4,v);break;case 1:if(Il(m,v,c),f=v,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ne){tn(f,f.return,ne)}if(f=v,m=f.updateQueue,m!==null){var x=f.stateNode;try{var D=m.shared.hiddenCallbacks;if(D!==null)for(m.shared.hiddenCallbacks=null,m=0;m<D.length;m++)MP(D[m],x)}catch(ne){tn(f,f.return,ne)}}c&&E&64&&FN(v),hg(v,v.return);break;case 27:zN(v);case 26:case 5:Il(m,v,c),c&&f===null&&E&4&&jN(v),hg(v,v.return);break;case 12:Il(m,v,c);break;case 13:Il(m,v,c),c&&E&4&&XN(m,v);break;case 22:v.memoizedState===null&&Il(m,v,c),hg(v,v.return);break;case 30:break;default:Il(m,v,c)}l=l.sibling}}function UR(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Xf(c))}function zR(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Xf(s))}function _s(s,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)JN(s,l,c,f),l=l.sibling}function JN(s,l,c,f){var m=l.flags;switch(l.tag){case 0:case 11:case 15:_s(s,l,c,f),m&2048&&cg(9,l);break;case 1:_s(s,l,c,f);break;case 3:_s(s,l,c,f),m&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Xf(s)));break;case 12:if(m&2048){_s(s,l,c,f),s=l.stateNode;try{var v=l.memoizedProps,E=v.id,x=v.onPostCommit;typeof x=="function"&&x(E,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(D){tn(l,l.return,D)}}else _s(s,l,c,f);break;case 13:_s(s,l,c,f);break;case 23:break;case 22:v=l.stateNode,E=l.alternate,l.memoizedState!==null?v._visibility&2?_s(s,l,c,f):dg(s,l):v._visibility&2?_s(s,l,c,f):(v._visibility|=2,Vh(s,l,c,f,(l.subtreeFlags&10256)!==0)),m&2048&&UR(E,l);break;case 24:_s(s,l,c,f),m&2048&&zR(l.alternate,l);break;default:_s(s,l,c,f)}}function Vh(s,l,c,f,m){for(m=m&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var v=s,E=l,x=c,D=f,ne=E.flags;switch(E.tag){case 0:case 11:case 15:Vh(v,E,x,D,m),cg(8,E);break;case 23:break;case 22:var de=E.stateNode;E.memoizedState!==null?de._visibility&2?Vh(v,E,x,D,m):dg(v,E):(de._visibility|=2,Vh(v,E,x,D,m)),m&&ne&2048&&UR(E.alternate,E);break;case 24:Vh(v,E,x,D,m),m&&ne&2048&&zR(E.alternate,E);break;default:Vh(v,E,x,D,m)}l=l.sibling}}function dg(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,f=l,m=f.flags;switch(f.tag){case 22:dg(c,f),m&2048&&UR(f.alternate,f);break;case 24:dg(c,f),m&2048&&zR(f.alternate,f);break;default:dg(c,f)}l=l.sibling}}var fg=8192;function $h(s){if(s.subtreeFlags&fg)for(s=s.child;s!==null;)eD(s),s=s.sibling}function eD(s){switch(s.tag){case 26:$h(s),s.flags&fg&&s.memoizedState!==null&&aK(Bo,s.memoizedState,s.memoizedProps);break;case 5:$h(s);break;case 3:case 4:var l=Bo;Bo=sw(s.stateNode.containerInfo),$h(s),Bo=l;break;case 22:s.memoizedState===null&&(l=s.alternate,l!==null&&l.memoizedState!==null?(l=fg,fg=16777216,$h(s),fg=l):$h(s));break;default:$h(s)}}function tD(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function gg(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];vi=f,iD(f,s)}tD(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nD(s),s=s.sibling}function nD(s){switch(s.tag){case 0:case 11:case 15:gg(s),s.flags&2048&&Al(9,s,s.return);break;case 3:gg(s);break;case 12:gg(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,qv(s)):gg(s);break;default:gg(s)}}function qv(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];vi=f,iD(f,s)}tD(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Al(8,l,l.return),qv(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,qv(l));break;default:qv(l)}s=s.sibling}}function iD(s,l){for(;vi!==null;){var c=vi;switch(c.tag){case 0:case 11:case 15:Al(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Xf(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,vi=f;else e:for(c=s;vi!==null;){f=vi;var m=f.sibling,v=f.return;if(qN(f),f===c){vi=null;break e}if(m!==null){m.return=v,vi=m;break e}vi=v}}}var R4={getCacheForType:function(s){var l=Pi(ci),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c}},E4=typeof WeakMap=="function"?WeakMap:Map,Yt=0,sn=null,wt=null,_t=0,Gt=0,kr=null,Pl=!1,Bh=!1,YR=!1,_a=0,In=0,Nl=0,qu=0,GR=0,uo=0,Fh=0,mg=null,hr=null,qR=!1,KR=0,Kv=1/0,Xv=null,Dl=null,_i=0,Ll=null,Wh=null,jh=0,XR=0,ZR=null,rD=null,pg=0,QR=null;function Vr(){if((Yt&2)!==0&&_t!==0)return _t&-_t;if(se.T!==null){var s=Ah;return s!==0?s:o0()}return Nf()}function oD(){uo===0&&(uo=(_t&536870912)===0||kt?ws():536870912);var s=lo.current;return s!==null&&(s.flags|=32),uo}function $r(s,l,c){(s===sn&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)&&(Uh(s,0),kl(s,_t,uo,!1)),ko(s,c),((Yt&2)===0||s!==sn)&&(s===sn&&((Yt&2)===0&&(qu|=c),In===4&&kl(s,_t,uo,!1)),Ms(s))}function sD(s,l,c){if((Yt&6)!==0)throw Error(i(327));var f=!c&&(l&124)===0&&(l&s.expiredLanes)===0||it(s,l),m=f?M4(s,l):t0(s,l,!0),v=f;do{if(m===0){Bh&&!f&&kl(s,l,0,!1);break}else{if(c=s.current.alternate,v&&!T4(c)){m=t0(s,l,!1),v=!1;continue}if(m===2){if(v=l,s.errorRecoveryDisabledLanes&v)var E=0;else E=s.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){l=E;e:{var x=s;m=mg;var D=x.current.memoizedState.isDehydrated;if(D&&(Uh(x,E).flags|=256),E=t0(x,E,!1),E!==2){if(YR&&!D){x.errorRecoveryDisabledLanes|=v,qu|=v,m=4;break e}v=hr,hr=m,v!==null&&(hr===null?hr=v:hr.push.apply(hr,v))}m=E}if(v=!1,m!==2)continue}}if(m===1){Uh(s,0),kl(s,l,0,!0);break}e:{switch(f=s,v=m,v){case 0:case 1:throw Error(i(345));case 4:if((l&4194048)!==l)break;case 6:kl(f,l,uo,!Pl);break e;case 2:hr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((l&62914560)===l&&(m=KR+300-W(),10<m)){if(kl(f,l,uo,!Pl),Ft(f,0,!0)!==0)break e;f.timeoutHandle=DD(aD.bind(null,f,c,hr,Xv,qR,l,uo,qu,Fh,Pl,v,2,-0,0),m);break e}aD(f,c,hr,Xv,qR,l,uo,qu,Fh,Pl,v,0,-0,0)}}break}while(!0);Ms(s)}function aD(s,l,c,f,m,v,E,x,D,ne,de,ve,re,oe){if(s.timeoutHandle=-1,ve=l.subtreeFlags,(ve&8192||(ve&16785408)===16785408)&&(Rg={stylesheets:null,count:0,unsuspend:sK},eD(l),ve=lK(),ve!==null)){s.cancelPendingCommit=ve(gD.bind(null,s,l,v,c,f,m,E,x,D,de,1,re,oe)),kl(s,v,E,!ne);return}gD(s,l,v,c,f,m,E,x,D)}function T4(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],v=m.getSnapshot;m=m.value;try{if(!Pr(v(),m))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function kl(s,l,c,f){l&=~GR,l&=~qu,s.suspendedLanes|=l,s.pingedLanes&=~l,f&&(s.warmLanes|=l),f=s.expirationTimes;for(var m=l;0<m;){var v=31-gt(m),E=1<<v;f[v]=-1,m&=~E}c!==0&&av(s,c,l)}function Zv(){return(Yt&6)===0?(vg(0),!1):!0}function JR(){if(wt!==null){if(Gt===0)var s=wt.return;else s=wt,wa=Wu=null,pR(s),Lh=null,ag=0,s=wt;for(;s!==null;)BN(s.alternate,s),s=s.return;wt=null}}function Uh(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,j4(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),JR(),sn=s,wt=c=ma(s.current,null),_t=l,Gt=0,kr=null,Pl=!1,Bh=it(s,l),YR=!1,Fh=uo=GR=qu=Nl=In=0,hr=mg=null,qR=!1,(l&8)!==0&&(l|=l&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=l;0<f;){var m=31-gt(f),v=1<<m;l|=s[m],f&=~v}return _a=l,yv(),c}function lD(s,l){mt=null,se.H=Vv,l===Qf||l===Ov?(l=TP(),Gt=3):l===SP?(l=TP(),Gt=4):Gt=l===_N?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,kr=l,wt===null&&(In=1,jv(s,ro(l,s.current)))}function uD(){var s=se.H;return se.H=Vv,s===null?Vv:s}function cD(){var s=se.A;return se.A=R4,s}function e0(){In=4,Pl||(_t&4194048)!==_t&&lo.current!==null||(Bh=!0),(Nl&134217727)===0&&(qu&134217727)===0||sn===null||kl(sn,_t,uo,!1)}function t0(s,l,c){var f=Yt;Yt|=2;var m=uD(),v=cD();(sn!==s||_t!==l)&&(Xv=null,Uh(s,l)),l=!1;var E=In;e:do try{if(Gt!==0&&wt!==null){var x=wt,D=kr;switch(Gt){case 8:JR(),E=6;break e;case 3:case 2:case 9:case 6:lo.current===null&&(l=!0);var ne=Gt;if(Gt=0,kr=null,zh(s,x,D,ne),c&&Bh){E=0;break e}break;default:ne=Gt,Gt=0,kr=null,zh(s,x,D,ne)}}_4(),E=In;break}catch(de){lD(s,de)}while(!0);return l&&s.shellSuspendCounter++,wa=Wu=null,Yt=f,se.H=m,se.A=v,wt===null&&(sn=null,_t=0,yv()),E}function _4(){for(;wt!==null;)hD(wt)}function M4(s,l){var c=Yt;Yt|=2;var f=uD(),m=cD();sn!==s||_t!==l?(Xv=null,Kv=W()+500,Uh(s,l)):Bh=it(s,l);e:do try{if(Gt!==0&&wt!==null){l=wt;var v=kr;t:switch(Gt){case 1:Gt=0,kr=null,zh(s,l,v,1);break;case 2:case 9:if(RP(v)){Gt=0,kr=null,dD(l);break}l=function(){Gt!==2&&Gt!==9||sn!==s||(Gt=7),Ms(s)},v.then(l,l);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:RP(v)?(Gt=0,kr=null,dD(l)):(Gt=0,kr=null,zh(s,l,v,7));break;case 5:var E=null;switch(wt.tag){case 26:E=wt.memoizedState;case 5:case 27:var x=wt;if(!E||GD(E)){Gt=0,kr=null;var D=x.sibling;if(D!==null)wt=D;else{var ne=x.return;ne!==null?(wt=ne,Qv(ne)):wt=null}break t}}Gt=0,kr=null,zh(s,l,v,5);break;case 6:Gt=0,kr=null,zh(s,l,v,6);break;case 8:JR(),In=6;break e;default:throw Error(i(462))}}O4();break}catch(de){lD(s,de)}while(!0);return wa=Wu=null,se.H=f,se.A=m,Yt=c,wt!==null?0:(sn=null,_t=0,yv(),In)}function O4(){for(;wt!==null&&!K();)hD(wt)}function hD(s){var l=VN(s.alternate,s,_a);s.memoizedProps=s.pendingProps,l===null?Qv(s):wt=l}function dD(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=IN(c,l,l.pendingProps,l.type,void 0,_t);break;case 11:l=IN(c,l,l.pendingProps,l.type.render,l.ref,_t);break;case 5:pR(l);default:BN(c,l),l=wt=fP(l,_a),l=VN(c,l,_a)}s.memoizedProps=s.pendingProps,l===null?Qv(s):wt=l}function zh(s,l,c,f){wa=Wu=null,pR(l),Lh=null,ag=0;var m=l.return;try{if(v4(s,m,l,c,_t)){In=1,jv(s,ro(c,s.current)),wt=null;return}}catch(v){if(m!==null)throw wt=m,v;In=1,jv(s,ro(c,s.current)),wt=null;return}l.flags&32768?(kt||f===1?s=!0:Bh||(_t&536870912)!==0?s=!1:(Pl=s=!0,(f===2||f===9||f===3||f===6)&&(f=lo.current,f!==null&&f.tag===13&&(f.flags|=16384))),fD(l,s)):Qv(l)}function Qv(s){var l=s;do{if((l.flags&32768)!==0){fD(l,Pl);return}s=l.return;var c=y4(l.alternate,l,_a);if(c!==null){wt=c;return}if(l=l.sibling,l!==null){wt=l;return}wt=l=s}while(l!==null);In===0&&(In=5)}function fD(s,l){do{var c=C4(s.alternate,s);if(c!==null){c.flags&=32767,wt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){wt=s;return}wt=s=c}while(s!==null);In=6,wt=null}function gD(s,l,c,f,m,v,E,x,D){s.cancelPendingCommit=null;do Jv();while(_i!==0);if((Yt&6)!==0)throw Error(i(327));if(l!==null){if(l===s.current)throw Error(i(177));if(v=l.lanes|l.childLanes,v|=zS,SS(s,c,v,E,x,D),s===sn&&(wt=sn=null,_t=0),Wh=l,Ll=s,jh=c,XR=v,ZR=m,rD=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,I4(ce,function(){return yD(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=se.T,se.T=null,m=fe.p,fe.p=2,E=Yt,Yt|=4;try{b4(s,l,c)}finally{Yt=E,fe.p=m,se.T=f}}_i=1,mD(),pD(),vD()}}function mD(){if(_i===1){_i=0;var s=Ll,l=Wh,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=se.T,se.T=null;var f=fe.p;fe.p=2;var m=Yt;Yt|=4;try{ZN(l,s);var v=f0,E=iP(s.containerInfo),x=v.focusedElem,D=v.selectionRange;if(E!==x&&x&&x.ownerDocument&&nP(x.ownerDocument.documentElement,x)){if(D!==null&&BS(x)){var ne=D.start,de=D.end;if(de===void 0&&(de=ne),"selectionStart"in x)x.selectionStart=ne,x.selectionEnd=Math.min(de,x.value.length);else{var ve=x.ownerDocument||document,re=ve&&ve.defaultView||window;if(re.getSelection){var oe=re.getSelection(),Ze=x.textContent.length,Ke=Math.min(D.start,Ze),Jt=D.end===void 0?Ke:Math.min(D.end,Ze);!oe.extend&&Ke>Jt&&(E=Jt,Jt=Ke,Ke=E);var Q=tP(x,Ke),z=tP(x,Jt);if(Q&&z&&(oe.rangeCount!==1||oe.anchorNode!==Q.node||oe.anchorOffset!==Q.offset||oe.focusNode!==z.node||oe.focusOffset!==z.offset)){var ee=ve.createRange();ee.setStart(Q.node,Q.offset),oe.removeAllRanges(),Ke>Jt?(oe.addRange(ee),oe.extend(z.node,z.offset)):(ee.setEnd(z.node,z.offset),oe.addRange(ee))}}}}for(ve=[],oe=x;oe=oe.parentNode;)oe.nodeType===1&&ve.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<ve.length;x++){var me=ve[x];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}hw=!!d0,f0=d0=null}finally{Yt=m,fe.p=f,se.T=c}}s.current=l,_i=2}}function pD(){if(_i===2){_i=0;var s=Ll,l=Wh,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=se.T,se.T=null;var f=fe.p;fe.p=2;var m=Yt;Yt|=4;try{GN(s,l.alternate,l)}finally{Yt=m,fe.p=f,se.T=c}}_i=3}}function vD(){if(_i===4||_i===3){_i=0,ie();var s=Ll,l=Wh,c=jh,f=rD;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?_i=5:(_i=0,Wh=Ll=null,wD(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Dl=null),Pf(c),l=l.stateNode,Be&&typeof Be.onCommitFiberRoot=="function")try{Be.onCommitFiberRoot(ot,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=se.T,m=fe.p,fe.p=2,se.T=null;try{for(var v=s.onRecoverableError,E=0;E<f.length;E++){var x=f[E];v(x.value,{componentStack:x.stack})}}finally{se.T=l,fe.p=m}}(jh&3)!==0&&Jv(),Ms(s),m=s.pendingLanes,(c&4194090)!==0&&(m&42)!==0?s===QR?pg++:(pg=0,QR=s):pg=0,vg(0)}}function wD(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Xf(l)))}function Jv(s){return mD(),pD(),vD(),yD()}function yD(){if(_i!==5)return!1;var s=Ll,l=XR;XR=0;var c=Pf(jh),f=se.T,m=fe.p;try{fe.p=32>c?32:c,se.T=null,c=ZR,ZR=null;var v=Ll,E=jh;if(_i=0,Wh=Ll=null,jh=0,(Yt&6)!==0)throw Error(i(331));var x=Yt;if(Yt|=4,nD(v.current),JN(v,v.current,E,c),Yt=x,vg(0,!1),Be&&typeof Be.onPostCommitFiberRoot=="function")try{Be.onPostCommitFiberRoot(ot,v)}catch{}return!0}finally{fe.p=m,se.T=f,wD(s,l)}}function CD(s,l,c){l=ro(c,l),l=AR(s.stateNode,l,2),s=_l(s,l,2),s!==null&&(ko(s,2),Ms(s))}function tn(s,l,c){if(s.tag===3)CD(s,s,c);else for(;l!==null;){if(l.tag===3){CD(l,s,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Dl===null||!Dl.has(f))){s=ro(c,s),c=EN(2),f=_l(l,c,2),f!==null&&(TN(c,f,l,s),ko(f,2),Ms(f));break}}l=l.return}}function n0(s,l,c){var f=s.pingCache;if(f===null){f=s.pingCache=new E4;var m=new Set;f.set(l,m)}else m=f.get(l),m===void 0&&(m=new Set,f.set(l,m));m.has(c)||(YR=!0,m.add(c),s=x4.bind(null,s,l,c),l.then(s,s))}function x4(s,l,c){var f=s.pingCache;f!==null&&f.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,sn===s&&(_t&c)===c&&(In===4||In===3&&(_t&62914560)===_t&&300>W()-KR?(Yt&2)===0&&Uh(s,0):GR|=c,Fh===_t&&(Fh=0)),Ms(s)}function bD(s,l){l===0&&(l=ys()),s=_h(s,l),s!==null&&(ko(s,l),Ms(s))}function A4(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),bD(s,c)}function H4(s,l){var c=0;switch(s.tag){case 13:var f=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(l),bD(s,c)}function I4(s,l){return q(s,l)}var ew=null,Yh=null,i0=!1,tw=!1,r0=!1,Ku=0;function Ms(s){s!==Yh&&s.next===null&&(Yh===null?ew=Yh=s:Yh=Yh.next=s),tw=!0,i0||(i0=!0,N4())}function vg(s,l){if(!r0&&tw){r0=!0;do for(var c=!1,f=ew;f!==null;){if(s!==0){var m=f.pendingLanes;if(m===0)var v=0;else{var E=f.suspendedLanes,x=f.pingedLanes;v=(1<<31-gt(42|s)+1)-1,v&=m&~(E&~x),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,TD(f,v))}else v=_t,v=Ft(f,f===sn?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||it(f,v)||(c=!0,TD(f,v));f=f.next}while(c);r0=!1}}function P4(){SD()}function SD(){tw=i0=!1;var s=0;Ku!==0&&(W4()&&(s=Ku),Ku=0);for(var l=W(),c=null,f=ew;f!==null;){var m=f.next,v=RD(f,l);v===0?(f.next=null,c===null?ew=m:c.next=m,m===null&&(Yh=c)):(c=f,(s!==0||(v&3)!==0)&&(tw=!0)),f=m}vg(s)}function RD(s,l){for(var c=s.suspendedLanes,f=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var E=31-gt(v),x=1<<E,D=m[E];D===-1?((x&c)===0||(x&f)!==0)&&(m[E]=sr(x,l)):D<=l&&(s.expiredLanes|=x),v&=~x}if(l=sn,c=_t,c=Ft(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===l&&(Gt===2||Gt===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&j(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||it(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(f!==null&&j(f),Pf(c)){case 2:case 8:c=Z;break;case 32:c=ce;break;case 268435456:c=Ie;break;default:c=ce}return f=ED.bind(null,s),c=q(c,f),s.callbackPriority=l,s.callbackNode=c,l}return f!==null&&f!==null&&j(f),s.callbackPriority=2,s.callbackNode=null,2}function ED(s,l){if(_i!==0&&_i!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(Jv()&&s.callbackNode!==c)return null;var f=_t;return f=Ft(s,s===sn?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(sD(s,f,l),RD(s,W()),s.callbackNode!=null&&s.callbackNode===c?ED.bind(null,s):null)}function TD(s,l){if(Jv())return null;sD(s,l,!0)}function N4(){U4(function(){(Yt&6)!==0?q(te,P4):SD()})}function o0(){return Ku===0&&(Ku=ws()),Ku}function _D(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:dv(""+s)}function MD(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function D4(s,l,c,f,m){if(l==="submit"&&c&&c.stateNode===m){var v=_D((m[Hi]||null).action),E=f.submitter;E&&(l=(l=E[Hi]||null)?_D(l.formAction):E.getAttribute("formAction"),l!==null&&(v=l,E=null));var x=new pv("action","action",null,f,m);s.push({event:x,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ku!==0){var D=E?MD(m,E):new FormData(m);TR(c,{pending:!0,data:D,method:m.method,action:v},null,D)}}else typeof v=="function"&&(x.preventDefault(),D=E?MD(m,E):new FormData(m),TR(c,{pending:!0,data:D,method:m.method,action:v},v,D))},currentTarget:m}]})}}for(var s0=0;s0<US.length;s0++){var a0=US[s0],L4=a0.toLowerCase(),k4=a0[0].toUpperCase()+a0.slice(1);$o(L4,"on"+k4)}$o(sP,"onAnimationEnd"),$o(aP,"onAnimationIteration"),$o(lP,"onAnimationStart"),$o("dblclick","onDoubleClick"),$o("focusin","onFocus"),$o("focusout","onBlur"),$o(e4,"onTransitionRun"),$o(t4,"onTransitionStart"),$o(n4,"onTransitionCancel"),$o(uP,"onTransitionEnd"),Pe("onMouseEnter",["mouseout","mouseover"]),Pe("onMouseLeave",["mouseout","mouseover"]),Pe("onPointerEnter",["pointerout","pointerover"]),Pe("onPointerLeave",["pointerout","pointerover"]),be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),be("onBeforeInput",["compositionend","keypress","textInput","paste"]),be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wg));function OD(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],m=f.event;f=f.listeners;e:{var v=void 0;if(l)for(var E=f.length-1;0<=E;E--){var x=f[E],D=x.instance,ne=x.currentTarget;if(x=x.listener,D!==v&&m.isPropagationStopped())break e;v=x,m.currentTarget=ne;try{v(m)}catch(de){Wv(de)}m.currentTarget=null,v=D}else for(E=0;E<f.length;E++){if(x=f[E],D=x.instance,ne=x.currentTarget,x=x.listener,D!==v&&m.isPropagationStopped())break e;v=x,m.currentTarget=ne;try{v(m)}catch(de){Wv(de)}m.currentTarget=null,v=D}}}}function yt(s,l){var c=l[bs];c===void 0&&(c=l[bs]=new Set);var f=s+"__bubble";c.has(f)||(xD(l,s,2,!1),c.add(f))}function l0(s,l,c){var f=0;l&&(f|=4),xD(c,s,f,l)}var nw="_reactListening"+Math.random().toString(36).slice(2);function u0(s){if(!s[nw]){s[nw]=!0,Fe.forEach(function(c){c!=="selectionchange"&&(V4.has(c)||l0(c,!1,s),l0(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[nw]||(l[nw]=!0,l0("selectionchange",!1,l))}}function xD(s,l,c,f){switch(JD(l)){case 2:var m=hK;break;case 8:m=dK;break;default:m=R0}c=m.bind(null,l,c,s),m=void 0,!HS||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(m=!0),f?m!==void 0?s.addEventListener(l,c,{capture:!0,passive:m}):s.addEventListener(l,c,!0):m!==void 0?s.addEventListener(l,c,{passive:m}):s.addEventListener(l,c,!1)}function c0(s,l,c,f,m){var v=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var x=f.stateNode.containerInfo;if(x===m)break;if(E===4)for(E=f.return;E!==null;){var D=E.tag;if((D===3||D===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;x!==null;){if(E=ca(x),E===null)return;if(D=E.tag,D===5||D===6||D===26||D===27){f=v=E;continue e}x=x.parentNode}}f=f.return}LI(function(){var ne=v,de=xS(c),ve=[];e:{var re=cP.get(s);if(re!==void 0){var oe=pv,Ze=s;switch(s){case"keypress":if(gv(c)===0)break e;case"keydown":case"keyup":oe=Iq;break;case"focusin":Ze="focus",oe=DS;break;case"focusout":Ze="blur",oe=DS;break;case"beforeblur":case"afterblur":oe=DS;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=$I;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=Cq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=Dq;break;case sP:case aP:case lP:oe=Rq;break;case uP:oe=kq;break;case"scroll":case"scrollend":oe=wq;break;case"wheel":oe=$q;break;case"copy":case"cut":case"paste":oe=Tq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=FI;break;case"toggle":case"beforetoggle":oe=Fq}var Ke=(l&4)!==0,Jt=!Ke&&(s==="scroll"||s==="scrollend"),Q=Ke?re!==null?re+"Capture":null:re;Ke=[];for(var z=ne,ee;z!==null;){var me=z;if(ee=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||ee===null||Q===null||(me=kf(z,Q),me!=null&&Ke.push(yg(z,me,ee))),Jt)break;z=z.return}0<Ke.length&&(re=new oe(re,Ze,null,c,de),ve.push({event:re,listeners:Ke}))}}if((l&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",oe=s==="mouseout"||s==="pointerout",re&&c!==OS&&(Ze=c.relatedTarget||c.fromElement)&&(ca(Ze)||Ze[Ei]))break e;if((oe||re)&&(re=de.window===de?de:(re=de.ownerDocument)?re.defaultView||re.parentWindow:window,oe?(Ze=c.relatedTarget||c.toElement,oe=ne,Ze=Ze?ca(Ze):null,Ze!==null&&(Jt=o(Ze),Ke=Ze.tag,Ze!==Jt||Ke!==5&&Ke!==27&&Ke!==6)&&(Ze=null)):(oe=null,Ze=ne),oe!==Ze)){if(Ke=$I,me="onMouseLeave",Q="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ke=FI,me="onPointerLeave",Q="onPointerEnter",z="pointer"),Jt=oe==null?re:bl(oe),ee=Ze==null?re:bl(Ze),re=new Ke(me,z+"leave",oe,c,de),re.target=Jt,re.relatedTarget=ee,me=null,ca(de)===ne&&(Ke=new Ke(Q,z+"enter",Ze,c,de),Ke.target=ee,Ke.relatedTarget=Jt,me=Ke),Jt=me,oe&&Ze)t:{for(Ke=oe,Q=Ze,z=0,ee=Ke;ee;ee=Gh(ee))z++;for(ee=0,me=Q;me;me=Gh(me))ee++;for(;0<z-ee;)Ke=Gh(Ke),z--;for(;0<ee-z;)Q=Gh(Q),ee--;for(;z--;){if(Ke===Q||Q!==null&&Ke===Q.alternate)break t;Ke=Gh(Ke),Q=Gh(Q)}Ke=null}else Ke=null;oe!==null&&AD(ve,re,oe,Ke,!1),Ze!==null&&Jt!==null&&AD(ve,Jt,Ze,Ke,!0)}}e:{if(re=ne?bl(ne):window,oe=re.nodeName&&re.nodeName.toLowerCase(),oe==="select"||oe==="input"&&re.type==="file")var ke=KI;else if(GI(re))if(XI)ke=Zq;else{ke=Kq;var pt=qq}else oe=re.nodeName,!oe||oe.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?ne&&MS(ne.elementType)&&(ke=KI):ke=Xq;if(ke&&(ke=ke(s,ne))){qI(ve,ke,c,de);break e}pt&&pt(s,re,ne),s==="focusout"&&ne&&re.type==="number"&&ne.memoizedProps.value!=null&&_S(re,"number",re.value)}switch(pt=ne?bl(ne):window,s){case"focusin":(GI(pt)||pt.contentEditable==="true")&&(Rh=pt,FS=ne,zf=null);break;case"focusout":zf=FS=Rh=null;break;case"mousedown":WS=!0;break;case"contextmenu":case"mouseup":case"dragend":WS=!1,rP(ve,c,de);break;case"selectionchange":if(Jq)break;case"keydown":case"keyup":rP(ve,c,de)}var je;if(kS)e:{switch(s){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Sh?zI(s,c)&&(Xe="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Xe="onCompositionStart");Xe&&(WI&&c.locale!=="ko"&&(Sh||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Sh&&(je=kI()):(Sl=de,IS="value"in Sl?Sl.value:Sl.textContent,Sh=!0)),pt=iw(ne,Xe),0<pt.length&&(Xe=new BI(Xe,s,null,c,de),ve.push({event:Xe,listeners:pt}),je?Xe.data=je:(je=YI(c),je!==null&&(Xe.data=je)))),(je=jq?Uq(s,c):zq(s,c))&&(Xe=iw(ne,"onBeforeInput"),0<Xe.length&&(pt=new BI("onBeforeInput","beforeinput",null,c,de),ve.push({event:pt,listeners:Xe}),pt.data=je)),D4(ve,s,ne,c,de)}OD(ve,l)})}function yg(s,l,c){return{instance:s,listener:l,currentTarget:c}}function iw(s,l){for(var c=l+"Capture",f=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=kf(s,c),m!=null&&f.unshift(yg(s,m,v)),m=kf(s,l),m!=null&&f.push(yg(s,m,v))),s.tag===3)return f;s=s.return}return[]}function Gh(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function AD(s,l,c,f,m){for(var v=l._reactName,E=[];c!==null&&c!==f;){var x=c,D=x.alternate,ne=x.stateNode;if(x=x.tag,D!==null&&D===f)break;x!==5&&x!==26&&x!==27||ne===null||(D=ne,m?(ne=kf(c,v),ne!=null&&E.unshift(yg(c,ne,D))):m||(ne=kf(c,v),ne!=null&&E.push(yg(c,ne,D)))),c=c.return}E.length!==0&&s.push({event:l,listeners:E})}var $4=/\r\n?/g,B4=/\u0000|\uFFFD/g;function HD(s){return(typeof s=="string"?s:""+s).replace($4,`
`).replace(B4,"")}function ID(s,l){return l=HD(l),HD(s)===l}function rw(){}function Qt(s,l,c,f,m,v){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||yh(s,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&yh(s,""+f);break;case"className":Ss(s,"class",f);break;case"tabIndex":Ss(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Ss(s,c,f);break;case"style":NI(s,f,v);break;case"data":if(l!=="object"){Ss(s,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=dv(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(l!=="input"&&Qt(s,l,"name",m.name,m,null),Qt(s,l,"formEncType",m.formEncType,m,null),Qt(s,l,"formMethod",m.formMethod,m,null),Qt(s,l,"formTarget",m.formTarget,m,null)):(Qt(s,l,"encType",m.encType,m,null),Qt(s,l,"method",m.method,m,null),Qt(s,l,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=dv(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=rw);break;case"onScroll":f!=null&&yt("scroll",s);break;case"onScrollEnd":f!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=dv(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":yt("beforetoggle",s),yt("toggle",s),ar(s,"popover",f);break;case"xlinkActuate":Ir(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ir(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ir(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ir(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ir(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ir(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ir(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ir(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ir(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ar(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=pq.get(c)||c,ar(s,c,f))}}function h0(s,l,c,f,m,v){switch(c){case"style":NI(s,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"children":typeof f=="string"?yh(s,f):(typeof f=="number"||typeof f=="bigint")&&yh(s,""+f);break;case"onScroll":f!=null&&yt("scroll",s);break;case"onScrollEnd":f!=null&&yt("scrollend",s);break;case"onClick":f!=null&&(s.onclick=rw);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Y.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),l=c.slice(2,m?c.length-7:void 0),v=s[Hi]||null,v=v!=null?v[c]:null,typeof v=="function"&&s.removeEventListener(l,v,m),typeof f=="function")){typeof v!="function"&&v!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,f,m);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):ar(s,c,f)}}}function Mi(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var f=!1,m=!1,v;for(v in c)if(c.hasOwnProperty(v)){var E=c[v];if(E!=null)switch(v){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Qt(s,l,v,E,c,null)}}m&&Qt(s,l,"srcSet",c.srcSet,c,null),f&&Qt(s,l,"src",c.src,c,null);return;case"input":yt("invalid",s);var x=v=E=m=null,D=null,ne=null;for(f in c)if(c.hasOwnProperty(f)){var de=c[f];if(de!=null)switch(f){case"name":m=de;break;case"type":E=de;break;case"checked":D=de;break;case"defaultChecked":ne=de;break;case"value":v=de;break;case"defaultValue":x=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,l));break;default:Qt(s,l,f,de,c,null)}}AI(s,v,x,D,ne,E,m,!1),cv(s);return;case"select":yt("invalid",s),f=E=v=null;for(m in c)if(c.hasOwnProperty(m)&&(x=c[m],x!=null))switch(m){case"value":v=x;break;case"defaultValue":E=x;break;case"multiple":f=x;default:Qt(s,l,m,x,c,null)}l=v,c=E,s.multiple=!!f,l!=null?wh(s,!!f,l,!1):c!=null&&wh(s,!!f,c,!0);return;case"textarea":yt("invalid",s),v=m=f=null;for(E in c)if(c.hasOwnProperty(E)&&(x=c[E],x!=null))switch(E){case"value":f=x;break;case"defaultValue":m=x;break;case"children":v=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:Qt(s,l,E,x,c,null)}II(s,f,m,v),cv(s);return;case"option":for(D in c)if(c.hasOwnProperty(D)&&(f=c[D],f!=null))switch(D){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Qt(s,l,D,f,c,null)}return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(f=0;f<wg.length;f++)yt(wg[f],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in c)if(c.hasOwnProperty(ne)&&(f=c[ne],f!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Qt(s,l,ne,f,c,null)}return;default:if(MS(l)){for(de in c)c.hasOwnProperty(de)&&(f=c[de],f!==void 0&&h0(s,l,de,f,c,void 0));return}}for(x in c)c.hasOwnProperty(x)&&(f=c[x],f!=null&&Qt(s,l,x,f,c,null))}function F4(s,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,E=null,x=null,D=null,ne=null,de=null;for(oe in c){var ve=c[oe];if(c.hasOwnProperty(oe)&&ve!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":D=ve;default:f.hasOwnProperty(oe)||Qt(s,l,oe,null,f,ve)}}for(var re in f){var oe=f[re];if(ve=c[re],f.hasOwnProperty(re)&&(oe!=null||ve!=null))switch(re){case"type":v=oe;break;case"name":m=oe;break;case"checked":ne=oe;break;case"defaultChecked":de=oe;break;case"value":E=oe;break;case"defaultValue":x=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,l));break;default:oe!==ve&&Qt(s,l,re,oe,f,ve)}}TS(s,E,x,D,ne,de,v,m);return;case"select":oe=E=x=re=null;for(v in c)if(D=c[v],c.hasOwnProperty(v)&&D!=null)switch(v){case"value":break;case"multiple":oe=D;default:f.hasOwnProperty(v)||Qt(s,l,v,null,f,D)}for(m in f)if(v=f[m],D=c[m],f.hasOwnProperty(m)&&(v!=null||D!=null))switch(m){case"value":re=v;break;case"defaultValue":x=v;break;case"multiple":E=v;default:v!==D&&Qt(s,l,m,v,f,D)}l=x,c=E,f=oe,re!=null?wh(s,!!c,re,!1):!!f!=!!c&&(l!=null?wh(s,!!c,l,!0):wh(s,!!c,c?[]:"",!1));return;case"textarea":oe=re=null;for(x in c)if(m=c[x],c.hasOwnProperty(x)&&m!=null&&!f.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Qt(s,l,x,null,f,m)}for(E in f)if(m=f[E],v=c[E],f.hasOwnProperty(E)&&(m!=null||v!=null))switch(E){case"value":re=m;break;case"defaultValue":oe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==v&&Qt(s,l,E,m,f,v)}HI(s,re,oe);return;case"option":for(var Ze in c)if(re=c[Ze],c.hasOwnProperty(Ze)&&re!=null&&!f.hasOwnProperty(Ze))switch(Ze){case"selected":s.selected=!1;break;default:Qt(s,l,Ze,null,f,re)}for(D in f)if(re=f[D],oe=c[D],f.hasOwnProperty(D)&&re!==oe&&(re!=null||oe!=null))switch(D){case"selected":s.selected=re&&typeof re!="function"&&typeof re!="symbol";break;default:Qt(s,l,D,re,f,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in c)re=c[Ke],c.hasOwnProperty(Ke)&&re!=null&&!f.hasOwnProperty(Ke)&&Qt(s,l,Ke,null,f,re);for(ne in f)if(re=f[ne],oe=c[ne],f.hasOwnProperty(ne)&&re!==oe&&(re!=null||oe!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,l));break;default:Qt(s,l,ne,re,f,oe)}return;default:if(MS(l)){for(var Jt in c)re=c[Jt],c.hasOwnProperty(Jt)&&re!==void 0&&!f.hasOwnProperty(Jt)&&h0(s,l,Jt,void 0,f,re);for(de in f)re=f[de],oe=c[de],!f.hasOwnProperty(de)||re===oe||re===void 0&&oe===void 0||h0(s,l,de,re,f,oe);return}}for(var Q in c)re=c[Q],c.hasOwnProperty(Q)&&re!=null&&!f.hasOwnProperty(Q)&&Qt(s,l,Q,null,f,re);for(ve in f)re=f[ve],oe=c[ve],!f.hasOwnProperty(ve)||re===oe||re==null&&oe==null||Qt(s,l,ve,re,f,oe)}var d0=null,f0=null;function ow(s){return s.nodeType===9?s:s.ownerDocument}function PD(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ND(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function g0(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var m0=null;function W4(){var s=window.event;return s&&s.type==="popstate"?s===m0?!1:(m0=s,!0):(m0=null,!1)}var DD=typeof setTimeout=="function"?setTimeout:void 0,j4=typeof clearTimeout=="function"?clearTimeout:void 0,LD=typeof Promise=="function"?Promise:void 0,U4=typeof queueMicrotask=="function"?queueMicrotask:typeof LD<"u"?function(s){return LD.resolve(null).then(s).catch(z4)}:DD;function z4(s){setTimeout(function(){throw s})}function Vl(s){return s==="head"}function kD(s,l){var c=l,f=0,m=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"){if(0<f&&8>f){c=f;var E=s.ownerDocument;if(c&1&&Cg(E.documentElement),c&2&&Cg(E.body),c&4)for(c=E.head,Cg(c),E=c.firstChild;E;){var x=E.nextSibling,D=E.nodeName;E[Cl]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&E.rel.toLowerCase()==="stylesheet"||c.removeChild(E),E=x}}if(m===0){s.removeChild(v),Og(l);return}m--}else c==="$"||c==="$?"||c==="$!"?m++:f=c.charCodeAt(0)-48;else f=0;c=v}while(c);Og(l)}function p0(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":p0(c),Hr(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function Y4(s,l,c,f){for(;s.nodeType===1;){var m=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[Cl])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Fo(s.nextSibling),s===null)break}return null}function G4(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Fo(s.nextSibling),s===null))return null;return s}function v0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function q4(s,l){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")l();else{var f=function(){l(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Fo(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return s}var w0=null;function VD(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(l===0)return s;l--}else c==="/$"&&l++}s=s.previousSibling}return null}function $D(s,l,c){switch(l=ow(c),s){case"html":if(s=l.documentElement,!s)throw Error(i(452));return s;case"head":if(s=l.head,!s)throw Error(i(453));return s;case"body":if(s=l.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Cg(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Hr(s)}var co=new Map,BD=new Set;function sw(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ma=fe.d;fe.d={f:K4,r:X4,D:Z4,C:Q4,L:J4,m:eK,X:nK,S:tK,M:iK};function K4(){var s=Ma.f(),l=Zv();return s||l}function X4(s){var l=ha(s);l!==null&&l.tag===5&&l.type==="form"?sN(l):Ma.r(s)}var qh=typeof document>"u"?null:document;function FD(s,l,c){var f=qh;if(f&&typeof l=="string"&&l){var m=io(l);m='link[rel="'+s+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),BD.has(m)||(BD.add(m),s={rel:s,crossOrigin:c,href:l},f.querySelector(m)===null&&(l=f.createElement("link"),Mi(l,"link",s),qn(l),f.head.appendChild(l)))}}function Z4(s){Ma.D(s),FD("dns-prefetch",s,null)}function Q4(s,l){Ma.C(s,l),FD("preconnect",s,l)}function J4(s,l,c){Ma.L(s,l,c);var f=qh;if(f&&s&&l){var m='link[rel="preload"][as="'+io(l)+'"]';l==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+io(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+io(c.imageSizes)+'"]')):m+='[href="'+io(s)+'"]';var v=m;switch(l){case"style":v=Kh(s);break;case"script":v=Xh(s)}co.has(v)||(s=g({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),co.set(v,s),f.querySelector(m)!==null||l==="style"&&f.querySelector(bg(v))||l==="script"&&f.querySelector(Sg(v))||(l=f.createElement("link"),Mi(l,"link",s),qn(l),f.head.appendChild(l)))}}function eK(s,l){Ma.m(s,l);var c=qh;if(c&&s){var f=l&&typeof l.as=="string"?l.as:"script",m='link[rel="modulepreload"][as="'+io(f)+'"][href="'+io(s)+'"]',v=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Xh(s)}if(!co.has(v)&&(s=g({rel:"modulepreload",href:s},l),co.set(v,s),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Sg(v)))return}f=c.createElement("link"),Mi(f,"link",s),qn(f),c.head.appendChild(f)}}}function tK(s,l,c){Ma.S(s,l,c);var f=qh;if(f&&s){var m=da(f).hoistableStyles,v=Kh(s);l=l||"default";var E=m.get(v);if(!E){var x={loading:0,preload:null};if(E=f.querySelector(bg(v)))x.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":l},c),(c=co.get(v))&&y0(s,c);var D=E=f.createElement("link");qn(D),Mi(D,"link",s),D._p=new Promise(function(ne,de){D.onload=ne,D.onerror=de}),D.addEventListener("load",function(){x.loading|=1}),D.addEventListener("error",function(){x.loading|=2}),x.loading|=4,aw(E,l,f)}E={type:"stylesheet",instance:E,count:1,state:x},m.set(v,E)}}}function nK(s,l){Ma.X(s,l);var c=qh;if(c&&s){var f=da(c).hoistableScripts,m=Xh(s),v=f.get(m);v||(v=c.querySelector(Sg(m)),v||(s=g({src:s,async:!0},l),(l=co.get(m))&&C0(s,l),v=c.createElement("script"),qn(v),Mi(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function iK(s,l){Ma.M(s,l);var c=qh;if(c&&s){var f=da(c).hoistableScripts,m=Xh(s),v=f.get(m);v||(v=c.querySelector(Sg(m)),v||(s=g({src:s,async:!0,type:"module"},l),(l=co.get(m))&&C0(s,l),v=c.createElement("script"),qn(v),Mi(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function WD(s,l,c,f){var m=(m=V.current)?sw(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Kh(c.href),c=da(m).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Kh(c.href);var v=da(m).hoistableStyles,E=v.get(s);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,E),(v=m.querySelector(bg(s)))&&!v._p&&(E.instance=v,E.state.loading=5),co.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},co.set(s,c),v||rK(m,s,c,E.state))),l&&f===null)throw Error(i(528,""));return E}if(l&&f!==null)throw Error(i(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Xh(c),c=da(m).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Kh(s){return'href="'+io(s)+'"'}function bg(s){return'link[rel="stylesheet"]['+s+"]"}function jD(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function rK(s,l,c,f){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=s.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),Mi(l,"link",c),qn(l),s.head.appendChild(l))}function Xh(s){return'[src="'+io(s)+'"]'}function Sg(s){return"script[async]"+s}function UD(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=s.querySelector('style[data-href~="'+io(c.href)+'"]');if(f)return l.instance=f,qn(f),f;var m=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),qn(f),Mi(f,"style",m),aw(f,c.precedence,s),l.instance=f;case"stylesheet":m=Kh(c.href);var v=s.querySelector(bg(m));if(v)return l.state.loading|=4,l.instance=v,qn(v),v;f=jD(c),(m=co.get(m))&&y0(f,m),v=(s.ownerDocument||s).createElement("link"),qn(v);var E=v;return E._p=new Promise(function(x,D){E.onload=x,E.onerror=D}),Mi(v,"link",f),l.state.loading|=4,aw(v,c.precedence,s),l.instance=v;case"script":return v=Xh(c.src),(m=s.querySelector(Sg(v)))?(l.instance=m,qn(m),m):(f=c,(m=co.get(v))&&(f=g({},c),C0(f,m)),s=s.ownerDocument||s,m=s.createElement("script"),qn(m),Mi(m,"link",f),s.head.appendChild(m),l.instance=m);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,aw(f,c.precedence,s));return l.instance}function aw(s,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,v=m,E=0;E<f.length;E++){var x=f[E];if(x.dataset.precedence===l)v=x;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function y0(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function C0(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var lw=null;function zD(s,l,c){if(lw===null){var f=new Map,m=lw=new Map;m.set(c,f)}else m=lw,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),m=0;m<c.length;m++){var v=c[m];if(!(v[Cl]||v[li]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(l)||"";E=s+E;var x=f.get(E);x?x.push(v):f.set(E,[v])}}return f}function YD(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function oK(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function GD(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Rg=null;function sK(){}function aK(s,l,c){if(Rg===null)throw Error(i(475));var f=Rg;if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=Kh(c.href),v=s.querySelector(bg(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(f.count++,f=uw.bind(f),s.then(f,f)),l.state.loading|=4,l.instance=v,qn(v);return}v=s.ownerDocument||s,c=jD(c),(m=co.get(m))&&y0(c,m),v=v.createElement("link"),qn(v);var E=v;E._p=new Promise(function(x,D){E.onload=x,E.onerror=D}),Mi(v,"link",c),l.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(f.count++,l=uw.bind(f),s.addEventListener("load",l),s.addEventListener("error",l))}}function lK(){if(Rg===null)throw Error(i(475));var s=Rg;return s.stylesheets&&s.count===0&&b0(s,s.stylesheets),0<s.count?function(l){var c=setTimeout(function(){if(s.stylesheets&&b0(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(c)}}:null}function uw(){if(this.count--,this.count===0){if(this.stylesheets)b0(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var cw=null;function b0(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,cw=new Map,l.forEach(uK,s),cw=null,uw.call(s))}function uK(s,l){if(!(l.state.loading&4)){var c=cw.get(s);if(c)var f=c.get(null);else{c=new Map,cw.set(s,c);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var E=m[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(c.set(E.dataset.precedence,E),f=E)}f&&c.set(null,f)}m=l.instance,E=m.getAttribute("data-precedence"),v=c.get(E)||f,v===f&&c.set(null,m),c.set(E,m),this.count++,f=uw.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),l.state.loading|=4}}var Eg={$$typeof:N,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function cK(s,l,c,f,m,v,E,x){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=If(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=If(0),this.hiddenUpdates=If(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=x,this.incompleteTransitions=new Map}function qD(s,l,c,f,m,v,E,x,D,ne,de,ve){return s=new cK(s,l,c,E,x,D,ne,ve),l=1,v===!0&&(l|=24),v=Nr(3,null,null,l),s.current=v,v.stateNode=s,l=nR(),l.refCount++,s.pooledCache=l,l.refCount++,v.memoizedState={element:f,isDehydrated:c,cache:l},sR(v),s}function KD(s){return s?(s=Mh,s):Mh}function XD(s,l,c,f,m,v){m=KD(m),f.context===null?f.context=m:f.pendingContext=m,f=Tl(l),f.payload={element:c},v=v===void 0?null:v,v!==null&&(f.callback=v),c=_l(s,f,l),c!==null&&($r(c,s,l),eg(c,s,l))}function ZD(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function S0(s,l){ZD(s,l),(s=s.alternate)&&ZD(s,l)}function QD(s){if(s.tag===13){var l=_h(s,67108864);l!==null&&$r(l,s,67108864),S0(s,67108864)}}var hw=!0;function hK(s,l,c,f){var m=se.T;se.T=null;var v=fe.p;try{fe.p=2,R0(s,l,c,f)}finally{fe.p=v,se.T=m}}function dK(s,l,c,f){var m=se.T;se.T=null;var v=fe.p;try{fe.p=8,R0(s,l,c,f)}finally{fe.p=v,se.T=m}}function R0(s,l,c,f){if(hw){var m=E0(f);if(m===null)c0(s,l,f,dw,c),eL(s,f);else if(gK(m,s,l,c,f))f.stopPropagation();else if(eL(s,f),l&4&&-1<fK.indexOf(s)){for(;m!==null;){var v=ha(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=Tt(v.pendingLanes);if(E!==0){var x=v;for(x.pendingLanes|=2,x.entangledLanes|=2;E;){var D=1<<31-gt(E);x.entanglements[1]|=D,E&=~D}Ms(v),(Yt&6)===0&&(Kv=W()+500,vg(0))}}break;case 13:x=_h(v,2),x!==null&&$r(x,v,2),Zv(),S0(v,2)}if(v=E0(f),v===null&&c0(s,l,f,dw,c),v===m)break;m=v}m!==null&&f.stopPropagation()}else c0(s,l,f,null,c)}}function E0(s){return s=xS(s),T0(s)}var dw=null;function T0(s){if(dw=null,s=ca(s),s!==null){var l=o(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=a(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return dw=s,null}function JD(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(X()){case te:return 2;case Z:return 8;case ce:case He:return 32;case Ie:return 268435456;default:return 32}default:return 32}}var _0=!1,$l=null,Bl=null,Fl=null,Tg=new Map,_g=new Map,Wl=[],fK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eL(s,l){switch(s){case"focusin":case"focusout":$l=null;break;case"dragenter":case"dragleave":Bl=null;break;case"mouseover":case"mouseout":Fl=null;break;case"pointerover":case"pointerout":Tg.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":_g.delete(l.pointerId)}}function Mg(s,l,c,f,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},l!==null&&(l=ha(l),l!==null&&QD(l)),s):(s.eventSystemFlags|=f,l=s.targetContainers,m!==null&&l.indexOf(m)===-1&&l.push(m),s)}function gK(s,l,c,f,m){switch(l){case"focusin":return $l=Mg($l,s,l,c,f,m),!0;case"dragenter":return Bl=Mg(Bl,s,l,c,f,m),!0;case"mouseover":return Fl=Mg(Fl,s,l,c,f,m),!0;case"pointerover":var v=m.pointerId;return Tg.set(v,Mg(Tg.get(v)||null,s,l,c,f,m)),!0;case"gotpointercapture":return v=m.pointerId,_g.set(v,Mg(_g.get(v)||null,s,l,c,f,m)),!0}return!1}function tL(s){var l=ca(s.target);if(l!==null){var c=o(l);if(c!==null){if(l=c.tag,l===13){if(l=a(c),l!==null){s.blockedOn=l,Df(s.priority,function(){if(c.tag===13){var f=Vr();f=Cs(f);var m=_h(c,f);m!==null&&$r(m,c,f),S0(c,f)}});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function fw(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=E0(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);OS=f,c.target.dispatchEvent(f),OS=null}else return l=ha(c),l!==null&&QD(l),s.blockedOn=c,!1;l.shift()}return!0}function nL(s,l,c){fw(s)&&c.delete(l)}function mK(){_0=!1,$l!==null&&fw($l)&&($l=null),Bl!==null&&fw(Bl)&&(Bl=null),Fl!==null&&fw(Fl)&&(Fl=null),Tg.forEach(nL),_g.forEach(nL)}function gw(s,l){s.blockedOn===l&&(s.blockedOn=null,_0||(_0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,mK)))}var mw=null;function iL(s){mw!==s&&(mw=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){mw===s&&(mw=null);for(var l=0;l<s.length;l+=3){var c=s[l],f=s[l+1],m=s[l+2];if(typeof f!="function"){if(T0(f||c)===null)continue;break}var v=ha(c);v!==null&&(s.splice(l,3),l-=3,TR(v,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function Og(s){function l(D){return gw(D,s)}$l!==null&&gw($l,s),Bl!==null&&gw(Bl,s),Fl!==null&&gw(Fl,s),Tg.forEach(l),_g.forEach(l);for(var c=0;c<Wl.length;c++){var f=Wl[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<Wl.length&&(c=Wl[0],c.blockedOn===null);)tL(c),c.blockedOn===null&&Wl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],v=c[f+1],E=m[Hi]||null;if(typeof v=="function")E||iL(c);else if(E){var x=null;if(v&&v.hasAttribute("formAction")){if(m=v,E=v[Hi]||null)x=E.formAction;else if(T0(m)!==null)continue}else x=E.action;typeof x=="function"?c[f+1]=x:(c.splice(f,3),f-=3),iL(c)}}}function M0(s){this._internalRoot=s}pw.prototype.render=M0.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(i(409));var c=l.current,f=Vr();XD(c,f,s,l,null,null)},pw.prototype.unmount=M0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;XD(s.current,2,null,s,null,null),Zv(),l[Ei]=null}};function pw(s){this._internalRoot=s}pw.prototype.unstable_scheduleHydration=function(s){if(s){var l=Nf();s={blockedOn:null,target:s,priority:l};for(var c=0;c<Wl.length&&l!==0&&l<Wl[c].priority;c++);Wl.splice(c,0,s),c===0&&tL(s)}};var rL=e.version;if(rL!=="19.1.0")throw Error(i(527,rL,"19.1.0"));fe.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=h(l),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var pK={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vw.isDisabled&&vw.supportsFiber)try{ot=vw.inject(pK),Be=vw}catch{}}return Ag.createRoot=function(s,l){if(!r(s))throw Error(i(299));var c=!1,f="",m=CN,v=bN,E=SN,x=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(x=l.unstable_transitionCallbacks)),l=qD(s,1,!1,null,null,c,f,m,v,E,x,null),s[Ei]=l.current,u0(s),new M0(l)},Ag.hydrateRoot=function(s,l,c){if(!r(s))throw Error(i(299));var f=!1,m="",v=CN,E=bN,x=SN,D=null,ne=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(x=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(D=c.unstable_transitionCallbacks),c.formState!==void 0&&(ne=c.formState)),l=qD(s,1,!0,l,c??null,f,m,v,E,x,D,ne),l.context=KD(null),c=l.current,f=Vr(),f=Cs(f),m=Tl(f),m.callback=null,_l(c,m,f),c=f,l.current.lanes=c,ko(l,c),Ms(l),s[Ei]=l.current,u0(s),new pw(l)},Ag.version="19.1.0",Ag}var mL;function OK(){if(mL)return A0.exports;mL=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),A0.exports=MK(),A0.exports}var xK=OK();/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AK=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HK=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,i)=>i?i.toUpperCase():n.toLowerCase()),pL=t=>{const e=HK(t);return e.charAt(0).toUpperCase()+e.slice(1)},x2=(...t)=>t.filter((e,n,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===n).join(" ").trim(),IK=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var PK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NK=un.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:o,iconNode:a,...u},h)=>un.createElement("svg",{ref:h,...PK,width:e,height:e,stroke:t,strokeWidth:i?Number(n)*24/Number(e):n,className:x2("lucide",r),...!o&&!IK(u)&&{"aria-hidden":"true"},...u},[...a.map(([d,g])=>un.createElement(d,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=(t,e)=>{const n=un.forwardRef(({className:i,...r},o)=>un.createElement(NK,{ref:o,iconNode:e,className:x2(`lucide-${AK(pL(t))}`,`lucide-${t}`,i),...r}));return n.displayName=pL(t),n};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DK=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],LK=mf("download",DK);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kK=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],VK=mf("play",kK);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $K=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],BK=mf("save",$K);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FK=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],WK=mf("settings",FK);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jK=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],UK=mf("trash-2",jK);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zK=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],YK=mf("upload",zK);var GK=O2();const A2=M2(GK);var vL;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(vL||(vL={}));const qK=Object.freeze({x:0,y:0});var Ud;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Ud||(Ud={}));var wL;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(wL||(wL={}));var Eo;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Eo||(Eo={}));Eo.Space,Eo.Enter,Eo.Esc,Eo.Space,Eo.Enter,Eo.Tab;var yL;(function(t){t[t.RightClick=2]="RightClick"})(yL||(yL={}));var CL;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(CL||(CL={}));var bL;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(bL||(bL={}));Ud.Backward+"",Ud.Forward+"",Ud.Backward+"",Ud.Forward+"";var D1;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(D1||(D1={}));var L1;(function(t){t.Optimized="optimized"})(L1||(L1={}));D1.WhileDragging,L1.Optimized;({...qK});var SL;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(SL||(SL={}));function KK(t,e,n){const i=t.slice();return i.splice(n<0?i.length+n:n,0,i.splice(e,1)[0]),i}Eo.Down,Eo.Right,Eo.Up,Eo.Left;const RL=t=>{const e=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0");return`${e}/${n}`},yw=t=>{const e=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0");return`${e}:${n}`},XK=(t,e)=>{const n=new Date(t),[i,r]=e.date.split("/"),[o,a]=e.arrivalTime.split(":"),h=new Date(n.getFullYear(),parseInt(i)-1,parseInt(r),parseInt(o),parseInt(a)).getTime()-n.getTime();return`${Math.round(h/(1e3*60*60)*10)/10}時間`},ZK=(t,e)=>un.useMemo(()=>{const n=[...e];for(let a=1;a<n.length;a++){const u=n[a],h=n[a-1];if(a<=1){u.hasError=!1;continue}u.distance<h.distance?u.hasError=!0:u.hasError=!1}const i=n.map((a,u,h)=>{if(u<=1)return a;const d=h[u-1],g=Number((a.distance-d.distance).toFixed(2));return{...a,interval:g>0?g:a.interval}}),r=new Date(t);let o=new Date(r);return i.map(a=>{if(a.id===0)return{...a,date:RL(o),arrivalTime:yw(o),departureTime:a.restTime>0?yw(new Date(o.getTime()+a.restTime*6e4)):""};!a.hasError&&a.interval>0&&a.pace>0&&(o=new Date(o.getTime()+a.interval*a.pace*6e4));const u=RL(o),h=yw(o);return a.restTime>0&&(o=new Date(o.getTime()+a.restTime*6e4)),{...a,date:u,arrivalTime:h,departureTime:a.restTime>0?yw(o):""}})},[t,e]);var EL={},Hg,TL;function ri(){if(TL)return Hg;TL=1;var t=function(e){return e&&e.Math===Math&&e};return Hg=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof oL=="object"&&oL)||t(typeof Hg=="object"&&Hg)||function(){return this}()||Function("return this")(),Hg}var N0={},D0,_L;function Ri(){return _L||(_L=1,D0=function(t){try{return!!t()}catch{return!0}}),D0}var L0,ML;function Ao(){if(ML)return L0;ML=1;var t=Ri();return L0=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),L0}var k0,OL;function Eb(){if(OL)return k0;OL=1;var t=Ri();return k0=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),k0}var V0,xL;function oi(){if(xL)return V0;xL=1;var t=Eb(),e=Function.prototype.call;return V0=t?e.bind(e):function(){return e.apply(e,arguments)},V0}var $0={},AL;function QK(){if(AL)return $0;AL=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return $0.f=n?function(r){var o=e(this,r);return!!o&&o.enumerable}:t,$0}var B0,HL;function Tb(){return HL||(HL=1,B0=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),B0}var F0,IL;function Yn(){if(IL)return F0;IL=1;var t=Eb(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return F0=t?i:function(r){return function(){return n.apply(r,arguments)}},F0}var W0,PL;function ah(){if(PL)return W0;PL=1;var t=Yn(),e=t({}.toString),n=t("".slice);return W0=function(i){return n(e(i),8,-1)},W0}var j0,NL;function JK(){if(NL)return j0;NL=1;var t=Yn(),e=Ri(),n=ah(),i=Object,r=t("".split);return j0=e(function(){return!i("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?r(o,""):i(o)}:i,j0}var U0,DL;function BO(){return DL||(DL=1,U0=function(t){return t==null}),U0}var z0,LL;function Pp(){if(LL)return z0;LL=1;var t=BO(),e=TypeError;return z0=function(n){if(t(n))throw new e("Can't call method on "+n);return n},z0}var Y0,kL;function Np(){if(kL)return Y0;kL=1;var t=JK(),e=Pp();return Y0=function(n){return t(e(n))},Y0}var G0,VL;function si(){if(VL)return G0;VL=1;var t=typeof document=="object"&&document.all;return G0=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},G0}var q0,$L;function Ho(){if($L)return q0;$L=1;var t=si();return q0=function(e){return typeof e=="object"?e!==null:t(e)},q0}var K0,BL;function pf(){if(BL)return K0;BL=1;var t=ri(),e=si(),n=function(i){return e(i)?i:void 0};return K0=function(i,r){return arguments.length<2?n(t[i]):t[i]&&t[i][r]},K0}var X0,FL;function Dp(){if(FL)return X0;FL=1;var t=Yn();return X0=t({}.isPrototypeOf),X0}var Z0,WL;function _b(){if(WL)return Z0;WL=1;var t=ri(),e=t.navigator,n=e&&e.userAgent;return Z0=n?String(n):"",Z0}var Q0,jL;function e6(){if(jL)return Q0;jL=1;var t=ri(),e=_b(),n=t.process,i=t.Deno,r=n&&n.versions||i&&i.version,o=r&&r.v8,a,u;return o&&(a=o.split("."),u=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!u&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(u=+a[1]))),Q0=u,Q0}var J0,UL;function FO(){if(UL)return J0;UL=1;var t=e6(),e=Ri(),n=ri(),i=n.String;return J0=!!Object.getOwnPropertySymbols&&!e(function(){var r=Symbol("symbol detection");return!i(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&t&&t<41}),J0}var eE,zL;function H2(){if(zL)return eE;zL=1;var t=FO();return eE=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",eE}var tE,YL;function WO(){if(YL)return tE;YL=1;var t=pf(),e=si(),n=Dp(),i=H2(),r=Object;return tE=i?function(o){return typeof o=="symbol"}:function(o){var a=t("Symbol");return e(a)&&n(a.prototype,r(o))},tE}var nE,GL;function Mb(){if(GL)return nE;GL=1;var t=String;return nE=function(e){try{return t(e)}catch{return"Object"}},nE}var iE,qL;function Or(){if(qL)return iE;qL=1;var t=si(),e=Mb(),n=TypeError;return iE=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")},iE}var rE,KL;function Lp(){if(KL)return rE;KL=1;var t=Or(),e=BO();return rE=function(n,i){var r=n[i];return e(r)?void 0:t(r)},rE}var oE,XL;function t6(){if(XL)return oE;XL=1;var t=oi(),e=si(),n=Ho(),i=TypeError;return oE=function(r,o){var a,u;if(o==="string"&&e(a=r.toString)&&!n(u=t(a,r))||e(a=r.valueOf)&&!n(u=t(a,r))||o!=="string"&&e(a=r.toString)&&!n(u=t(a,r)))return u;throw new i("Can't convert object to primitive value")},oE}var sE={exports:{}},aE,ZL;function Ou(){return ZL||(ZL=1,aE=!1),aE}var lE,QL;function jO(){if(QL)return lE;QL=1;var t=ri(),e=Object.defineProperty;return lE=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch{t[n]=i}return i},lE}var JL;function UO(){if(JL)return sE.exports;JL=1;var t=Ou(),e=ri(),n=jO(),i="__core-js_shared__",r=sE.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.42.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sE.exports}var uE,ek;function I2(){if(ek)return uE;ek=1;var t=UO();return uE=function(e,n){return t[e]||(t[e]=n||{})},uE}var cE,tk;function vf(){if(tk)return cE;tk=1;var t=Pp(),e=Object;return cE=function(n){return e(t(n))},cE}var hE,nk;function Io(){if(nk)return hE;nk=1;var t=Yn(),e=vf(),n=t({}.hasOwnProperty);return hE=Object.hasOwn||function(r,o){return n(e(r),o)},hE}var dE,ik;function P2(){if(ik)return dE;ik=1;var t=Yn(),e=0,n=Math.random(),i=t(1 .toString);return dE=function(r){return"Symbol("+(r===void 0?"":r)+")_"+i(++e+n,36)},dE}var fE,rk;function gs(){if(rk)return fE;rk=1;var t=ri(),e=I2(),n=Io(),i=P2(),r=FO(),o=H2(),a=t.Symbol,u=e("wks"),h=o?a.for||a:a&&a.withoutSetter||i;return fE=function(d){return n(u,d)||(u[d]=r&&n(a,d)?a[d]:h("Symbol."+d)),u[d]},fE}var gE,ok;function n6(){if(ok)return gE;ok=1;var t=oi(),e=Ho(),n=WO(),i=Lp(),r=t6(),o=gs(),a=TypeError,u=o("toPrimitive");return gE=function(h,d){if(!e(h)||n(h))return h;var g=i(h,u),p;if(g){if(d===void 0&&(d="default"),p=t(g,h,d),!e(p)||n(p))return p;throw new a("Can't convert object to primitive value")}return d===void 0&&(d="number"),r(h,d)},gE}var mE,sk;function N2(){if(sk)return mE;sk=1;var t=n6(),e=WO();return mE=function(n){var i=t(n,"string");return e(i)?i:i+""},mE}var pE,ak;function zO(){if(ak)return pE;ak=1;var t=ri(),e=Ho(),n=t.document,i=e(n)&&e(n.createElement);return pE=function(r){return i?n.createElement(r):{}},pE}var vE,lk;function D2(){if(lk)return vE;lk=1;var t=Ao(),e=Ri(),n=zO();return vE=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),vE}var uk;function L2(){if(uk)return N0;uk=1;var t=Ao(),e=oi(),n=QK(),i=Tb(),r=Np(),o=N2(),a=Io(),u=D2(),h=Object.getOwnPropertyDescriptor;return N0.f=t?h:function(g,p){if(g=r(g),p=o(p),u)try{return h(g,p)}catch{}if(a(g,p))return i(!e(n.f,g,p),g[p])},N0}var wE={},yE,ck;function k2(){if(ck)return yE;ck=1;var t=Ao(),e=Ri();return yE=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),yE}var CE,hk;function ai(){if(hk)return CE;hk=1;var t=Ho(),e=String,n=TypeError;return CE=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")},CE}var dk;function xu(){if(dk)return wE;dk=1;var t=Ao(),e=D2(),n=k2(),i=ai(),r=N2(),o=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",g="writable";return wE.f=t?n?function(w,y,b){if(i(w),y=r(y),i(b),typeof w=="function"&&y==="prototype"&&"value"in b&&g in b&&!b[g]){var T=u(w,y);T&&T[g]&&(w[y]=b.value,b={configurable:d in b?b[d]:T[d],enumerable:h in b?b[h]:T[h],writable:!1})}return a(w,y,b)}:a:function(w,y,b){if(i(w),y=r(y),i(b),e)try{return a(w,y,b)}catch{}if("get"in b||"set"in b)throw new o("Accessors not supported");return"value"in b&&(w[y]=b.value),w},wE}var bE,fk;function wf(){if(fk)return bE;fk=1;var t=Ao(),e=xu(),n=Tb();return bE=t?function(i,r,o){return e.f(i,r,n(1,o))}:function(i,r,o){return i[r]=o,i},bE}var SE={exports:{}},RE,gk;function i6(){if(gk)return RE;gk=1;var t=Ao(),e=Io(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),o=r&&(function(){}).name==="something",a=r&&(!t||t&&i(n,"name").configurable);return RE={EXISTS:r,PROPER:o,CONFIGURABLE:a},RE}var EE,mk;function r6(){if(mk)return EE;mk=1;var t=Yn(),e=si(),n=UO(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(r){return i(r)}),EE=n.inspectSource,EE}var TE,pk;function o6(){if(pk)return TE;pk=1;var t=ri(),e=si(),n=t.WeakMap;return TE=e(n)&&/native code/.test(String(n)),TE}var _E,vk;function YO(){if(vk)return _E;vk=1;var t=I2(),e=P2(),n=t("keys");return _E=function(i){return n[i]||(n[i]=e(i))},_E}var ME,wk;function GO(){return wk||(wk=1,ME={}),ME}var OE,yk;function V2(){if(yk)return OE;yk=1;var t=o6(),e=ri(),n=Ho(),i=wf(),r=Io(),o=UO(),a=YO(),u=GO(),h="Object already initialized",d=e.TypeError,g=e.WeakMap,p,w,y,b=function(_){return y(_)?w(_):p(_,{})},T=function(_){return function(N){var k;if(!n(N)||(k=w(N)).type!==_)throw new d("Incompatible receiver, "+_+" required");return k}};if(t||o.state){var M=o.state||(o.state=new g);M.get=M.get,M.has=M.has,M.set=M.set,p=function(_,N){if(M.has(_))throw new d(h);return N.facade=_,M.set(_,N),N},w=function(_){return M.get(_)||{}},y=function(_){return M.has(_)}}else{var I=a("state");u[I]=!0,p=function(_,N){if(r(_,I))throw new d(h);return N.facade=_,i(_,I,N),N},w=function(_){return r(_,I)?_[I]:{}},y=function(_){return r(_,I)}}return OE={set:p,get:w,has:y,enforce:b,getterFor:T},OE}var Ck;function $2(){if(Ck)return SE.exports;Ck=1;var t=Yn(),e=Ri(),n=si(),i=Io(),r=Ao(),o=i6().CONFIGURABLE,a=r6(),u=V2(),h=u.enforce,d=u.get,g=String,p=Object.defineProperty,w=t("".slice),y=t("".replace),b=t([].join),T=r&&!e(function(){return p(function(){},"length",{value:8}).length!==8}),M=String(String).split("String"),I=SE.exports=function(_,N,k){w(g(N),0,7)==="Symbol("&&(N="["+y(g(N),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),k&&k.getter&&(N="get "+N),k&&k.setter&&(N="set "+N),(!i(_,"name")||o&&_.name!==N)&&(r?p(_,"name",{value:N,configurable:!0}):_.name=N),T&&k&&i(k,"arity")&&_.length!==k.arity&&p(_,"length",{value:k.arity});try{k&&i(k,"constructor")&&k.constructor?r&&p(_,"prototype",{writable:!1}):_.prototype&&(_.prototype=void 0)}catch{}var $=h(_);return i($,"source")||($.source=b(M,typeof N=="string"?N:"")),_};return Function.prototype.toString=I(function(){return n(this)&&d(this).source||a(this)},"toString"),SE.exports}var xE,bk;function qO(){if(bk)return xE;bk=1;var t=si(),e=xu(),n=$2(),i=jO();return xE=function(r,o,a,u){u||(u={});var h=u.enumerable,d=u.name!==void 0?u.name:o;if(t(a)&&n(a,d,u),u.global)h?r[o]=a:i(o,a);else{try{u.unsafe?r[o]&&(h=!0):delete r[o]}catch{}h?r[o]=a:e.f(r,o,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return r},xE}var AE={},HE,Sk;function s6(){if(Sk)return HE;Sk=1;var t=Math.ceil,e=Math.floor;return HE=Math.trunc||function(i){var r=+i;return(r>0?e:t)(r)},HE}var IE,Rk;function kp(){if(Rk)return IE;Rk=1;var t=s6();return IE=function(e){var n=+e;return n!==n||n===0?0:t(n)},IE}var PE,Ek;function a6(){if(Ek)return PE;Ek=1;var t=kp(),e=Math.max,n=Math.min;return PE=function(i,r){var o=t(i);return o<0?e(o+r,0):n(o,r)},PE}var NE,Tk;function l6(){if(Tk)return NE;Tk=1;var t=kp(),e=Math.min;return NE=function(n){var i=t(n);return i>0?e(i,9007199254740991):0},NE}var DE,_k;function yf(){if(_k)return DE;_k=1;var t=l6();return DE=function(e){return t(e.length)},DE}var LE,Mk;function u6(){if(Mk)return LE;Mk=1;var t=Np(),e=a6(),n=yf(),i=function(r){return function(o,a,u){var h=t(o),d=n(h);if(d===0)return!r&&-1;var g=e(u,d),p;if(r&&a!==a){for(;d>g;)if(p=h[g++],p!==p)return!0}else for(;d>g;g++)if((r||g in h)&&h[g]===a)return r||g||0;return!r&&-1}};return LE={includes:i(!0),indexOf:i(!1)},LE}var kE,Ok;function B2(){if(Ok)return kE;Ok=1;var t=Yn(),e=Io(),n=Np(),i=u6().indexOf,r=GO(),o=t([].push);return kE=function(a,u){var h=n(a),d=0,g=[],p;for(p in h)!e(r,p)&&e(h,p)&&o(g,p);for(;u.length>d;)e(h,p=u[d++])&&(~i(g,p)||o(g,p));return g},kE}var VE,xk;function KO(){return xk||(xk=1,VE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),VE}var Ak;function c6(){if(Ak)return AE;Ak=1;var t=B2(),e=KO(),n=e.concat("length","prototype");return AE.f=Object.getOwnPropertyNames||function(r){return t(r,n)},AE}var $E={},Hk;function h6(){return Hk||(Hk=1,$E.f=Object.getOwnPropertySymbols),$E}var BE,Ik;function d6(){if(Ik)return BE;Ik=1;var t=pf(),e=Yn(),n=c6(),i=h6(),r=ai(),o=e([].concat);return BE=t("Reflect","ownKeys")||function(u){var h=n.f(r(u)),d=i.f;return d?o(h,d(u)):h},BE}var FE,Pk;function F2(){if(Pk)return FE;Pk=1;var t=Io(),e=d6(),n=L2(),i=xu();return FE=function(r,o,a){for(var u=e(o),h=i.f,d=n.f,g=0;g<u.length;g++){var p=u[g];!t(r,p)&&!(a&&t(a,p))&&h(r,p,d(o,p))}},FE}var WE,Nk;function f6(){if(Nk)return WE;Nk=1;var t=Ri(),e=si(),n=/#|\.prototype\./,i=function(h,d){var g=o[r(h)];return g===u?!0:g===a?!1:e(d)?t(d):!!d},r=i.normalize=function(h){return String(h).replace(n,".").toLowerCase()},o=i.data={},a=i.NATIVE="N",u=i.POLYFILL="P";return WE=i,WE}var jE,Dk;function rn(){if(Dk)return jE;Dk=1;var t=ri(),e=L2().f,n=wf(),i=qO(),r=jO(),o=F2(),a=f6();return jE=function(u,h){var d=u.target,g=u.global,p=u.stat,w,y,b,T,M,I;if(g?y=t:p?y=t[d]||r(d,{}):y=t[d]&&t[d].prototype,y)for(b in h){if(M=h[b],u.dontCallGetSet?(I=e(y,b),T=I&&I.value):T=y[b],w=a(g?b:d+(p?".":"#")+b,u.forced),!w&&T!==void 0){if(typeof M==typeof T)continue;o(M,T)}(u.sham||T&&T.sham)&&n(M,"sham",!0),i(y,b,M,u)}},jE}var UE,Lk;function Vp(){if(Lk)return UE;Lk=1;var t=Eb(),e=Function.prototype,n=e.apply,i=e.call;return UE=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(n):function(){return i.apply(n,arguments)}),UE}var zE,kk;function W2(){if(kk)return zE;kk=1;var t=Yn(),e=Or();return zE=function(n,i,r){try{return t(e(Object.getOwnPropertyDescriptor(n,i)[r]))}catch{}},zE}var YE,Vk;function g6(){if(Vk)return YE;Vk=1;var t=Ho();return YE=function(e){return t(e)||e===null},YE}var GE,$k;function m6(){if($k)return GE;$k=1;var t=g6(),e=String,n=TypeError;return GE=function(i){if(t(i))return i;throw new n("Can't set "+e(i)+" as a prototype")},GE}var qE,Bk;function j2(){if(Bk)return qE;Bk=1;var t=W2(),e=Ho(),n=Pp(),i=m6();return qE=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,o={},a;try{a=t(Object.prototype,"__proto__","set"),a(o,[]),r=o instanceof Array}catch{}return function(h,d){return n(h),i(d),e(h)&&(r?a(h,d):h.__proto__=d),h}}():void 0),qE}var KE,Fk;function p6(){if(Fk)return KE;Fk=1;var t=xu().f;return KE=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},KE}var XE,Wk;function v6(){if(Wk)return XE;Wk=1;var t=si(),e=Ho(),n=j2();return XE=function(i,r,o){var a,u;return n&&t(a=r.constructor)&&a!==o&&e(u=a.prototype)&&u!==o.prototype&&n(i,u),i},XE}var ZE,jk;function w6(){if(jk)return ZE;jk=1;var t=gs(),e=t("toStringTag"),n={};return n[e]="z",ZE=String(n)==="[object z]",ZE}var QE,Uk;function U2(){if(Uk)return QE;Uk=1;var t=w6(),e=si(),n=ah(),i=gs(),r=i("toStringTag"),o=Object,a=n(function(){return arguments}())==="Arguments",u=function(h,d){try{return h[d]}catch{}};return QE=t?n:function(h){var d,g,p;return h===void 0?"Undefined":h===null?"Null":typeof(g=u(d=o(h),r))=="string"?g:a?n(d):(p=n(d))==="Object"&&e(d.callee)?"Arguments":p},QE}var JE,zk;function Ob(){if(zk)return JE;zk=1;var t=U2(),e=String;return JE=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},JE}var eT,Yk;function y6(){if(Yk)return eT;Yk=1;var t=Ob();return eT=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},eT}var tT,Gk;function C6(){if(Gk)return tT;Gk=1;var t=Ho(),e=wf();return tT=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},tT}var nT,qk;function b6(){if(qk)return nT;qk=1;var t=Yn(),e=Error,n=t("".replace),i=function(a){return String(new e(a).stack)}("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,o=r.test(i);return nT=function(a,u){if(o&&typeof a=="string"&&!e.prepareStackTrace)for(;u--;)a=n(a,r,"");return a},nT}var iT,Kk;function S6(){if(Kk)return iT;Kk=1;var t=Ri(),e=Tb();return iT=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),iT}var rT,Xk;function R6(){if(Xk)return rT;Xk=1;var t=wf(),e=b6(),n=S6(),i=Error.captureStackTrace;return rT=function(r,o,a,u){n&&(i?i(r,o):t(r,"stack",e(a,u)))},rT}var oT,Zk;function E6(){if(Zk)return oT;Zk=1;var t=pf(),e=Io(),n=wf(),i=Dp(),r=j2(),o=F2(),a=p6(),u=v6(),h=y6(),d=C6(),g=R6(),p=Ao(),w=Ou();return oT=function(y,b,T,M){var I="stackTraceLimit",_=M?2:1,N=y.split("."),k=N[N.length-1],$=t.apply(null,N);if($){var L=$.prototype;if(!w&&e(L,"cause")&&delete L.cause,!T)return $;var F=t("Error"),he=b(function(le,G){var ye=h(M?G:le,void 0),we=M?new $(le):new $;return ye!==void 0&&n(we,"message",ye),g(we,he,we.stack,2),this&&i(L,this)&&u(we,this,he),arguments.length>_&&d(we,arguments[_]),we});if(he.prototype=L,k!=="Error"?r?r(he,F):o(he,F,{name:!0}):p&&I in $&&(a(he,$,I),a(he,$,"prepareStackTrace")),o(he,$),!w)try{L.name!==k&&n(L,"name",k),L.constructor=he}catch{}return he}},oT}var Qk;function T6(){if(Qk)return EL;Qk=1;var t=rn(),e=ri(),n=Vp(),i=E6(),r="WebAssembly",o=e[r],a=new Error("e",{cause:7}).cause!==7,u=function(d,g){var p={};p[d]=i(d,g,a),t({global:!0,constructor:!0,arity:1,forced:a},p)},h=function(d,g){if(o&&o[d]){var p={};p[d]=i(r+"."+d,g,a),t({target:r,stat:!0,constructor:!0,arity:1,forced:a},p)}};return u("Error",function(d){return function(p){return n(d,this,arguments)}}),u("EvalError",function(d){return function(p){return n(d,this,arguments)}}),u("RangeError",function(d){return function(p){return n(d,this,arguments)}}),u("ReferenceError",function(d){return function(p){return n(d,this,arguments)}}),u("SyntaxError",function(d){return function(p){return n(d,this,arguments)}}),u("TypeError",function(d){return function(p){return n(d,this,arguments)}}),u("URIError",function(d){return function(p){return n(d,this,arguments)}}),h("CompileError",function(d){return function(p){return n(d,this,arguments)}}),h("LinkError",function(d){return function(p){return n(d,this,arguments)}}),h("RuntimeError",function(d){return function(p){return n(d,this,arguments)}}),EL}T6();var Jk={},sT,eV;function z2(){if(eV)return sT;eV=1;var t=ah();return sT=Array.isArray||function(n){return t(n)==="Array"},sT}var aT,tV;function Y2(){if(tV)return aT;tV=1;var t=Ao(),e=z2(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return aT=r?function(o,a){if(e(o)&&!i(o,"length").writable)throw new n("Cannot set read only .length");return o.length=a}:function(o,a){return o.length=a},aT}var lT,nV;function G2(){if(nV)return lT;nV=1;var t=TypeError,e=9007199254740991;return lT=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},lT}var iV;function _6(){if(iV)return Jk;iV=1;var t=rn(),e=vf(),n=yf(),i=Y2(),r=G2(),o=Ri(),a=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{push:function(g){var p=e(this),w=n(p),y=arguments.length;r(w+y);for(var b=0;b<y;b++)p[w]=arguments[b],w++;return i(p,w),w}}),Jk}_6();var rV={},uT,oV;function M6(){if(oV)return uT;oV=1;var t=ah(),e=Yn();return uT=function(n){if(t(n)==="Function")return e(n)},uT}var cT,sV;function q2(){if(sV)return cT;sV=1;var t=M6(),e=Or(),n=Eb(),i=t(t.bind);return cT=function(r,o){return e(r),o===void 0?r:n?i(r,o):function(){return r.apply(o,arguments)}},cT}var hT,aV;function K2(){return aV||(aV=1,hT={}),hT}var dT,lV;function O6(){if(lV)return dT;lV=1;var t=gs(),e=K2(),n=t("iterator"),i=Array.prototype;return dT=function(r){return r!==void 0&&(e.Array===r||i[n]===r)},dT}var fT,uV;function XO(){if(uV)return fT;uV=1;var t=U2(),e=Lp(),n=BO(),i=K2(),r=gs(),o=r("iterator");return fT=function(a){if(!n(a))return e(a,o)||e(a,"@@iterator")||i[t(a)]},fT}var gT,cV;function x6(){if(cV)return gT;cV=1;var t=oi(),e=Or(),n=ai(),i=Mb(),r=XO(),o=TypeError;return gT=function(a,u){var h=arguments.length<2?r(a):u;if(e(h))return n(t(h,a));throw new o(i(a)+" is not iterable")},gT}var mT,hV;function eo(){if(hV)return mT;hV=1;var t=oi(),e=ai(),n=Lp();return mT=function(i,r,o){var a,u;e(i);try{if(a=n(i,"return"),!a){if(r==="throw")throw o;return o}a=t(a,i)}catch(h){u=!0,a=h}if(r==="throw")throw o;if(u)throw a;return e(a),o},mT}var pT,dV;function Cf(){if(dV)return pT;dV=1;var t=q2(),e=oi(),n=ai(),i=Mb(),r=O6(),o=yf(),a=Dp(),u=x6(),h=XO(),d=eo(),g=TypeError,p=function(y,b){this.stopped=y,this.result=b},w=p.prototype;return pT=function(y,b,T){var M=T&&T.that,I=!!(T&&T.AS_ENTRIES),_=!!(T&&T.IS_RECORD),N=!!(T&&T.IS_ITERATOR),k=!!(T&&T.INTERRUPTED),$=t(b,M),L,F,he,le,G,ye,we,Me=function(_e){return L&&d(L,"normal",_e),new p(!0,_e)},Ee=function(_e){return I?(n(_e),k?$(_e[0],_e[1],Me):$(_e[0],_e[1])):k?$(_e,Me):$(_e)};if(_)L=y.iterator;else if(N)L=y;else{if(F=h(y),!F)throw new g(i(y)+" is not iterable");if(r(F)){for(he=0,le=o(y);le>he;he++)if(G=Ee(y[he]),G&&a(w,G))return G;return new p(!1)}L=u(y,F)}for(ye=_?y.next:L.next;!(we=e(ye,L)).done;){try{G=Ee(we.value)}catch(_e){d(L,"throw",_e)}if(typeof G=="object"&&G&&a(w,G))return G}return new p(!1)},pT}var vT,fV;function X2(){if(fV)return vT;fV=1;var t=Ao(),e=xu(),n=Tb();return vT=function(i,r,o){t?e.f(i,r,n(0,o)):i[r]=o},vT}var gV;function A6(){if(gV)return rV;gV=1;var t=rn(),e=Cf(),n=X2();return t({target:"Object",stat:!0},{fromEntries:function(r){var o={};return e(r,function(a,u){n(o,a,u)},{AS_ENTRIES:!0}),o}}),rV}A6();var mV={},wT,pV;function oa(){if(pV)return wT;pV=1;var t=Yn(),e=Set.prototype;return wT={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},wT}var yT,vV;function lh(){if(vV)return yT;vV=1;var t=oa().has;return yT=function(e){return t(e),e},yT}var CT,wV;function uh(){if(wV)return CT;wV=1;var t=oi();return CT=function(e,n,i){for(var r=i?e:e.iterator,o=e.next,a,u;!(a=t(o,r)).done;)if(u=n(a.value),u!==void 0)return u},CT}var bT,yV;function $p(){if(yV)return bT;yV=1;var t=Yn(),e=uh(),n=oa(),i=n.Set,r=n.proto,o=t(r.forEach),a=t(r.keys),u=a(new i).next;return bT=function(h,d,g){return g?e({iterator:a(h),next:u},d):o(h,d)},bT}var ST,CV;function ZO(){if(CV)return ST;CV=1;var t=oa(),e=$p(),n=t.Set,i=t.add;return ST=function(r){var o=new n;return e(r,function(a){i(o,a)}),o},ST}var RT,bV;function Bp(){if(bV)return RT;bV=1;var t=W2(),e=oa();return RT=t(e.proto,"size","get")||function(n){return n.size},RT}var ET,SV;function sa(){return SV||(SV=1,ET=function(t){return{iterator:t,next:t.next,done:!1}}),ET}var TT,RV;function ch(){if(RV)return TT;RV=1;var t=Or(),e=ai(),n=oi(),i=kp(),r=sa(),o="Invalid size",a=RangeError,u=TypeError,h=Math.max,d=function(g,p){this.set=g,this.size=h(p,0),this.has=t(g.has),this.keys=t(g.keys)};return d.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(g){return n(this.has,this.set,g)}},TT=function(g){e(g);var p=+g.size;if(p!==p)throw new u(o);var w=i(p);if(w<0)throw new a(o);return new d(g,w)},TT}var _T,EV;function H6(){if(EV)return _T;EV=1;var t=lh(),e=oa(),n=ZO(),i=Bp(),r=ch(),o=$p(),a=uh(),u=e.has,h=e.remove;return _T=function(g){var p=t(this),w=r(g),y=n(p);return i(p)<=w.size?o(p,function(b){w.includes(b)&&h(y,b)}):a(w.getIterator(),function(b){u(p,b)&&h(y,b)}),y},_T}var MT,TV;function hh(){if(TV)return MT;TV=1;var t=pf(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return MT=function(i,r){var o=t("Set");try{new o()[i](e(0));try{return new o()[i](e(-1)),!1}catch{if(!r)return!0;try{return new o()[i](n(-1/0)),!1}catch{var a=new o;return a.add(1),a.add(2),r(a[i](n(1/0)))}}}catch{return!1}},MT}var _V;function I6(){if(_V)return mV;_V=1;var t=rn(),e=H6(),n=hh(),i=!n("difference",function(r){return r.size===0});return t({target:"Set",proto:!0,real:!0,forced:i},{difference:e}),mV}I6();var MV={},OT,OV;function P6(){if(OV)return OT;OV=1;var t=lh(),e=oa(),n=Bp(),i=ch(),r=$p(),o=uh(),a=e.Set,u=e.add,h=e.has;return OT=function(g){var p=t(this),w=i(g),y=new a;return n(p)>w.size?o(w.getIterator(),function(b){h(p,b)&&u(y,b)}):r(p,function(b){w.includes(b)&&u(y,b)}),y},OT}var xV;function N6(){if(xV)return MV;xV=1;var t=rn(),e=Ri(),n=P6(),i=hh(),r=!i("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),MV}N6();var AV={},xT,HV;function D6(){if(HV)return xT;HV=1;var t=lh(),e=oa().has,n=Bp(),i=ch(),r=$p(),o=uh(),a=eo();return xT=function(h){var d=t(this),g=i(h);if(n(d)<=g.size)return r(d,function(w){if(g.includes(w))return!1},!0)!==!1;var p=g.getIterator();return o(p,function(w){if(e(d,w))return a(p,"normal",!1)})!==!1},xT}var IV;function L6(){if(IV)return AV;IV=1;var t=rn(),e=D6(),n=hh(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),AV}L6();var PV={},AT,NV;function k6(){if(NV)return AT;NV=1;var t=lh(),e=Bp(),n=$p(),i=ch();return AT=function(o){var a=t(this),u=i(o);return e(a)>u.size?!1:n(a,function(h){if(!u.includes(h))return!1},!0)!==!1},AT}var DV;function V6(){if(DV)return PV;DV=1;var t=rn(),e=k6(),n=hh(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),PV}V6();var LV={},HT,kV;function $6(){if(kV)return HT;kV=1;var t=lh(),e=oa().has,n=Bp(),i=ch(),r=uh(),o=eo();return HT=function(u){var h=t(this),d=i(u);if(n(h)<d.size)return!1;var g=d.getIterator();return r(g,function(p){if(!e(h,p))return o(g,"normal",!1)})!==!1},HT}var VV;function B6(){if(VV)return LV;VV=1;var t=rn(),e=$6(),n=hh(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),LV}B6();var $V={},IT,BV;function F6(){if(BV)return IT;BV=1;var t=lh(),e=oa(),n=ZO(),i=ch(),r=uh(),o=e.add,a=e.has,u=e.remove;return IT=function(d){var g=t(this),p=i(d).getIterator(),w=n(g);return r(p,function(y){a(g,y)?u(w,y):o(w,y)}),w},IT}var FV;function W6(){if(FV)return $V;FV=1;var t=rn(),e=F6(),n=hh();return t({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:e}),$V}W6();var WV={},PT,jV;function j6(){if(jV)return PT;jV=1;var t=lh(),e=oa().add,n=ZO(),i=ch(),r=uh();return PT=function(a){var u=t(this),h=i(a).getIterator(),d=n(u);return r(h,function(g){e(d,g)}),d},PT}var UV;function U6(){if(UV)return WV;UV=1;var t=rn(),e=j6(),n=hh();return t({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:e}),WV}U6();var zV={},YV={},NT,GV;function z6(){if(GV)return NT;GV=1;var t=Dp(),e=TypeError;return NT=function(n,i){if(t(i,n))return n;throw new e("Incorrect invocation")},NT}var DT,qV;function Y6(){if(qV)return DT;qV=1;var t=Ri();return DT=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),DT}var LT,KV;function Z2(){if(KV)return LT;KV=1;var t=Io(),e=si(),n=vf(),i=YO(),r=Y6(),o=i("IE_PROTO"),a=Object,u=a.prototype;return LT=r?a.getPrototypeOf:function(h){var d=n(h);if(t(d,o))return d[o];var g=d.constructor;return e(g)&&d instanceof g?g.prototype:d instanceof a?u:null},LT}var kT,XV;function G6(){if(XV)return kT;XV=1;var t=$2(),e=xu();return kT=function(n,i,r){return r.get&&t(r.get,i,{getter:!0}),r.set&&t(r.set,i,{setter:!0}),e.f(n,i,r)},kT}var VT={},$T,ZV;function q6(){if(ZV)return $T;ZV=1;var t=B2(),e=KO();return $T=Object.keys||function(i){return t(i,e)},$T}var QV;function K6(){if(QV)return VT;QV=1;var t=Ao(),e=k2(),n=xu(),i=ai(),r=Np(),o=q6();return VT.f=t&&!e?Object.defineProperties:function(u,h){i(u);for(var d=r(h),g=o(h),p=g.length,w=0,y;p>w;)n.f(u,y=g[w++],d[y]);return u},VT}var BT,JV;function Q2(){if(JV)return BT;JV=1;var t=pf();return BT=t("document","documentElement"),BT}var FT,e$;function QO(){if(e$)return FT;e$=1;var t=ai(),e=K6(),n=KO(),i=GO(),r=Q2(),o=zO(),a=YO(),u=">",h="<",d="prototype",g="script",p=a("IE_PROTO"),w=function(){},y=function(_){return h+g+u+_+h+"/"+g+u},b=function(_){_.write(y("")),_.close();var N=_.parentWindow.Object;return _=null,N},T=function(){var _=o("iframe"),N="java"+g+":",k;return _.style.display="none",r.appendChild(_),_.src=String(N),k=_.contentWindow.document,k.open(),k.write(y("document.F=Object")),k.close(),k.F},M,I=function(){try{M=new ActiveXObject("htmlfile")}catch{}I=typeof document<"u"?document.domain&&M?b(M):T():b(M);for(var _=n.length;_--;)delete I[d][n[_]];return I()};return i[p]=!0,FT=Object.create||function(N,k){var $;return N!==null?(w[d]=t(N),$=new w,w[d]=null,$[p]=N):$=I(),k===void 0?$:e.f($,k)},FT}var WT,t$;function J2(){if(t$)return WT;t$=1;var t=Ri(),e=si(),n=Ho(),i=QO(),r=Z2(),o=qO(),a=gs(),u=Ou(),h=a("iterator"),d=!1,g,p,w;[].keys&&(w=[].keys(),"next"in w?(p=r(r(w)),p!==Object.prototype&&(g=p)):d=!0);var y=!n(g)||t(function(){var b={};return g[h].call(b)!==b});return y?g={}:u&&(g=i(g)),e(g[h])||o(g,h,function(){return this}),WT={IteratorPrototype:g,BUGGY_SAFARI_ITERATORS:d},WT}var n$;function X6(){if(n$)return YV;n$=1;var t=rn(),e=ri(),n=z6(),i=ai(),r=si(),o=Z2(),a=G6(),u=X2(),h=Ri(),d=Io(),g=gs(),p=J2().IteratorPrototype,w=Ao(),y=Ou(),b="constructor",T="Iterator",M=g("toStringTag"),I=TypeError,_=e[T],N=y||!r(_)||_.prototype!==p||!h(function(){_({})}),k=function(){if(n(this,p),o(this)===p)throw new I("Abstract class Iterator not directly constructable")},$=function(L,F){w?a(p,L,{configurable:!0,get:function(){return F},set:function(he){if(i(this),this===p)throw new I("You can't redefine this property");d(this,L)?this[L]=he:u(this,L,he)}}):p[L]=F};return d(p,M)||$(M,T),(N||!d(p,b)||p[b]===Object)&&$(b,k),k.prototype=p,t({global:!0,constructor:!0,forced:N},{Iterator:k}),YV}var i$;function Z6(){return i$||(i$=1,X6()),zV}Z6();var r$={},o$={},jT,s$;function Q6(){if(s$)return jT;s$=1;var t=qO();return jT=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},jT}var UT,a$;function J6(){return a$||(a$=1,UT=function(t,e){return{value:t,done:e}}),UT}var zT,l$;function JO(){if(l$)return zT;l$=1;var t=oi(),e=QO(),n=wf(),i=Q6(),r=gs(),o=V2(),a=Lp(),u=J2().IteratorPrototype,h=J6(),d=eo(),g=r("toStringTag"),p="IteratorHelper",w="WrapForValidIterator",y=o.set,b=function(I){var _=o.getterFor(I?w:p);return i(e(u),{next:function(){var k=_(this);if(I)return k.nextHandler();if(k.done)return h(void 0,!0);try{var $=k.nextHandler();return k.returnHandlerResult?$:h($,k.done)}catch(L){throw k.done=!0,L}},return:function(){var N=_(this),k=N.iterator;if(N.done=!0,I){var $=a(k,"return");return $?t($,k):h(void 0,!0)}if(N.inner)try{d(N.inner.iterator,"normal")}catch(L){return d(k,"throw",L)}return k&&d(k,"normal"),h(void 0,!0)}})},T=b(!0),M=b(!1);return n(M,g,"Iterator Helper"),zT=function(I,_,N){var k=function(L,F){F?(F.iterator=L.iterator,F.next=L.next):F=L,F.type=_?w:p,F.returnHandlerResult=!!N,F.nextHandler=I,F.counter=0,F.done=!1,y(this,F)};return k.prototype=_?T:M,k},zT}var YT,u$;function eU(){if(u$)return YT;u$=1;var t=ai(),e=eo();return YT=function(n,i,r,o){try{return o?i(t(r)[0],r[1]):i(r)}catch(a){e(n,"throw",a)}},YT}var GT,c$;function Au(){if(c$)return GT;c$=1;var t=ri();return GT=function(e,n){var i=t.Iterator,r=i&&i.prototype,o=r&&r[e],a=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(u){u instanceof n||(a=!1)}if(!a)return o},GT}var h$;function e8(){if(h$)return o$;h$=1;var t=rn(),e=oi(),n=Or(),i=ai(),r=sa(),o=JO(),a=eU(),u=Ou(),h=eo(),d=Au(),g=!u&&d("filter",TypeError),p=o(function(){for(var w=this.iterator,y=this.predicate,b=this.next,T,M,I;;){if(T=i(e(b,w)),M=this.done=!!T.done,M)return;if(I=T.value,a(w,y,[I,this.counter++],!0))return I}});return t({target:"Iterator",proto:!0,real:!0,forced:u||g},{filter:function(y){i(this);try{n(y)}catch(b){h(this,"throw",b)}return g?e(g,this,y):new p(r(this),{predicate:y})}}),o$}var d$;function t8(){return d$||(d$=1,e8()),r$}t8();var f$={},g$={},m$;function n8(){if(m$)return g$;m$=1;var t=rn(),e=oi(),n=Cf(),i=Or(),r=ai(),o=sa(),a=eo(),u=Au(),h=u("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{forEach:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var p=o(this),w=0;n(p,function(y){g(y,w++)},{IS_RECORD:!0})}}),g$}var p$;function i8(){return p$||(p$=1,n8()),f$}i8();var v$={},w$={},y$;function r8(){if(y$)return w$;y$=1;var t=rn(),e=oi(),n=Or(),i=ai(),r=sa(),o=JO(),a=eU(),u=eo(),h=Au(),d=Ou(),g=!d&&h("map",TypeError),p=o(function(){var w=this.iterator,y=i(e(this.next,w)),b=this.done=!!y.done;if(!b)return a(w,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:d||g},{map:function(y){i(this);try{n(y)}catch(b){u(this,"throw",b)}return g?e(g,this,y):new p(r(this),{mapper:y})}}),w$}var C$;function o8(){return C$||(C$=1,r8()),v$}o8();var b$={},S$={},qT,R$;function ex(){if(R$)return qT;R$=1;var t=Yn();return qT=t([].slice),qT}var KT,E$;function tU(){if(E$)return KT;E$=1;var t=TypeError;return KT=function(e,n){if(e<n)throw new t("Not enough arguments");return e},KT}var XT,T$;function s8(){if(T$)return XT;T$=1;var t=_b();return XT=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),XT}var ZT,_$;function nU(){if(_$)return ZT;_$=1;var t=ri(),e=_b(),n=ah(),i=function(r){return e.slice(0,r.length)===r};return ZT=function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),ZT}var QT,M$;function a8(){if(M$)return QT;M$=1;var t=nU();return QT=t==="NODE",QT}var JT,O$;function iU(){if(O$)return JT;O$=1;var t=ri(),e=Vp(),n=q2(),i=si(),r=Io(),o=Ri(),a=Q2(),u=ex(),h=zO(),d=tU(),g=s8(),p=a8(),w=t.setImmediate,y=t.clearImmediate,b=t.process,T=t.Dispatch,M=t.Function,I=t.MessageChannel,_=t.String,N=0,k={},$="onreadystatechange",L,F,he,le;o(function(){L=t.location});var G=function(Ee){if(r(k,Ee)){var _e=k[Ee];delete k[Ee],_e()}},ye=function(Ee){return function(){G(Ee)}},we=function(Ee){G(Ee.data)},Me=function(Ee){t.postMessage(_(Ee),L.protocol+"//"+L.host)};return(!w||!y)&&(w=function(_e){d(arguments.length,1);var se=i(_e)?_e:M(_e),fe=u(arguments,1);return k[++N]=function(){e(se,void 0,fe)},F(N),N},y=function(_e){delete k[_e]},p?F=function(Ee){b.nextTick(ye(Ee))}:T&&T.now?F=function(Ee){T.now(ye(Ee))}:I&&!g?(he=new I,le=he.port2,he.port1.onmessage=we,F=n(le.postMessage,le)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&L&&L.protocol!=="file:"&&!o(Me)?(F=Me,t.addEventListener("message",we,!1)):$ in h("script")?F=function(Ee){a.appendChild(h("script"))[$]=function(){a.removeChild(this),G(Ee)}}:F=function(Ee){setTimeout(ye(Ee),0)}),JT={set:w,clear:y},JT}var x$;function l8(){if(x$)return S$;x$=1;var t=rn(),e=ri(),n=iU().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),S$}var A$={},e_,H$;function u8(){if(H$)return e_;H$=1;var t=ri(),e=Vp(),n=si(),i=nU(),r=_b(),o=ex(),a=tU(),u=t.Function,h=/MSIE .\./.test(r)||i==="BUN"&&function(){var d=t.Bun.version.split(".");return d.length<3||d[0]==="0"&&(d[1]<3||d[1]==="3"&&d[2]==="0")}();return e_=function(d,g){var p=g?2:1;return h?function(w,y){var b=a(arguments.length,1)>p,T=n(w)?w:u(w),M=b?o(arguments,p):[],I=b?function(){e(T,this,M)}:T;return g?d(I,y):d(I)}:d},e_}var I$;function c8(){if(I$)return A$;I$=1;var t=rn(),e=ri(),n=iU().set,i=u8(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),A$}var P$;function h8(){return P$||(P$=1,l8(),c8()),b$}h8();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:rU,setPrototypeOf:N$,isFrozen:d8,getPrototypeOf:f8,getOwnPropertyDescriptor:g8}=Object;let{freeze:tr,seal:xo,create:oU}=Object,{apply:k1,construct:V1}=typeof Reflect<"u"&&Reflect;tr||(tr=function(e){return e});xo||(xo=function(e){return e});k1||(k1=function(e,n,i){return e.apply(n,i)});V1||(V1=function(e,n){return new e(...n)});const Cw=nr(Array.prototype.forEach),m8=nr(Array.prototype.lastIndexOf),D$=nr(Array.prototype.pop),Ig=nr(Array.prototype.push),p8=nr(Array.prototype.splice),iC=nr(String.prototype.toLowerCase),t_=nr(String.prototype.toString),L$=nr(String.prototype.match),Pg=nr(String.prototype.replace),v8=nr(String.prototype.indexOf),w8=nr(String.prototype.trim),Qo=nr(Object.prototype.hasOwnProperty),zi=nr(RegExp.prototype.test),Ng=y8(TypeError);function nr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return k1(t,e,i)}}function y8(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return V1(t,n)}}function Ct(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:iC;N$&&N$(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const o=n(r);o!==r&&(d8(e)||(e[i]=o),r=o)}t[r]=!0}return t}function C8(t){for(let e=0;e<t.length;e++)Qo(t,e)||(t[e]=null);return t}function Wa(t){const e=oU(null);for(const[n,i]of rU(t))Qo(t,n)&&(Array.isArray(i)?e[n]=C8(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=Wa(i):e[n]=i);return e}function Dg(t,e){for(;t!==null;){const i=g8(t,e);if(i){if(i.get)return nr(i.get);if(typeof i.value=="function")return nr(i.value)}t=f8(t)}function n(){return null}return n}const k$=tr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),n_=tr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),i_=tr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),b8=tr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),r_=tr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),S8=tr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),V$=tr(["#text"]),$$=tr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),o_=tr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B$=tr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bw=tr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),R8=xo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),E8=xo(/<%[\w\W]*|[\w\W]*%>/gm),T8=xo(/\$\{[\w\W]*/gm),_8=xo(/^data-[\-\w.\u00B7-\uFFFF]+$/),M8=xo(/^aria-[\-\w]+$/),sU=xo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),O8=xo(/^(?:\w+script|data):/i),x8=xo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aU=xo(/^html$/i),A8=xo(/^[a-z][.\w]*(-[.\w]+)+$/i);var F$=Object.freeze({__proto__:null,ARIA_ATTR:M8,ATTR_WHITESPACE:x8,CUSTOM_ELEMENT:A8,DATA_ATTR:_8,DOCTYPE_NAME:aU,ERB_EXPR:E8,IS_ALLOWED_URI:sU,IS_SCRIPT_OR_DATA:O8,MUSTACHE_EXPR:R8,TMPLIT_EXPR:T8});const Lg={element:1,text:3,progressingInstruction:7,comment:8,document:9},H8=function(){return typeof window>"u"?null:window},I8=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},W$=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function lU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H8();const e=Fe=>lU(Fe);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Lg.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:u,Element:h,NodeFilter:d,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:w,trustedTypes:y}=t,b=h.prototype,T=Dg(b,"cloneNode"),M=Dg(b,"remove"),I=Dg(b,"nextSibling"),_=Dg(b,"childNodes"),N=Dg(b,"parentNode");if(typeof a=="function"){const Fe=n.createElement("template");Fe.content&&Fe.content.ownerDocument&&(n=Fe.content.ownerDocument)}let k,$="";const{implementation:L,createNodeIterator:F,createDocumentFragment:he,getElementsByTagName:le}=n,{importNode:G}=i;let ye=W$();e.isSupported=typeof rU=="function"&&typeof N=="function"&&L&&L.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:we,ERB_EXPR:Me,TMPLIT_EXPR:Ee,DATA_ATTR:_e,ARIA_ATTR:se,IS_SCRIPT_OR_DATA:fe,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:Ge}=F$;let{IS_ALLOWED_URI:B}=F$,ue=null;const C=Ct({},[...k$,...n_,...i_,...r_,...V$]);let S=null;const R=Ct({},[...$$,...o_,...B$,...bw]);let P=Object.seal(oU(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,J=null,ae=!0,ge=!0,O=!1,H=!0,A=!1,q=!0,j=!1,K=!1,ie=!1,W=!1,X=!1,te=!1,Z=!0,ce=!1;const He="user-content-";let Ie=!0,Qe=!1,st={},ot=null;const Be=Ct({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Je=null;const gt=Ct({},["audio","video","img","source","image","track"]);let Ar=null;const Lo=Ct({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),or="http://www.w3.org/1998/Math/MathML",Bt="http://www.w3.org/2000/svg",cn="http://www.w3.org/1999/xhtml";let Tt=cn,Ft=!1,it=null;const sr=Ct({},[or,Bt,cn],t_);let ws=Ct({},["mi","mo","mn","ms","mtext"]),ys=Ct({},["annotation-xml"]);const If=Ct({},["title","style","font","a","script"]);let ko=null;const SS=["application/xhtml+xml","text/html"],av="text/html";let Bn=null,Cs=null;const Pf=n.createElement("form"),Nf=function(Y){return Y instanceof RegExp||Y instanceof Function},Df=function(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Cs&&Cs===Y)){if((!Y||typeof Y!="object")&&(Y={}),Y=Wa(Y),ko=SS.indexOf(Y.PARSER_MEDIA_TYPE)===-1?av:Y.PARSER_MEDIA_TYPE,Bn=ko==="application/xhtml+xml"?t_:iC,ue=Qo(Y,"ALLOWED_TAGS")?Ct({},Y.ALLOWED_TAGS,Bn):C,S=Qo(Y,"ALLOWED_ATTR")?Ct({},Y.ALLOWED_ATTR,Bn):R,it=Qo(Y,"ALLOWED_NAMESPACES")?Ct({},Y.ALLOWED_NAMESPACES,t_):sr,Ar=Qo(Y,"ADD_URI_SAFE_ATTR")?Ct(Wa(Lo),Y.ADD_URI_SAFE_ATTR,Bn):Lo,Je=Qo(Y,"ADD_DATA_URI_TAGS")?Ct(Wa(gt),Y.ADD_DATA_URI_TAGS,Bn):gt,ot=Qo(Y,"FORBID_CONTENTS")?Ct({},Y.FORBID_CONTENTS,Bn):Be,V=Qo(Y,"FORBID_TAGS")?Ct({},Y.FORBID_TAGS,Bn):Wa({}),J=Qo(Y,"FORBID_ATTR")?Ct({},Y.FORBID_ATTR,Bn):Wa({}),st=Qo(Y,"USE_PROFILES")?Y.USE_PROFILES:!1,ae=Y.ALLOW_ARIA_ATTR!==!1,ge=Y.ALLOW_DATA_ATTR!==!1,O=Y.ALLOW_UNKNOWN_PROTOCOLS||!1,H=Y.ALLOW_SELF_CLOSE_IN_ATTR!==!1,A=Y.SAFE_FOR_TEMPLATES||!1,q=Y.SAFE_FOR_XML!==!1,j=Y.WHOLE_DOCUMENT||!1,W=Y.RETURN_DOM||!1,X=Y.RETURN_DOM_FRAGMENT||!1,te=Y.RETURN_TRUSTED_TYPE||!1,ie=Y.FORCE_BODY||!1,Z=Y.SANITIZE_DOM!==!1,ce=Y.SANITIZE_NAMED_PROPS||!1,Ie=Y.KEEP_CONTENT!==!1,Qe=Y.IN_PLACE||!1,B=Y.ALLOWED_URI_REGEXP||sU,Tt=Y.NAMESPACE||cn,ws=Y.MATHML_TEXT_INTEGRATION_POINTS||ws,ys=Y.HTML_INTEGRATION_POINTS||ys,P=Y.CUSTOM_ELEMENT_HANDLING||{},Y.CUSTOM_ELEMENT_HANDLING&&Nf(Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(P.tagNameCheck=Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&Nf(Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(P.attributeNameCheck=Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&typeof Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(P.allowCustomizedBuiltInElements=Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),A&&(ge=!1),X&&(W=!0),st&&(ue=Ct({},V$),S=[],st.html===!0&&(Ct(ue,k$),Ct(S,$$)),st.svg===!0&&(Ct(ue,n_),Ct(S,o_),Ct(S,bw)),st.svgFilters===!0&&(Ct(ue,i_),Ct(S,o_),Ct(S,bw)),st.mathMl===!0&&(Ct(ue,r_),Ct(S,B$),Ct(S,bw))),Y.ADD_TAGS&&(ue===C&&(ue=Wa(ue)),Ct(ue,Y.ADD_TAGS,Bn)),Y.ADD_ATTR&&(S===R&&(S=Wa(S)),Ct(S,Y.ADD_ATTR,Bn)),Y.ADD_URI_SAFE_ATTR&&Ct(Ar,Y.ADD_URI_SAFE_ATTR,Bn),Y.FORBID_CONTENTS&&(ot===Be&&(ot=Wa(ot)),Ct(ot,Y.FORBID_CONTENTS,Bn)),Ie&&(ue["#text"]=!0),j&&Ct(ue,["html","head","body"]),ue.table&&(Ct(ue,["tbody"]),delete V.tbody),Y.TRUSTED_TYPES_POLICY){if(typeof Y.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ng('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Y.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ng('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=Y.TRUSTED_TYPES_POLICY,$=k.createHTML("")}else k===void 0&&(k=I8(y,r)),k!==null&&typeof $=="string"&&($=k.createHTML(""));tr&&tr(Y),Cs=Y}},Vo=Ct({},[...n_,...i_,...b8]),li=Ct({},[...r_,...S8]),Hi=function(Y){let be=N(Y);(!be||!be.tagName)&&(be={namespaceURI:Tt,tagName:"template"});const Pe=iC(Y.tagName),on=iC(be.tagName);return it[Y.namespaceURI]?Y.namespaceURI===Bt?be.namespaceURI===cn?Pe==="svg":be.namespaceURI===or?Pe==="svg"&&(on==="annotation-xml"||ws[on]):!!Vo[Pe]:Y.namespaceURI===or?be.namespaceURI===cn?Pe==="math":be.namespaceURI===Bt?Pe==="math"&&ys[on]:!!li[Pe]:Y.namespaceURI===cn?be.namespaceURI===Bt&&!ys[on]||be.namespaceURI===or&&!ws[on]?!1:!li[Pe]&&(If[Pe]||!Vo[Pe]):!!(ko==="application/xhtml+xml"&&it[Y.namespaceURI]):!1},Ei=function(Y){Ig(e.removed,{element:Y});try{N(Y).removeChild(Y)}catch{M(Y)}},bs=function(Y,be){try{Ig(e.removed,{attribute:be.getAttributeNode(Y),from:be})}catch{Ig(e.removed,{attribute:null,from:be})}if(be.removeAttribute(Y),Y==="is")if(W||X)try{Ei(be)}catch{}else try{be.setAttribute(Y,"")}catch{}},lv=function(Y){let be=null,Pe=null;if(ie)Y="<remove></remove>"+Y;else{const An=L$(Y,/^[\r\n\t ]+/);Pe=An&&An[0]}ko==="application/xhtml+xml"&&Tt===cn&&(Y='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Y+"</body></html>");const on=k?k.createHTML(Y):Y;if(Tt===cn)try{be=new w().parseFromString(on,ko)}catch{}if(!be||!be.documentElement){be=L.createDocument(Tt,"template",null);try{be.documentElement.innerHTML=Ft?$:on}catch{}}const ui=be.body||be.documentElement;return Y&&Pe&&ui.insertBefore(n.createTextNode(Pe),ui.childNodes[0]||null),Tt===cn?le.call(be,j?"html":"body")[0]:j?be.documentElement:ui},uv=function(Y){return F.call(Y.ownerDocument||Y,Y,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},vh=function(Y){return Y instanceof p&&(typeof Y.nodeName!="string"||typeof Y.textContent!="string"||typeof Y.removeChild!="function"||!(Y.attributes instanceof g)||typeof Y.removeAttribute!="function"||typeof Y.setAttribute!="function"||typeof Y.namespaceURI!="string"||typeof Y.insertBefore!="function"||typeof Y.hasChildNodes!="function")},Cl=function(Y){return typeof u=="function"&&Y instanceof u};function Hr(Fe,Y,be){Cw(Fe,Pe=>{Pe.call(e,Y,be,Cs)})}const ca=function(Y){let be=null;if(Hr(ye.beforeSanitizeElements,Y,null),vh(Y))return Ei(Y),!0;const Pe=Bn(Y.nodeName);if(Hr(ye.uponSanitizeElement,Y,{tagName:Pe,allowedTags:ue}),q&&Y.hasChildNodes()&&!Cl(Y.firstElementChild)&&zi(/<[/\w!]/g,Y.innerHTML)&&zi(/<[/\w!]/g,Y.textContent)||Y.nodeType===Lg.progressingInstruction||q&&Y.nodeType===Lg.comment&&zi(/<[/\w]/g,Y.data))return Ei(Y),!0;if(!ue[Pe]||V[Pe]){if(!V[Pe]&&bl(Pe)&&(P.tagNameCheck instanceof RegExp&&zi(P.tagNameCheck,Pe)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Pe)))return!1;if(Ie&&!ot[Pe]){const on=N(Y)||Y.parentNode,ui=_(Y)||Y.childNodes;if(ui&&on){const An=ui.length;for(let Ii=An-1;Ii>=0;--Ii){const ar=T(ui[Ii],!0);ar.__removalCount=(Y.__removalCount||0)+1,on.insertBefore(ar,I(Y))}}}return Ei(Y),!0}return Y instanceof h&&!Hi(Y)||(Pe==="noscript"||Pe==="noembed"||Pe==="noframes")&&zi(/<\/no(script|embed|frames)/i,Y.innerHTML)?(Ei(Y),!0):(A&&Y.nodeType===Lg.text&&(be=Y.textContent,Cw([we,Me,Ee],on=>{be=Pg(be,on," ")}),Y.textContent!==be&&(Ig(e.removed,{element:Y.cloneNode()}),Y.textContent=be)),Hr(ye.afterSanitizeElements,Y,null),!1)},ha=function(Y,be,Pe){if(Z&&(be==="id"||be==="name")&&(Pe in n||Pe in Pf))return!1;if(!(ge&&!J[be]&&zi(_e,be))){if(!(ae&&zi(se,be))){if(!S[be]||J[be]){if(!(bl(Y)&&(P.tagNameCheck instanceof RegExp&&zi(P.tagNameCheck,Y)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Y))&&(P.attributeNameCheck instanceof RegExp&&zi(P.attributeNameCheck,be)||P.attributeNameCheck instanceof Function&&P.attributeNameCheck(be))||be==="is"&&P.allowCustomizedBuiltInElements&&(P.tagNameCheck instanceof RegExp&&zi(P.tagNameCheck,Pe)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Pe))))return!1}else if(!Ar[be]){if(!zi(B,Pg(Pe,Te,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&Y!=="script"&&v8(Pe,"data:")===0&&Je[Y])){if(!(O&&!zi(fe,Pg(Pe,Te,"")))){if(Pe)return!1}}}}}}return!0},bl=function(Y){return Y!=="annotation-xml"&&L$(Y,Ge)},da=function(Y){Hr(ye.beforeSanitizeAttributes,Y,null);const{attributes:be}=Y;if(!be||vh(Y))return;const Pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:S,forceKeepAttr:void 0};let on=be.length;for(;on--;){const ui=be[on],{name:An,namespaceURI:Ii,value:ar}=ui,Ss=Bn(An),Ir=ar;let Kn=An==="value"?Ir:w8(Ir);if(Pe.attrName=Ss,Pe.attrValue=Kn,Pe.keepAttr=!0,Pe.forceKeepAttr=void 0,Hr(ye.uponSanitizeAttribute,Y,Pe),Kn=Pe.attrValue,ce&&(Ss==="id"||Ss==="name")&&(bs(An,Y),Kn=He+Kn),q&&zi(/((--!?|])>)|<\/(style|title)/i,Kn)){bs(An,Y);continue}if(Pe.forceKeepAttr)continue;if(!Pe.keepAttr){bs(An,Y);continue}if(!H&&zi(/\/>/i,Kn)){bs(An,Y);continue}A&&Cw([we,Me,Ee],fa=>{Kn=Pg(Kn,fa," ")});const Lf=Bn(Y.nodeName);if(!ha(Lf,Ss,Kn)){bs(An,Y);continue}if(k&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Ii)switch(y.getAttributeType(Lf,Ss)){case"TrustedHTML":{Kn=k.createHTML(Kn);break}case"TrustedScriptURL":{Kn=k.createScriptURL(Kn);break}}if(Kn!==Ir)try{Ii?Y.setAttributeNS(Ii,An,Kn):Y.setAttribute(An,Kn),vh(Y)?Ei(Y):D$(e.removed)}catch{bs(An,Y)}}Hr(ye.afterSanitizeAttributes,Y,null)},qn=function Fe(Y){let be=null;const Pe=uv(Y);for(Hr(ye.beforeSanitizeShadowDOM,Y,null);be=Pe.nextNode();)Hr(ye.uponSanitizeShadowNode,be,null),ca(be),da(be),be.content instanceof o&&Fe(be.content);Hr(ye.afterSanitizeShadowDOM,Y,null)};return e.sanitize=function(Fe){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be=null,Pe=null,on=null,ui=null;if(Ft=!Fe,Ft&&(Fe="<!-->"),typeof Fe!="string"&&!Cl(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw Ng("dirty is not a string, aborting")}else throw Ng("toString is not a function");if(!e.isSupported)return Fe;if(K||Df(Y),e.removed=[],typeof Fe=="string"&&(Qe=!1),Qe){if(Fe.nodeName){const ar=Bn(Fe.nodeName);if(!ue[ar]||V[ar])throw Ng("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof u)be=lv("<!---->"),Pe=be.ownerDocument.importNode(Fe,!0),Pe.nodeType===Lg.element&&Pe.nodeName==="BODY"||Pe.nodeName==="HTML"?be=Pe:be.appendChild(Pe);else{if(!W&&!A&&!j&&Fe.indexOf("<")===-1)return k&&te?k.createHTML(Fe):Fe;if(be=lv(Fe),!be)return W?null:te?$:""}be&&ie&&Ei(be.firstChild);const An=uv(Qe?Fe:be);for(;on=An.nextNode();)ca(on),da(on),on.content instanceof o&&qn(on.content);if(Qe)return Fe;if(W){if(X)for(ui=he.call(be.ownerDocument);be.firstChild;)ui.appendChild(be.firstChild);else ui=be;return(S.shadowroot||S.shadowrootmode)&&(ui=G.call(i,ui,!0)),ui}let Ii=j?be.outerHTML:be.innerHTML;return j&&ue["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&zi(aU,be.ownerDocument.doctype.name)&&(Ii="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+Ii),A&&Cw([we,Me,Ee],ar=>{Ii=Pg(Ii,ar," ")}),k&&te?k.createHTML(Ii):Ii},e.setConfig=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Df(Fe),K=!0},e.clearConfig=function(){Cs=null,K=!1},e.isValidAttribute=function(Fe,Y,be){Cs||Df({});const Pe=Bn(Fe),on=Bn(Y);return ha(Pe,on,be)},e.addHook=function(Fe,Y){typeof Y=="function"&&Ig(ye[Fe],Y)},e.removeHook=function(Fe,Y){if(Y!==void 0){const be=m8(ye[Fe],Y);return be===-1?void 0:p8(ye[Fe],be,1)[0]}return D$(ye[Fe])},e.removeHooks=function(Fe){ye[Fe]=[]},e.removeAllHooks=function(){ye=W$()},e}var P8=lU();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var uU;function Ce(){return uU.apply(null,arguments)}function N8(t){uU=t}function cs(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function qc(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tx(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Dt(t,e))return!1;return!0}function br(t){return t===void 0}function cl(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Fp(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function cU(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function mu(t,e){for(var n in e)Dt(e,n)&&(t[n]=e[n]);return Dt(e,"toString")&&(t.toString=e.toString),Dt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function aa(t,e,n,i){return PU(t,e,n,i,!0).utc()}function D8(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ut(t){return t._pf==null&&(t._pf=D8()),t._pf}var $1;Array.prototype.some?$1=Array.prototype.some:$1=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function nx(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=ut(t),n=$1.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function xb(t){var e=aa(NaN);return t!=null?mu(ut(e),t):ut(e).userInvalidated=!0,e}var j$=Ce.momentProperties=[],s_=!1;function ix(t,e){var n,i,r,o=j$.length;if(br(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),br(e._i)||(t._i=e._i),br(e._f)||(t._f=e._f),br(e._l)||(t._l=e._l),br(e._strict)||(t._strict=e._strict),br(e._tzm)||(t._tzm=e._tzm),br(e._isUTC)||(t._isUTC=e._isUTC),br(e._offset)||(t._offset=e._offset),br(e._pf)||(t._pf=ut(e)),br(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=j$[n],r=e[i],br(r)||(t[i]=r);return t}function Wp(t){ix(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),s_===!1&&(s_=!0,Ce.updateOffset(this),s_=!1)}function hs(t){return t instanceof Wp||t!=null&&t._isAMomentObject!=null}function hU(t){Ce.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Po(t,e){var n=!0;return mu(function(){if(Ce.deprecationHandler!=null&&Ce.deprecationHandler(null,t),n){var i=[],r,o,a,u=arguments.length;for(o=0;o<u;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(a in arguments[0])Dt(arguments[0],a)&&(r+=a+": "+arguments[0][a]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}hU(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var U$={};function dU(t,e){Ce.deprecationHandler!=null&&Ce.deprecationHandler(t,e),U$[t]||(hU(e),U$[t]=!0)}Ce.suppressDeprecationWarnings=!1;Ce.deprecationHandler=null;function la(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function L8(t){var e,n;for(n in t)Dt(t,n)&&(e=t[n],la(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function B1(t,e){var n=mu({},t),i;for(i in e)Dt(e,i)&&(qc(t[i])&&qc(e[i])?(n[i]={},mu(n[i],t[i]),mu(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)Dt(t,i)&&!Dt(e,i)&&qc(t[i])&&(n[i]=mu({},n[i]));return n}function rx(t){t!=null&&this.set(t)}var F1;Object.keys?F1=Object.keys:F1=function(t){var e,n=[];for(e in t)Dt(t,e)&&n.push(e);return n};var k8={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function V8(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return la(i)?i.call(e,n):i}function ia(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var ox=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Sw=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,a_={},Zd={};function Ye(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Zd[t]=r),e&&(Zd[e[0]]=function(){return ia(r.apply(this,arguments),e[1],e[2])}),n&&(Zd[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function $8(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function B8(t){var e=t.match(ox),n,i;for(n=0,i=e.length;n<i;n++)Zd[e[n]]?e[n]=Zd[e[n]]:e[n]=$8(e[n]);return function(r){var o="",a;for(a=0;a<i;a++)o+=la(e[a])?e[a].call(r,t):e[a];return o}}function rC(t,e){return t.isValid()?(e=fU(e,t.localeData()),a_[e]=a_[e]||B8(e),a_[e](t)):t.localeData().invalidDate()}function fU(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(Sw.lastIndex=0;n>=0&&Sw.test(t);)t=t.replace(Sw,i),Sw.lastIndex=0,n-=1;return t}var F8={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function W8(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(ox).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var j8="Invalid date";function U8(){return this._invalidDate}var z8="%d",Y8=/\d{1,2}/;function G8(t){return this._ordinal.replace("%d",t)}var q8={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function K8(t,e,n,i){var r=this._relativeTime[n];return la(r)?r(t,e,n,i):r.replace(/%d/i,t)}function X8(t,e){var n=this._relativeTime[t>0?"future":"past"];return la(n)?n(e):n.replace(/%s/i,e)}var z$={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function No(t){return typeof t=="string"?z$[t]||z$[t.toLowerCase()]:void 0}function sx(t){var e={},n,i;for(i in t)Dt(t,i)&&(n=No(i),n&&(e[n]=t[i]));return e}var Z8={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Q8(t){var e=[],n;for(n in t)Dt(t,n)&&e.push({unit:n,priority:Z8[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var gU=/\d/,to=/\d\d/,mU=/\d{3}/,ax=/\d{4}/,Ab=/[+-]?\d{6}/,mn=/\d\d?/,pU=/\d\d\d\d?/,vU=/\d\d\d\d\d\d?/,Hb=/\d{1,3}/,lx=/\d{1,4}/,Ib=/[+-]?\d{1,6}/,bf=/\d+/,Pb=/[+-]?\d+/,J8=/Z|[+-]\d\d:?\d\d/gi,Nb=/Z|[+-]\d\d(?::?\d\d)?/gi,e9=/[+-]?\d+(\.\d{1,3})?/,jp=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Sf=/^[1-9]\d?/,ux=/^([1-9]\d|\d)/,MC;MC={};function De(t,e,n){MC[t]=la(e)?e:function(i,r){return i&&n?n:e}}function t9(t,e){return Dt(MC,t)?MC[t](e._strict,e._locale):new RegExp(n9(t))}function n9(t){return al(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function al(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function To(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Rt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=To(e)),n}var W1={};function en(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),cl(e)&&(i=function(o,a){a[e]=Rt(o)}),r=t.length,n=0;n<r;n++)W1[t[n]]=i}function Up(t,e){en(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function i9(t,e,n){e!=null&&Dt(W1,t)&&W1[t](e,n._a,n,t)}function Db(t){return t%4===0&&t%100!==0||t%400===0}var ji=0,Ja=1,Qs=2,mi=3,as=4,el=5,Wc=6,r9=7,o9=8;Ye("Y",0,0,function(){var t=this.year();return t<=9999?ia(t,4):"+"+t});Ye(0,["YY",2],0,function(){return this.year()%100});Ye(0,["YYYY",4],0,"year");Ye(0,["YYYYY",5],0,"year");Ye(0,["YYYYYY",6,!0],0,"year");De("Y",Pb);De("YY",mn,to);De("YYYY",lx,ax);De("YYYYY",Ib,Ab);De("YYYYYY",Ib,Ab);en(["YYYYY","YYYYYY"],ji);en("YYYY",function(t,e){e[ji]=t.length===2?Ce.parseTwoDigitYear(t):Rt(t)});en("YY",function(t,e){e[ji]=Ce.parseTwoDigitYear(t)});en("Y",function(t,e){e[ji]=parseInt(t,10)});function Wm(t){return Db(t)?366:365}Ce.parseTwoDigitYear=function(t){return Rt(t)+(Rt(t)>68?1900:2e3)};var wU=Rf("FullYear",!0);function s9(){return Db(this.year())}function Rf(t,e){return function(n){return n!=null?(yU(this,t,n),Ce.updateOffset(this,e),this):hp(this,t)}}function hp(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function yU(t,e,n){var i,r,o,a,u;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,a=t.month(),u=t.date(),u=u===29&&a===1&&!Db(o)?28:u,r?i.setUTCFullYear(o,a,u):i.setFullYear(o,a,u)}}function a9(t){return t=No(t),la(this[t])?this[t]():this}function l9(t,e){if(typeof t=="object"){t=sx(t);var n=Q8(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=No(t),la(this[t]))return this[t](e);return this}function u9(t,e){return(t%e+e)%e}var Un;Array.prototype.indexOf?Un=Array.prototype.indexOf:Un=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function cx(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=u9(e,12);return t+=(e-n)/12,n===1?Db(t)?29:28:31-n%7%2}Ye("M",["MM",2],"Mo",function(){return this.month()+1});Ye("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ye("MMMM",0,0,function(t){return this.localeData().months(this,t)});De("M",mn,Sf);De("MM",mn,to);De("MMM",function(t,e){return e.monthsShortRegex(t)});De("MMMM",function(t,e){return e.monthsRegex(t)});en(["M","MM"],function(t,e){e[Ja]=Rt(t)-1});en(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Ja]=r:ut(n).invalidMonth=t});var c9="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),CU="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bU=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,h9=jp,d9=jp;function f9(t,e){return t?cs(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||bU).test(e)?"format":"standalone"][t.month()]:cs(this._months)?this._months:this._months.standalone}function g9(t,e){return t?cs(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[bU.test(e)?"format":"standalone"][t.month()]:cs(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function m9(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=aa([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=Un.call(this._shortMonthsParse,a),r!==-1?r:null):(r=Un.call(this._longMonthsParse,a),r!==-1?r:null):e==="MMM"?(r=Un.call(this._shortMonthsParse,a),r!==-1?r:(r=Un.call(this._longMonthsParse,a),r!==-1?r:null)):(r=Un.call(this._longMonthsParse,a),r!==-1?r:(r=Un.call(this._shortMonthsParse,a),r!==-1?r:null))}function p9(t,e,n){var i,r,o;if(this._monthsParseExact)return m9.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=aa([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function SU(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Rt(e);else if(e=t.localeData().monthsParse(e),!cl(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,cx(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function RU(t){return t!=null?(SU(this,t),Ce.updateOffset(this,!0),this):hp(this,"Month")}function v9(){return cx(this.year(),this.month())}function w9(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||EU.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Dt(this,"_monthsShortRegex")||(this._monthsShortRegex=h9),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function y9(t){return this._monthsParseExact?(Dt(this,"_monthsRegex")||EU.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Dt(this,"_monthsRegex")||(this._monthsRegex=d9),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function EU(){function t(h,d){return d.length-h.length}var e=[],n=[],i=[],r,o,a,u;for(r=0;r<12;r++)o=aa([2e3,r]),a=al(this.monthsShort(o,"")),u=al(this.months(o,"")),e.push(a),n.push(u),i.push(u),i.push(a);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function C9(t,e,n,i,r,o,a){var u;return t<100&&t>=0?(u=new Date(t+400,e,n,i,r,o,a),isFinite(u.getFullYear())&&u.setFullYear(t)):u=new Date(t,e,n,i,r,o,a),u}function dp(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function OC(t,e,n){var i=7+e-n,r=(7+dp(t,0,i).getUTCDay()-e)%7;return-r+i-1}function TU(t,e,n,i,r){var o=(7+n-i)%7,a=OC(t,i,r),u=1+7*(e-1)+o+a,h,d;return u<=0?(h=t-1,d=Wm(h)+u):u>Wm(t)?(h=t+1,d=u-Wm(t)):(h=t,d=u),{year:h,dayOfYear:d}}function fp(t,e,n){var i=OC(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,a;return r<1?(a=t.year()-1,o=r+ll(a,e,n)):r>ll(t.year(),e,n)?(o=r-ll(t.year(),e,n),a=t.year()+1):(a=t.year(),o=r),{week:o,year:a}}function ll(t,e,n){var i=OC(t,e,n),r=OC(t+1,e,n);return(Wm(t)-i+r)/7}Ye("w",["ww",2],"wo","week");Ye("W",["WW",2],"Wo","isoWeek");De("w",mn,Sf);De("ww",mn,to);De("W",mn,Sf);De("WW",mn,to);Up(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Rt(t)});function b9(t){return fp(t,this._week.dow,this._week.doy).week}var S9={dow:0,doy:6};function R9(){return this._week.dow}function E9(){return this._week.doy}function T9(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function _9(t){var e=fp(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ye("d",0,"do","day");Ye("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ye("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ye("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ye("e",0,0,"weekday");Ye("E",0,0,"isoWeekday");De("d",mn);De("e",mn);De("E",mn);De("dd",function(t,e){return e.weekdaysMinRegex(t)});De("ddd",function(t,e){return e.weekdaysShortRegex(t)});De("dddd",function(t,e){return e.weekdaysRegex(t)});Up(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:ut(n).invalidWeekday=t});Up(["d","e","E"],function(t,e,n,i){e[i]=Rt(t)});function M9(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function O9(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function hx(t,e){return t.slice(e,7).concat(t.slice(0,e))}var x9="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),_U="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),A9="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),H9=jp,I9=jp,P9=jp;function N9(t,e){var n=cs(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?hx(n,this._week.dow):t?n[t.day()]:n}function D9(t){return t===!0?hx(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function L9(t){return t===!0?hx(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function k9(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=aa([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=Un.call(this._weekdaysParse,a),r!==-1?r:null):e==="ddd"?(r=Un.call(this._shortWeekdaysParse,a),r!==-1?r:null):(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null):e==="dddd"?(r=Un.call(this._weekdaysParse,a),r!==-1||(r=Un.call(this._shortWeekdaysParse,a),r!==-1)?r:(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null)):e==="ddd"?(r=Un.call(this._shortWeekdaysParse,a),r!==-1||(r=Un.call(this._weekdaysParse,a),r!==-1)?r:(r=Un.call(this._minWeekdaysParse,a),r!==-1?r:null)):(r=Un.call(this._minWeekdaysParse,a),r!==-1||(r=Un.call(this._weekdaysParse,a),r!==-1)?r:(r=Un.call(this._shortWeekdaysParse,a),r!==-1?r:null))}function V9(t,e,n){var i,r,o;if(this._weekdaysParseExact)return k9.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=aa([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function $9(t){if(!this.isValid())return t!=null?this:NaN;var e=hp(this,"Day");return t!=null?(t=M9(t,this.localeData()),this.add(t-e,"d")):e}function B9(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function F9(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=O9(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function W9(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||dx.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Dt(this,"_weekdaysRegex")||(this._weekdaysRegex=H9),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function j9(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||dx.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Dt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=I9),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function U9(t){return this._weekdaysParseExact?(Dt(this,"_weekdaysRegex")||dx.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Dt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=P9),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function dx(){function t(g,p){return p.length-g.length}var e=[],n=[],i=[],r=[],o,a,u,h,d;for(o=0;o<7;o++)a=aa([2e3,1]).day(o),u=al(this.weekdaysMin(a,"")),h=al(this.weekdaysShort(a,"")),d=al(this.weekdays(a,"")),e.push(u),n.push(h),i.push(d),r.push(u),r.push(h),r.push(d);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function fx(){return this.hours()%12||12}function z9(){return this.hours()||24}Ye("H",["HH",2],0,"hour");Ye("h",["hh",2],0,fx);Ye("k",["kk",2],0,z9);Ye("hmm",0,0,function(){return""+fx.apply(this)+ia(this.minutes(),2)});Ye("hmmss",0,0,function(){return""+fx.apply(this)+ia(this.minutes(),2)+ia(this.seconds(),2)});Ye("Hmm",0,0,function(){return""+this.hours()+ia(this.minutes(),2)});Ye("Hmmss",0,0,function(){return""+this.hours()+ia(this.minutes(),2)+ia(this.seconds(),2)});function MU(t,e){Ye(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}MU("a",!0);MU("A",!1);function OU(t,e){return e._meridiemParse}De("a",OU);De("A",OU);De("H",mn,ux);De("h",mn,Sf);De("k",mn,Sf);De("HH",mn,to);De("hh",mn,to);De("kk",mn,to);De("hmm",pU);De("hmmss",vU);De("Hmm",pU);De("Hmmss",vU);en(["H","HH"],mi);en(["k","kk"],function(t,e,n){var i=Rt(t);e[mi]=i===24?0:i});en(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});en(["h","hh"],function(t,e,n){e[mi]=Rt(t),ut(n).bigHour=!0});en("hmm",function(t,e,n){var i=t.length-2;e[mi]=Rt(t.substr(0,i)),e[as]=Rt(t.substr(i)),ut(n).bigHour=!0});en("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[mi]=Rt(t.substr(0,i)),e[as]=Rt(t.substr(i,2)),e[el]=Rt(t.substr(r)),ut(n).bigHour=!0});en("Hmm",function(t,e,n){var i=t.length-2;e[mi]=Rt(t.substr(0,i)),e[as]=Rt(t.substr(i))});en("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[mi]=Rt(t.substr(0,i)),e[as]=Rt(t.substr(i,2)),e[el]=Rt(t.substr(r))});function Y9(t){return(t+"").toLowerCase().charAt(0)==="p"}var G9=/[ap]\.?m?\.?/i,q9=Rf("Hours",!0);function K9(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var xU={calendar:k8,longDateFormat:F8,invalidDate:j8,ordinal:z8,dayOfMonthOrdinalParse:Y8,relativeTime:q8,months:c9,monthsShort:CU,week:S9,weekdays:x9,weekdaysMin:A9,weekdaysShort:_U,meridiemParse:G9},vn={},kg={},gp;function X9(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function Y$(t){return t&&t.toLowerCase().replace("_","-")}function Z9(t){for(var e=0,n,i,r,o;e<t.length;){for(o=Y$(t[e]).split("-"),n=o.length,i=Y$(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Lb(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&X9(o,i)>=n-1)break;n--}e++}return gp}function Q9(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Lb(t){var e=null,n;if(vn[t]===void 0&&typeof _C<"u"&&_C&&_C.exports&&Q9(t))try{e=gp._abbr,n=require,n("./locale/"+t),Su(e)}catch{vn[t]=null}return vn[t]}function Su(t,e){var n;return t&&(br(e)?n=ml(t):n=gx(t,e),n?gp=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),gp._abbr}function gx(t,e){if(e!==null){var n,i=xU;if(e.abbr=t,vn[t]!=null)dU("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=vn[t]._config;else if(e.parentLocale!=null)if(vn[e.parentLocale]!=null)i=vn[e.parentLocale]._config;else if(n=Lb(e.parentLocale),n!=null)i=n._config;else return kg[e.parentLocale]||(kg[e.parentLocale]=[]),kg[e.parentLocale].push({name:t,config:e}),null;return vn[t]=new rx(B1(i,e)),kg[t]&&kg[t].forEach(function(r){gx(r.name,r.config)}),Su(t),vn[t]}else return delete vn[t],null}function J9(t,e){if(e!=null){var n,i,r=xU;vn[t]!=null&&vn[t].parentLocale!=null?vn[t].set(B1(vn[t]._config,e)):(i=Lb(t),i!=null&&(r=i._config),e=B1(r,e),i==null&&(e.abbr=t),n=new rx(e),n.parentLocale=vn[t],vn[t]=n),Su(t)}else vn[t]!=null&&(vn[t].parentLocale!=null?(vn[t]=vn[t].parentLocale,t===Su()&&Su(t)):vn[t]!=null&&delete vn[t]);return vn[t]}function ml(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return gp;if(!cs(t)){if(e=Lb(t),e)return e;t=[t]}return Z9(t)}function e7(){return F1(vn)}function mx(t){var e,n=t._a;return n&&ut(t).overflow===-2&&(e=n[Ja]<0||n[Ja]>11?Ja:n[Qs]<1||n[Qs]>cx(n[ji],n[Ja])?Qs:n[mi]<0||n[mi]>24||n[mi]===24&&(n[as]!==0||n[el]!==0||n[Wc]!==0)?mi:n[as]<0||n[as]>59?as:n[el]<0||n[el]>59?el:n[Wc]<0||n[Wc]>999?Wc:-1,ut(t)._overflowDayOfYear&&(e<ji||e>Qs)&&(e=Qs),ut(t)._overflowWeeks&&e===-1&&(e=r9),ut(t)._overflowWeekday&&e===-1&&(e=o9),ut(t).overflow=e),t}var t7=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,n7=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,i7=/Z|[+-]\d\d(?::?\d\d)?/,Rw=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],l_=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],r7=/^\/?Date\((-?\d+)/i,o7=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,s7={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function AU(t){var e,n,i=t._i,r=t7.exec(i)||n7.exec(i),o,a,u,h,d=Rw.length,g=l_.length;if(r){for(ut(t).iso=!0,e=0,n=d;e<n;e++)if(Rw[e][1].exec(r[1])){a=Rw[e][0],o=Rw[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(r[3]){for(e=0,n=g;e<n;e++)if(l_[e][1].exec(r[3])){u=(r[2]||" ")+l_[e][0];break}if(u==null){t._isValid=!1;return}}if(!o&&u!=null){t._isValid=!1;return}if(r[4])if(i7.exec(r[4]))h="Z";else{t._isValid=!1;return}t._f=a+(u||"")+(h||""),vx(t)}else t._isValid=!1}function a7(t,e,n,i,r,o){var a=[l7(t),CU.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&a.push(parseInt(o,10)),a}function l7(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function u7(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function c7(t,e,n){if(t){var i=_U.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return ut(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function h7(t,e,n){if(t)return s7[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function HU(t){var e=o7.exec(u7(t._i)),n;if(e){if(n=a7(e[4],e[3],e[2],e[5],e[6],e[7]),!c7(e[1],n,t))return;t._a=n,t._tzm=h7(e[8],e[9],e[10]),t._d=dp.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ut(t).rfc2822=!0}else t._isValid=!1}function d7(t){var e=r7.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(AU(t),t._isValid===!1)delete t._isValid;else return;if(HU(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Ce.createFromInputFallback(t)}Ce.createFromInputFallback=Po("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Dd(t,e,n){return t??e??n}function f7(t){var e=new Date(Ce.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function px(t){var e,n,i=[],r,o,a;if(!t._d){for(r=f7(t),t._w&&t._a[Qs]==null&&t._a[Ja]==null&&g7(t),t._dayOfYear!=null&&(a=Dd(t._a[ji],r[ji]),(t._dayOfYear>Wm(a)||t._dayOfYear===0)&&(ut(t)._overflowDayOfYear=!0),n=dp(a,0,t._dayOfYear),t._a[Ja]=n.getUTCMonth(),t._a[Qs]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[mi]===24&&t._a[as]===0&&t._a[el]===0&&t._a[Wc]===0&&(t._nextDay=!0,t._a[mi]=0),t._d=(t._useUTC?dp:C9).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[mi]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ut(t).weekdayMismatch=!0)}}function g7(t){var e,n,i,r,o,a,u,h,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,a=4,n=Dd(e.GG,t._a[ji],fp(gn(),1,4).year),i=Dd(e.W,1),r=Dd(e.E,1),(r<1||r>7)&&(h=!0)):(o=t._locale._week.dow,a=t._locale._week.doy,d=fp(gn(),o,a),n=Dd(e.gg,t._a[ji],d.year),i=Dd(e.w,d.week),e.d!=null?(r=e.d,(r<0||r>6)&&(h=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(h=!0)):r=o),i<1||i>ll(n,o,a)?ut(t)._overflowWeeks=!0:h!=null?ut(t)._overflowWeekday=!0:(u=TU(n,i,r,o,a),t._a[ji]=u.year,t._dayOfYear=u.dayOfYear)}Ce.ISO_8601=function(){};Ce.RFC_2822=function(){};function vx(t){if(t._f===Ce.ISO_8601){AU(t);return}if(t._f===Ce.RFC_2822){HU(t);return}t._a=[],ut(t).empty=!0;var e=""+t._i,n,i,r,o,a,u=e.length,h=0,d,g;for(r=fU(t._f,t._locale).match(ox)||[],g=r.length,n=0;n<g;n++)o=r[n],i=(e.match(t9(o,t))||[])[0],i&&(a=e.substr(0,e.indexOf(i)),a.length>0&&ut(t).unusedInput.push(a),e=e.slice(e.indexOf(i)+i.length),h+=i.length),Zd[o]?(i?ut(t).empty=!1:ut(t).unusedTokens.push(o),i9(o,i,t)):t._strict&&!i&&ut(t).unusedTokens.push(o);ut(t).charsLeftOver=u-h,e.length>0&&ut(t).unusedInput.push(e),t._a[mi]<=12&&ut(t).bigHour===!0&&t._a[mi]>0&&(ut(t).bigHour=void 0),ut(t).parsedDateParts=t._a.slice(0),ut(t).meridiem=t._meridiem,t._a[mi]=m7(t._locale,t._a[mi],t._meridiem),d=ut(t).era,d!==null&&(t._a[ji]=t._locale.erasConvertYear(d,t._a[ji])),px(t),mx(t)}function m7(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function p7(t){var e,n,i,r,o,a,u=!1,h=t._f.length;if(h===0){ut(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<h;r++)o=0,a=!1,e=ix({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],vx(e),nx(e)&&(a=!0),o+=ut(e).charsLeftOver,o+=ut(e).unusedTokens.length*10,ut(e).score=o,u?o<i&&(i=o,n=e):(i==null||o<i||a)&&(i=o,n=e,a&&(u=!0));mu(t,n||e)}function v7(t){if(!t._d){var e=sx(t._i),n=e.day===void 0?e.date:e.day;t._a=cU([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),px(t)}}function w7(t){var e=new Wp(mx(IU(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function IU(t){var e=t._i,n=t._f;return t._locale=t._locale||ml(t._l),e===null||n===void 0&&e===""?xb({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),hs(e)?new Wp(mx(e)):(Fp(e)?t._d=e:cs(n)?p7(t):n?vx(t):y7(t),nx(t)||(t._d=null),t))}function y7(t){var e=t._i;br(e)?t._d=new Date(Ce.now()):Fp(e)?t._d=new Date(e.valueOf()):typeof e=="string"?d7(t):cs(e)?(t._a=cU(e.slice(0),function(n){return parseInt(n,10)}),px(t)):qc(e)?v7(t):cl(e)?t._d=new Date(e):Ce.createFromInputFallback(t)}function PU(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(qc(t)&&tx(t)||cs(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,w7(o)}function gn(t,e,n,i){return PU(t,e,n,i,!1)}var C7=Po("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=gn.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:xb()}),b7=Po("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=gn.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:xb()});function NU(t,e){var n,i;if(e.length===1&&cs(e[0])&&(e=e[0]),!e.length)return gn();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function S7(){var t=[].slice.call(arguments,0);return NU("isBefore",t)}function R7(){var t=[].slice.call(arguments,0);return NU("isAfter",t)}var E7=function(){return Date.now?Date.now():+new Date},Vg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function T7(t){var e,n=!1,i,r=Vg.length;for(e in t)if(Dt(t,e)&&!(Un.call(Vg,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Vg[i]]){if(n)return!1;parseFloat(t[Vg[i]])!==Rt(t[Vg[i]])&&(n=!0)}return!0}function _7(){return this._isValid}function M7(){return ms(NaN)}function kb(t){var e=sx(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,u=e.hour||0,h=e.minute||0,d=e.second||0,g=e.millisecond||0;this._isValid=T7(e),this._milliseconds=+g+d*1e3+h*6e4+u*1e3*60*60,this._days=+a+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=ml(),this._bubble()}function oC(t){return t instanceof kb}function j1(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function O7(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,a;for(a=0;a<i;a++)Rt(t[a])!==Rt(e[a])&&o++;return o+r}function DU(t,e){Ye(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+ia(~~(n/60),2)+e+ia(~~n%60,2)})}DU("Z",":");DU("ZZ","");De("Z",Nb);De("ZZ",Nb);en(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=wx(Nb,t)});var x7=/([\+\-]|\d\d)/gi;function wx(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(x7)||["-",0,0],o=+(r[1]*60)+Rt(r[2]),o===0?0:r[0]==="+"?o:-o)}function yx(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(hs(t)||Fp(t)?t.valueOf():gn(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Ce.updateOffset(n,!1),n):gn(t).local()}function U1(t){return-Math.round(t._d.getTimezoneOffset())}Ce.updateOffset=function(){};function A7(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=wx(Nb,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=U1(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?VU(this,ms(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ce.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:U1(this)}function H7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function I7(t){return this.utcOffset(0,t)}function P7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(U1(this),"m")),this}function N7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=wx(J8,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function D7(t){return this.isValid()?(t=t?gn(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function L7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function k7(){if(!br(this._isDSTShifted))return this._isDSTShifted;var t={},e;return ix(t,this),t=IU(t),t._a?(e=t._isUTC?aa(t._a):gn(t._a),this._isDSTShifted=this.isValid()&&O7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function V7(){return this.isValid()?!this._isUTC:!1}function $7(){return this.isValid()?this._isUTC:!1}function LU(){return this.isValid()?this._isUTC&&this._offset===0:!1}var B7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,F7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ms(t,e){var n=t,i=null,r,o,a;return oC(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:cl(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=B7.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Rt(i[Qs])*r,h:Rt(i[mi])*r,m:Rt(i[as])*r,s:Rt(i[el])*r,ms:Rt(j1(i[Wc]*1e3))*r}):(i=F7.exec(t))?(r=i[1]==="-"?-1:1,n={y:Xu(i[2],r),M:Xu(i[3],r),w:Xu(i[4],r),d:Xu(i[5],r),h:Xu(i[6],r),m:Xu(i[7],r),s:Xu(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(a=W7(gn(n.from),gn(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),o=new kb(n),oC(t)&&Dt(t,"_locale")&&(o._locale=t._locale),oC(t)&&Dt(t,"_isValid")&&(o._isValid=t._isValid),o}ms.fn=kb.prototype;ms.invalid=M7;function Xu(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function G$(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function W7(t,e){var n;return t.isValid()&&e.isValid()?(e=yx(e,t),t.isBefore(e)?n=G$(t,e):(n=G$(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function kU(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(dU(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=ms(n,i),VU(this,r,t),this}}function VU(t,e,n,i){var r=e._milliseconds,o=j1(e._days),a=j1(e._months);t.isValid()&&(i=i??!0,a&&SU(t,hp(t,"Month")+a*n),o&&yU(t,"Date",hp(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&Ce.updateOffset(t,o||a))}var j7=kU(1,"add"),U7=kU(-1,"subtract");function $U(t){return typeof t=="string"||t instanceof String}function z7(t){return hs(t)||Fp(t)||$U(t)||cl(t)||G7(t)||Y7(t)||t===null||t===void 0}function Y7(t){var e=qc(t)&&!tx(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,a=i.length;for(r=0;r<a;r+=1)o=i[r],n=n||Dt(t,o);return e&&n}function G7(t){var e=cs(t),n=!1;return e&&(n=t.filter(function(i){return!cl(i)&&$U(t)}).length===0),e&&n}function q7(t){var e=qc(t)&&!tx(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||Dt(t,o);return e&&n}function K7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function X7(t,e){arguments.length===1&&(arguments[0]?z7(arguments[0])?(t=arguments[0],e=void 0):q7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||gn(),i=yx(n,this).startOf("day"),r=Ce.calendarFormat(this,i)||"sameElse",o=e&&(la(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,gn(n)))}function Z7(){return new Wp(this)}function Q7(t,e){var n=hs(t)?t:gn(t);return this.isValid()&&n.isValid()?(e=No(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function J7(t,e){var n=hs(t)?t:gn(t);return this.isValid()&&n.isValid()?(e=No(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function e5(t,e,n,i){var r=hs(t)?t:gn(t),o=hs(e)?e:gn(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function t5(t,e){var n=hs(t)?t:gn(t),i;return this.isValid()&&n.isValid()?(e=No(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function n5(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function i5(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function r5(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=yx(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=No(e),e){case"year":o=sC(this,i)/12;break;case"month":o=sC(this,i);break;case"quarter":o=sC(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:To(o)}function sC(t,e){if(t.date()<e.date())return-sC(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}Ce.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ce.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function o5(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function s5(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?rC(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):la(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",rC(n,"Z")):rC(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function a5(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function l5(t){t||(t=this.isUtc()?Ce.defaultFormatUtc:Ce.defaultFormat);var e=rC(this,t);return this.localeData().postformat(e)}function u5(t,e){return this.isValid()&&(hs(t)&&t.isValid()||gn(t).isValid())?ms({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function c5(t){return this.from(gn(),t)}function h5(t,e){return this.isValid()&&(hs(t)&&t.isValid()||gn(t).isValid())?ms({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function d5(t){return this.to(gn(),t)}function BU(t){var e;return t===void 0?this._locale._abbr:(e=ml(t),e!=null&&(this._locale=e),this)}var FU=Po("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function WU(){return this._locale}var xC=1e3,Qd=60*xC,AC=60*Qd,jU=(365*400+97)*24*AC;function Jd(t,e){return(t%e+e)%e}function UU(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-jU:new Date(t,e,n).valueOf()}function zU(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-jU:Date.UTC(t,e,n)}function f5(t){var e,n;if(t=No(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?zU:UU,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Jd(e+(this._isUTC?0:this.utcOffset()*Qd),AC);break;case"minute":e=this._d.valueOf(),e-=Jd(e,Qd);break;case"second":e=this._d.valueOf(),e-=Jd(e,xC);break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function g5(t){var e,n;if(t=No(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?zU:UU,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=AC-Jd(e+(this._isUTC?0:this.utcOffset()*Qd),AC)-1;break;case"minute":e=this._d.valueOf(),e+=Qd-Jd(e,Qd)-1;break;case"second":e=this._d.valueOf(),e+=xC-Jd(e,xC)-1;break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function m5(){return this._d.valueOf()-(this._offset||0)*6e4}function p5(){return Math.floor(this.valueOf()/1e3)}function v5(){return new Date(this.valueOf())}function w5(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function y5(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function C5(){return this.isValid()?this.toISOString():null}function b5(){return nx(this)}function S5(){return mu({},ut(this))}function R5(){return ut(this).overflow}function E5(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ye("N",0,0,"eraAbbr");Ye("NN",0,0,"eraAbbr");Ye("NNN",0,0,"eraAbbr");Ye("NNNN",0,0,"eraName");Ye("NNNNN",0,0,"eraNarrow");Ye("y",["y",1],"yo","eraYear");Ye("y",["yy",2],0,"eraYear");Ye("y",["yyy",3],0,"eraYear");Ye("y",["yyyy",4],0,"eraYear");De("N",Cx);De("NN",Cx);De("NNN",Cx);De("NNNN",D5);De("NNNNN",L5);en(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?ut(n).era=r:ut(n).invalidEra=t});De("y",bf);De("yy",bf);De("yyy",bf);De("yyyy",bf);De("yo",k5);en(["y","yy","yyy","yyyy"],ji);en(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[ji]=n._locale.eraYearOrdinalParse(t,r):e[ji]=parseInt(t,10)});function T5(t,e){var n,i,r,o=this._eras||ml("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=Ce(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=Ce(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function _5(t,e,n){var i,r,o=this.eras(),a,u,h;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(a=o[i].name.toUpperCase(),u=o[i].abbr.toUpperCase(),h=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(u===t)return o[i];break;case"NNNN":if(a===t)return o[i];break;case"NNNNN":if(h===t)return o[i];break}else if([a,u,h].indexOf(t)>=0)return o[i]}function M5(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Ce(t.since).year():Ce(t.since).year()+(e-t.offset)*n}function O5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function x5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function A5(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function H5(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-Ce(r[t].since).year())*n+r[t].offset;return this.year()}function I5(t){return Dt(this,"_erasNameRegex")||bx.call(this),t?this._erasNameRegex:this._erasRegex}function P5(t){return Dt(this,"_erasAbbrRegex")||bx.call(this),t?this._erasAbbrRegex:this._erasRegex}function N5(t){return Dt(this,"_erasNarrowRegex")||bx.call(this),t?this._erasNarrowRegex:this._erasRegex}function Cx(t,e){return e.erasAbbrRegex(t)}function D5(t,e){return e.erasNameRegex(t)}function L5(t,e){return e.erasNarrowRegex(t)}function k5(t,e){return e._eraYearOrdinalRegex||bf}function bx(){var t=[],e=[],n=[],i=[],r,o,a,u,h,d=this.eras();for(r=0,o=d.length;r<o;++r)a=al(d[r].name),u=al(d[r].abbr),h=al(d[r].narrow),e.push(a),t.push(u),n.push(h),i.push(a),i.push(u),i.push(h);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ye(0,["gg",2],0,function(){return this.weekYear()%100});Ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Vb(t,e){Ye(0,[t,t.length],0,e)}Vb("gggg","weekYear");Vb("ggggg","weekYear");Vb("GGGG","isoWeekYear");Vb("GGGGG","isoWeekYear");De("G",Pb);De("g",Pb);De("GG",mn,to);De("gg",mn,to);De("GGGG",lx,ax);De("gggg",lx,ax);De("GGGGG",Ib,Ab);De("ggggg",Ib,Ab);Up(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Rt(t)});Up(["gg","GG"],function(t,e,n,i){e[i]=Ce.parseTwoDigitYear(t)});function V5(t){return YU.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function $5(t){return YU.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function B5(){return ll(this.year(),1,4)}function F5(){return ll(this.isoWeekYear(),1,4)}function W5(){var t=this.localeData()._week;return ll(this.year(),t.dow,t.doy)}function j5(){var t=this.localeData()._week;return ll(this.weekYear(),t.dow,t.doy)}function YU(t,e,n,i,r){var o;return t==null?fp(this,i,r).year:(o=ll(t,i,r),e>o&&(e=o),U5.call(this,t,e,n,i,r))}function U5(t,e,n,i,r){var o=TU(t,e,n,i,r),a=dp(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Ye("Q",0,"Qo","quarter");De("Q",gU);en("Q",function(t,e){e[Ja]=(Rt(t)-1)*3});function z5(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ye("D",["DD",2],"Do","date");De("D",mn,Sf);De("DD",mn,to);De("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});en(["D","DD"],Qs);en("Do",function(t,e){e[Qs]=Rt(t.match(mn)[0])});var GU=Rf("Date",!0);Ye("DDD",["DDDD",3],"DDDo","dayOfYear");De("DDD",Hb);De("DDDD",mU);en(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Rt(t)});function Y5(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ye("m",["mm",2],0,"minute");De("m",mn,ux);De("mm",mn,to);en(["m","mm"],as);var G5=Rf("Minutes",!1);Ye("s",["ss",2],0,"second");De("s",mn,ux);De("ss",mn,to);en(["s","ss"],el);var q5=Rf("Seconds",!1);Ye("S",0,0,function(){return~~(this.millisecond()/100)});Ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ye(0,["SSS",3],0,"millisecond");Ye(0,["SSSS",4],0,function(){return this.millisecond()*10});Ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});De("S",Hb,gU);De("SS",Hb,to);De("SSS",Hb,mU);var pu,qU;for(pu="SSSS";pu.length<=9;pu+="S")De(pu,bf);function K5(t,e){e[Wc]=Rt(("0."+t)*1e3)}for(pu="S";pu.length<=9;pu+="S")en(pu,K5);qU=Rf("Milliseconds",!1);Ye("z",0,0,"zoneAbbr");Ye("zz",0,0,"zoneName");function X5(){return this._isUTC?"UTC":""}function Z5(){return this._isUTC?"Coordinated Universal Time":""}var Se=Wp.prototype;Se.add=j7;Se.calendar=X7;Se.clone=Z7;Se.diff=r5;Se.endOf=g5;Se.format=l5;Se.from=u5;Se.fromNow=c5;Se.to=h5;Se.toNow=d5;Se.get=a9;Se.invalidAt=R5;Se.isAfter=Q7;Se.isBefore=J7;Se.isBetween=e5;Se.isSame=t5;Se.isSameOrAfter=n5;Se.isSameOrBefore=i5;Se.isValid=b5;Se.lang=FU;Se.locale=BU;Se.localeData=WU;Se.max=b7;Se.min=C7;Se.parsingFlags=S5;Se.set=l9;Se.startOf=f5;Se.subtract=U7;Se.toArray=w5;Se.toObject=y5;Se.toDate=v5;Se.toISOString=s5;Se.inspect=a5;typeof Symbol<"u"&&Symbol.for!=null&&(Se[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Se.toJSON=C5;Se.toString=o5;Se.unix=p5;Se.valueOf=m5;Se.creationData=E5;Se.eraName=O5;Se.eraNarrow=x5;Se.eraAbbr=A5;Se.eraYear=H5;Se.year=wU;Se.isLeapYear=s9;Se.weekYear=V5;Se.isoWeekYear=$5;Se.quarter=Se.quarters=z5;Se.month=RU;Se.daysInMonth=v9;Se.week=Se.weeks=T9;Se.isoWeek=Se.isoWeeks=_9;Se.weeksInYear=W5;Se.weeksInWeekYear=j5;Se.isoWeeksInYear=B5;Se.isoWeeksInISOWeekYear=F5;Se.date=GU;Se.day=Se.days=$9;Se.weekday=B9;Se.isoWeekday=F9;Se.dayOfYear=Y5;Se.hour=Se.hours=q9;Se.minute=Se.minutes=G5;Se.second=Se.seconds=q5;Se.millisecond=Se.milliseconds=qU;Se.utcOffset=A7;Se.utc=I7;Se.local=P7;Se.parseZone=N7;Se.hasAlignedHourOffset=D7;Se.isDST=L7;Se.isLocal=V7;Se.isUtcOffset=$7;Se.isUtc=LU;Se.isUTC=LU;Se.zoneAbbr=X5;Se.zoneName=Z5;Se.dates=Po("dates accessor is deprecated. Use date instead.",GU);Se.months=Po("months accessor is deprecated. Use month instead",RU);Se.years=Po("years accessor is deprecated. Use year instead",wU);Se.zone=Po("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",H7);Se.isDSTShifted=Po("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",k7);function Q5(t){return gn(t*1e3)}function J5(){return gn.apply(null,arguments).parseZone()}function KU(t){return t}var Lt=rx.prototype;Lt.calendar=V8;Lt.longDateFormat=W8;Lt.invalidDate=U8;Lt.ordinal=G8;Lt.preparse=KU;Lt.postformat=KU;Lt.relativeTime=K8;Lt.pastFuture=X8;Lt.set=L8;Lt.eras=T5;Lt.erasParse=_5;Lt.erasConvertYear=M5;Lt.erasAbbrRegex=P5;Lt.erasNameRegex=I5;Lt.erasNarrowRegex=N5;Lt.months=f9;Lt.monthsShort=g9;Lt.monthsParse=p9;Lt.monthsRegex=y9;Lt.monthsShortRegex=w9;Lt.week=b9;Lt.firstDayOfYear=E9;Lt.firstDayOfWeek=R9;Lt.weekdays=N9;Lt.weekdaysMin=L9;Lt.weekdaysShort=D9;Lt.weekdaysParse=V9;Lt.weekdaysRegex=W9;Lt.weekdaysShortRegex=j9;Lt.weekdaysMinRegex=U9;Lt.isPM=Y9;Lt.meridiem=K9;function HC(t,e,n,i){var r=ml(),o=aa().set(i,e);return r[n](o,t)}function XU(t,e,n){if(cl(t)&&(e=t,t=void 0),t=t||"",e!=null)return HC(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=HC(t,i,n,"month");return r}function Sx(t,e,n,i){typeof t=="boolean"?(cl(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,cl(e)&&(n=e,e=void 0),e=e||"");var r=ml(),o=t?r._week.dow:0,a,u=[];if(n!=null)return HC(e,(n+o)%7,i,"day");for(a=0;a<7;a++)u[a]=HC(e,(a+o)%7,i,"day");return u}function eX(t,e){return XU(t,e,"months")}function tX(t,e){return XU(t,e,"monthsShort")}function nX(t,e,n){return Sx(t,e,n,"weekdays")}function iX(t,e,n){return Sx(t,e,n,"weekdaysShort")}function rX(t,e,n){return Sx(t,e,n,"weekdaysMin")}Su("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Rt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Ce.lang=Po("moment.lang is deprecated. Use moment.locale instead.",Su);Ce.langData=Po("moment.langData is deprecated. Use moment.localeData instead.",ml);var Oa=Math.abs;function oX(){var t=this._data;return this._milliseconds=Oa(this._milliseconds),this._days=Oa(this._days),this._months=Oa(this._months),t.milliseconds=Oa(t.milliseconds),t.seconds=Oa(t.seconds),t.minutes=Oa(t.minutes),t.hours=Oa(t.hours),t.months=Oa(t.months),t.years=Oa(t.years),this}function ZU(t,e,n,i){var r=ms(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function sX(t,e){return ZU(this,t,e,1)}function aX(t,e){return ZU(this,t,e,-1)}function q$(t){return t<0?Math.floor(t):Math.ceil(t)}function lX(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,a,u,h;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=q$(z1(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=To(t/1e3),i.seconds=r%60,o=To(r/60),i.minutes=o%60,a=To(o/60),i.hours=a%24,e+=To(a/24),h=To(QU(e)),n+=h,e-=q$(z1(h)),u=To(n/12),n%=12,i.days=e,i.months=n,i.years=u,this}function QU(t){return t*4800/146097}function z1(t){return t*146097/4800}function uX(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=No(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+QU(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(z1(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function pl(t){return function(){return this.as(t)}}var JU=pl("ms"),cX=pl("s"),hX=pl("m"),dX=pl("h"),fX=pl("d"),gX=pl("w"),mX=pl("M"),pX=pl("Q"),vX=pl("y"),wX=JU;function yX(){return ms(this)}function CX(t){return t=No(t),this.isValid()?this[t+"s"]():NaN}function dh(t){return function(){return this.isValid()?this._data[t]:NaN}}var bX=dh("milliseconds"),SX=dh("seconds"),RX=dh("minutes"),EX=dh("hours"),TX=dh("days"),_X=dh("months"),MX=dh("years");function OX(){return To(this.days()/7)}var Ga=Math.round,zd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function xX(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function AX(t,e,n,i){var r=ms(t).abs(),o=Ga(r.as("s")),a=Ga(r.as("m")),u=Ga(r.as("h")),h=Ga(r.as("d")),d=Ga(r.as("M")),g=Ga(r.as("w")),p=Ga(r.as("y")),w=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||a<=1&&["m"]||a<n.m&&["mm",a]||u<=1&&["h"]||u<n.h&&["hh",u]||h<=1&&["d"]||h<n.d&&["dd",h];return n.w!=null&&(w=w||g<=1&&["w"]||g<n.w&&["ww",g]),w=w||d<=1&&["M"]||d<n.M&&["MM",d]||p<=1&&["y"]||["yy",p],w[2]=e,w[3]=+t>0,w[4]=i,xX.apply(null,w)}function HX(t){return t===void 0?Ga:typeof t=="function"?(Ga=t,!0):!1}function IX(t,e){return zd[t]===void 0?!1:e===void 0?zd[t]:(zd[t]=e,t==="s"&&(zd.ss=e-1),!0)}function PX(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=zd,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},zd,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=AX(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var u_=Math.abs;function Zh(t){return(t>0)-(t<0)||+t}function $b(){if(!this.isValid())return this.localeData().invalidDate();var t=u_(this._milliseconds)/1e3,e=u_(this._days),n=u_(this._months),i,r,o,a,u=this.asSeconds(),h,d,g,p;return u?(i=To(t/60),r=To(i/60),t%=60,i%=60,o=To(n/12),n%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",d=Zh(this._months)!==Zh(u)?"-":"",g=Zh(this._days)!==Zh(u)?"-":"",p=Zh(this._milliseconds)!==Zh(u)?"-":"",h+"P"+(o?d+o+"Y":"")+(n?d+n+"M":"")+(e?g+e+"D":"")+(r||i||t?"T":"")+(r?p+r+"H":"")+(i?p+i+"M":"")+(t?p+a+"S":"")):"P0D"}var At=kb.prototype;At.isValid=_7;At.abs=oX;At.add=sX;At.subtract=aX;At.as=uX;At.asMilliseconds=JU;At.asSeconds=cX;At.asMinutes=hX;At.asHours=dX;At.asDays=fX;At.asWeeks=gX;At.asMonths=mX;At.asQuarters=pX;At.asYears=vX;At.valueOf=wX;At._bubble=lX;At.clone=yX;At.get=CX;At.milliseconds=bX;At.seconds=SX;At.minutes=RX;At.hours=EX;At.days=TX;At.weeks=OX;At.months=_X;At.years=MX;At.humanize=PX;At.toISOString=$b;At.toString=$b;At.toJSON=$b;At.locale=BU;At.localeData=WU;At.toIsoString=Po("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$b);At.lang=FU;Ye("X",0,0,"unix");Ye("x",0,0,"valueOf");De("x",Pb);De("X",e9);en("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});en("x",function(t,e,n){n._d=new Date(Rt(t))});//! moment.js
Ce.version="2.30.1";N8(gn);Ce.fn=Se;Ce.min=S7;Ce.max=R7;Ce.now=E7;Ce.utc=aa;Ce.unix=Q5;Ce.months=eX;Ce.isDate=Fp;Ce.locale=Su;Ce.invalid=xb;Ce.duration=ms;Ce.isMoment=hs;Ce.weekdays=nX;Ce.parseZone=J5;Ce.localeData=ml;Ce.isDuration=oC;Ce.monthsShort=tX;Ce.weekdaysMin=rX;Ce.defineLocale=gx;Ce.updateLocale=J9;Ce.locales=e7;Ce.weekdaysShort=iX;Ce.normalizeUnits=No;Ce.relativeTimeRounding=HX;Ce.relativeTimeThreshold=IX;Ce.calendarFormat=K7;Ce.prototype=Se;Ce.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function NX(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function K$(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function aC(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function xr(t,e,n,i){let r=-1,o=t,a=n;Array.isArray(t)||(o=Array.from(t));const u=o.length;for(r+=1;r<u;)a=e(a,o[r],r,o),r+=1;return a}function Zc(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let a=-1;for(;n<r;){const u=i[n];e(u,n,i)&&(a+=1,o[a]=u),n+=1}return o}function St(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let a=-1;for(;n<r;){const u=i[n];a+=1,o[a]=e(u,n,i),n+=1}return o}function U(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function DX(t){const e=[];return U(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function X$(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return U(r,a=>{o=o.filter(u=>!a.includes(u))}),o}function Z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return xr(t,(o,a,u)=>{const h=a.replace(/\r?\n\s*/g,""),d=n[u]?n[u]:"";return o+h+d},"").trim()}function yn(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ne(t){return typeof t<"u"}function wn(t){return typeof t>"u"}function Vn(t){return t===null||t===""||wn(t)}function LX(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Dm="length",jm=t=>parseInt(t,16),Q$=t=>parseInt(t,10),IC=(t,e,n)=>t.substr(e,n),Um=t=>t.codePointAt(0)-65,Y1=t=>`${t}`.replace(/\-/g,""),kX=t=>jm(IC(Y1(t),jm("12"),Um("F")))/(jm(IC(Y1(t),Um("B"),~~![][Dm]))||9),VX=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let J$=!1;const eB={invalid:()=>$t`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return $t`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>$t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},tB={invalid:()=>$t`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return $t`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>$t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function $X(t,e){const n=!Vn(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="15.3.0";let o,a="invalid",u="invalid";t=Y1(t||"");const h=BX(t);if(n||i||h)if(h){const d=Ce("29/04/2025","DD/MM/YYYY"),g=Math.floor(d.toDate().getTime()/864e5),p=kX(t);o=Ce((p+1)*864e5,"x").format("MMMM DD, YYYY"),g>p?(a="expired",u="expired"):(a="valid",u="valid")}else i?(a="non_commercial",u="valid"):(a="invalid",u="invalid");else a="missing",u="missing";if(VX()&&(a="valid",u="valid"),!J$&&a!=="valid"&&(eB[a]({keyValidityDate:o,hotVersion:r})&&console[a==="non_commercial"?"info":"warn"](eB[a]({keyValidityDate:o,hotVersion:r})),J$=!0),u!=="valid"&&e.parentNode&&tB[u]({keyValidityDate:o,hotVersion:r})){const g=document.createElement("div");g.className="handsontable hot-display-license-info",g.innerHTML=tB[u]({keyValidityDate:o,hotVersion:r}),e.parentNode.insertBefore(g,e.nextSibling)}}function BX(t){let e=[][Dm],n=e;if(t[Dm]!==Um("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=Um(r.shift());o;o=Um(r.shift()||"A"))--o<""[Dm]?n=n|(Q$(`${Q$(jm(i)+(jm(IC(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=IC(t,o,o?r[Dm]===1?9:8:6);return n===e}function ds(t){return t[0].toUpperCase()+t.substr(1)}function ez(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function tz(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function nz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function nB(t){return Rx(`${t}`,{ALLOWED_TAGS:[]})}function Rx(t,e){return P8.sanitize(t,e)}const fh=t=>["tabindex",t],FX=()=>["role","treegrid"],tl=()=>["role","presentation"],WX=()=>["role","gridcell"],jX=()=>["role","rowheader"],iz=()=>["role","rowgroup"],UX=()=>["role","columnheader"],G1=()=>["role","row"],zX=()=>["role","menu"],YX=()=>["role","menuitem"],GX=()=>["role","menuitemcheckbox"],qX=()=>["role","combobox"],rz=()=>["role","listbox"],KX=()=>["role","option"],XX=()=>["role","checkbox"],ZX=()=>["scope","col"],QX=()=>["scope","row"],JX=()=>["type","text"],mp=t=>["aria-label",t],gh=()=>["aria-hidden","true"],eZ=()=>["aria-disabled","true"],tZ=()=>["aria-multiselectable","true"],oz=t=>["aria-haspopup",t],sz=t=>["aria-rowcount",t],Bb=t=>["aria-colcount",t],az=t=>["aria-rowindex",t],Ex=t=>["aria-colindex",t],Oo=t=>["aria-expanded",t],nZ=t=>["aria-sort",t],iB=()=>["aria-readonly","true"],rB=()=>["aria-invalid","true"],lz=t=>["aria-checked",t],Tx=()=>["aria-selected","true"],iZ=()=>["aria-autocomplete","list"],rZ=t=>["aria-controls",t],oZ=t=>["aria-activedescendant",t],sZ=t=>["aria-live",t],aZ=t=>["aria-relevant",t],lZ=t=>["aria-setsize",t],uZ=t=>["aria-posinset",t];function cZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function lC(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function hZ(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function sf(t){return hZ(t)&&t.parent}function Qc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:a,nodeName:u}=o;if(a===i&&(e.includes(u)||e.includes(o)))return o;const{host:h}=o;h&&a===r?o=h:o=o.parentNode}return null}function Ew(t,e,n){const i=[];let r=t;for(;r&&(r=Qc(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function dZ(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function Kc(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function fZ(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Zu(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function uz(t){return!t||!t.length?[]:t.filter(e=>!!e)}function cz(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),{regexFree:i,regexes:n}}function ze(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function pe(t,e){typeof e=="string"&&(e=e.split(" ")),e=uz(e),e.length>0&&t.classList.add(...e)}function Ue(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=cz(e,!0);n=uz(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function qe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function Ef(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=cz(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function hz(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)hz(e[n])}}function hl(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const gZ=/(<(.*)>|&(.*);)/;function Tf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;gZ.test(e)?t.innerHTML=n?Rx(e):e:Jc(t,e)}function Jc(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(hl(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function af(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return af(i.host.impl);if(i.host)return af(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function mZ(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function Wi(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,a,u;for(o=r.offsetLeft,a=r.offsetTop,u=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,a+=r.offsetTop,u=r;return u&&u.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,a+=n.pageYOffset||i.scrollTop),{left:o,top:a}}function dz(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function _x(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Mx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dz(e):t.scrollTop}function fz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?_x(e):t.scrollLeft}function PC(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:a,overflowY:u}=r.style;if([o,a,u].includes("scroll"))return r;if({overflow:o,overflowX:a,overflowY:u}=n.getComputedStyle(r),i.includes(o)||i.includes(a)||i.includes(u)||r.clientHeight<=r.scrollHeight+1&&(i.includes(u)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(a)||i.includes(o)))return r;r=r.parentNode}return n}function pZ(t){return t.scrollHeight-t.clientHeight}function vZ(t){return t.scrollWidth-t.clientWidth}function pp(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],a=r.getPropertyValue("overflow"),u=r.getPropertyValue("overflow-y"),h=r.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(u)||o.includes(h))return i;i=i.parentNode}return n}function NC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function zn(t){return t.offsetWidth}function ni(t){return t.offsetHeight}function zm(t){return t.clientHeight||t.innerHeight}function gz(t){return t.clientWidth||t.innerWidth}function mz(t){return t.selectionStart?t.selectionStart:0}function wZ(t){return t.selectionEnd?t.selectionEnd:0}function oB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Fb(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let c_;function yZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function Si(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c_===void 0&&(c_=yZ(t)),c_}function pz(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function vz(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Ox(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Wb(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function uC(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function wz(t){return uC(t)&&t.hasAttribute("data-hot-input")===!1}function yz(t){return!t.parentNode}function CZ(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Cz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();qe(t,"contenteditable",!0),n&&qe(t,...gh()),e&&pe(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function bz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ue(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function bZ(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Cz(t,n),e(),bz(t,n)}function ul(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function Ut(t){return typeof t=="function"}function jb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,a)},e),i}return r}function Sz(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return t.apply(this,n.concat(a))}}function SZ(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];const h=i.concat(a);let d;return h.length>=e?d=t.apply(this,h):d=n(h),d}}return n([])}function q1(t,e,n,i,r,o,a,u){return Ne(u)?t.call(e,n,i,r,o,a,u):Ne(a)?t.call(e,n,i,r,o,a):Ne(o)?t.call(e,n,i,r,o):Ne(r)?t.call(e,n,i,r):Ne(i)?t.call(e,n,i):Ne(n)?t.call(e,n):t.call(e)}var sB={},h_,aB;function RZ(){if(aB)return h_;aB=1;var t=Yn(),e=z2(),n=si(),i=ah(),r=Ob(),o=t([].push);return h_=function(a){if(n(a))return a;if(e(a)){for(var u=a.length,h=[],d=0;d<u;d++){var g=a[d];typeof g=="string"?o(h,g):(typeof g=="number"||i(g)==="Number"||i(g)==="String")&&o(h,r(g))}var p=h.length,w=!0;return function(y,b){if(w)return w=!1,b;if(e(this))return b;for(var T=0;T<p;T++)if(h[T]===y)return b}}},h_}var lB;function EZ(){if(lB)return sB;lB=1;var t=rn(),e=pf(),n=Vp(),i=oi(),r=Yn(),o=Ri(),a=si(),u=WO(),h=ex(),d=RZ(),g=FO(),p=String,w=e("JSON","stringify"),y=r(/./.exec),b=r("".charAt),T=r("".charCodeAt),M=r("".replace),I=r(1 .toString),_=/[\uD800-\uDFFF]/g,N=/^[\uD800-\uDBFF]$/,k=/^[\uDC00-\uDFFF]$/,$=!g||o(function(){var le=e("Symbol")("stringify detection");return w([le])!=="[null]"||w({a:le})!=="{}"||w(Object(le))!=="{}"}),L=o(function(){return w("\uDF06\uD834")!=='"\\udf06\\ud834"'||w("\uDEAD")!=='"\\udead"'}),F=function(le,G){var ye=h(arguments),we=d(G);if(!(!a(we)&&(le===void 0||u(le))))return ye[1]=function(Me,Ee){if(a(we)&&(Ee=i(we,this,p(Me),Ee)),!u(Ee))return Ee},n(w,null,ye)},he=function(le,G,ye){var we=b(ye,G-1),Me=b(ye,G+1);return y(N,le)&&!y(k,Me)||y(k,le)&&!y(N,we)?"\\u"+I(T(le,0),16):le};return w&&t({target:"JSON",stat:!0,arity:3,forced:$||L},{stringify:function(G,ye,we){var Me=h(arguments),Ee=n($?F:w,null,Me);return L&&typeof Ee=="string"?M(Ee,_,he):Ee}}),sB}EZ();function vp(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ft(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=vp(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[vp(n[0])]:e[i]=[]:e[i]=null)})),e}function TZ(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function ii(t,e,n){const i=Array.isArray(n);return ft(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function Ub(t,e){ft(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Ub(t[i],e[i])):t[i]=e[i]})}function ir(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ra(t){const e={};return ft(t,(n,i)=>{e[i]=n}),e}function Xt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return U(n,r=>{t.MIXINS.push(r.MIXIN_NAME),ft(r,(o,a)=>{if(t.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[a]=o;else{const u=function(g,p){const w=`_${g}`,y=b=>{let T=b;return(Array.isArray(T)||dt(T))&&(T=ir(T)),T};return function(){return this[w]===void 0&&(this[w]=y(p)),this[w]}},h=function(g){const p=`_${g}`;return function(w){this[p]=w}};Object.defineProperty(t.prototype,a,{get:u(a,o),set:h(a),configurable:!0})}})}),t}function xx(t,e){return JSON.stringify(t)===JSON.stringify(e)}function dt(t){return Object.prototype.toString.call(t)==="[object Object]"}function vl(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function ft(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function _Z(t,e){const n=e.split(".");let i=t;return ft(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function d_(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((o,a)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(a!==i.length-1?(ti(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function Ax(t){if(!dt(t))return 0;const e=function(n){let i=0;return dt(n)?ft(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Jr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function ti(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function DC(t){return window.requestAnimationFrame(t)}function LC(t){window.cancelAnimationFrame(t)}function Rz(){return"ontouchstart"in window}function MZ(){return typeof window<"u"}let Qh;function OZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Qh||(typeof Intl=="object"?Qh=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Qh=(n,i)=>`${n}`.localeCompare(i):Qh=(n,i)=>n===i?0:n>i?-1:1,Qh)}const yo=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},Hu={chrome:yo((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:yo(t=>/CriOS/.test(t)),edge:yo(t=>/Edge/.test(t)),edgeWebKit:yo(t=>/EdgiOS/.test(t)),firefox:yo(t=>/Firefox/.test(t)),firefoxWebKit:yo(t=>/FxiOS/.test(t)),mobile:yo(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:yo((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},zp={mac:yo(t=>/^Mac/.test(t)),win:yo(t=>/^Win/.test(t)),linux:yo(t=>/^Linux/.test(t)),ios:yo(t=>/iPhone|iPad|iPod/i.test(t))};function xZ(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ft(Hu,n=>{let{test:i}=n;return void i(t,e)})}function AZ(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ft(zp,e=>{let{test:n}=e;return void n(t)})}MZ()&&(xZ(),AZ());function Ez(){return Hu.chrome.value}function HZ(){return Hu.chromeWebKit.value}function f_(){return Hu.firefox.value}function IZ(){return Hu.firefoxWebKit.value}function kC(){return Hu.safari.value}function PZ(){return Hu.edge.value}function nl(){return Hu.mobile.value}function Tz(){return zp.ios.value}function _z(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&zp.mac.value}function uB(){return zp.win.value}function cB(){return zp.mac.value}const We={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:f_()?182:174,AUDIO_MUTE:f_()?181:173,AUDIO_UP:f_()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},NZ=[We.ALT,We.ARROW_DOWN,We.ARROW_LEFT,We.ARROW_RIGHT,We.ARROW_UP,We.AUDIO_DOWN,We.AUDIO_MUTE,We.AUDIO_UP,We.BACKSPACE,We.CAPS_LOCK,We.DELETE,We.END,We.ENTER,We.ESCAPE,We.F1,We.F2,We.F3,We.F4,We.F5,We.F6,We.F7,We.F8,We.F9,We.F10,We.F11,We.F12,We.F13,We.F14,We.F15,We.F16,We.F17,We.F18,We.F19,We.HOME,We.INSERT,We.MEDIA_NEXT,We.MEDIA_PLAY_PAUSE,We.MEDIA_PREV,We.MEDIA_STOP,We.NULL,We.NUM_LOCK,We.PAGE_DOWN,We.PAGE_UP,We.PAUSE,We.SCROLL_LOCK,We.SHIFT,We.TAB];function DZ(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Mz(t){return NZ.includes(t)}function LZ(t){return[We.CONTROL,We.COMMAND_LEFT,We.COMMAND_RIGHT,We.COMMAND_FIREFOX].includes(t)}function Yp(t,e){const n=e.split("|");let i=!1;return U(n,r=>{if(t===We[r])return i=!0,!1}),i}function ps(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function $c(t){return t.isImmediatePropagationEnabled===!1}function eh(t){return t.button===2}function Hx(t){return t.button===0}function kZ(t){return t instanceof TouchEvent}function VZ(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!ul(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function Nt(){Ne(console)&&console.warn(...arguments)}function Ix(){Ne(console)&&console.error(...arguments)}const Bc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],g_=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),m_=new Map([[]]);var hB={},p_,dB;function $Z(){if(dB)return p_;dB=1;var t=yf();return p_=function(e,n,i){for(var r=0,o=arguments.length>2?i:t(n),a=new e(o);o>r;)a[r]=n[r++];return a},p_}var v_,fB;function BZ(){if(fB)return v_;fB=1;var t=ri();return v_=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},v_}var w_,gB;function zb(){if(gB)return w_;gB=1;var t=gs(),e=QO(),n=xu().f,i=t("unscopables"),r=Array.prototype;return r[i]===void 0&&n(r,i,{configurable:!0,value:e(null)}),w_=function(o){r[i][o]=!0},w_}var mB;function FZ(){if(mB)return hB;mB=1;var t=rn(),e=Yn(),n=Or(),i=Np(),r=$Z(),o=BZ(),a=zb(),u=Array,h=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(g){g!==void 0&&n(g);var p=i(this),w=r(u,p);return h(w,g)}}),a("toSorted"),hB}FZ();var pB={},vB={},wB;function WZ(){if(wB)return vB;wB=1;var t=rn(),e=oi(),n=Cf(),i=Or(),r=ai(),o=sa(),a=eo(),u=Au(),h=u("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var p=o(this),w=0;return n(p,function(y,b){if(g(y,w++))return b(y)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),vB}var yB;function jZ(){return yB||(yB=1,WZ()),pB}jZ();function UZ(t,e){Oz(t,e),e.add(t)}function y_(t,e,n){Oz(t,e),e.set(t,n)}function Oz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CB(t,e,n){return t.set(VC(t,e),n),n}function xi(t,e){return t.get(VC(t,e))}function VC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zZ=100;var Ur=new WeakMap,Ld=new WeakMap,C_=new WeakMap,b_=new WeakSet;class bB{constructor(){UZ(this,b_),y_(this,Ur,new Map),y_(this,Ld,new Map),y_(this,C_,new Set),Bc.forEach(e=>VC(b_,this,SB).call(this,e))}getHooks(e){var n;return(n=xi(Ur,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};xi(Ur,this).has(e)||(VC(b_,this,SB).call(this,e),Bc.push(e));const r=xi(Ur,this).get(e);if(r.find(d=>d.callback===n))return;const o=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,u=!!i.initialHook;let h=!1;if(u){const d=r.find(g=>g.initialHook);d&&(d.callback=n,h=!0)}if(!h){r.push({callback:n,orderIndex:o,runOnce:a,initialHook:u,skip:!1});let d=xi(C_,this).has(e);!d&&o!==0&&(d=!0,xi(C_,this).add(e)),d&&r.length>1&&xi(Ur,this).set(e,r.toSorted((g,p)=>g.orderIndex-p.orderIndex))}}has(e){return xi(Ur,this).has(e)&&xi(Ur,this).get(e).length>0}remove(e,n){if(!xi(Ur,this).has(e))return!1;const i=xi(Ur,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=xi(Ld,this).get(e);return r.skip=!0,o+=1,o>zZ&&(xi(Ur,this).set(e,i.filter(a=>!a.skip)),o=0),xi(Ld,this).set(e,o),!0}return!1}destroy(){xi(Ur,this).clear(),xi(Ld,this).clear(),CB(Ur,this,null),CB(Ld,this,null)}}function SB(t){xi(Ur,this).set(t,[]),xi(Ld,this).set(t,0)}function YZ(t,e,n){return(e=GZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GZ(t){var e=qZ(t,"string");return typeof e=="symbol"?e:e+""}function qZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const KZ=$t`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class xe{constructor(){YZ(this,"globalBucket",new bB)}static getSingleton(){return ZZ()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new bB),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?U(n,o=>this.add(e,o,i)):(g_.has(e)&&Nt(nz(KZ,{hookName:e,removedInVersion:g_.get(e)})),m_.has(e)&&Nt(m_.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?U(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?U(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,a,u,h){{const d=this.getBucket().getHooks(n),g=d?d.length:0;let p=0;if(g)for(;p<g;){if(!d[p]||d[p].skip){p+=1;continue}const w=q1(d[p].callback,e,i,r,o,a,u,h);w!==void 0&&(i=w),d[p]&&d[p].runOnce&&this.remove(n,d[p].callback),p+=1}}{const d=this.getBucket(e).getHooks(n),g=d?d.length:0;let p=0;if(g)for(;p<g;){if(!d[p]||d[p].skip){p+=1;continue}const w=q1(d[p].callback,e,i,r,o,a,u,h);w!==void 0&&(i=w),d[p]&&d[p].runOnce&&this.remove(n,d[p].callback,e),p+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Bc.push(e)}deregister(e){this.isRegistered(e)&&Bc.splice(Bc.indexOf(e),1)}isDeprecated(e){return m_.has(e)||g_.has(e)}isRegistered(e){return Bc.indexOf(e)>=0}getRegistered(){return Bc}}const XZ=new xe;function ZZ(){return XZ}const S_=new Map;function vs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";S_.has(t)||S_.set(t,new Map);const e=S_.get(t);function n(u,h){e.set(u,h)}function i(u){return e.get(u)}function r(u){return e.has(u)}function o(){return[...e.keys()]}function a(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:a}}const K1=new WeakMap,{register:QZ,getItem:xz,hasItem:Az,getNames:$Se,getValues:BSe}=vs("editors");function JZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},xe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Hz(t,e){let n;if(typeof t=="function")K1.get(t)||Yr(null,t),n=K1.get(t);else if(typeof t=="string")n=xz(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function X1(t){if(typeof t=="function")return t;if(!Az(t))throw Error(`No registered editor found under "${t}" name`);return xz(t).getConstructor()}function Yr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new JZ(e);typeof t=="string"&&QZ(t,n),K1.set(e,n)}function eQ(t,e,n){return(e=tQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tQ(t){var e=nQ(t,"string");return typeof e=="symbol"?e:e+""}function nQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;eQ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){i.call(this,iQ(a))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===n&&a.element===e){if(i&&i!==a.callback||r&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):a=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${n}`,a)}}function iQ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ps(this)},t}function rQ(t,e){oQ(t,e),e.add(t)}function oQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qu(t,e,n){return(e=sQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function R_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tw=new WeakSet;class Z1{constructor(e,n,i){rQ(this,Tw),Qu(this,"hot",void 0),Qu(this,"tableMeta",void 0),Qu(this,"selection",void 0),Qu(this,"eventManager",void 0),Qu(this,"destroyed",!1),Qu(this,"activeEditor",void 0),Qu(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new fs(e),this.hot.addHook("afterDocumentKeyDown",r=>R_(Tw,this,RB).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>R_(Tw,this,RB).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,o,a)=>R_(Tw,this,lQ).call(this,r,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let a=i,u=r;if(Array.isArray(o)&&([a,u]=o),this.cellProperties=this.hot.getCellMeta(a,u),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(i,r,!0);if(h){const d=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(u),p=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),u);this.activeEditor=Hz(d,this.hot),this.activeEditor.prepare(i,r,g,h,p,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,u=o.isHidden(this.hot.toPhysicalRow(i))||a.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||u)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function RB(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||$c(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Mz(n)&&!LZ(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function lQ(t,e){e.isCell()&&this.openEditor(null,t,!0)}const EB=new WeakMap;Z1.getInstance=function(t,e,n){let i=EB.get(t);return i||(i=new Z1(t,e,n),EB.set(t,i)),i};function uQ(t,e){Iz(t,e),e.add(t)}function $g(t,e,n){Iz(t,e),e.set(t,n)}function Iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function an(t,e){return t.get(Za(t,e))}function Bg(t,e,n){return t.set(Za(t,e),n),n}function Za(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ef=Object.freeze({CELL:"cell",MIXED:"mixed"});var ei=new WeakMap,_w=new WeakMap,Mw=new WeakMap,Ow=new WeakMap,xw=new WeakMap,au=new WeakSet;class cQ{constructor(e){var n=this;uQ(this,au),$g(this,ei,void 0),$g(this,_w,void 0),$g(this,Mw,1),$g(this,Ow,null),$g(this,xw,new Map);const i=e.getSettings();Bg(ei,this,e),Bg(_w,this,i.imeFastEdit?ef.MIXED:ef.CELL),an(ei,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Za(au,n,dQ).call(n,...o)}),an(ei,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Za(au,n,TB).call(n,...o)}),an(ei,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Za(au,n,TB).call(n,...o)}),an(ei,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Za(au,n,hQ).call(n,...o)})}getFocusMode(){return an(_w,this)}setFocusMode(e){Object.values(ef).includes(e)?Bg(_w,this,e):Nt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return an(Mw,this)}setRefocusDelay(e){Bg(Mw,this,e)}setRefocusElementGetter(e){Bg(Ow,this,e)}getRefocusElement(){var e;return typeof an(Ow,this)=="function"?an(Ow,this).call(this):(e=an(ei,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const a=(r=an(ei,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!a)return;let u=an(ei,this).runHooks("modifyFocusedElement",a.row,a.col,i);ul(u)||(u=i),u&&!((o=an(ei,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&u.focus({preventScroll:!0})};e?n(e):Za(au,this,Px).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:an(Mw,this);if(an(ei,this).getSettings().imeFastEdit&&!((e=an(ei,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=an(ei,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),an(xw,this).has(n)||an(xw,this).set(n,jb(()=>{if(!an(ei,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),an(xw,this).get(n)()}}}function Px(t){var e;const n=(e=an(ei,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!an(ei,this).selection.isCellVisible(n)){t(null);return}const i=an(ei,this).getCell(n.row,n.col,!0);i===null?an(ei,this).addHookOnce("afterScroll",()=>{t(an(ei,this).getCell(n.row,n.col,!0))}):t(i)}function TB(){Za(au,this,Px).call(this,t=>{const{activeElement:e}=an(ei,this).rootDocument;e&&wz(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function hQ(){Za(au,this,Px).call(this,t=>{this.getFocusMode()===ef.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function dQ(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ef.MIXED:ef.CELL)}var _B={},E_,MB;function fQ(){if(MB)return E_;MB=1;var t=Ho(),e=ah(),n=gs(),i=n("match");return E_=function(r){var o;return t(r)&&((o=r[i])!==void 0?!!o:e(r)==="RegExp")},E_}var T_,OB;function gQ(){if(OB)return T_;OB=1;var t=ai();return T_=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},T_}var __,xB;function mQ(){if(xB)return __;xB=1;var t=oi(),e=Io(),n=Dp(),i=gQ(),r=RegExp.prototype;return __=function(o){var a=o.flags;return a===void 0&&!("flags"in r)&&!e(o,"flags")&&n(r,o)?t(i,o):a},__}var M_,AB;function pQ(){if(AB)return M_;AB=1;var t=Yn(),e=vf(),n=Math.floor,i=t("".charAt),r=t("".replace),o=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return M_=function(h,d,g,p,w,y){var b=g+h.length,T=p.length,M=u;return w!==void 0&&(w=e(w),M=a),r(y,M,function(I,_){var N;switch(i(_,0)){case"$":return"$";case"&":return h;case"`":return o(d,0,g);case"'":return o(d,b);case"<":N=w[o(_,1,-1)];break;default:var k=+_;if(k===0)return I;if(k>T){var $=n(k/10);return $===0?I:$<=T?p[$-1]===void 0?i(_,1):p[$-1]+i(_,1):I}N=p[k-1]}return N===void 0?"":N})},M_}var HB;function vQ(){if(HB)return _B;HB=1;var t=rn(),e=oi(),n=Yn(),i=Pp(),r=si(),o=Ho(),a=fQ(),u=Ob(),h=Lp(),d=mQ(),g=pQ(),p=gs(),w=Ou(),y=p("replace"),b=TypeError,T=n("".indexOf),M=n("".replace),I=n("".slice),_=Math.max;return t({target:"String",proto:!0},{replaceAll:function(k,$){var L=i(this),F,he,le,G,ye,we,Me,Ee,_e,se,fe=0,Te="";if(o(k)){if(F=a(k),F&&(he=u(i(d(k))),!~T(he,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(le=h(k,y),le)return e(le,k,L,$);if(w&&F)return M(u(L),k,$)}for(G=u(L),ye=u(k),we=r($),we||($=u($)),Me=ye.length,Ee=_(1,Me),_e=T(G,ye);_e!==-1;)se=we?u($(ye,_e,G)):g(ye,G,_e,[],void 0,$),Te+=I(G,fe,_e)+se,fe=_e+Me,_e=_e+Ee>G.length?-1:T(G,ye,_e+Ee);return fe<G.length&&(Te+=I(G,fe)),Te}}),_B}vQ();var IB={},PB={},NB;function wQ(){if(NB)return PB;NB=1;var t=rn(),e=Cf(),n=Or(),i=ai(),r=sa(),o=eo(),a=Au(),u=Vp(),h=Ri(),d=TypeError,g=h(function(){[].keys().reduce(function(){},void 0)}),p=!g&&a("reduce",d);return t({target:"Iterator",proto:!0,real:!0,forced:g||p},{reduce:function(y){i(this);try{n(y)}catch(_){o(this,"throw",_)}var b=arguments.length<2,T=b?void 0:arguments[1];if(p)return u(p,this,b?[y]:[y,T]);var M=r(this),I=0;if(e(M,function(_){b?(b=!1,T=_):T=y(T,_,I),I++},{IS_RECORD:!0}),b)throw new d("Reduce of empty iterator with no initial value");return T}}),PB}var DB;function yQ(){return DB||(DB=1,wQ()),IB}yQ();const Pz={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},CQ=new RegExp(Object.keys(Pz).map(t=>`(${t})`).join("|"),"gi");function bQ(t){return(t&&t.nodeName||"")==="TABLE"}function LB(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,a=o>0?r[0].length:0,u=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],g=n?1:0,p=e?1:0;for(let w=0;w<o;w+=1){const y=e&&w===0,b=[];for(let M=0;M<a;M+=1){const I=!y&&n&&M===0;let _="";if(y)_=`<th>${t.getColHeader(M-g)}</th>`;else if(I)_=`<th>${t.getRowHeader(w-p)}</th>`;else{const N=r[w][M],{hidden:k,rowspan:$,colspan:L}=t.getCellMeta(w-p,M-g);if(!k){const F=[];if($&&F.push(`rowspan="${$}"`),L&&F.push(`colspan="${L}"`),Vn(N))_=`<td ${F.join(" ")}></td>`;else{const he=N.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${F.join(" ")}>${he}</td>`}}}b.push(_)}const T=["<tr>",...b,"</tr>"].join("");y?h.splice(1,0,T):d.splice(-1,0,T)}return u.splice(1,0,h.join(""),d.join("")),u.join("")}function kB(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,a=[];i===0&&n.push("<tbody>");for(let u=0;u<o;u+=1){const h=r[u],d=Vn(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,g=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(g.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${d}</td>`)}n.push("<tr>",...a,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function SQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const N=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,k=>{const $=k.match(/<td\b[^>]*?>/g)[0],L=/<p.*?>/g,F=k.substring($.length,k.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(L,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${$}${F}</td>`});r.insertAdjacentHTML("afterbegin",`${N}`),o=r.querySelector("table")}if(!o||!bQ(o))return;const a=r.querySelector('meta[name$="enerator"]'),u=o.querySelector("tbody th")!==null,h=o.querySelector("tr"),d=h?Array.from(h.cells).reduce((N,k)=>N+k.colSpan,0)-(u?1:0):0,g=o.tFoot&&Array.from(o.tFoot.rows)||[],p=[];let w=!1,y=0,b=0;if(o.tHead){const N=Array.from(o.tHead.rows).filter(k=>{const $=k.querySelector("td")!==null;return $&&p.push(k),!$});y=N.length,w=y>0,y>1?n.nestedHeaders=Array.from(N).reduce((k,$)=>{const L=Array.from($.cells).reduce((F,he,le)=>{if(u&&le===0)return F;const{colSpan:G,innerHTML:ye}=he,we=G>1?{label:ye,colspan:G}:ye;return F.push(we),F},[]);return k.push(L),k},[]):w&&(n.colHeaders=Array.from(N[0].children).reduce((k,$,L)=>(u&&L===0||k.push($.innerHTML),k),[]))}p.length&&(n.fixedRowsTop=p.length),g.length&&(n.fixedRowsBottom=g.length);const T=[...p,...Array.from(o.tBodies).reduce((N,k)=>(N.push(...Array.from(k.rows)),N),[]),...g];b=T.length;const M=new Array(b);for(let N=0;N<b;N++)M[N]=new Array(d);const I=[],_=[];for(let N=0;N<b;N++){const k=T[N],$=Array.from(k.cells),L=$.length;for(let F=0;F<L;F++){const he=$[F],{nodeName:le,innerHTML:G,rowSpan:ye,colSpan:we}=he,Me=M[N].findIndex(Ee=>Ee===void 0);if(le==="TD"){if(ye>1||we>1){for(let fe=N;fe<N+ye;fe++)if(fe<b)for(let Te=Me;Te<Me+we;Te++)M[fe][Te]=null;const _e=he.getAttribute("style");_e&&_e.includes("mso-ignore:colspan")||I.push({col:Me,row:N,rowspan:ye,colspan:we})}let Ee="";a&&/excel/gi.test(a.content)?Ee=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Ee=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),M[N][Me]=Ee.replace(CQ,_e=>Pz[_e])}else _.push(G)}}return I.length&&(n.mergeCells=I),_.length&&(n.rowHeaders=_),M.length&&(n.data=M),n}function er(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function RQ(t){return er(t,[","])}function Ve(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function VB(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function Nz(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Et(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Q1="asc",EQ="desc",$B=new Map([[Q1,[-1,1]],[EQ,[1,-1]]]),TQ=t=>`The priority '${t}' is already declared in a map.`,_Q=t=>`The priority '${t}' is not a number.`;function MQ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ut(t)?t:TQ,e=Ut(e)?e:_Q;function i(o,a){if(!er(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,a)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q1;const[a,u]=$B.get(o)||$B.get(Q1);return[...n].sort((h,d)=>h[0]<d[0]?a:u).map(h=>h[1])}return{addItem:i,getItems:r}}const OQ=t=>`The id '${t}' is already declared in a map.`;function Yb(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ut(t)?t:OQ;function n(d,g){if(h(d))throw new Error(t(d));e.set(d,g)}function i(d){return e.delete(d)}function r(){e.clear()}function o(d){const[g]=u().find(p=>{let[w,y]=p;return d===y?w:!1})||[null];return g}function a(d){return e.get(d)}function u(){return[...e]}function h(d){return e.has(d)}return{addItem:n,clear:r,getId:o,getItem:a,getItems:u,hasItem:h,removeItem:i}}const xQ=t=>`'${t}' value is already declared in a unique set.`;function AQ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ut(t)?t:xQ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const Nx=t=>`There is already registered "${t}" plugin.`,HQ=t=>`There is already registered plugin on priority "${t}".`,IQ=t=>`The priority "${t}" is not a number.`,Dz=MQ({errorPriorityExists:HQ,errorPriorityNaN:IQ}),Lz=AQ({errorItemExists:Nx}),J1=Yb({errorIdExists:Nx});function kz(){return[...Dz.getItems(),...Lz.getItems()]}function Dx(t){const e=ds(t);return J1.getItem(e)}function PQ(t){return!!Dx(t)}function Mt(t,e,n){[t,e,n]=DQ(t,e,n),Dx(t)===void 0&&NQ(t,e,n)}function NQ(t,e,n){const i=ds(t);if(J1.hasItem(i))throw new Error(Nx(i));n===void 0?Lz.addItem(i):Dz.addItem(n,i),J1.addItem(i,e)}function DQ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:LQ,getItem:kQ,hasItem:Vz,getNames:FSe,getValues:WSe}=vs("renderers");function eO(t){if(typeof t=="function")return t;if(!Vz(t))throw Error(`No registered renderer found under "${t}" name`);return kQ(t)}function vo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),LQ(t,e)}const{register:VQ,getItem:$Q,hasItem:$z,getNames:jSe,getValues:USe}=vs("validators");function BQ(t){if(typeof t=="function")return t;if(!$z(t))throw Error(`No registered validator found under "${t}" name`);return $Q(t)}function kd(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),VQ(t,e)}var BB={},FB;function FQ(){if(FB)return BB;FB=1;var t=rn(),e=vf(),n=yf(),i=kp(),r=zb();return t({target:"Array",proto:!0},{at:function(a){var u=e(this),h=n(u),d=i(a),g=d>=0?d:h+d;return g<0||g>=h?void 0:u[g]}}),r("at"),BB}FQ();var WB={},jB;function WQ(){if(jB)return WB;jB=1;var t=rn(),e=Yn(),n=Pp(),i=kp(),r=Ob(),o=Ri(),a=e("".charAt),u=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:u},{at:function(d){var g=r(n(this)),p=g.length,w=i(d),y=w>=0?w:p+w;return y<0||y>=p?void 0:a(g,y)}}),WB}WQ();function Fg(t,e,n){return(e=jQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jQ(t){var e=UQ(t,"string");return typeof e=="symbol"?e:e+""}function UQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zQ{constructor(){Fg(this,"count",0),Fg(this,"startColumn",null),Fg(this,"endColumn",null),Fg(this,"startPosition",null),Fg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:a}=n,u=r>0?o+1:o;i>=r&&i+a<=r+u&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=d[this.endColumn]+g-d[this.startColumn-1];if(b<=r&&(this.startColumn-=1),b>=r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const p=a>0?r+1:r,w=i+r-p,y=this.startColumn===null?0:e.getColumnWidth(this.startColumn);w<-1*o||i>d.at(-1)||-1*i-r>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wg(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qQ{constructor(){Wg(this,"count",0),Wg(this,"startRow",null),Wg(this,"endRow",null),Wg(this,"startPosition",null),Wg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:a}=n;i>=r&&i+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const w=h[this.endRow]+d-h[this.startRow-1];if(w<=r-o&&(this.startRow-=1),w>=r-o)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null;const g=i+r-o,p=this.startRow===null?0:e.getRowHeight(this.startRow);g<p||i>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jg(t,e,n){return(e=KQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KQ(t){var e=XQ(t,"string");return typeof e=="symbol"?e:e+""}function XQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bz{constructor(){jg(this,"count",0),jg(this,"startColumn",null),jg(this,"endColumn",null),jg(this,"startPosition",null),jg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const a=r>0?o+1:o;i>=r&&i<=r+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=d[this.endColumn]+g-d[this.startColumn-1];if(this.startColumn-=1,y>r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const p=a>0?r+1:r;i+r-p<-1*o||i>d.at(-1)+g||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ug(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fz{constructor(){Ug(this,"count",0),Ug(this,"startRow",null),Ug(this,"endRow",null),Ug(this,"startPosition",null),Ug(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const p=h[this.endRow]+d-h[this.startRow-1];if(this.startRow-=1,p>=r-o)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>h.at(-1)+d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function zg(t,e,n){return(e=JQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JQ(t){var e=eJ(t,"string");return typeof e=="symbol"?e:e+""}function eJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tJ{constructor(){zg(this,"count",0),zg(this,"startColumn",0),zg(this,"endColumn",0),zg(this,"startPosition",0),zg(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Yg(t,e,n){return(e=nJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nJ(t){var e=iJ(t,"string");return typeof e=="symbol"?e:e+""}function iJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rJ{constructor(){Yg(this,"count",0),Yg(this,"startRow",0),Yg(this,"endRow",0),Yg(this,"startPosition",0),Yg(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function UB(t,e,n){return(e=oJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oJ(t){var e=sJ(t,"string");return typeof e=="symbol"?e:e+""}function sJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aJ extends Bz{constructor(){super(...arguments),UB(this,"columnStartOffset",0),UB(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const a=this.startColumn,u=this.endColumn;i(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-u}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function zB(t,e,n){return(e=lJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lJ(t){var e=uJ(t,"string");return typeof e=="symbol"?e:e+""}function uJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cJ extends Fz{constructor(){super(...arguments),zB(this,"rowStartOffset",0),zB(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const a=this.startRow,u=this.endRow;i(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-u}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function YB(t,e,n){return(e=hJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hJ(t){var e=dJ(t,"string");return typeof e=="symbol"?e:e+""}function dJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wz{constructor(e){YB(this,"calculationTypes",[]),YB(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Wo(t,e,n){return(e=fJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fJ(t){var e=gJ(t,"string");return typeof e=="symbol"?e:e+""}function gJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lf=50;class mJ extends Wz{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:a,overrideFn:u,inlineStartOffset:h}=e;super(n),Wo(this,"viewportWidth",0),Wo(this,"scrollOffset",0),Wo(this,"zeroBasedScrollOffset",0),Wo(this,"totalColumns",0),Wo(this,"columnWidthFn",null),Wo(this,"columnWidth",0),Wo(this,"overrideFn",null),Wo(this,"inlineStartOffset",0),Wo(this,"totalCalculatedWidth",0),Wo(this,"startPositions",[]),Wo(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=u,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?lf:n}}function ho(t,e,n){return(e=pJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pJ(t){var e=vJ(t,"string");return typeof e=="symbol"?e:e+""}function vJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wJ extends Wz{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:a,rowHeightFn:u,overrideFn:h,horizontalScrollbarHeight:d}=e;super(n),ho(this,"viewportHeight",0),ho(this,"scrollOffset",0),ho(this,"zeroBasedScrollOffset",0),ho(this,"totalRows",0),ho(this,"rowHeightFn",null),ho(this,"rowHeight",0),ho(this,"overrideFn",null),ho(this,"horizontalScrollbarHeight",0),ho(this,"innerViewportHeight",0),ho(this,"totalCalculatedHeight",0),ho(this,"startPositions",[]),ho(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=u,this.overrideFn=h,this.horizontalScrollbarHeight=d??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function yJ(t,e,n){CJ(t,e),e.set(t,n)}function CJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GB(t,e,n){return(e=bJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bJ(t){var e=SJ(t,"string");return typeof e=="symbol"?e:e+""}function SJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jh(t,e){return t.get(jz(t,e))}function qB(t,e,n){return t.set(jz(t,e),n),n}function jz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xa=new WeakMap;class th{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;GB(this,"row",null),GB(this,"col",null),yJ(this,xa,!1),qB(xa,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Jh(xa,this)}isSouthEastOf(e){return this.row>=e.row&&(Jh(xa,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Jh(xa,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Jh(xa,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Jh(xa,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof th&&qB(xa,this,e.isRtl()),this}clone(){return new th(this.row,this.col,Jh(xa,this))}toObject(){return{row:this.row,col:this.col}}}function RJ(t,e,n){EJ(t,e),e.set(t,n)}function EJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function O_(t,e,n){return(e=TJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TJ(t){var e=_J(t,"string");return typeof e=="symbol"?e:e+""}function _J(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fo(t,e){return t.get(Uz(t,e))}function MJ(t,e,n){return t.set(Uz(t,e),n),n}function Uz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dr=new WeakMap;class Gp{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;O_(this,"highlight",null),O_(this,"from",null),O_(this,"to",null),RJ(this,dr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),MJ(dr,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),a=e.getOuterTopStartCorner(),u=e.getOuterBottomEndCorner(),h=Math.min(i.row,a.row),d=Math.min(i.col,a.col),g=Math.max(r.row,u.row),p=Math.max(r.col,u.col),w=this._createCellCoords(h,d),y=this._createCellCoords(g,p);return this.from=w,this.to=y,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return fo(dr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return fo(dr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return fo(dr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return fo(dr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return fo(dr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return fo(dr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return fo(dr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return fo(dr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof th))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(fo(dr,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(fo(dr,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new Gp(this.highlight,this.from,this.to,fo(dr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new th(e,n,fo(dr,this))}}function Os(t,e,n){OJ(t,e),e.set(t,n)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(zz(t,e))}function Ul(t,e,n){return t.set(zz(t,e),n),n}function zz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var go=new WeakMap,x_=new WeakMap,yi=new WeakMap,ed=new WeakMap,Aw=new WeakMap,jo=new WeakMap,A_=new WeakMap,Gg=new WeakMap,Ju=new WeakMap,xs=new WeakMap;let Yz=class{constructor(e,n,i,r,o,a){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Os(this,go,void 0),Os(this,x_,void 0),Os(this,yi,void 0),Os(this,ed,void 0),Os(this,Aw,void 0),Os(this,jo,void 0),Os(this,A_,void 0),Os(this,Gg,void 0),Os(this,Ju,[null,null]),Os(this,xs,[null,null]),Ul(go,this,i),Ul(x_,this,n),Ul(yi,this,o),Ul(ed,this,a),Ul(Aw,this,u),Ul(jo,this,r),Ul(A_,this,e),this.registerEvents()}registerEvents(){$e(jo,this).addEventListener($e(yi,this).holder,"contextmenu",i=>this.onContextMenu(i)),$e(jo,this).addEventListener($e(yi,this).TABLE,"mouseover",i=>this.onMouseOver(i)),$e(jo,this).addEventListener($e(yi,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{$e(jo,this).addEventListener($e(yi,this).holder,"touchstart",i=>this.onTouchStart(i)),$e(jo,this).addEventListener($e(yi,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),$e(jo,this).addEventListener($e(yi,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||$e(go,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,$e(go,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{$e(jo,this).addEventListener($e(yi,this).holder,"mouseup",i=>this.onMouseUp(i)),$e(jo,this).addEventListener($e(yi,this).holder,"mousedown",i=>this.onMouseDown(i))};nl()?e():(Rz()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if($e(Gg,this)&&i){const[r,o]=[i.row,$e(Gg,this).from.row],[a,u]=[i.col,$e(Gg,this).from.col];return r===o&&a===u}return!1}parentCell(e){const n={},i=$e(yi,this).TABLE,r=Ew(e,["TD","TH"],i);return r?(n.coords=$e(yi,this).getCoords(r),n.TD=r):ze(e,"wtBorder")&&ze(e,"current")?(n.coords=$e(ed,this).getFocusSelection().cellRange.highlight,n.TD=$e(yi,this).getCell(n.coords)):ze(e,"wtBorder")&&ze(e,"area")&&$e(ed,this).getAreaSelection().cellRange&&(n.coords=$e(ed,this).getAreaSelection().cellRange.to,n.TD=$e(yi,this).getCell(n.coords)),n}onMouseDown(e){const n=$e(x_,this).rootDocument.activeElement,i=Sz(cZ,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);ze(r,"corner")?$e(go,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&$e(go,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&($e(xs,this)[0]=o.TD,clearTimeout($e(Ju,this)[0]),$e(Ju,this)[0]=setTimeout(()=>{$e(xs,this)[0]=null},1e3))}onContextMenu(e){if($e(go,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!$e(go,this).has("onCellMouseOver"))return;const n=$e(yi,this).TABLE,i=Ew(e.target,["TD","TH"],n),r=$e(Aw,this)||this;i&&i!==r.lastMouseOver&&Kc(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,$e(yi,this).getCoords(i),i))}onMouseOut(e){if(!$e(go,this).has("onCellMouseOut"))return;const n=$e(yi,this).TABLE,i=Ew(e.target,["TD","TH"],n),r=Ew(e.relatedTarget,["TD","TH"],n),o=$e(Aw,this)||this;i&&i!==r&&Kc(i,n)&&(this.callListener("onCellMouseOut",e,$e(yi,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&$e(go,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===$e(xs,this)[0]&&n.TD===$e(xs,this)[1]?(ze(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),$e(xs,this)[0]=null,$e(xs,this)[1]=null):n.TD===$e(xs,this)[0]&&($e(xs,this)[1]=n.TD,clearTimeout($e(Ju,this)[1]),$e(Ju,this)[1]=setTimeout(()=>{$e(xs,this)[1]=null},500)))}onTouchStart(e){Ul(Gg,this,$e(ed,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=Ne(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&$e(go,this).getSetting("isDataViewInstance")){const u=["A","BUTTON","INPUT"];Tz()&&(HZ()||IZ())&&this.selectedCellWasTouched(i)&&!u.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=$e(go,this).getSettingPure(e);o&&o(n,i,r,$e(A_,this).call(this))}destroy(){clearTimeout($e(Ju,this)[0]),clearTimeout($e(Ju,this)[1]),$e(jo,this).destroy()}};function H_(t,e,n){return(e=xJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:e+""}function AJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HJ{constructor(e,n,i){H_(this,"offset",void 0),H_(this,"total",void 0),H_(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function I_(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=PJ(t,"string");return typeof e=="symbol"?e:e+""}function PJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NJ{constructor(e,n,i){I_(this,"offset",void 0),I_(this,"total",void 0),I_(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Hw(t,e,n){return(e=DJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=LJ(t,"string");return typeof e=="symbol"?e:e+""}function LJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kJ{constructor(){Hw(this,"currentSize",0),Hw(this,"nextSize",0),Hw(this,"currentOffset",0),Hw(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const VJ=0,KB=1,tO=2;function P_(t,e,n){return(e=$J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=BJ(t,"string");return typeof e=="symbol"?e:e+""}function BJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FJ{constructor(){P_(this,"size",new kJ),P_(this,"workingSpace",VJ),P_(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=KB,e.workingSpace=tO,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=tO,e.workingSpace=KB,this.sharedSize=e.getViewSize()}}var XB={},N_,ZB;function WJ(){if(ZB)return N_;ZB=1;var t=Mb(),e=TypeError;return N_=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},N_}var QB;function jJ(){if(QB)return XB;QB=1;var t=rn(),e=vf(),n=yf(),i=Y2(),r=WJ(),o=G2(),a=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(g){var p=e(this),w=n(p),y=arguments.length;if(y){o(w+y);for(var b=w;b--;){var T=b+y;b in p?p[T]=p[b]:r(p,T)}for(var M=0;M<y;M++)p[M]=arguments[M]}return i(p,w+y)}}),XB}jJ();function UJ(t,e,n){return(e=zJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zJ(t){var e=YJ(t,"string");return typeof e=="symbol"?e:e+""}function YJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JB{constructor(e,n){UJ(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function GJ(t,e,n){return(e=qJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=KJ(t,"string");return typeof e=="symbol"?e:e+""}function KJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XJ{constructor(e){GJ(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:a}=e.getViewSize(),u=new JB(o,n),h=new JB(a,i),d=[];for(let g=0;g<r;g++){const p=u.get(g),w=h.get(g);if(w===-1)d.push(["remove",p]);else if(p===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(tO)?d.push(["append",w]):d.push(["prepend",w]);else if(w>p)u.has(w)&&(u.remove(w),i<=u.length&&(r-=1)),d.push(["replace",w,p]);else if(w<p){const y=u.prepend(w);d.push(["insert_before",w,p,y])}else d.push(["none",w])}return d}}function td(t,e,n){return(e=ZJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZJ(t){var e=QJ(t,"string");return typeof e=="symbol"?e:e+""}function QJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gz{constructor(e,n){td(this,"rootNode",void 0),td(this,"nodesPool",void 0),td(this,"sizeSet",new FJ),td(this,"collectedNodes",[]),td(this,"viewDiffer",new XJ(this.sizeSet)),td(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,a]=e,u=this.nodesPool(r);switch(this.collectedNodes.push(u),i){case"prepend":n.insertBefore(u,n.firstChild);break;case"append":n.appendChild(u);break;case"insert_before":n.insertBefore(u,this.nodesPool(o)),n.removeChild(this.nodesPool(a));break;case"replace":n.replaceChild(u,this.nodesPool(o));break;case"remove":n.removeChild(u);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class qz extends Gz{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function eF(t,e,n){return(e=JJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){var e=eee(t,"string");return typeof e=="symbol"?e:e+""}function eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tee{constructor(e){eF(this,"nodeType",void 0),eF(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function qg(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=iee(t,"string");return typeof e=="symbol"?e:e+""}function iee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qp{constructor(e,n){qg(this,"nodesPool",null),qg(this,"nodeType",void 0),qg(this,"rootNode",void 0),qg(this,"table",null),qg(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new tee(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function tF(t,e,n){return(e=ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class see extends qp{constructor(){super("TH"),tF(this,"orderViews",new WeakMap),tF(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new qz(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let a=0;a<e;a++){const u=this.table.renderedRowToSource(a),h=r.getRenderedNode(a);this.sourceRowIndex=u;const d=this.obtainOrderView(h),g=o.obtainOrderView(h);d.appendView(g).setSize(i).setOffset(0).start();for(let p=i-1;p>=0;p--){d.render();const w=d.getCurrentNode();w.className="",w.removeAttribute("style"),Ef(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&qe(w,[jX(),QX(),Ex(p+1),fh(-1)]),n[p](u,w,p)}d.end()}}}class aee extends qp{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let u=0,h=e;u<h;u++){for(i=this.rootNode.childNodes[u],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let u=e;u<a;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&hl(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&qe(this.rootNode,[iz()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&qe(a,[G1(),az(n+1)]);for(let u=-1*o;u<r;u+=1){const h=this.table.renderedColumnToSource(u),d=a.childNodes[u+o];d.className="",d.removeAttribute("style"),Ef(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&qe(d,[Ex(u+1+this.table.rowHeadersCount),fh(-1),UX(),...u>=0?[ZX()]:[G1()]]),i[n](h,d,n)}}}}let nF=!1;class lee extends qp{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!nF&&e>1e3&&(nF=!0,Nt($t`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${a}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${a}px`}const i=this.rootNode.firstChild;i&&pe(i,"rowHeader")}}function uee(t,e,n){return(e=cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:e+""}function hee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nd={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let iF=!1;class dee extends qp{constructor(e){super("TR",e),uee(this,"orderView",void 0),this.orderView=new Gz(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!iF&&e>1e3&&(iF=!0,Nt($t`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&qe(this.rootNode,[iz()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;qe(o,[G1(),az(a+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(a+1)%2===0?ze(o,nd.rowEven)||(Ue(o,nd.rowOdd),pe(o,nd.rowEven)):ze(o,nd.rowOdd)||(Ue(o,nd.rowEven),pe(o,nd.rowOdd))}this.orderView.end()}}function rF(t,e,n){return(e=fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:e+""}function gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mee extends qp{constructor(){super("TD"),rF(this,"orderViews",new WeakMap),rF(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new qz(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let u=0;u<e;u++){const h=this.table.renderedRowToSource(u),d=i.getRenderedNode(u);this.sourceRowIndex=h;const g=this.obtainOrderView(d),p=r.obtainOrderView(d);g.prependView(p).setSize(n).setOffset(0).start();for(let w=0;w<n;w++){g.render();const y=this.table.renderedColumnToSource(w),b=g.getCurrentNode();if(ze(b,"hide")||(b.className=""),b.removeAttribute("style"),b.removeAttribute("dir"),Ef(b,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,y,b),this.table.isAriaEnabled()){var o,a;qe(b,[...b.hasAttribute("role")?[]:[WX()],fh(-1),Ex(y+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}g.end()}}}function Qn(t,e,n){return(e=pee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=vee(t,"string");return typeof e=="symbol"?e:e+""}function vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wee{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qn(this,"rootNode",void 0),Qn(this,"rootDocument",void 0),Qn(this,"rowHeaders",null),Qn(this,"columnHeaders",null),Qn(this,"colGroup",null),Qn(this,"rows",null),Qn(this,"cells",null),Qn(this,"rowFilter",null),Qn(this,"columnFilter",null),Qn(this,"rowUtils",null),Qn(this,"columnUtils",null),Qn(this,"rowsToRender",0),Qn(this,"columnsToRender",0),Qn(this,"rowHeaderFunctions",[]),Qn(this,"rowHeadersCount",0),Qn(this,"columnHeaderFunctions",[]),Qn(this,"columnHeadersCount",0),Qn(this,"cellRenderer",void 0),Qn(this,"activeOverlayName",void 0),Qn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const a=this.renderedRowToSource(i),u=o.getHeightByOverlayName(a,this.activeOverlayName),d=this.stylesHandler.areCellsBorderBox()?0:1;u?r.firstChild.style.height=`${u-d}px`:r.firstChild.style.height=""}}}}class yee{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:a,cellRenderer:u,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new wee(e,{cellRenderer:u,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new see,columnHeaders:new aee(n),colGroup:new lee(i),rows:new dee(r),cells:new mee}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function D_(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class See{constructor(e,n){D_(this,"dataAccessObject",void 0),D_(this,"wtSettings",void 0),D_(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let a=Array.isArray(n)?n[o]:n;a=a??r,this.headerWidths.set(o,a)}}}}function oF(t,e,n){return(e=Ree(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ree(t){var e=Eee(t,"string");return typeof e=="symbol"?e:e+""}function Eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tee{constructor(e,n){oF(this,"dataAccessObject",void 0),oF(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function As(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _f{constructor(e,n,i,r,o){As(this,"wtSettings",null),As(this,"domBindings",void 0),As(this,"TBODY",null),As(this,"THEAD",null),As(this,"COLGROUP",null),As(this,"hasTableHeight",!0),As(this,"hasTableWidth",!0),As(this,"isTableVisible",!1),As(this,"tableOffset",0),As(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,hz(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new Tee(this.dataAccessObject,this.wtSettings),this.columnUtils=new See(this.dataAccessObject,this.wtSettings),this.tableRenderer=new yee({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&qe(i,[tl()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&qe(i,[tl()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ze(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",qe(i,[fh(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&qe(i.parentNode,[tl()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&qe(i,[tl()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),a=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),h=u.length,d=n.getSetting("columnHeaders"),g=d.length;let p=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=Wi(this.holder),p=r.createCalculators(p),h&&!n.getSetting("fixedColumnsStart"))){const y=i.inlineStartOverlay.getScrollPosition(),b=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,b!==this.correctHeaderWidth&&(p=!1)}if(p)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=Wi(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const y=Math.max(this.getFirstRenderedRow(),0),b=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new NJ(y,o,g),this.columnFilter=new HJ(b,a,h);let T=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const M={};this.wtSettings.getSetting("beforeDraw",!0,M),T=M.skipRender!==!0}T&&(this.tableRenderer.setHeaderContentRenderers(u,d),(this.is(Js)||this.is(Ru))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Js))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Js)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let w=!1;return this.isMaster&&(w=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(w=i.bottomOverlay.resetFixedPosition()||w),w=i.inlineStartOverlay.resetFixedPosition()||w,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),w?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(p),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,a,u;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),a=this.getColumnHeader(n,i),a&&(u=zm(a),(!o&&r<u||o<u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),Array.isArray(h)?h[i]!==null&&h[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(h[i]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,a=r.length;o<a;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Js))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!a&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,u=(r<0?this.THEAD:this.TBODY).childNodes[o];return u==null?void 0:u.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o==null?void 0:o.childNodes[r];a&&n.push(a)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Qc(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let o=fZ(i),a=n.cellIndex;Zu(rh,n,this.wtRootElement)||Zu(nh,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):Zu(Ru,n,this.wtRootElement)||Zu(Js,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Zu(rh,n,this.wtRootElement)||Zu(ih,n,this.wtRootElement)||Zu(Ru,n,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):this.columnFilter&&(a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a));const u=this.wtSettings.getSetting("onModifyGetCoordsElement",o,a);return u&&Array.isArray(u)&&([o,a]=u),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=zm(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),o=r?ni:zm,a=r?0:1,u=r?1:0;let h,d,g,p,w;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,g=this.rowFilter.renderedToSource(e),h=this.getRowHeight(g),p=this.getTrForRow(g),w=p.querySelector("th");const y=g===0?u:0;w?d=o(w):d=o(p)-a,(!h&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<d-y||h<d)&&(r||(d+=1),this.dataAccessObject.wtViewport.oversizedRows[g]=d)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return zn(this.TABLE)}getHeight(){return ni(this.TABLE)}getTotalWidth(){const e=zn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ni(this.hider);return e!==0?e:this.getHeight()}isVisible(){return af(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ut(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Oee="stickyRowsBottom",Lx={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};vl(Lx,"MIXIN_NAME",Oee,{writable:!1,enumerable:!1});const xee="stickyColumnsStart",Gb={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vl(Gb,"MIXIN_NAME",xee,{writable:!1,enumerable:!1});class kx extends _f{constructor(e,n,i,r){super(e,n,i,r,Ru)}}Xt(kx,Lx);Xt(kx,Gb);const nh="top",Js="bottom",ih="inline_start",rh="top_inline_start_corner",Ru="bottom_inline_start_corner",Kz=[nh,Js,ih,rh,Ru],Aee=new Map([[nh,`ht_clone_${nh}`],[Js,`ht_clone_${Js}`],[ih,`ht_clone_${ih} ht_clone_left`],[rh,`ht_clone_${rh} ht_clone_top_left_corner`],[Ru,`ht_clone_${Ru} ht_clone_bottom_left_corner`]]);function Hee(t,e){Iee(t,e),e.add(t)}function Iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pee(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:e+""}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Kg=new WeakSet;class Lee{constructor(e){Hee(this,Kg),Pee(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=Jr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:a,inlineStartOverlay:u}=this.dataAccessObject,h=n==="auto";if(h&&e<a)return!1;const d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();let p=!1;return(h&&(e<d||e>g)||!h)&&(p=u.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():n==="end")),p}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=Jr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:a,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject,d=n==="auto";if(d&&(e<u||e>r-a-1))return!1;const g=this.getFirstVisibleRow(),p=this.getLastVisibleRow();let w=!1;return(d&&(e<g||e>p)||!d)&&(w=h.scrollTo(e,d?e>=this.getLastPartiallyVisibleRow():n==="bottom")),w}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Iw(Kg,this,aF).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Iw(Kg,this,aF).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Iw(Kg,this,sF).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Iw(Kg,this,sF).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function sF(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(n.mainTableScrollableElement===a){const u=e.getSetting("rtlMode");let h=null;if(u){const g=i.TABLE.getBoundingClientRect(),w=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(g.right-w)}else h=Wi(i.wtRootElement).left;const d=Math.abs(fz(a,a));if(h>d){const g=gz(a);let p=r.getRowHeaderWidth();for(let w=1;w<=o;w++)if(p+=n.sumCellSizes(w-1,w),h+p-d>=g){t=w-2;break}}}return t}function aF(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const a=Wi(n.wtRootElement),u=Mx(o,o);if(a.top>u){const h=zm(o);let d=i.getColumnHeaderHeight();for(let g=1;g<=r;g++)if(d+=e.sumCellSizes(g-1,g),a.top+d-u>=h){t=g-2;break}}}return t}function mo(t,e,n){return(e=kee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:e+""}function Vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vx{get eventManager(){return new fs(this)}constructor(e,n){mo(this,"wtTable",void 0),mo(this,"wtScroll",void 0),mo(this,"wtViewport",void 0),mo(this,"wtOverlays",void 0),mo(this,"selectionManager",void 0),mo(this,"wtEvent",void 0),mo(this,"guid",`wt_${ez()}`),mo(this,"drawInterrupted",!1),mo(this,"drawn",!1),mo(this,"activeOverlayName","master"),mo(this,"domBindings",void 0),mo(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Lee(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Jc(i,e[n])}])}}createCellCoords(e,n){return new th(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Gp(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||mZ(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function lF(t,e,n){return(e=$ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=Bee(t,"string");return typeof e=="symbol"?e:e+""}function Bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fee extends Vx{constructor(e,n,i){super(e,n),lF(this,"cloneSource",void 0),lF(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Yz(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function Wee(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:e+""}function Uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kp{constructor(e,n,i,r,o){Wee(this,"wtSettings",null),vl(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:a,hider:u,spreader:h,holder:d,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=u,this.spreader=h,this.holder=d,this.wtRootElement=g,this.trimmingContainer=pp(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=pp(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=PC(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){Nt(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),a=n<this.wtSettings.getSetting("fixedRowsTop"),u=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(h),top:h.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop};let p=null;return r?p=this.getRelativeCellPositionWithinWindow(a,o,g,d):p=this.getRelativeCellPositionWithinHolder(a,u,o,g,d),p}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,u=0;if(!n)a=r.start;else{let h=o.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Si())),a=h<=0?-1*h:0}return e?u=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:u=r.top,{start:i.start+a,top:i.top+u}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let u=0,h=0;if(i||(u=a.horizontal-o.start),n){const d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(h=a.vertical-o.top);return{start:r.start-u,top:r.top-h}}makeClone(){if(Kz.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),a=i.createElement("table"),u=e.wtRootElement.parentNode;o.className=`${Aee.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&qe(o,[tl()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),u.appendChild(o);const d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===nh||d==="vertical"&&this.type===ih?this.mainTableScrollableElement=r:r.getComputedStyle(u).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=PC(e.TABLE),new Fee(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class zee extends Kp{constructor(e,n,i,r,o,a){super(e,n,Ru,i,r),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new kx(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${a}px`}else Wb(n),this.repositionOverlay();let i=ni(this.clone.wtTable.TABLE);const r=zn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Si(i)),r.style.bottom=`${o}px`}}const Yee="calculatedColumns",qb={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vl(qb,"MIXIN_NAME",Yee,{writable:!1,enumerable:!1});class $x extends _f{constructor(e,n,i,r){super(e,n,i,r,Js)}}Xt($x,Lx);Xt($x,qb);function Gee(t,e,n){return(e=qee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qee(t){var e=Kee(t,"string");return typeof e=="symbol"?e:e+""}function Kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xee extends Kp{constructor(e,n,i,r){super(e,n,Js,i,r),Gee(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new $x(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Si(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(_x(n),top),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,stylesHandler:r}=this.wot,o=r.getDefaultRowHeight();let a=e,u=0;for(;a<n;){const h=i.getRowHeight(a);u+=h===void 0?o:h,a+=1}return u}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=Si(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=ni(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;n&&o.offsetHeight!==o.clientHeight&&(a=Si(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=a,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mx(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o,u=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+r,0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const a=this.wot.wtTable.holder.parentNode,u=ze(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(pe(a,"innerBorderBottom"),o=!u):(Ue(a,"innerBorderBottom"),o=u)}return o}}const Zee="calculatedRows",Bx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vl(Bx,"MIXIN_NAME",Zee,{writable:!1,enumerable:!1});class Fx extends _f{constructor(e,n,i,r){super(e,n,i,r,ih)}}Xt(Fx,Bx);Xt(Fx,Gb);const Qee="localHooks",Ai={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,o,a){if(this._localHooks[t]){const u=this._localHooks[t].length;for(let h=0;h<u;h++)q1(this._localHooks[t][h],this,e,n,i,r,o,a)}},clearLocalHooks(){return this._localHooks={},this}};vl(Ai,"MIXIN_NAME",Qee,{writable:!1,enumerable:!1});let Xz=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};Xt(Xz,Ai);const Zz="active-header",Wx="header",jx="area",Ym="focus",Jee="fill",ete="row",tte="column",nte="custom-selection",Ux=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var uF={},cF;function ite(){if(cF)return uF;cF=1;var t=zb();return t("flat"),uF}ite();function rte(t,e){Qz(t,e),e.add(t)}function hF(t,e,n){Qz(t,e),e.set(t,n)}function Qz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(t,e){return t.get(Gm(t,e))}function dF(t,e,n){return t.set(Gm(t,e),n),n}function Gm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ko=new WeakMap,Vi=new WeakMap,Pw=new WeakSet;class ote{constructor(){rte(this,Pw),hF(this,Ko,void 0),hF(this,Vi,void 0)}setActiveOverlay(e){return dF(Vi,this,e),this}setActiveSelection(e){return dF(Ko,this,e),this}scan(){const e=En(Ko,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=En(Ko,this).getCorners(),{wtTable:a}=En(Vi,this),u=a.getRenderedColumnsCount(),h=a.getColumnHeadersCount();let d=0;for(let g=-a.getRowHeadersCount();g<u;g++){const p=a.columnFilter.renderedToSource(g);if(!(p<i||p>o)){for(let w=-h;w<0;w++){if(w<n||w>r)continue;const y=w+h;let b=a.getColumnHeader(p,y);const T=En(Vi,this).getSetting("onBeforeHighlightingColumnHeader",p,y,{selectionType:En(Ko,this).settings.selectionType,columnCursor:d,selectionWidth:o-i+1});T!==null&&(T!==p&&(b=a.getColumnHeader(T,y)),e(b))}d+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=En(Ko,this).getCorners(),{wtTable:a}=En(Vi,this),u=a.getRenderedRowsCount(),h=a.getRowHeadersCount();let d=0;for(let g=-a.getColumnHeadersCount();g<u;g++){const p=a.rowFilter.renderedToSource(g);if(!(p<n||p>r)){for(let w=-h;w<0;w++){if(w<i||w>o)continue;const y=w+h;let b=a.getRowHeader(p,y);const T=En(Vi,this).getSetting("onBeforeHighlightingRowHeader",p,y,{selectionType:En(Ko,this).settings.selectionType,rowCursor:d,selectionHeight:r-n+1});T!==null&&(T!==p&&(b=a.getRowHeader(T,y)),e(b))}d+=1}}}scanCellsRange(e){const{wtTable:n}=En(Vi,this);Gm(Pw,this,ste).call(this,(i,r)=>{const o=n.getCell(En(Vi,this).createCellCoords(i,r)),a=En(Vi,this).getSetting("onAfterDrawSelection",i,r,En(Ko,this).settings.layerLevel);typeof a=="string"&&pe(o,a),e(o)})}scanRowsInCellsRange(e){const[n,,i]=En(Ko,this).getCorners(),{wtTable:r}=En(Vi,this);Gm(Pw,this,fF).call(this,(o,a)=>{if(o>=n&&o<=i){const u=r.getCell(En(Vi,this).createCellCoords(o,a));e(u)}})}scanColumnsInCellsRange(e){const[,n,,i]=En(Ko,this).getCorners(),{wtTable:r}=En(Vi,this);Gm(Pw,this,fF).call(this,(o,a)=>{if(a>=n&&a<=i){const u=r.getCell(En(Vi,this).createCellCoords(o,a));e(u)}})}}function ste(t){let[e,n,i,r]=En(Ko,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=En(Vi,this),a=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),a){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const u=o.getCell(En(Vi,this).createCellCoords(e,n));if(!ul(u))return}for(let u=e;u<=i;u+=1)for(let h=n;h<=r;h+=1)t(u,h)}function fF(t){const{wtTable:e}=En(Vi,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let a=0;a<i;a+=1)t(o,e.columnFilter.renderedToSource(a))}}class gF{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ux(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ps(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function a(h){if(h.clientY<Math.floor(o.top)||h.clientY>Math.ceil(o.top+o.height)||h.clientX<Math.floor(o.left)||h.clientX>Math.ceil(o.left+o.width))return!0}function u(h){a(h)&&(i.eventManager.removeEventListener(r,"mousemove",u),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",u)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let u=0;u<5;u++){const h=i[u],d=n.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(d.className+=" hidden"),r=d.style,r.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,r.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,r.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),nl()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=n.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,i=n.getCSSVariableValue("cell-mobile-handle-size"),r=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),u=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const h=10,d=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const g={position:"absolute",height:`${d}px`,width:`${d}px`,"border-radius":`${parseInt(d/1.5,10)}px`};ft(g,(w,y)=>{this.selectionHandles.styles.bottomHitArea[y]=w,this.selectionHandles.styles.topHitArea[y]=w});const p=n.isClassicTheme()?{position:"absolute",height:`${h}px`,width:`${h}px`,"border-radius":`${parseInt(h/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${r}px`,background:`${o}`,border:`${a}px solid ${u}`};ft(p,(w,y)=>{this.selectionHandles.styles.bottom[y]=w,this.selectionHandles.styles.top[y]=w}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,a){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:g,bottom:p,bottomHitArea:w}=this.selectionHandles.styles,y=parseInt(d.borderWidth,10),b=parseInt(d.width,10),T=parseInt(g.width,10),M=this.wot.wtTable.getWidth(),I=this.wot.wtTable.getHeight();d.top=`${parseInt(i-b-1,10)}px`,d[h]=`${parseInt(r-b-1,10)}px`,g.top=`${parseInt(i-T/4*3,10)}px`,g[h]=`${parseInt(r-T/4*3,10)}px`;const _=Math.min(parseInt(r+o,10),M-b-y*2),N=Math.min(parseInt(r+o-T/4,10),M-T-y*2);p[h]=`${_}px`,w[h]=`${N}px`;const k=Math.min(parseInt(i+a,10),I-b-y*2),$=Math.min(parseInt(i+a-T/4,10),I-T-y*2);p.top=`${k}px`,w.top=`${$}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",g.display="block",this.isPartRange(e,n)?(p.display="none",w.display="none"):(p.display="block",w.display="block")):(d.display="none",p.display="none",g.display="none",w.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",g.zIndex="9999"):(d.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:a,rootDocument:u,rootWindow:h}=this.wot,d=n!==r||i!==o,g=a.getFirstRenderedRow(),p=a.getLastRenderedRow(),w=a.getFirstRenderedColumn(),y=a.getLastRenderedColumn();if(w<0&&y<0||g<0&&p<0){this.disappear();return}let b;if(d){if(i=Math.max(i,w),o=Math.min(o,y),n=Math.max(n,g),r=Math.min(r,p),o<i||r<n){this.disappear();return}b=a.getCell(this.wot.createCellCoords(n,i))}else if(b=a.getCell(this.wot.createCellCoords(n,i)),!ul(b)){this.disappear();return}const T=d?a.getCell(this.wot.createCellCoords(r,o)):b,M=Wi(b),I=d?Wi(T):M,_=Wi(a.TABLE),N=M.top,k=M.left,$=this.wot.wtSettings.getSetting("rtlMode");let L=0,F=0;if($){const fe=zn(a.TABLE),Te=zn(b),Ge=h.innerWidth-_.left-fe;F=k+Te-I.left,L=h.innerWidth-k-Te-Ge-1}else F=I.left+zn(T)-k,L=k-_.left-1;if(this.isEntireColumnSelected(n,r)){const fe=n,Te=this.getDimensionsFromHeader("columns",i,o,fe,_);let Ge=null;Te&&([Ge,L,F]=Te),Ge&&(b=Ge)}let he=N-_.top-1,le=I.top+ni(T)-N;if(this.isEntireRowSelected(i,o)){const fe=i,Te=this.getDimensionsFromHeader("rows",n,r,fe,_);let Ge=null;Te&&([Ge,he,le]=Te),Ge&&(b=Ge)}const G=h.getComputedStyle(b);parseInt(G.borderTopWidth,10)>0&&(he+=1,le=le>0?le-1:0),parseInt(G[$?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,F=F>0?F-1:0);const ye=$?"right":"left";this.topStyle.top=`${he}px`,this.topStyle[ye]=`${L}px`,this.topStyle.width=`${F}px`,this.topStyle.display="block",this.startStyle.top=`${he}px`,this.startStyle[ye]=`${L}px`,this.startStyle.height=`${le}px`,this.startStyle.display="block";const we=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${he+le-we}px`,this.bottomStyle[ye]=`${L}px`,this.bottomStyle.width=`${F}px`,this.bottomStyle.display="block",this.endStyle.top=`${he}px`,this.endStyle[ye]=`${L+F-we}px`,this.endStyle.height=`${le+1}px`,this.endStyle.display="block";let Me=this.settings.border.cornerVisible;Me=typeof Me=="function"?Me(this.settings.layerLevel):Me;const Ee=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[_e,se]=[r,o];if(Ee&&Array.isArray(Ee)&&([,,_e,se]=Ee),nl()||!Me||this.isPartRange(_e,se))this.cornerStyle.display="none";else{this.cornerStyle.top=`${he+le+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[ye]=`${L+F+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let fe=pp(a.TABLE);const Te=fe===h;Te&&(fe=u.documentElement);const Ge=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,B=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),ue=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const C=Te?T.getBoundingClientRect().left:T.offsetLeft;let S=!1,R=0;$?(R=C-parseInt(this.cornerDefaultStyle.width,10)/2,S=R<0):(R=C+zn(T)+parseInt(this.cornerDefaultStyle.width,10)/2,S=R>=gz(fe)),S&&(this.cornerStyle[ye]=`${Math.floor(L+F+this.cornerCenterPointOffset-B-Ge)}px`,this.cornerStyle[$?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const R=(Te?T.getBoundingClientRect().top:T.offsetTop)+ni(T)+parseInt(this.cornerDefaultStyle.height,10)/2>=zm(fe),P=this.wot.stylesHandler.isClassicTheme();if(R){const V=Math.floor(he+le+this.cornerCenterPointOffset-ue-Ge);P?(this.cornerStyle.top=`${V}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${V-1}px`}}this.cornerStyle.display="block"}nl()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,he,L,F,le)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:a}=this.wot,u=a.wtRootElement.parentNode;let h=null,d=null,g=null,p=null,w=null,y=null,b=null,T=null;switch(e){case"rows":h=function(){return a.getRowHeader(...arguments)},d=function(){return ni(...arguments)},g="ht__selection--rows",y="top";break;case"columns":h=function(){return a.getColumnHeader(...arguments)},d=function(){return zn(...arguments)},g="ht__selection--columns",y="left";break}if(u.classList.contains(g)){const M=this.wot.getSetting("columnHeaders").length;if(b=h(n,M-r),T=h(i,M-r),!b||!T)return!1;const I=Wi(b),_=Wi(T);return b&&T&&(p=I[y]-o[y]-1,w=_[y]+d(T)-I[y]),[b,p,w]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?pe(this[e],"hidden"):(ze(this[e],"hidden")&&Ue(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?pe(this[e],"hidden"):Ue(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",nl()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function ate(t,e){Jz(t,e),e.add(t)}function id(t,e,n){Jz(t,e),e.set(t,n)}function Jz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(zx(t,e))}function mF(t,e,n){return t.set(zx(t,e),n),n}function zx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $i=new WeakMap,Sr=new WeakMap,L_=new WeakMap,Lm=new WeakMap,k_=new WeakMap,ec=new WeakMap,pF=new WeakSet;class lte{constructor(e){ate(this,pF),id(this,$i,void 0),id(this,Sr,void 0),id(this,L_,new ote),id(this,Lm,new WeakMap),id(this,k_,new WeakSet),id(this,ec,new Map),mF(Sr,this,e)}setActiveOverlay(e){return mF($i,this,e),ct(L_,this).setActiveOverlay(ct($i,this)),ct(Lm,this).has(ct($i,this))||ct(Lm,this).set(ct($i,this),new Set),this}getFocusSelection(){return ct(Sr,this)!==null?ct(Sr,this).getFocus():null}getAreaSelection(){return ct(Sr,this)!==null?ct(Sr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ct(ec,this).has(e)){const i=ct(ec,this).get(e);if(i.has(ct($i,this)))return i.get(ct($i,this));const r=new gF(ct($i,this),e.settings);return i.set(ct($i,this),r),r}const n=new gF(ct($i,this),e.settings);return ct(ec,this).set(e,new Map([[ct($i,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=ct(ec,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){ct(ec,this).get(e).forEach(n=>n.destroy()),ct(ec,this).delete(e)}render(e){if(ct(Sr,this)===null)return;e&&zx(pF,this,ute).call(this);const n=Array.from(ct(Sr,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const a=n[o],{className:u,headerAttributes:h,createLayers:d,selectionType:g}=a.settings;ct(k_,this).has(a)||(ct(k_,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const p=this.getBorderInstance(a);if(a.isEmpty()){p==null||p.disappear();continue}u&&ct(L_,this).setActiveSelection(a).scan().forEach(b=>{if(i.has(b)){const T=i.get(b);T.has(u)&&d===!0?T.set(u,T.get(u)+1):T.set(u,1)}else i.set(b,new Map([[u,1]]));h&&(r.has(b)||r.set(b,[]),b.nodeName==="TH"&&r.get(b).push(...h))});const w=a.getCorners();ct($i,this).getSetting("onBeforeDrawBorders",w,g),p==null||p.appear(w)}i.forEach((o,a)=>{var u;const h=Array.from(o).map(d=>{let[g,p]=d;return p===1?g:[g,...Array.from({length:p-1},(w,y)=>`${g}-${y+1}`)]}).flat();h.forEach(d=>ct(Lm,this).get(ct($i,this)).add(d)),pe(a,h),a.nodeName==="TD"&&Array.isArray((u=ct(Sr,this).options)===null||u===void 0?void 0:u.cellAttributes)&&qe(a,ct(Sr,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{qe(o,[...r.get(o)])})}}function ute(){const t=ct(Lm,this).get(ct($i,this)),e=ct($i,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=ct($i,this).wtTable.TABLE.querySelectorAll(`.${n}`);let a=[];Array.isArray((i=ct(Sr,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(a=ct(Sr,this).options.cellAttributes.map(u=>u[0])),Array.isArray((r=ct(Sr,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(a=[...a,...ct(Sr,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=o.length;u<h;u++)Ue(o[u],n),Ef(o[u],a)}),t.clear()}class cte extends Kp{constructor(e,n,i,r){super(e,n,ih,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Fx(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Ox(i,`${o}px`,"0px")):(o=this.getScrollPosition(),Wb(i));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,dz(n)),i=o!==n.scrollX}else if(e!==r.scrollLeft){const o=r.scrollLeft;r.scrollLeft=e,i=o!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="vertical"){let d=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(d-=Si(i)),d=Math.min(d,e.wtRootElement.scrollHeight),a.height=`${d}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const h=zn(this.clone.wtTable.TABLE);a.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=Ux(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),u=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=o===0&&r.length>0&&!ze(u.parentNode,"innerBorderInlineStart")?1:0;let d=this.getTableParentOffset(),g=0;if(n){const p=this.wot.wtTable.getColumnWidth(e),w=this.wot.wtViewport.getViewportWidth();p>w&&(n=!1)}return n&&u.offsetWidth!==u.clientWidth&&(g=Si(this.domBindings.rootDocument)),n?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=h):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=g,vZ(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(fz(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=r-o;i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=n.getSetting("totalRows"),u=n.getSetting("preventOverflow")==="vertical";a?Ue(i,"emptyRows"):pe(i,"emptyRows");let h=!1;if(!u){if(o&&!r.length)pe(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const d=ze(i,"innerBorderInlineStart");e?(pe(i,"innerBorderLeft innerBorderInlineStart"),h=!d):(Ue(i,"innerBorderLeft innerBorderInlineStart"),h=d)}}return h}}const hte="stickyRowsTop",Yx={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vl(Yx,"MIXIN_NAME",hte,{writable:!1,enumerable:!1});class Gx extends _f{constructor(e,n,i,r){super(e,n,i,r,rh)}}Xt(Gx,Yx);Xt(Gx,Gb);function vF(t,e,n){return(e=dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dte(t){var e=fte(t,"string");return typeof e=="symbol"?e:e+""}function fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gte extends Kp{constructor(e,n,i,r,o,a){super(e,n,rh,i,r),vF(this,"topOverlay",void 0),vF(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Gx(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ox(e,`${r}px`,`${o}px`)}else Wb(e);let n=ni(this.clone.wtTable.TABLE);const i=zn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class qx extends _f{constructor(e,n,i,r){super(e,n,i,r,nh)}}Xt(qx,Yx);Xt(qx,qb);function mte(t,e,n){return(e=pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pte(t){var e=vte(t,"string");return typeof e=="symbol"?e:e+""}function vte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wte extends Kp{constructor(e,n,i,r){super(e,n,nh,i,r),mte(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new qx(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:u}=this.wot,h=u.hider.getBoundingClientRect(),d=Math.ceil(h.bottom),g=e.offsetHeight;o=d===g,r=this.getOverlayOffset(),Ox(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Wb(e);const a=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(_x(n),e),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wot.stylesHandler.getDefaultRowHeight();let r=e,o=0;for(;r<n;){const a=this.wot.wtTable.getRowHeight(r);o+=a===void 0?i:a,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=Si(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=ni(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=Ux(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,a=(i.cloneSource?i.cloneSource:i).wtTable.holder,u=r.getSetting("columnHeaders"),d=r.getSetting("fixedRowsTop")===0&&u.length>0&&!ze(a.parentNode,"innerBorderTop")?1:0;let g=this.getTableParentOffset(),p=0;if(n){const w=this.wot.wtTable.getRowHeight(e),y=this.wot.wtViewport.getViewportHeight();w>y&&(n=!1)}if(n&&a.offsetHeight!==a.clientHeight&&(p=Si(this.domBindings.rootDocument)),n){const w=r.getSetting("fixedRowsBottom"),y=r.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=i.wtViewport.getViewportHeight()-this.sumCellSizes(y-w,y),g+=1,g+=d}else g+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return g+=p,pZ(this.mainTableScrollableElement)===g-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mx(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),a=i.getSetting("preventOverflow")==="horizontal";o?Ue(r,"emptyColumns"):pe(r,"emptyColumns");let u=!1;if(!n&&!a){const h=i.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==h,g=i.getSetting("columnHeaders");if((d||h===0)&&g.length>0){const p=ze(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(pe(r,"innerBorderTop"),u=!p):(Ue(r,"innerBorderTop"),u=p)}}return u}}function Nw(t,e,n){yte(t,e),e.set(t,n)}function yte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=bte(t,"string");return typeof e=="symbol"?e:e+""}function bte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tc(t,e,n){return t.set(eY(t,e),n),n}function Ha(t,e){return t.get(eY(t,e))}function eY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rd=new WeakMap,Dw=new WeakMap,od=new WeakMap,Lw=new WeakMap;class Ste{constructor(e,n,i,r,o,a){Aa(this,"wot",null),Nw(this,rd,[]),Aa(this,"topOverlay",null),Aa(this,"bottomOverlay",null),Aa(this,"inlineStartOverlay",null),Aa(this,"topInlineStartCornerOverlay",null),Aa(this,"bottomInlineStartCornerOverlay",null),Aa(this,"browserLineHeight",void 0),Aa(this,"wtSettings",null),Nw(this,Dw,!1),Nw(this,od,0),Nw(this,Lw,null),Aa(this,"resizeObserver",new ResizeObserver(g=>{DC(()=>{!Array.isArray(g)||!g.length||(tc(od,this,Ha(od,this)+1),Ha(od,this)===100&&(Nt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Ha(Lw,this)!==null&&clearTimeout(Ha(Lw,this)),tc(Lw,this,setTimeout(()=>{tc(od,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=a;const{rootDocument:u,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Si(u);const d=h.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?a.holder:PC(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Ha(rd,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new wte(...e),this.bottomOverlay=new Xee(...e),this.inlineStartOverlay=new cte(...e),this.topInlineStartCornerOverlay=new gte(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new zee(...e,this.bottomOverlay,this.inlineStartOverlay),tc(rd,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){tc(Dw,this,Ha(rd,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Ha(rd,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Ha(rd,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",p=>this.onKeyDown(p)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",p=>this.onTableScroll(p),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",p=>this.onTableScroll(p),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,a=this.scrollableElement===n,u=this.wtSettings.getSetting("preventWheel"),h={passive:a};(u||o||!Ez())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",p=>this.onCloneWheel(p,u),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(p=>{this.eventManager.addEventListener(p.clone.wtTable.holder,"wheel",w=>this.onCloneWheel(w,u),h)});let g;this.eventManager.addEventListener(n,"resize",()=>{DC(()=>{clearTimeout(g),this.wtSettings.getSetting("onWindowResize"),g=setTimeout(()=>{tc(od,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,u=o!==i&&a!==i&&!a.contains(o),h=r!==i&&a!==i&&!a.contains(r);if(this.keyPressed&&(u||h)||this.scrollableElement===i)return;const d=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Yp(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Ha(Dw,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),tc(Dw,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=PC(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),u=e.getRowHeaderWidth(),d=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,g=u+this.inlineStartOverlay.sumCellSizes(0,o),w=n.hider.style,y=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,d-n.holder.clientHeight),b=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,g-n.holder.clientWidth),T=y()?1:0,M=b()?1:0;w.width=`${g+M}px`,w.height=`${d+T}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return U(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];U(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function wF(t,e,n){return(e=Rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rte(t){var e=Ete(t,"string");return typeof e=="symbol"?e:e+""}function Ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tte{constructor(e){wF(this,"settings",{}),wF(this,"defaults",Object.freeze(this.getDefaults())),ft(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Jc(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?ft(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Kx extends _f{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=pp(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=NC(e,"height",n),o=NC(e,"overflow",n),a=this.holder.style,{scrollWidth:u,scrollHeight:h}=e;let d=e.offsetWidth,g=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const w=e.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",e.nextElementSibling?i.insertBefore(w,e.nextElementSibling):i.appendChild(w);const y=parseInt(n.getComputedStyle(w).height,10);i.removeChild(w),y===0&&(g=0)}g=Math.min(g,h),a.height=r==="auto"?"auto":`${g}px`,d=Math.min(d,u),a.width=`${d}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:g>0,this.hasTableWidth=d>0}this.isTableVisible=af(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const u=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let d=0;d<o;d++)for(let g=-1*u;g<h;g++)this.markIfOversizedColumnHeader(g);n.hasOversizedColumnHeadersMarked[i]=!0}}}Xt(Kx,Bx);Xt(Kx,qb);class _te{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new rJ:new cJ],["fullyVisible",()=>new qQ],["partiallyVisible",()=>new Fz]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new tJ:new aJ],["fullyVisible",()=>new zQ],["partiallyVisible",()=>new Bz]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=ni(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,i=e.clientWidth,r=n.offsetWidth;return i<r?!0:r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return Wi(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ni(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=zn(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let u=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=n.getSetting("fixedRowsTop"),d=n.getSetting("fixedRowsBottom"),g=n.getSetting("totalRows");return h&&u>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,h),u+=a,r-=a),d&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(g-d,g),r-=a),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=Si(this.domBindings.rootDocument),new wJ({calculationTypes:e.map(p=>[p,this.rowsCalculatorTypes.get(p)()]),viewportHeight:r,scrollOffset:u,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:p=>i.getRowHeight(p),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=n.getSetting("fixedColumnsStart");if(a&&o>=0){const u=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=u,r-=u}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=Si(this.domBindings.rootDocument)),new mJ({calculationTypes:e.map(u=>[u,this.columnsCalculatorTypes.get(u)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:u=>i.getColumnWidth(u),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:o,rowStartOffset:a,rowEndOffset:u}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(a,d)),i=Math.min(h,i+Math.min(u,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(a/2)),i=Math.min(h,i+Math.ceil(u/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:o,columnStartOffset:a,columnEndOffset:u}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(a,d)),i=Math.min(h,i+Math.min(u,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(a/2)),i=Math.min(h,i+Math.ceil(u/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<h)}resetHasOversizedColumnHeadersMarked(){ft(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}function Mte(t,e){tY(t,e),e.add(t)}function nc(t,e,n){tY(t,e),e.set(t,n)}function tY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fn(t,e){return t.get(rs(t,e))}function is(t,e,n){return t.set(rs(t,e),n),n}function rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yF=23;var js=new WeakMap,Qa=new WeakMap,Xx=new WeakMap,nO=new WeakMap,ou=new WeakMap,km=new WeakMap,wp=new WeakMap,Ys=new WeakSet;class Ote{constructor(e){Mte(this,Ys),nc(this,js,void 0),nc(this,Qa,void 0),nc(this,Xx,void 0),nc(this,nO,void 0),nc(this,ou,!0),nc(this,km,{}),nc(this,wp,{}),is(Qa,this,e.rootTable.parentElement.parentElement),is(nO,this,e.rootDocument)}isClassicTheme(){return fn(ou,this)}getCSSVariableValue(e){var n;if(fn(ou,this))return null;if(fn(km,this)[`--ht-${e}`])return fn(km,this)[`--ht-${e}`];const i=(n=rs(Ys,this,Ite).call(this,`--ht-${e}`))!==null&&n!==void 0?n:rs(Ys,this,nY).call(this,`--ht-${e}`);if(i!==null)return fn(km,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=fn(wp,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(fn(ou,this))return yF;const e=rs(Ys,this,xte).call(this);return!e&&ze(fn(Qa,this),"ht-wrapper")?(Nt(`The "${fn(js,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),is(ou,this,!0),this.useTheme(),yF):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){rs(Ys,this,CF).call(this),is(ou,this,!0),is(js,this,e||void 0);return}e&&e!==fn(js,this)&&(fn(js,this)&&rs(Ys,this,Pte).call(this),is(js,this,e),is(ou,this,!1),rs(Ys,this,Ate).call(this),rs(Ys,this,CF).call(this))}getThemeName(){return fn(js,this)}removeClassNames(){ze(fn(Qa,this),fn(js,this))&&Ue(fn(Qa,this),fn(js,this))}}function xte(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Ate(){Ue(fn(Qa,this),/ht-theme-.*/g),pe(fn(Qa,this),fn(js,this))}function CF(){this.isClassicTheme()||is(Xx,this,getComputedStyle(fn(Qa,this)));const t=rs(Ys,this,Hte).call(this,["box-sizing","border-bottom-width"]);fn(wp,this).td={...fn(wp,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Hte(t){const e=fn(nO,this),n=fn(Qa,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),a=e.createElement("tr"),u=e.createElement("td");a.appendChild(u),r.appendChild(o),r.appendChild(a),i.appendChild(r),n.appendChild(i);const h=getComputedStyle(u),d={};return t.forEach(g=>{d[g]=h.getPropertyValue(g)}),n.removeChild(i),d}function Ite(t){const e=Math.ceil(parseFloat(rs(Ys,this,nY).call(this,t)));return Number.isNaN(e)?null:e}function nY(t){const e=fn(Xx,this).getPropertyValue(t);return e===""?null:e}function Pte(){is(wp,this,{}),is(km,this,{}),is(ou,this,!0)}class Nte extends Vx{constructor(e,n){super(e,new Tte(n)),this.stylesHandler=new Ote(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new Kx(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new _te(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new lte(this.wtSettings.getSetting("selections")),this.wtEvent=new Yz(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Ste(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];ft(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),Ue(this.wtTable.wtRootElement.parentNode,n),pe(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!Kz.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Zx{constructor(e){e instanceof Vx?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new Zx(n);return()=>i},this._wot=new Nte(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function bF(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:a,cellCoordsFactory:u}=t;const h=o.isSelected()?o.getSelectedRange().current():null,d=o.isSelectedByCorner(),g=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&h)r.row>=0&&r.col>=0&&!a.cell?o.setRangeEnd(r):(d||g)&&r.row>=0&&r.col>=0&&!a.cell?o.setRangeEnd(u(r.row,r.col)):d&&r.row<0&&!a.column?o.setRangeEnd(u(h.to.row,r.col)):g&&r.col<0&&!a.row?o.setRangeEnd(u(r.row,h.to.col)):(!d&&!g&&r.col<0||d&&r.col<0)&&!a.row?o.selectRows(Math.max(h.from.row,0),r.row,r.col):(!d&&!g&&r.row<0||g&&r.row<0)&&!a.column&&o.selectColumns(Math.max(h.from.col,0),r.col,r.row);else{const p=!o.inInSelection(r),w=n||i&&p;r.row<0&&r.col>=0&&!a.column?w&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!a.row?w&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!a.cell?w&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Dte(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const a=i.isSelectedByRowHeader(),u=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),u&&!r.column?i.setRangeEnd(o(d-1,n.col)):a&&!r.row?i.setRangeEnd(o(n.row,h-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const Lte=new Map([["mousedown",bF],["mouseover",Dte],["touchstart",bF]]);function SF(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:o}=e;Lte.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Hx(t)||t.type==="touchstart",isRightClick:eh(t)})}const iY=new WeakMap,Qx=Symbol("rootInstance");function kte(t){iY.set(t,!0)}function Vte(t){return t===Qx}function cC(t){return iY.has(t)}function $te(t,e){rY(t,e),e.add(t)}function zl(t,e,n){rY(t,e),e.set(t,n)}function rY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e,n){return(e=Bte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:e+""}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jn(t,e){return t.get(tf(t,e))}function fr(t,e,n){return t.set(tf(t,e),n),n}function tf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var V_=new WeakMap,kw=new WeakMap,Vw=new WeakMap,Ia=new WeakMap,Uo=new WeakMap,$_=new WeakMap,B_=new WeakMap,sd=new WeakMap,Vm=new WeakSet;class Wte{constructor(e){$te(this,Vm),Yl(this,"hot",void 0),Yl(this,"eventManager",void 0),Yl(this,"settings",void 0),Yl(this,"THEAD",void 0),Yl(this,"TBODY",void 0),Yl(this,"_wt",void 0),Yl(this,"activeWt",void 0),zl(this,V_,0),zl(this,kw,0),Yl(this,"postponedAdjustElementsSize",!1),zl(this,Vw,!1),zl(this,Ia,void 0),zl(this,Uo,void 0),zl(this,$_,0),zl(this,B_,0),zl(this,sd,null),this.hot=e,this.eventManager=new fs(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),tf(Vm,this,Ute).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),pe(e,"handsontable"),fr(Uo,this,n.createElement("TABLE")),pe(jn(Uo,this),"htCore"),this.hot.getSettings().tableClassName&&pe(jn(Uo,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(qe(jn(Uo,this),[tl()]),qe(e,[FX(),sz(-1),Bb(this.hot.countCols()),tZ()])),this.THEAD=n.createElement("THEAD"),jn(Uo,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),jn(Uo,this).appendChild(this.TBODY),this.hot.table=jn(Uo,this),this.hot.container.insertBefore(jn(Uo,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",u=>{fr(Vw,this,!0),this.isTextSelectionAllowed(u.target)||(oB(r),u.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{fr(Vw,this,!1)}),this.eventManager.addEventListener(e,"mousemove",u=>{jn(Vw,this)&&!this.isTextSelectionAllowed(u.target)&&(this.settings.fragmentSelection&&oB(r),u.preventDefault())}),this.eventManager.addEventListener(o,"keyup",u=>{i.isInProgress()&&!u.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",u=>{i.isInProgress()&&Hx(u)&&i.finish(),fr(Ia,this,!1);const h=wz(n.activeElement);uC(n.activeElement)&&!h||(h||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(u.target)&&!eh(u))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",u=>{i.isInProgress()&&eh(u)&&(i.finish(),fr(Ia,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),fr(Ia,this,!1)}),this.eventManager.addEventListener(o,"mousedown",u=>{const h=u.target,d=u.x||u.clientX,g=u.y||u.clientY;let p=u.target;if(jn(Ia,this)||!e||!this.hot.view)return;const{holder:w}=this._wt.wtTable;if(p===w){const b=Si(n);if(n.elementFromPoint(d+b,g)!==w||n.elementFromPoint(d,g+b)!==w)return}else for(;p!==o;){if(p===null){if(u.isTargetWebComponent)break;return}if(p===e)return;p=p.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=sf(r);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=sf(a);this.eventManager.addEventListener(jn(Uo,this),"selectstart",u=>{this.settings.fragmentSelection||uC(u.target)||u.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),a=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let u=0;return n<0?u=a+1:n>0&&(u=r-a),u}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&pe(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&Ue(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:jn(Uo,this),isDataViewInstance:()=>cC(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,u)=>{const h=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(h,u)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),fr(kw,this,o.length),this.hot.getSettings().ariaTags&&tf(Vm,this,oY).call(this)===this.hot.countCols()&&tf(Vm,this,jte).call(this,jn(kw,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,u)=>{const h=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(h,u)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),fr(V_,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const u=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),h=u===null?o:u;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,a)},cellRenderer:(o,a,u)=>{const[h,d]=this.translateFromRenderableToVisualIndex(o,a),g=this.hot.runHooks("modifyGetCellCoords",h,d,!1,"meta");let p=h,w=d;Array.isArray(g)&&([p,w]=g);const y=this.hot.getCellMeta(p,w),b=this.hot.colToProp(w);let T=this.hot.getDataAtRowProp(p,b);this.hot.hasHook("beforeValueRender")&&(T=this.hot.runHooks("beforeValueRender",T,y)),this.hot.runHooks("beforeRenderer",u,h,d,b,T,y),this.hot.getCellRenderer(y)(this.hot,u,h,d,b,T,y),this.hot.runHooks("afterRenderer",u,h,d,b,T,y)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&af(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,fr(Ia,this,!0),fr(sd,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,d,u,g),!$c(o)&&(SF(o,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(p,w)=>this.hot._createCellCoords(p,w)}),this.hot.runHooks("afterOnCellMouseDown",o,d,u),this.activeWt=this._wt)},onCellContextMenu:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,fr(Ia,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,d,u),!$c(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,d,u),this.activeWt=this._wt)},onCellMouseOut:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",o,d,u),!$c(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,d,u),this.activeWt=this._wt)},onCellMouseOver:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",o,d,u,g),!$c(o)&&(jn(Ia,this)&&(!jn(sd,this)||jn(sd,this).x!==o.clientX||jn(sd,this).y!==o.clientY)&&SF(o,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(p,w)=>this.hot._createCellCoords(p,w)}),this.hot.runHooks("afterOnCellMouseOver",o,d,u),this.activeWt=this._wt,fr(sd,this,null))},onCellMouseUp:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",o,d,u),!($c(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,d,u),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,a)=>{const u=this.hot.rowIndexMapper,h=o<0;let d=o;return!h&&(d=u.getVisualFromRenderableIndex(o),d===null)?o:(d=this.hot.runHooks("beforeViewportScrollVertically",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onBeforeViewportScrollHorizontally:(o,a)=>{const u=this.hot.columnIndexMapper,h=o<0;let d=o;return!h&&(d=u.getVisualFromRenderableIndex(o),d===null)?o:(d=this.hot.runHooks("beforeViewportScrollHorizontally",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,u)=>{const h=this.hot.rowIndexMapper,d=o<0;let g=o;d||(g=h.getVisualFromRenderableIndex(o));const p=this.hot.runHooks("beforeHighlightingRowHeader",g,a,u);return d?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:(o,a,u)=>{const h=this.hot.columnIndexMapper,d=o<0;let g=o;d||(g=h.getVisualFromRenderableIndex(o));const p=this.hot.runHooks("beforeHighlightingColumnHeader",g,a,u);return d?p:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:(o,a,u)=>{let h;const[d,g]=this.translateFromRenderableToVisualIndex(o,a),p=this.hot.selection.getSelectedRange();if(p.size()>0){const y=p.peekByIndex(u??0);h=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.hot.runHooks("afterDrawSelection",d,g,h,u)},onBeforeDrawBorders:(o,a)=>{const[u,h,d,g]=o,p=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",p,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,u,h)=>{const d=this.hot.rowIndexMapper,g=this.hot.columnIndexMapper,p=a>=0?g.getVisualFromRenderableIndex(a):a,w=o>=0?d.getVisualFromRenderableIndex(o):o,y=this.hot.runHooks("modifyGetCellCoords",w,p,u,h);if(Array.isArray(y)){const[b,T,M,I]=y;return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,T>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(T,1)):T,M>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(M,-1)):M,I>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(I,-1)):I]}},onModifyGetCoordsElement:(o,a)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=a>=0?h.getVisualFromRenderableIndex(a):a,g=o>=0?u.getVisualFromRenderableIndex(o):o,p=this.hot.runHooks("modifyGetCoordsElement",g,d);if(Array.isArray(p)){const[w,y]=p;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,y>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1)):y]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const u=this.countRenderableRows(),h=o.startRow,d=o.endRow;if(typeof a=="number")o.startRow=Math.max(h-a,0),o.endRow=Math.min(d+a,u-1);else if(a==="auto"){const g=Math.max(1,Math.ceil(d/u*12));o.startRow=Math.max(h-g,0),o.endRow=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const u=this.countRenderableColumns(),h=o.startColumn,d=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(h-a,0),o.endColumn=Math.min(d+a,u-1)),a==="auto"){const g=Math.max(1,Math.ceil(d/u*6));o.startColumn=Math.max(h-g,0),o.endColumn=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Zx(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(uC(e))return!0;const n=Kc(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return jn(Ia,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!ze(i,"relative")){hl(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),a=i.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,r),o.appendChild(a),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(n.firstChild){const a=n.firstChild;ze(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,i,r),a.className="",pe(a,["relative",...o()])):(hl(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:a}=this.hot,u=a.createElement("div"),h=a.createElement("span"),d=o();u.classList.add("relative",...d),h.className="colHeader",this.settings.ariaTags&&(qe(u,...tl()),qe(h,...tl())),this.updateCellHeader(h,e,i,r),u.appendChild(h),n.appendChild(u)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ze(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(n):ze(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(n))),o>-1?Tf(e,i(n,r)):(Jc(e," "),pe(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){fr($_,this,e),fr(B_,this,n)}getLastSize(){return{width:jn($_,this),height:jn(B_,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return jn(V_,this)}getRowHeadersCount(){return jn(kw,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function oY(){return parseInt(this.hot.rootElement.getAttribute(Bb()[0]),10)}function jte(t){const e=tf(Vm,this,oY).call(this)+t;qe(this.hot.rootElement,...Bb(e))}function Ute(){const t=this.hot.rootElement;this.hasVerticalScroll()?pe(t,"htHasScrollY"):Ue(t,"htHasScrollY"),this.hasHorizontalScroll()?pe(t,"htHasScrollX"):Ue(t,"htHasScrollX")}var RF={},EF={},TF;function zte(){if(TF)return EF;TF=1;var t=rn(),e=oi(),n=Cf(),i=Or(),r=ai(),o=sa(),a=eo(),u=Au(),h=u("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{every:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var p=o(this),w=0;return!n(p,function(y,b){if(!g(y,w++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),EF}var _F;function Yte(){return _F||(_F=1,zte()),RF}Yte();const Gte="ABCDEFGHIJKLMNOPQRSTUVWXYZ",MF=Gte.length;function qte(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%MF,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/MF,10);return n}function sY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((a,u)=>{i.push([o+e,u,a])}):Object.keys(r).forEach(a=>{i.push([o+e,a,r[a]])})}),i}function aY(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&dt(t[0])&&(e=Ax(t[0]))),e}function Kte(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Xte(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Xg(t,e,n){return(e=Zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:e+""}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jte{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Xg(this,"hot",void 0),Xg(this,"data",void 0),Xg(this,"dataType","array"),Xg(this,"colToProp",()=>{}),Xg(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return U(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:a}=this.hot.getSettings();let u=null,h=null;if(u=this.modifyRowData(e),Array.isArray(u))h=[],o?u.forEach((d,g)=>{h[g]=this.getAtPhysicalCell(e,g,u)}):Ve(n,i,d=>{h[d-n]=this.getAtPhysicalCell(e,d,u)});else if(dt(u)||Ut(u))if(r?h=[]:h={},!o||r){const g=this.countFirstRowKeys()-1;Ve(0,g,p=>{const w=this.colToProp(p);if(p>=(n||0)&&p<=(i||g)&&!Number.isInteger(w)){const y=this.getAtPhysicalCell(e,w,u);r?h.push(y):a?d_(h,w,y):h[w]=y}})}else ft(u,(d,g)=>{const p=this.getAtPhysicalCell(e,g,u);a?d_(h,g,p):h[g]=p});return h}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Jr(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:d_(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?_Z(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=Jr(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,a=null,u=null,h=null;e===null||n===null?(r=!0,o=0,u=this.countRows()-1):(o=Math.min(e.row,n.row),a=Math.min(e.col,n.col),u=Math.max(e.row,n.row),h=Math.max(e.col,n.col));const d=[];return Ve(o,u,g=>{d.push(r?this.getAtRow(g,void 0,void 0,i):this.getAtRow(g,a,h,i))}),d}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return aY(this.data)}destroy(){this.data=null,this.hot=null}}var OF={},xF={},AF;function ene(){if(AF)return xF;AF=1;var t=rn(),e=oi(),n=Cf(),i=Or(),r=ai(),o=sa(),a=eo(),u=Au(),h=u("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var p=o(this),w=0;return n(p,function(y,b){if(g(y,w++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),xF}var HF;function tne(){return HF||(HF=1,ene()),OF}tne();function IF(t,e,n){return(e=nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nne(t){var e=ine(t,"string");return typeof e=="symbol"?e:e+""}function ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;IF(this,"indexedValues",[]),IF(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ut(this.initValueOrFn)?Ve(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Ve(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Xt(mh,Ai);function Jx(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,a)=>Ut(i)?i(o,a):i),...r===void 0?[]:t.slice(r)]}function eA(t,e){return Zc(t,(n,i)=>e.includes(i)===!1)}class Iu extends mh{insert(e,n){this.indexedValues=Jx(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=eA(this.indexedValues,e),super.remove(e)}}class Kb extends Iu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return xr(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function tA(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function yp(t,e){return Zc(t,n=>e.includes(n)===!1)}function nA(t,e){return St(t,n=>n-e.filter(i=>i<n).length)}function iA(t,e){const n=e[0],i=e.length;return St(t,r=>r>=n?r+i:r)}function rne(t,e,n){return(e=one(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function one(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xb extends mh{constructor(){super(...arguments),rne(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=yp(this.orderOfIndexes,[e]),Ut(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Jx(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=iA(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=eA(this.indexedValues,e),this.orderOfIndexes=yp(this.orderOfIndexes,e),this.orderOfIndexes=nA(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Xp extends Iu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return xr(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const PF=new Map([["indexesSequence",{getListWithInsertedItems:tA,getListWithRemovedItems:yp}],["physicallyIndexed",{getListWithInsertedItems:Jx,getListWithRemovedItems:eA}]]),lY=t=>{if(PF.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return PF.get(t)};class uY extends mh{constructor(){super(e=>e)}insert(e,n){const i=iA(this.indexedValues,n);this.indexedValues=tA(i,e,n),super.insert(e,n)}remove(e){const n=yp(this.indexedValues,e);this.indexedValues=nA(n,e),super.remove(e)}}const NF=new Map([["hiding",Kb],["index",mh],["linkedPhysicalIndexToValue",Xb],["physicalIndexToValue",Iu],["trimming",Xp]]);function ane(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!NF.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(NF.get(t))(e)}function lne(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rA{constructor(){lne(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);Ne(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return wn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}Xt(rA,Ai);function F_(t,e,n){return(e=hne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hne(t){var e=dne(t,"string");return typeof e=="symbol"?e:e+""}function dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DF extends rA{constructor(e,n){super(),F_(this,"mergedValuesCache",[]),F_(this,"aggregationFunction",void 0),F_(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=St(this.get(),o=>o.getValues()),i=[],r=Ne(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const a=[];for(let u=0;u<this.getLength();u+=1)a.push(n[u][o]);i.push(a)}return St(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return Ne(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function fne(t,e,n){gne(t,e),e.set(t,n)}function gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mne(t,e,n){return t.set(cY(t,e),n),n}function pne(t,e){return t.get(cY(t,e))}function cY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var W_=new WeakMap;class hY{constructor(){fne(this,W_,[])}subscribe(e){return this.addLocalHook("change",e),this._write(pne(W_,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){mne(W_,this,e)}}Xt(hY,Ai);function LF(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function Zg(t,e,n){vne(t,e),e.set(t,n)}function vne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function po(t,e){return t.get(dY(t,e))}function $w(t,e,n){return t.set(dY(t,e),n),n}function dY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bw=new WeakMap,Qg=new WeakMap,Fw=new WeakMap,Ww=new WeakMap,jw=new WeakMap;class wne{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zg(this,Bw,new Set),Zg(this,Qg,[]),Zg(this,Fw,[]),Zg(this,Ww,!1),Zg(this,jw,!1),$w(jw,this,e??!1)}createObserver(){const e=new hY;return po(Bw,this).add(e),e.addLocalHook("unsubscribe",()=>{po(Bw,this).delete(e)}),e._writeInitialChanges(LF(po(Qg,this),po(Fw,this))),e}emit(e){let n=po(Fw,this);(!po(Ww,this)||po(Qg,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(po(jw,this)):$w(Qg,this,new Array(e.length).fill(po(jw,this))),po(Ww,this)||($w(Ww,this,!0),n=po(Qg,this)));const i=LF(n,e);po(Bw,this).forEach(r=>r._write(i)),$w(Fw,this,e)}}function Yi(t,e,n){return(e=yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yne(t){var e=Cne(t,"string");return typeof e=="symbol"?e:e+""}function Cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iO{constructor(){Yi(this,"indexesSequence",new uY),Yi(this,"trimmingMapsCollection",new DF(e=>e.some(n=>n===!0),!1)),Yi(this,"hidingMapsCollection",new DF(e=>e.some(n=>n===!0),!1)),Yi(this,"variousMapsCollection",new rA),Yi(this,"hidingChangesObservable",new wne({initialIndexValue:!1})),Yi(this,"notTrimmedIndexesCache",[]),Yi(this,"notHiddenIndexesCache",[]),Yi(this,"isBatched",!1),Yi(this,"indexesSequenceChanged",!1),Yi(this,"indexesChangeSource",void 0),Yi(this,"trimmedIndexesChanged",!1),Yi(this,"hiddenIndexesChanged",!1),Yi(this,"renderablePhysicalIndexesCache",[]),Yi(this,"fromPhysicalToVisualIndexesCache",new Map),Yi(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,ane(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Xp?this.trimmingMapsCollection.register(e,n):n instanceof Kb?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Ne(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Ne(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Ne(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Ne(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return n>0?a=o.findIndex(u=>u>e):a=o.reverse().findIndex(u=>u<e),a===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=St(e,d=>this.getPhysicalFromVisualIndex(d)),r=this.getNotTrimmedIndexesLength(),o=e.length,a=yp(this.getIndexesSequence(),i),u=a.filter(d=>this.isTrimmed(d)===!1);let h=a.indexOf(u[u.length-1])+1;if(n+o<r){const d=u[n];h=a.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(tA(a,h,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=Ne(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=St(new Array(n).fill(r),(u,h)=>u+h);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,a),this.hidingMapsCollection.insertToEvery(o,a),this.variousMapsCollection.insertToEvery(o,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}Xt(iO,Ai);function bne(t,e){return ft(e,(n,i)=>{wn(t[i])&&(t[i]=n)}),t}function fY(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function gY(t){Ne(t)&&Ix($t`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Sne(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Rne,getValues:Ene}=vs("phraseFormatters");function Tne(t,e){Rne(t,e)}function _ne(){return Ene()}Tne("pluralize",Sne);const mY="ContextMenu:items",nt=mY,oA=`${nt}.noItems`,sA=`${nt}.insertRowAbove`,aA=`${nt}.insertRowBelow`,lA=`${nt}.insertColumnOnTheLeft`,uA=`${nt}.insertColumnOnTheRight`,cA=`${nt}.removeRow`,hA=`${nt}.removeColumn`,dA=`${nt}.undo`,fA=`${nt}.redo`,$C=`${nt}.readOnly`,gA=`${nt}.clearColumn`,mA=`${nt}.copy`,pA=`${nt}.copyWithHeaders`,vA=`${nt}.copyWithGroupHeaders`,wA=`${nt}.copyHeadersOnly`,yA=`${nt}.cut`,CA=`${nt}.freezeColumn`,bA=`${nt}.unfreezeColumn`,SA=`${nt}.mergeCells`,RA=`${nt}.unmergeCells`,EA=`${nt}.addComment`,TA=`${nt}.editComment`,_A=`${nt}.removeComment`,MA=`${nt}.readOnlyComment`,OA=`${nt}.align`,xA=`${nt}.align.left`,AA=`${nt}.align.center`,HA=`${nt}.align.right`,IA=`${nt}.align.justify`,PA=`${nt}.align.top`,NA=`${nt}.align.middle`,DA=`${nt}.align.bottom`,LA=`${nt}.borders`,kA=`${nt}.borders.top`,VA=`${nt}.borders.right`,$A=`${nt}.borders.bottom`,BA=`${nt}.borders.left`,FA=`${nt}.borders.remove`,WA=`${nt}.nestedHeaders.insertChildRow`,jA=`${nt}.nestedHeaders.detachFromParent`,UA=`${nt}.hideColumn`,zA=`${nt}.showColumn`,YA=`${nt}.hideRow`,GA=`${nt}.showRow`,rr="Filters:",xn=`${rr}conditions`,Zb=`${xn}.none`,qA=`${xn}.isEmpty`,KA=`${xn}.isNotEmpty`,XA=`${xn}.isEqualTo`,ZA=`${xn}.isNotEqualTo`,QA=`${xn}.beginsWith`,JA=`${xn}.endsWith`,eH=`${xn}.contains`,tH=`${xn}.doesNotContain`,Mne=`${xn}.byValue`,nH=`${xn}.greaterThan`,iH=`${xn}.greaterThanOrEqualTo`,rH=`${xn}.lessThan`,oH=`${xn}.lessThanOrEqualTo`,sH=`${xn}.isBetween`,aH=`${xn}.isNotBetween`,lH=`${xn}.after`,uH=`${xn}.before`,cH=`${xn}.today`,hH=`${xn}.tomorrow`,dH=`${xn}.yesterday`,fH=`${rr}labels.filterByCondition`,gH=`${rr}labels.filterByValue`,mH=`${rr}labels.conjunction`,Qb=`${rr}labels.disjunction`,BC=`${rr}values.blankCells`,pH=`${rr}buttons.selectAll`,vH=`${rr}buttons.clear`,wH=`${rr}buttons.ok`,yH=`${rr}buttons.cancel`,CH=`${rr}buttons.placeholder.search`,bH=`${rr}buttons.placeholder.value`,SH=`${rr}buttons.placeholder.secondValue`,RH="CheckboxRenderer:",EH=`${RH}checked`,TH=`${RH}unchecked`,One=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:EH,CHECKBOX_RENDERER_NAMESPACE:RH,CHECKBOX_UNCHECKED:TH,CONTEXTMENU_ITEMS_ADD_COMMENT:EA,CONTEXTMENU_ITEMS_ALIGNMENT:OA,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:DA,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:AA,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:IA,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:xA,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:NA,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:HA,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:PA,CONTEXTMENU_ITEMS_BORDERS:LA,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:$A,CONTEXTMENU_ITEMS_BORDERS_LEFT:BA,CONTEXTMENU_ITEMS_BORDERS_RIGHT:VA,CONTEXTMENU_ITEMS_BORDERS_TOP:kA,CONTEXTMENU_ITEMS_CLEAR_COLUMN:gA,CONTEXTMENU_ITEMS_COPY:mA,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:wA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:vA,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:pA,CONTEXTMENU_ITEMS_CUT:yA,CONTEXTMENU_ITEMS_EDIT_COMMENT:TA,CONTEXTMENU_ITEMS_FREEZE_COLUMN:CA,CONTEXTMENU_ITEMS_HIDE_COLUMN:UA,CONTEXTMENU_ITEMS_HIDE_ROW:YA,CONTEXTMENU_ITEMS_INSERT_LEFT:lA,CONTEXTMENU_ITEMS_INSERT_RIGHT:uA,CONTEXTMENU_ITEMS_MERGE_CELLS:SA,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:jA,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:WA,CONTEXTMENU_ITEMS_NO_ITEMS:oA,CONTEXTMENU_ITEMS_READ_ONLY:$C,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:MA,CONTEXTMENU_ITEMS_REDO:fA,CONTEXTMENU_ITEMS_REMOVE_BORDERS:FA,CONTEXTMENU_ITEMS_REMOVE_COLUMN:hA,CONTEXTMENU_ITEMS_REMOVE_COMMENT:_A,CONTEXTMENU_ITEMS_REMOVE_ROW:cA,CONTEXTMENU_ITEMS_ROW_ABOVE:sA,CONTEXTMENU_ITEMS_ROW_BELOW:aA,CONTEXTMENU_ITEMS_SHOW_COLUMN:zA,CONTEXTMENU_ITEMS_SHOW_ROW:GA,CONTEXTMENU_ITEMS_UNDO:dA,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:bA,CONTEXTMENU_ITEMS_UNMERGE_CELLS:RA,CONTEXT_MENU_ITEMS_NAMESPACE:mY,FILTERS_BUTTONS_CANCEL:yH,FILTERS_BUTTONS_CLEAR:vH,FILTERS_BUTTONS_OK:wH,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:CH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:SH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:bH,FILTERS_BUTTONS_SELECT_ALL:pH,FILTERS_CONDITIONS_AFTER:lH,FILTERS_CONDITIONS_BEFORE:uH,FILTERS_CONDITIONS_BEGINS_WITH:QA,FILTERS_CONDITIONS_BETWEEN:sH,FILTERS_CONDITIONS_BY_VALUE:Mne,FILTERS_CONDITIONS_CONTAINS:eH,FILTERS_CONDITIONS_EMPTY:qA,FILTERS_CONDITIONS_ENDS_WITH:JA,FILTERS_CONDITIONS_EQUAL:XA,FILTERS_CONDITIONS_GREATER_THAN:nH,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:iH,FILTERS_CONDITIONS_LESS_THAN:rH,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:oH,FILTERS_CONDITIONS_NAMESPACE:xn,FILTERS_CONDITIONS_NONE:Zb,FILTERS_CONDITIONS_NOT_BETWEEN:aH,FILTERS_CONDITIONS_NOT_CONTAIN:tH,FILTERS_CONDITIONS_NOT_EMPTY:KA,FILTERS_CONDITIONS_NOT_EQUAL:ZA,FILTERS_CONDITIONS_TODAY:cH,FILTERS_CONDITIONS_TOMORROW:hH,FILTERS_CONDITIONS_YESTERDAY:dH,FILTERS_DIVS_FILTER_BY_CONDITION:fH,FILTERS_DIVS_FILTER_BY_VALUE:gH,FILTERS_LABELS_CONJUNCTION:mH,FILTERS_LABELS_DISJUNCTION:Qb,FILTERS_NAMESPACE:rr,FILTERS_VALUES_BLANK_CELLS:BC},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const pY={languageCode:"en-US",[oA]:"No available options",[sA]:"Insert row above",[aA]:"Insert row below",[lA]:"Insert column left",[uA]:"Insert column right",[cA]:["Remove row","Remove rows"],[hA]:["Remove column","Remove columns"],[dA]:"Undo",[fA]:"Redo",[$C]:"Read only",[gA]:"Clear column",[OA]:"Alignment",[xA]:"Left",[AA]:"Center",[HA]:"Right",[IA]:"Justify",[PA]:"Top",[NA]:"Middle",[DA]:"Bottom",[CA]:"Freeze column",[bA]:"Unfreeze column",[LA]:"Borders",[kA]:"Top",[VA]:"Right",[$A]:"Bottom",[BA]:"Left",[FA]:"Remove border(s)",[EA]:"Add comment",[TA]:"Edit comment",[_A]:"Delete comment",[MA]:"Read-only comment",[SA]:"Merge cells",[RA]:"Unmerge cells",[mA]:"Copy",[pA]:["Copy with header","Copy with headers"],[vA]:["Copy with group header","Copy with group headers"],[wA]:["Copy header only","Copy headers only"],[yA]:"Cut",[WA]:"Insert child row",[jA]:"Detach from parent",[UA]:["Hide column","Hide columns"],[zA]:["Show column","Show columns"],[YA]:["Hide row","Hide rows"],[GA]:["Show row","Show rows"],[Zb]:"None",[qA]:"Is empty",[KA]:"Is not empty",[XA]:"Is equal to",[ZA]:"Is not equal to",[QA]:"Begins with",[JA]:"Ends with",[eH]:"Contains",[tH]:"Does not contain",[nH]:"Greater than",[iH]:"Greater than or equal to",[rH]:"Less than",[oH]:"Less than or equal to",[sH]:"Is between",[aH]:"Is not between",[lH]:"After",[uH]:"Before",[cH]:"Today",[hH]:"Tomorrow",[dH]:"Yesterday",[BC]:"Blank cells",[fH]:"Filter by condition",[gH]:"Filter by value",[mH]:"And",[Qb]:"Or",[pH]:"Select all",[vH]:"Clear",[wH]:"OK",[yH]:"Cancel",[CH]:"Search",[bH]:"Value",[SH]:"Second value",[EH]:"Checked",[TH]:"Unchecked"},xne=One,rO=pY.languageCode,{register:Ane,getItem:vY,hasItem:Hne,getValues:Ine}=vs("languagesDictionaries");wY(pY);function wY(t,e){let n=t,i=e;return dt(t)&&(i=t,n=i.languageCode),Pne(n,i),Ane(n,ir(i)),ir(i)}function Pne(t,e){t!==rO&&bne(e,vY(rO))}function yY(t){return _H(t)?ir(vY(t)):null}function _H(t){return Hne(t)}function Nne(){return Ine()}function CY(t,e,n){const i=yY(t);if(i===null)return null;const r=i[e];if(wn(r))return null;const o=Dne(r,n);return Array.isArray(o)?o[0]:o}function Dne(t,e){let n=t;return U(_ne(),i=>{n=i(t,e)}),n}function Lne(t){let e=fY(t);return _H(e)||(e=rO,gY(t)),e}function kne(t,e,n){return(e=Vne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vne(t){var e=$ne(t,"string");return typeof e=="symbol"?e:e+""}function $ne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wl extends Xz{constructor(e,n){super(e,null),kne(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(n,i,r)),a!==null&&e.overlaps(a)){const u=e.highlight.clone();if(u.row>=0&&(u.row=a.row),u.col>=0&&(u.col=a.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(u);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(u)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function j_(t){let{activeHeaderClassName:e,...n}=t;return new wl({className:e,...n,selectionType:Zz})}function Bne(t){let{areaCornerVisible:e,...n}=t;return new wl({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:jx})}function Fne(t){let{...e}=t;return new wl({className:"highlight",...e,selectionType:jx})}function Wne(t){let{columnClassName:e,...n}=t;return new wl({className:e,...n,selectionType:tte})}function jne(t){let{cellCornerVisible:e,...n}=t;return new wl({className:"current",headerAttributes:[Tx()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ym})}function Une(t){let{border:e,visualCellRange:n,...i}=t;return new wl({...e,...i,selectionType:nte},n)}function zne(t){let{...e}=t;return new wl({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Jee})}function kF(t){let{headerClassName:e,...n}=t;return new wl({className:e,...n,selectionType:Wx})}function Yne(t){let{rowClassName:e,...n}=t;return new wl({className:e,...n,selectionType:ete})}function Gne(t,e){qne(t,e),e.add(t)}function qne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(t,e,n){return(e=Kne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kne(t){var e=Xne(t,"string");return typeof e=="symbol"?e:e+""}function Xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hs=new WeakSet;class Zne{constructor(e){Gne(this,Hs),gr(this,"options",void 0),gr(this,"layerLevel",0),gr(this,"focus",void 0),gr(this,"fill",void 0),gr(this,"layeredAreas",new Map),gr(this,"areas",new Map),gr(this,"rowHeaders",new Map),gr(this,"columnHeaders",new Map),gr(this,"activeRowHeaders",new Map),gr(this,"activeColumnHeaders",new Map),gr(this,"activeCornerHeaders",new Map),gr(this,"rowHighlights",new Map),gr(this,"columnHighlights",new Map),gr(this,"customSelections",[]),this.options=e,this.focus=jne(e),this.fill=zne(e)}isEnabledFor(e,n){let i=e;e===Ym&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Pa(Hs,this,Na).call(this,this.layeredAreas,Bne)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Pa(Hs,this,Na).call(this,this.areas,Fne)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Pa(Hs,this,Na).call(this,this.rowHeaders,kF)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Pa(Hs,this,Na).call(this,this.columnHeaders,kF)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Pa(Hs,this,Na).call(this,this.activeRowHeaders,j_)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Pa(Hs,this,Na).call(this,this.activeColumnHeaders,j_)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Pa(Hs,this,Na).call(this,this.activeCornerHeaders,j_)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Pa(Hs,this,Na).call(this,this.rowHighlights,Yne)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Pa(Hs,this,Na).call(this,this.columnHighlights,Wne)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Une({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),U(this.areas.values(),e=>void e.clear()),U(this.layeredAreas.values(),e=>void e.clear()),U(this.rowHeaders.values(),e=>void e.clear()),U(this.columnHeaders.values(),e=>void e.clear()),U(this.activeRowHeaders.values(),e=>void e.clear()),U(this.activeColumnHeaders.values(),e=>void e.clear()),U(this.activeCornerHeaders.values(),e=>void e.clear()),U(this.rowHighlights.values(),e=>void e.clear()),U(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Na(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function VF(t,e,n){return(e=Qne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qne(t){var e=Jne(t,"string");return typeof e=="symbol"?e:e+""}function Jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eie{constructor(e){VF(this,"ranges",[]),VF(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function tie(t,e){bY(t,e),e.add(t)}function U_(t,e,n){bY(t,e),e.set(t,n)}function bY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xt(t,e){return t.get(Jn(t,e))}function Uw(t,e,n){return t.set(Jn(t,e),n),n}function Jn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zw=new WeakMap,ln=new WeakMap,ls=new WeakMap,fi=new WeakSet;class oO{constructor(e,n){tie(this,fi),U_(this,zw,void 0),U_(this,ln,void 0),U_(this,ls,{x:0,y:0}),Uw(zw,this,e),Uw(ln,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=xt(ln,this).createCellCoords(e,n);let o=xt(zw,this).current().highlight;const a=xt(ln,this).visualToRenderableCoords(o);let u=0,h=0;if(this.runLocalHooks("beforeTransformStart",r),a.row!==null&&a.col!==null){const{width:d,height:g}=Jn(fi,this,SY).call(this),{row:p,col:w}=Jn(fi,this,BF).call(this,o),y=xt(ln,this).fixedRowsBottom(),b=xt(ln,this).minSpareRows(),T=xt(ln,this).minSpareCols(),M=xt(ln,this).autoWrapRow(),I=xt(ln,this).autoWrapCol(),_=xt(ln,this).createCellCoords(p+r.row,w+r.col);if(_.row>=g){const $=Jr(i&&b>0&&y===0),L=_.col+1,F=xt(ln,this).createCellCoords(_.row-g,L>=d?L-d:L);this.runLocalHooks("beforeColumnWrap",$,Jn(fi,this,ad).call(this,F),L>=d),$.value?this.runLocalHooks("insertRowRequire",xt(ln,this).countRenderableRows()):I&&_.assign(F)}else if(_.row<0){const $=Jr(I),L=_.col-1,F=xt(ln,this).createCellCoords(g+_.row,L<0?d+L:L);this.runLocalHooks("beforeColumnWrap",$,Jn(fi,this,ad).call(this,F),L<0),I&&_.assign(F)}if(_.col>=d){const $=Jr(i&&T>0),L=_.row+1,F=xt(ln,this).createCellCoords(L>=g?L-g:L,_.col-d);this.runLocalHooks("beforeRowWrap",$,Jn(fi,this,ad).call(this,F),L>=g),$.value?this.runLocalHooks("insertColRequire",xt(ln,this).countRenderableColumns()):M&&_.assign(F)}else if(_.col<0){const $=Jr(M),L=_.row-1,F=xt(ln,this).createCellCoords(L<0?g+L:L,d+_.col);this.runLocalHooks("beforeRowWrap",$,Jn(fi,this,ad).call(this,F),L<0),M&&_.assign(F)}const{rowDir:N,colDir:k}=Jn(fi,this,$F).call(this,_);u=N,h=k,o=Jn(fi,this,ad).call(this,_)}return this.runLocalHooks("afterTransformStart",o,u,h),o}transformEnd(e,n){const i=xt(ln,this).createCellCoords(e,n),r=xt(zw,this).current(),o=xt(ln,this).visualToRenderableCoords(r.highlight),a=Jn(fi,this,z_).call(this,r.to.row,r.from.row),u=Jn(fi,this,Y_).call(this,r.to.col,r.from.col),h=r.to.clone();let d=0,g=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&a!==null&&u!==null){const{row:p,col:w}=Jn(fi,this,BF).call(this,r.highlight),y=xt(ln,this).createCellCoords(a+i.row,u+i.col),b=r.getTopStartCorner(),T=r.getTopEndCorner(),M=r.getBottomEndCorner();if(i.col<0&&u>=w&&y.col<w){const k=y.col-w;y.col=Jn(fi,this,Y_).call(this,b.col,T.col)+k}else if(i.col>0&&u<=w&&y.col>w){const k=Jn(fi,this,Y_).call(this,T.col,b.col),$=Math.max(y.col-k,1);y.col=k+$}if(i.row<0&&a>=p&&y.row<p){const k=y.row-p;y.row=Jn(fi,this,z_).call(this,b.row,M.row)+k}else if(i.row>0&&a<=p&&y.row>p){const k=Jn(fi,this,z_).call(this,M.row,b.row),$=Math.max(y.row-k,1);y.row=k+$}const{rowDir:I,colDir:_}=Jn(fi,this,$F).call(this,y);d=I,g=_;const N=Jn(fi,this,ad).call(this,y);i.row===0&&i.col!==0?h.col=N.col:i.row!==0&&i.col===0?h.row=N.row:(h.row=N.row,h.col=N.col)}return this.runLocalHooks("afterTransformEnd",h,d,g),h}setOffsetSize(e){let{x:n,y:i}=e;Uw(ls,this,{x:n,y:i})}resetOffsetSize(){Uw(ls,this,{x:0,y:0})}}function $F(t){const{width:e,height:n}=Jn(fi,this,SY).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function SY(){return{width:xt(ls,this).x+xt(ln,this).countRenderableColumns(),height:xt(ls,this).y+xt(ln,this).countRenderableRows()}}function z_(t,e){const n=xt(ln,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:xt(ls,this).y+n}function Y_(t,e){const n=xt(ln,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:xt(ls,this).x+n}function BF(t){const{row:e,col:n}=xt(ln,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return xt(ln,this).createCellCoords(xt(ls,this).y+e,xt(ls,this).x+n)}function ad(t){const e=t.clone();return e.col=t.col-xt(ls,this).x,e.row=t.row-xt(ls,this).y,xt(ln,this).renderableToVisualCoords(e)}Xt(oO,Ai);const Jb=0,eS=1,RY=2,MH=3,nie=[MH,RY],iie=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],G_=Symbol("root"),FF=Symbol("child");function uf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:G_;if(e!==G_&&e!==FF)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===G_;let r=Jb;if(n){const o=t[0];t.length===0?r=eS:i&&o instanceof Gp?r=MH:i&&Array.isArray(o)?r=uf(o,FF):t.length>=2&&t.length<=4&&!t.some((u,h)=>!iie[h].includes(typeof u))&&(r=RY)}return r}function Cp(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nie.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=t===MH;let u=a?o.from.row:o[0],h=a?o.from.col:o[1],d=a?o.to.row:o[2],g=a?o.to.col:o[3];if(typeof r=="function"&&(typeof h=="string"&&(h=r(h)),typeof g=="string"&&(g=r(g))),wn(d)&&(d=u),wn(g)&&(g=h),!i){const y=u,b=h,T=d,M=g;u=Math.min(y,T),h=Math.min(b,M),d=Math.max(y,T),g=Math.max(b,M)}const p=e(u,h),w=e(d,g);return n(p,p,w)}}function rie(t){const e=uf(t.getSelected());if(e===Jb||e===eS)return[];const n=Cp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;U(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.col,0),g=h.col-d+1;U(Array.from(new Array(g),(p,w)=>d+w),p=>{i.has(p)||i.add(p)})});const r=Array.from(i).sort((a,u)=>a-u);return xr(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function oie(t){const e=uf(t.getSelected());if(e===Jb||e===eS)return[];const n=Cp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;U(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.row,0),g=h.row-d+1;U(Array.from(new Array(g),(p,w)=>d+w),p=>{i.has(p)||i.add(p)})});const r=Array.from(i).sort((a,u)=>a-u);return xr(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function ld(t,e,n){sie(t,e),e.set(t,n)}function sie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ic(t,e,n){return(e=aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:e+""}function lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hn(t,e){return t.get(EY(t,e))}function Is(t,e,n){return t.set(EY(t,e),n),n}function EY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Di=new WeakMap,rc=new WeakMap,Yw=new WeakMap,Jg=new WeakMap,Gw=new WeakMap,em=new WeakMap;class TY{constructor(e,n){var i=this;ic(this,"settings",void 0),ic(this,"tableProps",void 0),ic(this,"inProgress",!1),ic(this,"selectedRange",new eie((r,o,a)=>this.tableProps.createCellRange(r,o,a))),ic(this,"highlight",void 0),ld(this,Di,void 0),ld(this,rc,void 0),ic(this,"selectedByRowHeader",new Set),ic(this,"selectedByColumnHeader",new Set),ld(this,Yw,!1),ld(this,Jg,!1),ld(this,Gw,"unknown"),ld(this,em,-1),this.settings=e,this.tableProps=n,this.highlight=new Zne({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Tx()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,a)=>this.tableProps.createCellRange(r,o,a)}),Is(Di,this,new oO(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Is(rc,this,new oO(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),hn(Di,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformStart",...o)}),hn(Di,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformStart",...o)}),hn(Di,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),hn(Di,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformEnd",...o)}),hn(Di,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertRowRequire",...o)}),hn(Di,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertColRequire",...o)}),hn(Di,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeRowWrap",...o)}),hn(Di,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeColumnWrap",...o)}),hn(rc,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),hn(rc,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Is(Gw,this,e)}markEndSource(){Is(Gw,this,"unknown")}getSelectionSource(){return hn(Gw,this)}setExpectedLayers(e){Is(em,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Is(em,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=wn(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,u=e.clone();Is(Yw,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,u),(!o||o&&!a&&wn(n))&&this.selectedRange.clear(),this.selectedRange.add(u).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!o||r===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const h=a.getHorizontalDirection(),d=a.getVerticalDirection(),g=this.isMultiple();a.setTo(n),g&&(h!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),g&&(d!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const u=hn(em,this)===-1||this.selectedRange.size()===hn(em,this);this.runLocalHooks("afterSetRangeEnd",e,u)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(U(this.highlight.getAreas(),b=>void b.clear()),U(this.highlight.getLayeredAreas(),b=>void b.clear()),U(this.highlight.getRowHeaders(),b=>void b.clear()),U(this.highlight.getColumnHeaders(),b=>void b.clear()),U(this.highlight.getActiveRowHeaders(),b=>void b.clear()),U(this.highlight.getActiveColumnHeaders(),b=>void b.clear()),U(this.highlight.getActiveCornerHeaders(),b=>void b.clear()),U(this.highlight.getRowHighlights(),b=>void b.clear()),U(this.highlight.getColumnHighlights(),b=>void b.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),u.clear(),h.clear(),d.clear(),g.clear(),p.clear(),w.clear(),y.clear(),this.highlight.isEnabledFor(jx,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),n===1)){const b=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(b.from).commit().syncWith(b),this.highlight.createLayeredArea().add(b.from).commit().syncWith(b),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(Wx,e.highlight)){if(!e.isSingleHeader()){const M=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),I=this.tableProps.createCellCoords(e.to.row,-1),_=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),N=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(u.add(M).commit(),h.add(_).commit(),w.add(M).commit(),y.add(_).commit()):(u.add(M).add(I).commit(),h.add(_).add(N).commit(),w.add(M).add(I).commit(),y.add(_).add(N).commit())}const b=!hn(Jg,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),T=!hn(Jg,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());b&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),T&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),b&&T&&p.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Ym,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(Is(Yw,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?hn(Di,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hn(Di,this).resetOffsetSize(),this.setRangeStart(hn(Di,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?hn(Di,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hn(Di,this).resetOffsetSize(),this.setRangeEnd(hn(Di,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,o-1),u=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?hn(rc,this).setOffsetSize({x:o<0?Math.abs(o):-a,y:r<0?Math.abs(r):-u}):hn(rc,this).setOffsetSize({x:o<0?0:-a,y:r<0?0:-u});const h=hn(rc,this).transformStart(e,n);this.setRangeFocus(h.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:a}=i,u=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=d?-1:0,p=d?0:n;this.getSelectedRange().pop();const w=this.tableProps.createCellCoords(Et(r.row+p,g,u-1),r.col),y=this.tableProps.createCellCoords(Et(o.row+n,g,u-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(w,!0,this.tableProps.createCellCoords(Et(a.row+n,0,u-1),a.col)):this.setRangeStartOnly(w,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:a}=i,u=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=h?-1:0,p=h?0:n;this.getSelectedRange().pop();const w=this.tableProps.createCellCoords(r.row,Et(r.col+p,g,u-1)),y=this.tableProps.createCellCoords(o.row,Et(o.col+n,g,u-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(w,!0,this.tableProps.createCellCoords(a.row,Et(a.col+n,0,u-1))):this.setRangeStartOnly(w,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Jr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&hn(Yw,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),u=this.tableProps.countCols();return(a>0&&o<0||a===0)&&r.getWidth()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),u=this.tableProps.countRows();return(a>0&&o<0||a===0)&&r.getHeight()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),u=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),d=i?-h:0,g=n?-u:0;if(d===0&&g===0&&(o===0||a===0))return;let p=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:w,disableHeadersHighlight:y}=r;Is(Jg,this,y),w&&Number.isInteger(w==null?void 0:w.row)&&Number.isInteger(w==null?void 0:w.col)&&(p=this.tableProps.createCellCoords(Et(w.row,d,o-1),Et(w.col,g,a-1)));const b=this.tableProps.createCellCoords(d,g),T=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.setRangeStartOnly(b,void 0,p),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.finish(),Is(Jg,this,!1)}selectCells(e){var n=this;const i=uf(e);if(i===eS)return!1;if(i===Jb)throw new Error($t`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=Cp(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},u=!e.some(h=>{const d=r(h),g=d.isValid(a);return!(g&&!d.containsHeaders()||g&&d.containsHeaders()&&d.isSingleHeader())});return u&&(this.clear(),this.setExpectedLayers(e.length),U(e,h=>{const{from:d,to:g}=r(h);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),u}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,a=this.tableProps.countRows(),u=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),d=h===0?0:-h,g=this.tableProps.createCellCoords(d,r),p=this.tableProps.createCellCoords(a-1,o),w=this.tableProps.createCellRange(g,g,p).isValid({countRows:a,countCols:u,countRowHeaders:0,countColHeaders:h});if(w){let y=0,b=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(y=Et(i.row,d,a-1),b=Et(i.col,Math.min(r,o),Math.max(r,o))):(y=Et(i,d,a-1),b=r);const T=this.tableProps.createCellCoords(y,b),M=h===0?0:Et(T.row,d,-1),I=a-1,_=this.tableProps.createCellCoords(M,r),N=this.tableProps.createCellCoords(I,o);this.runLocalHooks("beforeSelectColumns",_,N,T),_.row=M,N.row=I,this.setRangeStartOnly(_,void 0,T),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(N),this.runLocalHooks("afterSelectColumns",_,N,T),this.finish()}return w}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),u=a===0?0:-a,h=this.tableProps.createCellCoords(e,u),d=this.tableProps.createCellCoords(n,o-1),g=this.tableProps.createCellRange(h,h,d).isValid({countRows:r,countCols:o,countRowHeaders:a,countColHeaders:0});if(g){let p=0,w=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(p=Et(i.row,Math.min(e,n),Math.max(e,n)),w=Et(i.col,u,o-1)):(p=e,w=Et(i,u,o-1));const y=this.tableProps.createCellCoords(p,w),b=a===0?0:Et(y.col,u,-1),T=o-1,M=this.tableProps.createCellCoords(e,b),I=this.tableProps.createCellCoords(n,T);this.runLocalHooks("beforeSelectRows",M,I,y),M.col=b,I.col=T,this.setRangeStartOnly(M,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectRows",M,I,y),this.finish()}return g}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:o,highlight:a}=i;this.clear(),a.assign({row:Et(a.row,-1/0,e-1),col:Et(a.col,-1/0,n-1)}),r.assign({row:Et(r.row,-1/0,e-1),col:Et(r.col,-1/0,n-1)}),o.assign({row:Et(o.row,0,e-1),col:Et(o.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.isEnabledFor(Ym,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(a).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(Ym,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();o.commit(),a.commit(),u.commit(),h.commit(),d.commit(),g.commit(),p.commit(),w.commit(),y.commit()}this.highlight.useLayerLevel(n)}}Xt(TY,Ai);const WF=/^(\r\n|\n\r|\r|\n)/,uie=/^[^\t\r\n]+/,jF=/^\t/;function cie(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(jF))t=t.replace(jF,""),n+=1,e[i][n]="";else if(t.match(WF))t=t.replace(WF,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let a=0,u=!0;for(;u;){const h=t.slice(0,1);h==='"'&&(a+=1),o+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(u=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const a=t.match(uie);o=a?a[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function qm(t){let e,n,i,r,o="",a;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),a=t[e][i],typeof a=="string"?a.indexOf(`
`)>-1?o+=`"${a.replace(/"/g,'""')}"`:o+=a:a==null?o+="":o+=a;e!==n-1&&(o+=`
`)}return o}function oc(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yd{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){oc(this,"hot",void 0),oc(this,"metaManager",void 0),oc(this,"tableMeta",void 0),oc(this,"dataSource",void 0),oc(this,"duckSchema",void 0),oc(this,"colToPropCache",void 0),oc(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,a=!1;if(typeof n=="function"){const u=Ax(e);r=u>0?u:this.countFirstRowKeys(),a=!0}else{const u=this.tableMeta.maxCols;r=Math.min(u,n.length)}for(i=0;i<r;i++){const u=a?n(i):n[i];if(dt(u)){if(typeof u.data<"u"){const h=a?o:i;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return aY(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,a;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&ft(e,(u,h)=>{u===null?(a=o+h,this.colToPropCache.push(a),this.propToColCache.set(a,r),r+=1):r=this.recursiveDuckColumns(u,r,`${h}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Ne(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Ne(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?vp(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let a=o,u=0,h=e;if((typeof h!="number"||h>=o)&&(h=o),h<this.hot.countRows()&&(a=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,n,i)===!1||a===null)return{delta:0};const g=this.tableMeta.maxRows,p=this.getSchema().length,w=[];for(;u<n&&o+u<g;){let b=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?b=ir(this.getSchema()):(b=[],Ve(p-1,()=>b.push(null))):this.hot.dataType==="function"?b=this.tableMeta.dataSchema(h+u):(b={},Ub(b,this.getSchema())),w.push(b),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),r==="below"&&(a=Math.min(a+1,o)),this.spliceData(a,0,w);const y=this.hot.toVisualRow(a);return this.hot.countSourceRows()===w.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(e==null?this.metaManager.createRow(null,u):i!=="auto"&&this.metaManager.createRow(a,n)),this.hot.runHooks("afterCreateRow",y,u,i),{delta:u,startPhysicalIndex:a}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,a=this.tableMeta.maxCols,u=this.hot.countSourceCols();let h=e;if((typeof h!="number"||h>=u)&&(h=u),this.hot.runHooks("beforeCreateCol",h,n,i)===!1)return{delta:0};let g=u;h<this.hot.countCols()&&(g=this.hot.toPhysicalColumn(h));const p=this.hot.countSourceRows();let w=this.hot.countCols(),y=0,b=g;r==="end"&&(b=Math.min(b+1,u));const T=b;for(;y<n&&w<a;){if(typeof h!="number"||h>=w)if(p>0)for(let I=0;I<p;I+=1)typeof o[I]>"u"&&(o[I]=[]),o[I].push(null);else o.push([null]);else for(let I=0;I<p;I++)o[I].splice(b,0,null);y+=1,b+=1,w+=1}this.hot.columnIndexMapper.insertIndexes(h,y),y>0&&(e==null?this.metaManager.createColumn(null,y):i!=="auto"&&this.metaManager.createColumn(T,n));const M=this.hot.toVisualColumn(T);return this.hot.runHooks("afterCreateCol",M,y,i),this.refreshDuckSchema(),{delta:y,startPhysicalIndex:T}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),a=this.hot.countSourceRows();if(r=(a+r)%a,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const h=o.length;if(this.filterData(r,h,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const g=Ne(this.tableMeta.columns)||Ne(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!g&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((g,p)=>p-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",r,h,o,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),a=o.slice(0).sort((p,w)=>w-p);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let h=!0;const d=a.length,g=this.dataSource;for(let p=0;p<d;p++)h&&o[0]!==o[p]-p&&(h=!1);if(h)for(let p=0,w=this.hot.countSourceRows();p<w;p++)g[p].splice(o[0],n),p===0&&this.metaManager.removeColumn(o[0],n);else for(let p=0,w=this.hot.countSourceRows();p<w;p++)for(let y=0;y<d;y++)g[p].splice(a[y],1),p===0&&this.metaManager.removeColumn(a[y],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];K$(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return NX(h),this.hot.populateFromArray(n,e,h,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];K$(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return this.hot.populateFromArray(e,n,[h],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(a=>this.dataSource.push(a))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,a)=>i.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:a}=this.hot.getSettings();let u=null;if(r&&r.hasOwnProperty&&ti(r,n))u=r[n];else if(a&&typeof n=="string"&&n.indexOf(".")>-1){let h=r;if(!h)return null;const d=n.split(".");for(let g=0,p=d.length;g<p;g++)if(h=h[d[g]],typeof h>"u")return null;u=h}else typeof n=="function"&&(u=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const h=Jr(u);this.hot.runHooks("modifyData",i,this.propToCol(n),h,"get"),h.isTouched()&&(u=h.value)}return u}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,a=this.dataSource[r];const u=this.hot.runHooks("modifyRowData",r);if(a=isNaN(u)?u:a,this.hot.hasHook("modifyData")){const d=Jr(o);this.hot.runHooks("modifyData",r,this.propToCol(n),d,"set"),d.isTouched()&&(o=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(a&&a.hasOwnProperty&&ti(a,n))a[n]=o;else if(h&&typeof n=="string"&&n.indexOf(".")>-1){let d=a,g=0,p;const w=n.split(".");for(g=0,p=w.length-1;g<p;g++){if(w[g]==="__proto__"||w[g]==="constructor"||w[g]==="prototype")return;typeof d[w[g]]>"u"&&(d[w[g]]={}),d=d[w[g]]}d[w[g]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;a[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,a=n,u;for(;o<i&&a;)u=this.hot.toPhysicalRow(o),r.push(u),a-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,a=n;for(;o<i&&a;){const u=this.hot.toPhysicalColumn(o);r.push(u),a-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Yd.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,a,u;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const g=i===Yd.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,p=Math.min(Math.max(h-1,0),Math.max(e.row,n.row)),w=Math.min(Math.max(d-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=p;o++){u=[];const y=o>=0?this.hot.toPhysicalRow(o):o;for(a=Math.min(e.col,n.col);a<=w&&y!==null;a++)u.push(g.call(this,o,this.colToProp(a)));y!==null&&r.push(u)}return r}getText(e,n){return qm(this.getRange(e,n,Yd.DESTINATION_RENDERER))}getCopyableText(e,n){return qm(this.getRange(e,n,Yd.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:fie,getItem:gie,hasItem:_Y,getNames:GSe,getValues:qSe}=vs("cellTypes");function mie(t){if(!_Y(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return gie(t)}function Xo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&Yr(t,n),i&&vo(t,i),r&&kd(t,r),fie(t,e)}function pie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ti(e,t)}function tS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?mie(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ft(e,(o,a)=>void t._automaticallyAssignedMetaProps.delete(a)),!dt(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};ft(i,(o,a)=>{if(pie(a,n)){var u;r[a]=o,(u=t._automaticallyAssignedMetaProps)===null||u===void 0||u.add(a)}}),ii(t,r)}function vie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}TZ(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function hC(t){return Number.isInteger(t)&&t>=0}function dC(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function qw(t){return t==null}const MY=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Vn(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Vn(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),xx(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function UF(t,e,n){return(e=wie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wie(t){var e=yie(t,"string");return typeof e=="symbol"?e:e+""}function yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cie(){return class{}}class bie{constructor(e){UF(this,"metaCtor",Cie()),UF(this,"meta",void 0),this.meta=this.metaCtor.prototype,ii(this.meta,MY()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;ii(this.meta,e),tS(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Sie(t,e,n){return(e=Rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:e+""}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tie{constructor(e){Sie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){ii(this.meta,e),tS(this.meta,e,e)}}function Kw(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Mie(t,"string");return typeof e=="symbol"?e:e+""}function Mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FC{constructor(e){Kw(this,"valueFactory",void 0),Kw(this,"data",[]),Kw(this,"index",[]),Kw(this,"holes",new Set),this.valueFactory=e}obtain(e){dC(()=>hC(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dC(()=>hC(e)||qw(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let a=0;a<n;a++)i.push(r+a),this.data.push(void 0);const o=qw(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dC(()=>hC(e)||qw(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(qw(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function zF(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=xie(t,"string");return typeof e=="symbol"?e:e+""}function xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Aie=["data","width"];class Hie{constructor(e){zF(this,"globalMeta",void 0),zF(this,"metas",new FC(()=>this._createMeta())),this.globalMeta=e,this.metas=new FC(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);ii(i,n),tS(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return vie(this.globalMeta.getMetaConstructor(),Aie).prototype}}function YF(t,e,n){return(e=Iie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iie(t){var e=Pie(t,"string");return typeof e=="symbol"?e:e+""}function Pie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nie{constructor(e){YF(this,"columnMeta",void 0),YF(this,"metas",new FC(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);ii(r,i),tS(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const a=this.metas.obtain(e).obtain(n);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),a[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)Ne(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){dC(()=>hC(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new FC(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class OY{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new bie(e),this.tableMeta=new Tie(this.globalMeta),this.columnMeta=new Hie(this.globalMeta),this.cellMeta=new Nie(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Xt(OY,Ai);function GF(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:a,internalSource:u,source:h,metaManager:d,firstRun:g}=i,p=ds(u),w=r.getSettings();Array.isArray(w.dataSchema)?r.dataType="array":Ut(w.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${p}`,t,g,h);const y=new Yd(r,t,d);if(e(y),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const b=y.getSchema();t=[];let T,M=0,I=0;for(M=0,I=w.startRows;M<I;M++)if((r.dataType==="object"||r.dataType==="function")&&w.dataSchema)T=ir(b),t.push(T);else if(r.dataType==="array")T=ir(b[0]),t.push(T);else{T=[];for(let _=0,N=w.startCols;_<N;_++)T.push(null);t.push(T)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),w.data=t,y.dataSource=t,a.data=t,a.dataType=r.dataType,a.colToProp=y.colToProp.bind(y),a.propToCol=y.propToCol.bind(y),a.countCachedColumns=y.countCachedColumns.bind(y),n(y),r.runHooks(`after${p}`,t,g,h),g||(r.runHooks("afterChange",null,u),r.render()),r.getSettings().ariaTags&&qe(r.rootElement,[sz(-1),Bb(r.countCols()+(r.view?r.countRowHeaders():0))])}function qF(t,e,n){return(e=Die(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Die(t){var e=Lie(t,"string");return typeof e=="symbol"?e:e+""}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kie{constructor(e){var n=this;qF(this,"metaManager",void 0),qF(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),xe.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:a}=e,u=this.metaManager.hot,h=u.colToProp(a);e.prop=h,u.runHooks("beforeGetCellMeta",o,a,e);const d=ti(e,"type")?e.type:null;let g=Ut(e.cells)?e.cells(i,r,h):null;if(d)if(g){var p;g.type=(p=g.type)!==null&&p!==void 0?p:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,r,g),u.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function Vie(t,e,n){$ie(t,e),e.set(t,n)}function $ie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q_(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=Fie(t,"string");return typeof e=="symbol"?e:e+""}function Fie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wie(t,e){return t.get(jie(t,e))}function jie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KF=new WeakMap;class Uie{constructor(e){q_(this,"metaManager",void 0),q_(this,"usageTracker",new Set),q_(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Vie(this,KF,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,a=typeof r=="string",u=a?r:n,h=`_${u}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[u],o?(this.installPropWatcher(n,h,o),a&&this.installPropWatcher(r,h,o)):i&&(this.installPropWatcher(n,h,Wie(KF,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const a=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,a),this[n]=o},enumerable:!0,configurable:!0})}}const xY="gridDefault",Pu="editorManager.handlingEditor",zie={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Yie="hooksRefRegisterer",AY={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){U(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ft(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};vl(AY,"MIXIN_NAME",Yie,{writable:!1,enumerable:!1});function zo(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kie="base",Ln=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Mf{static get EDITOR_TYPE(){return Kie}constructor(e){zo(this,"hot",void 0),zo(this,"state",Ln.VIRGIN),zo(this,"_opened",!1),zo(this,"_fullEditMode",!1),zo(this,"_closeCallback",null),zo(this,"TD",null),zo(this,"row",null),zo(this,"col",null),zo(this,"prop",null),zo(this,"originalValue",null),zo(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,a){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:Ln.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,a;if(n){const h=this.hot.getSelectedLast();i=Math.max(Math.min(h[0],h[2]),0),r=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),a=Math.max(h[1],h[3])}else[i,r,o,a]=[this.row,this.col,null,null];const u=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(u)&&([i,r]=u),this.hot.populateFromArray(i,r,e,o,a,"edit")}beginEditing(e,n){if(this.state!==Ln.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=Ln.EDITING,this.isInFullEditMode()){const h=typeof e=="string"?e:yn(this.originalValue);this.setValue(h)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),i(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ln.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ln.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Ln.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=Ln.FINISHED,this.discardEditor(a)}):(this.state=Ln.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ln.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ln.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ln.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ln.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ln.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,a=Wi(n),u=zn(n),h=Wi(this.hot.rootElement),d=zn(this.hot.rootElement),g=i.topOverlay.holder,p=i.inlineStartOverlay.holder,w=g!==o?g.scrollTop:0,y=p!==o?p.scrollLeft:0,b=o.innerWidth-h.left-d,{wtTable:T}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,M=T.name,I=["master","inline_start"].includes(M)?w:0,_=["master","top","bottom"].includes(M)?y:0,N=a.top===h.top?0:1;let k=a.top-h.top-N-I,$=0;this.hot.isRtl()?$=o.innerWidth-a.left-u-b-1+_:$=a.left-h.left-1-_,["top","top_inline_start_corner"].includes(M)&&(k+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(M)&&($+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),F=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),he=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&F<=0||F===G)&&(k+=1),he<=0&&($+=1);const ye=r.rowsRenderCalculator.startPosition,we=r.columnsRenderCalculator.startPosition,Me=Math.abs(i.inlineStartOverlay.getScrollPosition()),Ee=i.topOverlay.getScrollPosition(),_e=Si(this.hot.rootDocument);let se=n.offsetTop;if(["inline_start","master"].includes(M)&&(se+=ye-Ee),["bottom","bottom_inline_start_corner"].includes(M)){const{wtViewport:ae,wtTable:ge}=i.bottomOverlay.clone;se+=ae.getWorkspaceHeight()-ge.getHeight()-_e}let fe=n.offsetLeft;this.hot.isRtl()?(fe>=0?fe=T.getWidth()-n.offsetLeft:fe=Math.abs(fe),fe+=we-Me-u):["top","master","bottom"].includes(M)&&(fe+=we-Me);const Te=o.getComputedStyle(this.TD),Ge=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",B=parseInt(Te[Ge],10)>0?0:1,ue=parseInt(Te.borderTopWidth,10)>0?0:1,C=zn(n)+B,S=ni(n)+ue,R=pz(g)?_e:0,P=vz(p)?_e:0,V=this.hot.view.maximumVisibleElementWidth(fe)-R+B,J=Math.max(this.hot.view.maximumVisibleElementHeight(se)-P+ue,this.hot.view.getDefaultRowHeight());return{top:k,start:$,height:S,maxHeight:J,width:C,maxWidth:V}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}Xt(Mf,AY);const Xie={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Ln.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Zie={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Qie={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Jie={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},ere={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:o}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const a=t.getSettings(),u=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;n.includes("shift")?t.selection.transformFocus(-u.row,-u.col):t.selection.transformFocus(u.row,u.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),ps(e))}};function tre(){return[zie,Xie,Zie,Qie,Jie,ere]}const nre={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},ire={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(r,-1);if(o!==null){const a=t._createCellCoords(o,i.col),u=i.row-t.getFirstFullyVisibleRow(),h=Math.min(a.row-u,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(a),e.markEndSource(),t.scrollViewportTo({row:h,verticalSnap:"top",horizontalSnap:"start"})}}},rre={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},ore={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},sre={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},are={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),a=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(t.countRows()-1,-1),h=r.clone();h.row=i.row,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,o.col)),e.markEndSource()}}},lre={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const a=n.getNearestNotHiddenIndex(t.countCols()-1,-1),u=r.clone();u.col=i.col,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},ure={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const a=parseInt(t.getSettings().fixedColumnsStart,10),u=n.getNearestNotHiddenIndex(a,1),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},cre={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),a=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},hre={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),a=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},dre={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),a=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(0,1),h=r.clone();h.row=i.row,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,o.col)),e.markEndSource()}}},fre={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},gre={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},mre={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeLast(),r=Math.max(i.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(r,1);if(o!==null){const a=t._createCellCoords(o,i.col),u=i.row-t.getFirstFullyVisibleRow(),h=Math.max(a.row-u,0);e.markSource("keyboard"),e.setRangeEnd(a),e.markEndSource(),t.scrollViewportTo({row:h,verticalSnap:"top",horizontalSnap:"start"})}}};function pre(){return[nre,ire,rre,ore,sre,are,lre,ure,cre,hre,dre,fre,gre,mre]}const vre={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},wre={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+i;o=o===0?1:o,r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},yre={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},Cre={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRangeLast(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},bre={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Sre={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Rre={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},Ere={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),a=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},Tre={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},_re={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,o)),e.markEndSource()}},Mre={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Ore={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},xre={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},Are={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(r,1),u=i.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(a,u)),e.markEndSource()}},Hre={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Ire={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+i;o=o===0?-1:-o,r===-i?o=-1:r+o<i&&(o=-(r+i)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Pre(){return[vre,wre,yre,Cre,bre,Sre,Rre,Ere,Tre,_re,Mre,Ore,xre,Are,Hre,Ire]}const Nre={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Dre={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,a=t._createCellCoords(n,i),u=t._createCellCoords(r,o);if(!t._createCellRange(a,a,u).includes(e)&&(e.row>=0||e.col>=0)){const d={};if(e.col>=0){const g=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-g,0)}if(e.row>=0){const g=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-g,0)}t.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},Lre={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},kre={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Vre={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let a=0;a<e.length;a++)e[a].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==n||h!==i)){const{readOnly:d}=t.getCellMeta(u,h);d||o.set(`${u}x${h}`,[u,h,r])}});t.setDataAtCell(Array.from(o.values()))}},$re=[...tre(),...pre(),...Pre(),Nre,Dre,Lre,kre,Vre];function HY(t){const e={};return $re.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return r(t,...a)}}),e}function Bre(t){const e=t.getShortcutManager().addContext("editor"),n=HY(t),i={group:Pu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function Fre(t){const e=t.getShortcutManager().addContext("grid"),n=HY(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return Ne(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:xY};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorOpen(r,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Pu,runOnlyIf:()=>Ne(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,o;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function Wre(t){[Fre,Bre].forEach(e=>e(t))}function jre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=XF(t),r=XF(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function XF(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&qe(n,[mp("Focus catcher")]),n}function Ure(t){const e=zre(t);let n;const{activate:i,deactivate:r}=jre(t,{onFocusFromTop(){var p;const w=(p=e(n))!==null&&p!==void 0?p:sO(t);w&&(t.runHooks("modifyFocusOnTabNavigation","from_above",w),t.selectCell(w.row,w.col)),t.listen()},onFocusFromBottom(){var p;const w=(p=e(n))!==null&&p!==void 0?p:aO(t);w&&(t.runHooks("modifyFocusOnTabNavigation","from_below",w),t.selectCell(w.row,w.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let a=!0,u=!1,h=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(p,w,y,b,T)=>{if(u&&(o.wrapped&&o.flipped||h)&&(h=!1,T.value=!0),a){var M;n=(M=t.getSelectedRangeLast())===null||M===void 0?void 0:M.highlight}}),t.addHook("beforeRowWrap",(p,w,y)=>{o.wrapped=!0,o.flipped=y});function d(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:xY,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{const{tabNavigation:p}=t.getSettings();u=!0,t.getSelectedRangeLast()&&!p&&(a=!1),p||(h=!0)},position:"before"},{...g,callback:p=>{const{tabNavigation:w,autoWrapRow:y}=t.getSettings();if(u=!1,a=!0,!w||!t.selection.isSelected()||y&&o.wrapped&&o.flipped||!y&&o.wrapped)return y&&o.wrapped&&o.flipped&&(n=p.shiftKey?sO(t):aO(t)),d(),!1;p.preventDefault()},position:"after"}])}function sO(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function aO(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let a=i.getRenderableIndexesLength()-1,u=r.getRenderableIndexesLength()-1;if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}if(u<0){if(!o||t.countColHeaders()===0)return null;u=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(n=r.getVisualFromRenderableIndex(u))!==null&&n!==void 0?n:u)}function zre(t){return e=>{if(!e)return null;const n=sO(t),i=aO(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function Of(t){ul(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function nS(t){const{selection:e,view:n}=t,i=t.getSelectedRangeLast(),r=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),a=n.getLastFullyVisibleColumn(),u=i.getTopStartCorner().col,h=i.getBottomEndCorner().col,d=u<=o,g=h>=a,p=n.getFirstFullyVisibleRow(),w=n.getLastFullyVisibleRow(),y=i.getTopStartCorner().row,b=i.getBottomEndCorner().row,T=y<=p,M=b>=w;return{getComputedColumnTarget(I){return r==="mouse"||r==="keyboard"?I.col:d&&g?i.highlight.col:d?u:g?h:I.col},getComputedRowTarget(I){return r==="mouse"||r==="keyboard"?I.row:T&&M?i.highlight.row:T?y:M?b:I.row}}}function Yre(t){return e=>{const n=nS(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;Of(t.getCell(i?-1:0,n,!0))})}}function Gre(){return()=>{}}function qre(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:i}=t.getSelectedRangeLast().highlight;Of(t.getCell(n,i,!0))})}}function Kre(t){return e=>{const n=nS(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Of(t.getCell(r,o,!0))})}}function Xre(t){return e=>{const n=nS(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Of(t.getCell(r,o,!0))})}}function Zre(t){return e=>{const n=nS(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;Of(t.getCell(n,i?-1:0,!0))})}}function Qre(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,o=()=>{Of(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},o);else if(r<0&&i>=0)t.scrollViewportTo({row:i},o);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},o)}}}function Jre(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let a;e.isFocusSelectionChanged()?a=qre(t):e.isSelectedByCorner()?a=Gre():e.isSelectedByRowHeader()?a=Zre(t):e.isSelectedByColumnHeader()?a=Yre(t):e.getSelectedRange().size()===1&&e.isMultiple()?a=Kre(t):e.getSelectedRange().size()===1&&!e.isMultiple()?a=Qre(t):e.getSelectedRange().size()>1&&(a=Xre(t)),(o=a)===null||o===void 0||o(r)}}}const ZF=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Xw=t=>t.map(e=>{const n=e.toLowerCase();return ZF.has(n)?ZF.get(n):n}).sort().join("+"),eoe=t=>t.split("+"),QF=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),K_=t=>{let{which:e,key:n}=t;if(QF.has(e))return QF.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},IY=Symbol("shortcut-context");function PY(t){return dt(t)&&t.__kindOf===IY}const toe=t=>{const e=Yb({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:h,callback:d,group:g,runOnlyIf:p=()=>!0,captureCtrl:w=!1,preventDefault:y=!0,stopPropagation:b=!1,relativeToGroup:T,position:M,forwardToContext:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wn(g))throw new Error("You need to define the shortcut's group.");if(Ut(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error($t`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:d,group:g,runOnlyIf:p,captureCtrl:w,preventDefault:y,stopPropagation:b};Ne(T)&&(_.relativeToGroup=T,_.position=M),PY(I)&&(_.forwardToContext=I),h.forEach(N=>{const k=Xw(N);if(e.hasItem(k)){const L=e.getItem(k);let F=L.findIndex(he=>he.group===T);F!==-1?M==="before"?F-=1:F+=1:F=L.length,L.splice(F,0,_)}else e.addItem(k,[_])})},i=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(g=>{ft(d,(p,w)=>{Object.prototype.hasOwnProperty.call(g,w)===!1&&(g[w]=d[w])}),n(g)})},r=h=>{const d=Xw(h);e.removeItem(d)};return{__kindOf:IY,addShortcut:n,addShortcuts:i,getShortcuts:h=>{const d=Xw(h),g=e.getItem(d);return Ne(g)?g.slice():[]},hasShortcut:h=>{const d=Xw(h);return e.hasItem(d)},removeShortcutsByKeys:r,removeShortcutsByGroup:h=>{e.getItems().forEach(g=>{let[p,w]=g;const y=w.filter(b=>b.group!==h);y.length===0?r(eoe(p)):(w.length=0,w.push(...y))})}}};function noe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const ioe=["meta","alt","shift","control"],tm=noe(),nm=[];let Zw=0;function roe(t,e,n,i,r){const o=y=>ioe.includes(y),a=function(y){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const T=[];return y.altKey&&T.push("alt"),b&&(y.ctrlKey||y.metaKey)?T.push("control/meta"):(y.ctrlKey&&T.push("control"),y.metaKey&&T.push("meta")),y.shiftKey&&T.push("shift"),T},u=y=>{if(e(y)===!1||n(y)===!1||y.keyCode===229||typeof y.key!="string"||$c(y))return;const T=K_(y);let M=[];o(T)||(M=a(y));const I=[T].concat(M);!r(y,I)&&(cB()&&M.includes("meta")||!cB()&&M.includes("control"))&&r(y,[T].concat(a(y,!0))),i(y)},h=y=>{if(typeof y.key=="string"){const b=K_(y);o(b)&&tm.press(b)}},d=y=>{if(typeof y.key=="string"){const b=K_(y);o(b)&&tm.release(b)}},g=()=>{tm.releaseAll()};return{mount:()=>{let y=t;for(Zw+=1;y;)Zw===1&&(y.document.documentElement.addEventListener("keydown",h),nm.push({event:"keydown",listener:h}),y.document.documentElement.addEventListener("keyup",d),nm.push({event:"keyup",listener:d})),y.document.documentElement.addEventListener("keydown",u),y.document.documentElement.addEventListener("blur",g),y=sf(y)},unmount:()=>{let y=t;for(Zw-=1;y;){if(Zw===0){for(let b=0;b<nm.length;b++){const{event:T,listener:M}=nm[b];y.document.documentElement.removeEventListener(T,M)}nm.length=0}y.document.documentElement.removeEventListener("keydown",u),y.document.documentElement.removeEventListener("blur",g),y=sf(y)}},isPressed:y=>tm.isPressed(y),releasePressedKeys:()=>tm.releaseAll()}}const ooe=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=Yb({errorIdExists:b=>`The "${b}" context name is already registered.`});let a="grid";const u=b=>{const T=toe(b);return o.addItem(b,T),T},h=()=>a,d=b=>o.getItem(b),g=b=>{if(!o.hasItem(b))throw new Error($t`You've tried to activate the "${b}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=b};let p=!1;const w=function(b,T){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const I=PY(M)?M:d(M);let _=!1;if(!I.hasShortcut(T))return _;const N=I.getShortcuts(T);for(let k=0;k<N.length;k++){const{callback:$,runOnlyIf:L,preventDefault:F,stopPropagation:he,captureCtrl:le,forwardToContext:G}=N[k];if(L(b)===!0){if(p=le,_=$(b,T)===!1,p=!1,F&&b.preventDefault(),he&&(ps(b),b.stopPropagation()),_)break;G&&w(b,T,G)}}return _},y=roe(e,n,i,r,w);return y.mount(),{addContext:u,getActiveContextName:h,getContext:d,setActiveContextName:g,isCtrlPressed:()=>!p&&(y.isPressed("control")||y.isPressed("meta")),releasePressedKeys:()=>y.releasePressedKeys(),destroy:()=>y.unmount()}};function JF(t){const{classNames:e}=dZ(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let X_=null;const Z_=new Map;function NY(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new fs(o);let u,h,d,g,p,w,y=!0;Vte(r)&&kte(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",T=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=Lne(e.language);const M=Object.fromEntries(Object.entries(e).filter(C=>{let[S]=C;return!(xe.getSingleton().isRegistered(S)||xe.getSingleton().isDeprecated(S))})),I=new OY(o,M,[kie,Uie]),_=I.getTableMeta(),N=I.getGlobalMeta(),k=Yb();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),cC(this)&&($X(e.licenseKey,t),pe(t,"ht-wrapper")),this.guid=`ht_${ez()}`,Z_.set(this.guid,this),this.columnIndexMapper=new iO,this.rowIndexMapper=new iO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",C=>{o.runHooks("afterColumnSequenceChange",C)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",C=>{o.runHooks("afterRowSequenceChange",C)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",C=>{o.runHooks("beforeCompositionStart",C)}),h=new Jte(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const $=C=>{const{row:S,col:R}=C;return o._createCellCoords(S>=0?o.rowIndexMapper.getRenderableFromVisualIndex(S):S,R>=0?o.columnIndexMapper.getRenderableFromVisualIndex(R):R)},L=C=>{const{row:S,col:R}=C;return o._createCellCoords(S>=0?o.rowIndexMapper.getVisualFromRenderableIndex(S):S,R>=0?o.columnIndexMapper.getVisualFromRenderableIndex(R):R)},F=(C,S)=>{const R=S>C?1:-1,P=Math.min(C,S),V=Math.max(C,S),J=o.rowIndexMapper.getNearestNotHiddenIndex(C,R);return J===null||R===1&&J>V||R===-1&&J<P?null:J>=0?o.rowIndexMapper.getRenderableFromVisualIndex(J):J},he=(C,S)=>{const R=S>C?1:-1,P=Math.min(C,S),V=Math.max(C,S),J=o.columnIndexMapper.getNearestNotHiddenIndex(C,R);return J===null||R===1&&J>V||R===-1&&J<P?null:J>=0?o.columnIndexMapper.getRenderableFromVisualIndex(J):J};let le=new TY(_,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:C=>u.propToCol(C),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(C,S)=>o._createCellCoords(C,S),createCellRange:(C,S,R)=>o._createCellRange(C,S,R),visualToRenderableCoords:$,renderableToVisualCoords:L,findFirstNonHiddenRenderableRow:F,findFirstNonHiddenRenderableColumn:he,isDisabledCellSelection:(C,S)=>C<0||S<0?o.getSettings().disableVisualSelection:o.getCellMeta(C,S).disableVisualSelection});this.selection=le;const G=C=>{let{hiddenIndexesChanged:S}=C;this.forceFullRender=!0,S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(C,S)=>{const R=Jr(!1),P=this.selection.getSelectedRange(),{from:V,to:J}=P.current(),ae=P.size()-1;this.runHooks("afterSelection",V.row,V.col,J.row,J.col,R,ae),this.runHooks("afterSelectionByProp",V.row,o.colToProp(V.col),J.row,o.colToProp(J.col),R,ae),S&&(!R.isTouched()||R.isTouched()&&!R.value)&&w.scrollTo(C);const ge=le.isSelectedByRowHeader(),O=le.isSelectedByColumnHeader();ge&&O?pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ge?(Ue(this.rootElement,"ht__selection--columns"),pe(this.rootElement,"ht__selection--rows")):O?(Ue(this.rootElement,"ht__selection--rows"),pe(this.rootElement,"ht__selection--columns")):Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),le.getSelectionSource()!=="shift"&&g.closeEditor(null),o.view.render(),g.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",C=>{this.runHooks("beforeSelectionFocusSet",C.row,C.col)}),this.selection.addLocalHook("afterSetFocus",C=>{const S=Jr(!1);this.runHooks("afterSelectionFocusSet",C.row,C.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&w.scrollTo(C),g.closeEditor(),o.view.render(),g.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",C=>{const S=C.length-1,{from:R,to:P}=C[S];this.runHooks("afterSelectionEnd",R.row,R.col,P.row,P.col,S),this.runHooks("afterSelectionEndByProp",R.row,o.colToProp(R.col),P.row,o.colToProp(P.col),S)}),this.selection.addLocalHook("afterIsMultipleSelection",C=>{const S=this.runHooks("afterIsMultipleSelection",C.value);C.value&&(C.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{g.closeEditor(),o.view.render(),Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("afterSelectRows",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var C=arguments.length,S=new Array(C),R=0;R<C;R++)S[R]=arguments[R];return i.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",C=>this.alter("insert_row_above",C,1,"auto")).addLocalHook("insertColRequire",C=>this.alter("insert_col_start",C,1,"auto")),d={alter(C,S){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,P=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0;const J=ae=>{if(ae.length===0)return[];const ge=[...ae];return ge.sort((H,A)=>{let[q]=H,[j]=A;return q===j?0:q>j?1:-1}),xr(ge,(H,A)=>{let[q,j]=A;const K=H[H.length-1],[ie,W]=K,X=ie+W;if(q<=X){const te=Math.max(j-(X-q),0);K[1]+=te}else H.push([q,j]);return H},[ge[0]])};switch(C){case"insert_row_below":case"insert_row_above":const ae=o.countSourceRows();if(_.maxRows===ae)return;const ge=C==="insert_row_below"?"below":"above";S=S??(ge==="below"?ae:0);const{delta:O,startPhysicalIndex:H}=u.createRow(S,R,{source:P,mode:ge});le.shiftRows(o.toVisualRow(H),O);break;case"insert_col_start":case"insert_col_end":const A=C==="insert_col_end"?"end":"start";S=S??(A==="end"?o.countSourceCols():0);const{delta:q,startPhysicalIndex:j}=u.createCol(S,R,{source:P,mode:A});if(q){if(Array.isArray(_.colHeaders)){const W=[o.toVisualColumn(j),0];W.length+=q,Array.prototype.splice.apply(_.colHeaders,W)}le.shiftColumns(o.toVisualColumn(j),q)}break;case"remove_row":const K=W=>{let X=0;U(W,te=>{let[Z,ce]=te;const He=Vn(Z)?o.countRows()-1:Math.max(Z-X,0);if(Number.isInteger(Z)&&(Z=Math.max(Z-X,0)),!u.removeRow(Z,ce,P))return;if(le.isSelected()){const{row:Be}=o.getSelectedRangeLast().highlight;Be>=Z&&Be<=Z+ce-1&&g.closeEditor(!0)}const Qe=o.countRows(),st=_.fixedRowsTop;st>=He+1&&(_.fixedRowsTop-=Math.min(ce,st-He));const ot=_.fixedRowsBottom;ot&&He>=Qe-ot&&(_.fixedRowsBottom-=Math.min(ce,ot)),Qe===0?le.deselect():P==="ContextMenu.removeRow"?le.refresh():le.shiftRows(Z,-ce),X+=ce})};Array.isArray(S)?K(J(S)):K([[S,R]]);break;case"remove_col":const ie=W=>{let X=0;U(W,te=>{let[Z,ce]=te;const He=Vn(Z)?o.countCols()-1:Math.max(Z-X,0);let Ie=o.toPhysicalColumn(He);if(Number.isInteger(Z)&&(Z=Math.max(Z-X,0)),!u.removeCol(Z,ce,P))return;if(le.isSelected()){const{col:Be}=o.getSelectedRangeLast().highlight;Be>=Z&&Be<=Z+ce-1&&g.closeEditor(!0)}o.countCols()===0?le.deselect():P==="ContextMenu.removeColumn"?le.refresh():le.shiftColumns(Z,-ce);const ot=_.fixedColumnsStart;ot>=He+1&&(_.fixedColumnsStart-=Math.min(ce,ot-He)),Array.isArray(_.colHeaders)&&(typeof Ie>"u"&&(Ie=-1),_.colHeaders.splice(Ie,ce)),X+=ce})};Array.isArray(S)?ie(J(S)):ie([[S,R]]);break;default:throw new Error(`There is no such action "${C}"`)}V||d.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const C=_.minRows,S=_.minSpareRows,R=_.minCols,P=_.minSpareCols;if(C){const V=o.countRows();V<C&&u.createRow(V,C-V,{source:"auto"})}if(S){const V=o.countEmptyRows(!0);if(V<S){const J=S-V,ae=Math.min(J,_.maxRows-o.countSourceRows());u.createRow(o.countRows(),ae,{source:"auto"})}}{let V;(R||P)&&(V=o.countEmptyCols(!0));let J=o.countCols();if(R&&!_.columns&&J<R){const ae=R-J;V+=ae,u.createCol(J,ae,{source:"auto"})}if(P&&!_.columns&&o.dataType==="array"&&V<P){J=o.countCols();const ae=P-V,ge=Math.min(ae,_.maxCols-J);u.createCol(J,ge,{source:"auto"})}}},populateFromArray(C,S,R,P,V){let J,ae,ge,O;const H=[],A={},q=[],j=C.row,K=C.col;if(ae=S.length,ae===0)return!1;let ie=0,W=0;switch(dt(R)&&(ie=R.col-K+1,W=R.row-j+1),V){case"shift_down":const X=aC(S),te=X.length,Z=Math.max(te,ie),ce=o.getData().slice(j),He=aC(ce).slice(K,K+Z);for(ge=0;ge<Z;ge+=1)if(ge<te){for(J=0,ae=X[ge].length;J<W-ae;J+=1)X[ge].push(X[ge][J%ae]);ge<He.length?q.push(X[ge].concat(He[ge])):q.push(X[ge].concat(new Array(ce.length).fill(null)))}else q.push(X[ge%te].concat(He[ge]));o.populateFromArray(j,K,aC(q));break;case"shift_right":const Ie=S.length,Qe=Math.max(Ie,W),st=o.getData().slice(j).map(Bt=>Bt.slice(K));for(J=0;J<Qe;J+=1)if(J<Ie){for(ge=0,O=S[J].length;ge<ie-O;ge+=1)S[J].push(S[J][ge%O]);if(J<st.length)for(let Bt=0;Bt<st[J].length;Bt+=1)S[J].push(st[J][Bt]);else S[J].push(...new Array(st[0].length).fill(null))}else S.push(S[J%ae].slice(0,Qe).concat(st[J]));o.populateFromArray(j,K,S);break;case"overwrite":default:A.row=C.row,A.col=C.col;let ot=0,Be=0,Je=!0,gt;const Ar=function(cn){let Tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ft=S[cn%S.length];return Tt!==null?Ft[Tt%Ft.length]:Ft},Lo=S.length,or=R?R.row-C.row+1:0;for(R?ae=or:ae=Math.max(Lo,or),J=0;J<ae&&!(R&&A.row>R.row&&or>Lo||!_.allowInsertRow&&A.row>o.countRows()-1||A.row>=_.maxRows);J++){const Bt=J-ot,cn=Ar(Bt).length,Tt=R?R.col-C.col+1:0;if(R?O=Tt:O=Math.max(cn,Tt),A.col=C.col,gt=o.getCellMeta(A.row,A.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&gt.skipRowOnPaste){ot+=1,A.row+=1,ae+=1;continue}for(Be=0,ge=0;ge<O&&!(R&&A.col>R.col&&Tt>cn||!_.allowInsertColumn&&A.col>o.countCols()-1||A.col>=_.maxCols);ge++){if(gt=o.getCellMeta(A.row,A.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&gt.skipColumnOnPaste){Be+=1,A.col+=1,O+=1;continue}if(gt.readOnly&&P!=="UndoRedo.undo"){A.col+=1;continue}const Ft=ge-Be;let it=Ar(Bt,Ft),sr=o.getDataAtCell(A.row,A.col);if(it!==null&&typeof it=="object")if(Array.isArray(it)&&sr===null&&(sr=[]),sr===null||typeof sr!="object")Je=!1;else{const ws=vp(Array.isArray(sr)?sr:sr[0]||sr),ys=vp(Array.isArray(it)?it:it[0]||it);xx(ws,ys)||Array.isArray(ws)&&Array.isArray(ys)?it=ir(it):Je=!1}else sr!==null&&typeof sr=="object"&&(Je=!1);Je&&H.push([A.row,A.col,it]),Je=!0,A.col+=1}A.row+=1}o.setDataAtCell(H,null,null,P||"populateFromArray");break}}};function ye(C){const S=fY(C);_H(S)?(o.runHooks("beforeLanguageChange",S),N.language=S,o.runHooks("afterLanguageChange",S)):gY(C)}function we(C,S){const R=C==="className"?o.rootElement:o.table;if(y)pe(R,S);else{let P=[],V=[];N[C]&&(P=Array.isArray(N[C])?N[C]:Z$(N[C])),S&&(V=Array.isArray(S)?S:Z$(S));const J=X$(P,V),ae=X$(V,P);J.length&&Ue(R,J),ae.length&&pe(R,ae)}N[C]=S}this.init=function(){h.setData(_.data),o.runHooks("beforeInit"),(nl()||_z())&&pe(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Wte(this);const C=_.themeName||JF(o.rootElement);o.useTheme(C),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),g=Z1.getInstance(o,_,le),w=Jre(o),p=new cQ(o),cC(this)&&Ure(o),o.runHooks("init"),this.render(),y&&o.rootElement.offsetParent===null&&CZ(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof y=="object"&&(o.runHooks("afterChange",y[0],y[1]),y=!1),o.runHooks("afterInit")};function Me(){let C=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,C=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&C===!1&&(C=!0,this.onQueueEmpty(this.valid))}}}function Ee(C){const S=C.replace(",",".");return isNaN(parseFloat(S))===!1?parseFloat(S):C}function _e(C,S,R){if(!C.length){R();return}const P=o.getActiveEditor(),V=new Me;let J=!0;V.onQueueEmpty=()=>{P&&J&&P.cancelChanges(),R()};for(let ae=C.length-1;ae>=0;ae--){const[ge,O]=C[ae],H=u.propToCol(O);let A;Number.isInteger(H)?A=o.getCellMeta(ge,H):A={...Object.getPrototypeOf(_),..._},o.getCellValidator(A)&&(V.addValidatorToQueue(),o.validateCell(C[ae][3],A,function(q,j){return function(K){if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&j.allowInvalid===!1&&(J=!1,C.splice(q,1),j.valid=!0),V.removeValidatorFormQueue()}}(ae,A),S))}V.checkIfQueueIsEmpty()}function se(C,S){for(let P=C.length-1;P>=0;P--){let V=!1;if(C[P]===null){C.splice(P,1);continue}if(!((C[P][2]===null||C[P][2]===void 0)&&(C[P][3]===null||C[P][3]===void 0))){if(_.allowInsertRow)for(;C[P][0]>o.countRows()-1;){const{delta:J}=u.createRow(void 0,void 0,{source:"auto"});if(J===0){V=!0;break}}if(o.dataType==="array"&&(!_.columns||_.columns.length===0)&&_.allowInsertColumn)for(;u.propToCol(C[P][1])>o.countCols()-1;){const{delta:J}=u.createCol(void 0,void 0,{source:"auto"});if(J===0){V=!0;break}}V||u.set(C[P][0],C[P][1],C[P][3])}}if(C.length>0){d.adjustRowsAndCols(),o.runHooks("beforeChangeRender",C,S),g.closeEditor(),o.render(),g.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",C,S||"edit");const P=o.getActiveEditor();P&&Ne(P.refreshValue)&&P.refreshValue()}else o.render()}this._createCellCoords=function(C,S){return o.view._wt.createCellCoords(C,S)},this._createCellRange=function(C,S,R){return o.view._wt.createCellRange(C,S,R)},this.validateCell=function(C,S,R,P){let V=o.getCellValidator(S);function J(ae){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){R(ae);return}const O=S.visualCol,H=S.visualRow,A=o.getCell(H,O,!0);if(A&&A.nodeName!=="TH"){const q=o.rowIndexMapper.getRenderableFromVisualIndex(H),j=o.columnIndexMapper.getRenderableFromVisualIndex(O);o.view._wt.getSetting("cellRenderer",q,j,A)}R(ae)}LX(V)&&(V=function(ae){return function(ge,O){O(ae.test(ge))}}(V)),Ut(V)?(C=o.runHooks("beforeValidate",C,S.visualRow,S.prop,P),o._registerImmediate(()=>{V.call(S,C,ae=>{o&&(ae=o.runHooks("afterValidate",ae,C,S.visualRow,S.prop,P),S.valid=ae,J(ae),o.runHooks("postAfterValidate",ae,C,S.visualRow,S.prop,P))})})):o._registerImmediate(()=>{S.valid=!0,J(S.valid,!1)})};function fe(C,S,R){return Array.isArray(C)?C:[[C,S,R]]}function Te(C,S){const R=o.runHooks("beforeChange",C,S||"edit"),P=C.filter(J=>J!==null);if(R===!1||P.length===0){var V;return(V=o.getActiveEditor())===null||V===void 0||V.cancelChanges(),[]}for(let J=P.length-1;J>=0;J--){const[ae,ge,,O]=P[J],H=u.propToCol(ge);let A;Number.isInteger(H)?A=o.getCellMeta(ae,H):A={...Object.getPrototypeOf(_),..._};const{type:q,checkedTemplate:j,uncheckedTemplate:K}=A;if(q==="numeric"&&typeof O=="string"&&RQ(O)&&(P[J][3]=Ee(O)),q==="checkbox"){const ie=yn(O),W=ie===yn(j),X=ie===yn(K);(W||X)&&(P[J][3]=W?j:K)}}return P}this.setDataAtCell=function(C,S,R,P){const V=fe(C,S,R),J=[];let ae=P,ge,O,H;for(ge=0,O=V.length;ge<O;ge++){if(typeof V[ge]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof V[ge][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");V[ge][1]>=this.countCols()?H=V[ge][1]:H=u.colToProp(V[ge][1]),J.push([V[ge][0],H,h.getAtCell(this.toPhysicalRow(V[ge][0]),V[ge][1]),V[ge][2]])}!ae&&typeof C=="object"&&(ae=S);const A=Te(J,ae);o.runHooks("afterSetDataAtCell",A,ae),_e(A,ae,()=>{se(A,ae)})},this.setDataAtRowProp=function(C,S,R,P){const V=fe(C,S,R),J=[];let ae=P,ge,O;for(ge=0,O=V.length;ge<O;ge++)J.push([V[ge][0],V[ge][1],h.getAtCell(this.toPhysicalRow(V[ge][0]),V[ge][1]),V[ge][2]]);!ae&&typeof C=="object"&&(ae=S);const H=Te(J,P);o.runHooks("afterSetDataAtRowProp",H,ae),_e(H,ae,()=>{se(H,ae)})},this.listen=function(){o&&!o.isListening()&&(Z_.forEach(C=>{o!==C&&C.unlisten()}),X_=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(X_=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return X_===o.guid},this.destroyEditor=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.closeEditor(C),o.view.render(),S&&le.isSelected()&&g.prepareEditor()},this.populateFromArray=function(C,S,R,P,V,J,ae){if(!(typeof R=="object"&&typeof R[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const ge=typeof P=="number"?o._createCellCoords(P,V):null;return d.populateFromArray(o._createCellCoords(C,S),R,ge,J,ae)},this.spliceCol=function(C,S,R){for(var P=arguments.length,V=new Array(P>3?P-3:0),J=3;J<P;J++)V[J-3]=arguments[J];return u.spliceCol(C,S,R,...V)},this.spliceRow=function(C,S,R){for(var P=arguments.length,V=new Array(P>3?P-3:0),J=3;J<P;J++)V[J-3]=arguments[J];return u.spliceRow(C,S,R,...V)},this.getSelected=function(){if(le.isSelected())return St(le.getSelectedRange(),C=>{let{from:S,to:R}=C;return[S.row,S.col,R.row,R.col]})},this.getSelectedLast=function(){const C=this.getSelected();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.getSelectedRange=function(){if(le.isSelected())return Array.from(le.getSelectedRange())},this.getSelectedRangeLast=function(){const C=this.getSelectedRange();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.emptySelectedCells=function(C){if(!le.isSelected()||this.countRows()===0||this.countCols()===0)return;const S=[];U(le.getSelectedRange(),R=>{if(R.isSingleHeader())return;const P=R.getTopStartCorner(),V=R.getBottomEndCorner();Ve(P.row,V.row,J=>{Ve(P.col,V.col,ae=>{this.getCellMeta(J,ae).readOnly||S.push([J,ae,null])})})}),S.length>0&&this.setDataAtCell(S,C)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const C=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(C,0),!this.isRenderSuspended()&&C===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(C){this.suspendRender();const S=C();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||C)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const R=C();return this.resumeExecution(S),R},this.batch=function(C){this.suspendRender(),this.suspendExecution();const S=C();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!o.view)return;const C=o.view,{width:S,height:R}=C.getLastSize(),{width:P,height:V}=o.rootElement.getBoundingClientRect(),J=P!==S||V!==R;o.runHooks("beforeRefreshDimensions",{width:S,height:R},{width:P,height:V},J)!==!1&&((J||C._wt.wtOverlays.scrollableElement===o.rootWindow)&&(C.setLastSize(P,V),o.render(),C.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:S,height:R},{width:P,height:V},J))},this.updateData=function(C,S){GF(C,R=>{u=R},R=>{u=R,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),le.refresh()},{hotInstance:o,dataMap:u,dataSource:h,internalSource:"updateData",source:S,metaManager:I,firstRun:y})},this.loadData=function(C,S){GF(C,R=>{u=R},()=>{I.clearCellsCache(),o.initIndexMappers(),d.adjustRowsAndCols(),le.refresh(),y&&(y=[null,"loadData"])},{hotInstance:o,dataMap:u,dataSource:h,internalSource:"loadData",source:S,metaManager:I,firstRun:y})},this.getInitialColumnCount=function(){const C=_.columns;let S=0;if(Array.isArray(C))S=C.length;else if(Ut(C))if(o.dataType==="array"){const R=this.countSourceCols();for(let P=0;P<R;P+=1)C(P)&&(S+=1)}else(o.dataType==="object"||o.dataType==="function")&&(S=u.colToPropCache.length);else if(Ne(_.dataSchema)){const R=u.getSchema();S=Array.isArray(R)?R.length:Ax(R)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(C,S,R,P){return wn(C)?u.getAll():u.getRange(o._createCellCoords(C,S),o._createCellCoords(R,P),u.DESTINATION_RENDERER)},this.getCopyableText=function(C,S,R,P){return u.getCopyableText(o._createCellCoords(C,S),o._createCellCoords(R,P))},this.getCopyableData=function(C,S){return u.getCopyable(C,u.colToProp(S))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const R=(y?o.loadData:o.updateData).bind(this);let P=!1,V,J;if(Ne(C.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ne(C.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ne(C.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');C.language&&ye(C.language);for(V in C)if(!(V==="data"||V==="language"))if(V==="className")we("className",C.className);else if(V==="tableClassName"&&o.table)we("tableClassName",C.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(xe.getSingleton().isRegistered(V)||xe.getSingleton().isDeprecated(V)){const A=C[V];Ut(A)?(xe.getSingleton().addAsFixed(V,A,o),_[V]=A):Array.isArray(A)&&(xe.getSingleton().add(V,A,o),_[V]=A)}else!S&&ti(C,V)&&(N[V]=C[V]);C.data===void 0&&_.data===void 0?R(null,"updateSettings"):C.data!==void 0?R(C.data,"updateSettings"):C.columns!==void 0&&(u.createMap(),o.initIndexMappers());const ae=o.countCols(),ge=_.columns;if(ge&&Ut(ge)&&(P=!0),(C.cell!==void 0||C.cells!==void 0||C.columns!==void 0)&&I.clearCache(),ae>0)for(V=0,J=0;V<ae;V++){if(ge){const A=P?ge(V):ge[J];A&&I.updateColumnMeta(J,A)}J+=1}Ne(C.cell)&&ft(C.cell,A=>{o.setCellMetaObject(A.row,A.col,A)}),o.runHooks("afterCellMetaReset");let O=o.rootElement.style.height;O!==""&&(O=parseInt(o.rootElement.style.height,10));let H=C.height;if(Ut(H)&&(H=H()),S&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),H===null){const A=o.rootElement.getAttribute("data-initialstyle");A&&(A.indexOf("height")>-1||A.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",A):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else H!==void 0&&(o.rootElement.style.height=isNaN(H)?`${H}`:`${H}px`,o.rootElement.style.overflow="hidden");if(typeof C.width<"u"){let A=C.width;Ut(A)&&(A=A()),o.rootElement.style.width=isNaN(A)?`${A}`:`${A}px`}if(!S){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const A=o.getCurrentThemeName(),q=ti(C,"themeName");A&&q&&A!==C.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(A));const j=q&&C.themeName||JF(o.rootElement);o.useTheme(j),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",C)}d.adjustRowsAndCols(),o.view&&!y&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!S&&o.view&&(O===""||H===""||H===void 0)&&O!==H&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const C=o.getSelectedLast();if(_.getValue){if(Ut(_.getValue))return _.getValue.call(o);if(C)return o.getData()[C[0][0]][_.getValue]}else if(C)return o.getDataAtCell(C[0],C[1])},this.getSettings=function(){return _},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(C,S,R,P,V){d.alter(C,S,R,P,V)},this.getCell=function(C,S){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=S,V=C;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;P=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(C>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(C)))return null;V=this.rowIndexMapper.getRenderableFromVisualIndex(C)}return V===null||P===null||V===void 0||P===void 0?null:o.view.getCellAtCoords(o._createCellCoords(V,P),R)},this.getCoords=function(C){const S=this.view._wt.wtTable.getCoords(C);if(S===null)return null;const{row:R,col:P}=S;let V=R,J=P;return R>=0&&(V=this.rowIndexMapper.getVisualFromRenderableIndex(R)),P>=0&&(J=this.columnIndexMapper.getVisualFromRenderableIndex(P)),o._createCellCoords(V,J)},this.colToProp=function(C){return u.colToProp(C)},this.propToCol=function(C){return u.propToCol(C)},this.toVisualRow=C=>this.rowIndexMapper.getVisualFromPhysicalIndex(C),this.toVisualColumn=C=>this.columnIndexMapper.getVisualFromPhysicalIndex(C),this.toPhysicalRow=C=>this.rowIndexMapper.getPhysicalFromVisualIndex(C),this.toPhysicalColumn=C=>this.columnIndexMapper.getPhysicalFromVisualIndex(C),this.getDataAtCell=function(C,S){return u.get(C,u.colToProp(S))},this.getDataAtRowProp=function(C,S){return u.get(C,S)},this.getDataAtCol=function(C){const S=[],R=u.getRange(o._createCellCoords(0,C),o._createCellCoords(_.data.length-1,C),u.DESTINATION_RENDERER);for(let P=0;P<R.length;P+=1)for(let V=0;V<R[P].length;V+=1)S.push(R[P][V]);return S},this.getDataAtProp=function(C){const S=[],R=u.getRange(o._createCellCoords(0,u.propToCol(C)),o._createCellCoords(_.data.length-1,u.propToCol(C)),u.DESTINATION_RENDERER);for(let P=0;P<R.length;P+=1)for(let V=0;V<R[P].length;V+=1)S.push(R[P][V]);return S},this.getSourceData=function(C,S,R,P){let V;return C===void 0?V=h.getData():V=h.getByRange(o._createCellCoords(C,S),o._createCellCoords(R,P)),V},this.getSourceDataArray=function(C,S,R,P){let V;return C===void 0?V=h.getData(!0):V=h.getByRange(o._createCellCoords(C,S),o._createCellCoords(R,P),!0),V},this.getSourceDataAtCol=function(C){return h.getAtColumn(C)},this.setSourceDataAtCell=function(C,S,R,P){const V=fe(C,S,R),J=this.hasHook("afterSetSourceDataAtCell"),ae=[];J&&U(V,O=>{let[H,A,q]=O;ae.push([H,A,h.getAtCell(H,A),q])}),U(V,O=>{let[H,A,q]=O;h.setAtCell(H,A,q)}),J&&this.runHooks("afterSetSourceDataAtCell",ae,P),this.render();const ge=o.getActiveEditor();ge&&Ne(ge.refreshValue)&&ge.refreshValue()},this.getSourceDataAtRow=function(C){return h.getAtRow(C)},this.getSourceDataAtCell=function(C,S){return h.getAtCell(C,S)},this.getDataAtRow=function(C){return u.getRange(o._createCellCoords(C,0),o._createCellCoords(C,this.countCols()-1),u.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(C,S,R,P){const V=C===void 0?[0,0,this.countRows(),this.countCols()]:[C,S,R,P],[J,ae]=V;let[,,ge,O]=V,H=null,A=null;ge===void 0&&(ge=J),O===void 0&&(O=ae);let q="mixed";return Ve(Math.max(Math.min(J,ge),0),Math.max(J,ge),j=>{let K=!0;return Ve(Math.max(Math.min(ae,O),0),Math.max(ae,O),ie=>(A=this.getCellMeta(j,ie).type,H?K=H===A:H=A,K)),q=K?A:"mixed",K}),q},this.removeCellMeta=function(C,S,R){const[P,V]=[this.toPhysicalRow(C),this.toPhysicalColumn(S)];let J=I.getCellMetaKeyValue(P,V,R);o.runHooks("beforeRemoveCellMeta",C,S,R,J)!==!1&&(I.removeCellMeta(P,V,R),o.runHooks("afterRemoveCellMeta",C,S,R,J)),J=null},this.spliceCellsMeta=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var R=arguments.length,P=new Array(R>2?R-2:0),V=2;V<R;V++)P[V-2]=arguments[V];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&I.removeRow(this.toPhysicalRow(C),S),P.length>0&&U(P.reverse(),J=>{I.createRow(this.toPhysicalRow(C)),U(J,(ae,ge)=>this.setCellMetaObject(C,ge,ae))}),o.render()},this.setCellMetaObject=function(C,S,R){typeof R=="object"&&ft(R,(P,V)=>{this.setCellMeta(C,S,V,P)})},this.setCellMeta=function(C,S,R,P){if(o.runHooks("beforeSetCellMeta",C,S,R,P)===!1)return;let J=C,ae=S;C<this.countRows()&&(J=this.toPhysicalRow(C)),S<this.countCols()&&(ae=this.toPhysicalColumn(S)),I.setCellMeta(J,ae,R,P),o.runHooks("afterSetCellMeta",C,S,R,P)},this.getCellsMeta=function(){return I.getCellsMeta()},this.getCellMeta=function(C,S){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},P=this.toPhysicalRow(C),V=this.toPhysicalColumn(S);return P===null&&(P=C),V===null&&(V=S),I.getCellMeta(P,V,{visualRow:C,visualColumn:S,...R})},this.getColumnMeta=function(C){return I.getColumnMeta(this.toPhysicalColumn(C))},this.getCellMetaAtRow=function(C){return I.getCellsMetaAtRow(C)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||_.columns)},this.getCellRenderer=function(C,S){const R=typeof C=="number"?o.getCellMeta(C,S).renderer:C.renderer;return typeof R=="string"?eO(R):wn(R)?eO("text"):R},this.getCellEditor=function(C,S){const R=typeof C=="number"?o.getCellMeta(C,S).editor:C.editor;return typeof R=="string"?X1(R):wn(R)?X1("text"):R},this.getCellValidator=function(C,S){const R=typeof C=="number"?o.getCellMeta(C,S).validator:C.validator;return typeof R=="string"?BQ(R):R},this.validateCells=function(C){this._validateCells(C)},this.validateRows=function(C,S){if(!Array.isArray(C))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,C)},this.validateColumns=function(C,S){if(!Array.isArray(C))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,C)},this._validateCells=function(C,S,R){const P=new Me;C&&(P.onQueueEmpty=C);let V=o.countRows()-1;for(;V>=0;){if(S!==void 0&&S.indexOf(V)===-1){V-=1;continue}let J=o.countCols()-1;for(;J>=0;){if(R!==void 0&&R.indexOf(J)===-1){J-=1;continue}P.addValidatorToQueue(),o.validateCell(o.getDataAtCell(V,J),o.getCellMeta(V,J),ae=>{if(typeof ae!="boolean")throw new Error("Validation error: result is not boolean");ae===!1&&(P.valid=!1),P.removeValidatorFormQueue()},"validateCells"),J-=1}V-=1}P.checkIfQueueIsEmpty()},this.getRowHeader=function(C){let S=_.rowHeaders,R=C;return R!==void 0&&(R=o.runHooks("modifyRowHeader",R)),R===void 0?(S=[],Ve(o.countRows()-1,P=>{S.push(o.getRowHeader(P))})):Array.isArray(S)&&S[R]!==void 0?S=S[R]:Ut(S)?S=S(R):S&&typeof S!="string"&&typeof S!="number"&&(S=R+1),S},this.hasRowHeaders=function(){return!!_.rowHeaders},this.hasColHeaders=function(){if(_.colHeaders!==void 0&&_.colHeaders!==null)return!!_.colHeaders;for(let C=0,S=o.countCols();C<S;C++)if(o.getColHeader(C))return!0;return!1},this.getColHeader=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const R=o.runHooks("modifyColHeader",C);if(R===void 0){const ge=[],O=o.countCols();for(let H=0;H<O;H++)ge.push(o.getColHeader(H));return ge}let P=_.colHeaders;const V=function(ge){const O=[],H=o.countCols();let A=0;for(;A<H;A++)Ut(_.columns)&&_.columns(A)&&O.push(A);return O[ge]},J=o.toPhysicalColumn(R),ae=V(J);return _.colHeaders===!1?P=null:_.columns&&Ut(_.columns)&&_.columns(ae)&&_.columns(ae).title?P=_.columns(ae).title:_.columns&&_.columns[J]&&_.columns[J].title?P=_.columns[J].title:Array.isArray(_.colHeaders)&&_.colHeaders[J]!==void 0?P=_.colHeaders[J]:Ut(_.colHeaders)?P=_.colHeaders(J):_.colHeaders&&typeof _.colHeaders!="string"&&typeof _.colHeaders!="number"&&(P=qte(R)),P=o.runHooks("modifyColumnHeaderValue",P,C,S),P},this._getColWidthFromSettings=function(C){let S;if(C>=0&&(S=o.getCellMeta(0,C).width),(S===void 0||S===_.width)&&(S=_.colWidths),S!=null){switch(typeof S){case"object":S=S[C];break;case"function":S=S(C);break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getColWidth=function(C,S){let R=o._getColWidthFromSettings(C);return R=o.runHooks("modifyColWidth",R,C,S),R===void 0&&(R=lf),R},this._getRowHeightFromSettings=function(C){const S=this.view.getDefaultRowHeight();let R=_.rowHeights;if(R!=null){switch(typeof R){case"object":R=R[C];break;case"function":R=R(C);break}typeof R=="string"&&(R=parseInt(R,10))}return R!=null&&R<S?S:R},this.getRowHeight=function(C,S){let R=o._getRowHeightFromSettings(C);return R=o.runHooks("modifyRowHeight",R,C,S),R},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return u.getLength()},this.countCols=function(){const C=_.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(C,S)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return VB(o.countRows()-1,R=>{if(o.isEmptyRow(R))S+=1;else if(C===!0)return!1}),S},this.countEmptyCols=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return VB(o.countCols()-1,R=>{if(o.isEmptyCol(R))S+=1;else if(C===!0)return!1}),S},this.isEmptyRow=function(C){return _.isEmptyRow.call(o,C)},this.isEmptyCol=function(C){return _.isEmptyCol.call(o,C)},this.selectCell=function(C,S,R,P){let V=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,J=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return wn(C)||wn(S)?!1:this.selectCells([[C,S,R,P]],V,J)},this.selectCells=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&w.suspend();const P=le.selectCells(C);return P&&R&&o.listen(),w.resume(),P},this.selectColumns=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,R=arguments.length>2?arguments[2]:void 0;return le.selectColumns(C,S,R)},this.selectRows=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,R=arguments.length>2?arguments[2]:void 0;return le.selectRows(C,S,R)},this.deselectCell=function(){le.deselect()},this.selectAll=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,R=arguments.length>2?arguments[2]:void 0;w.skipNextScrollCycle(),le.selectAll(C,S,R)};const Ge=(C,S)=>C.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(C,S){if(typeof C=="number"){var R;C={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(R=arguments[4])!==null&&R!==void 0?R:!0}}const{row:P,col:V,considerHiddenIndexes:J}=C??{};let ae=P,ge=V;if(Ut(S)&&this.addHookOnce("afterScroll",S),J===void 0||J){const q=Number.isInteger(P)&&P>=0,j=Number.isInteger(V)&&V>=0,K=q?Ge(this.rowIndexMapper,P):void 0,ie=j?Ge(this.columnIndexMapper,V):void 0;if(K===null||ie===null)return!1;ae=q?o.rowIndexMapper.getRenderableFromVisualIndex(K):P,ge=j?o.columnIndexMapper.getRenderableFromVisualIndex(ie):V}const O=Number.isInteger(ae),H=Number.isInteger(ge);let A=!1;return O&&ae>=0&&H&&ge>=0?A=o.view.scrollViewport(o._createCellCoords(ae,ge),C.horizontalSnap,C.verticalSnap):O&&ae>=0&&(H&&ge<0||!H)?A=o.view.scrollViewportVertically(ae,C.verticalSnap):H&&ge>=0&&(O&&ae<0||!O)&&(A=o.view.scrollViewportHorizontally(ge,C.horizontalSnap)),Ut(S)&&(A?this.view.render():(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S()))),A},this.scrollToFocusedCell=function(C){if(!this.selection.isSelected())return!1;Ut(C)&&this.addHookOnce("afterScroll",C);const{highlight:S}=this.getSelectedRangeLast(),R=this.scrollViewportTo(S.toObject());return R?this.view.render():Ut(C)&&(this.removeHook("afterScroll",C),this._registerMicrotask(()=>C())),R},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),I.clearCache(),Z_.delete(this.guid),cC(o)){const C=this.rootDocument.querySelector(".hot-display-license-info");C&&C.parentNode.removeChild(C)}hl(o.rootElement),a.destroy(),g&&g.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),k.getItems().forEach(C=>{let[,S]=C;S.destroy()}),k.clear(),o.runHooks("afterDestroy")},!0),xe.getSingleton().destroy(o),ft(o,(C,S,R)=>{Ut(C)?R[S]=B(S):S!=="guid"&&(R[S]=null)}),o.isDestroyed=!0,u&&u.destroy(),u=null,d=null,le=null,g=null,o=null};function B(C){return()=>{throw new Error(`The "${C}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(C){return k.getItem(ds(C))},this.getPluginName=function(C){return C===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:k.getId(C)},this.getInstance=function(){return o},this.addHook=function(C,S,R){xe.getSingleton().add(C,S,o,R)},this.hasHook=function(C){return xe.getSingleton().has(C,o)||xe.getSingleton().has(C)},this.addHookOnce=function(C,S,R){xe.getSingleton().once(C,S,o,R)},this.removeHook=function(C,S){xe.getSingleton().remove(C,S,o)},this.runHooks=function(C,S,R,P,V,J,ae){return xe.getSingleton().run(o,C,S,R,P,V,J,ae)},this.getTranslatedPhrase=function(C,S){return CY(_.language,C,S)},this.toHTML=()=>LB(this),this.toTableElement=()=>{const C=this.rootDocument.createElement("div");return C.insertAdjacentHTML("afterbegin",LB(this)),C.firstElementChild},this.timeouts=[],this.useTheme=C=>{this.view.getStylesHandler().useTheme(C),this.runHooks("afterSetTheme",C,!!y)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=C;typeof R=="function"&&(R=setTimeout(R,S)),this.timeouts.push(R)},this._clearTimeouts=function(){U(this.timeouts,C=>{clearTimeout(C)})},this.immediates=[],this._registerImmediate=function(C){this.immediates.push(setImmediate(C))},this._clearImmediates=function(){U(this.immediates,C=>{clearImmediate(C)})},this._registerMicrotask=function(C){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||C()})},this._getEditorManager=function(){return g};const ue=ooe({handleEvent(){return o.isListening()},beforeKeyDown:C=>this.runHooks("beforeKeyDown",C),afterKeyDown:C=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",C=>{C.ctrlKey===!1&&C.metaKey===!1&&ue.releasePressedKeys()}),this.getShortcutManager=function(){return ue},this.getFocusManager=function(){return p},kz().forEach(C=>{const S=Dx(C);k.addItem(C,new S(this))}),Wre(o),ue.setActiveContextName("grid"),xe.getSingleton().run(o,"construct")}function eW(t,e,n){t.addEventListener(e,n,!1)}function tW(t,e,n){t.removeEventListener(e,n,!1)}function Qw(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function DY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:p=>p.value,...e},i=t.body,r=t.createTextNode(""),o=t.createElement("span");let a;function u(){var p,w;r.textContent=n.textContent(a),o.style.position="absolute",o.style.fontSize=Qw(a).fontSize,o.style.fontFamily=Qw(a).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const y=parseInt(((p=Qw(a))===null||p===void 0?void 0:p.paddingInlineStart)||0,10),b=parseInt(((w=Qw(a))===null||w===void 0?void 0:w.paddingInlineEnd)||0,10),T=o.clientWidth+y+b+1;i.removeChild(o);const M=a.style;M.height=`${n.minHeight}px`,n.minWidth>T?M.width=`${n.minWidth}px`:T>n.maxWidth?M.width=`${n.maxWidth}px`:M.width=`${T}px`;const I=a.scrollHeight?a.scrollHeight-1:0;n.minHeight>I?M.height=`${n.minHeight}px`:n.maxHeight<I?(M.height=`${n.maxHeight}px`,M.overflowY="visible"):M.height=`${I}px`}function h(){t.defaultView.setTimeout(u,0)}function d(p){if(p&&p.minHeight)if(p.minHeight==="inherit")n.minHeight=a.clientHeight;else{const w=parseInt(p.minHeight,10);isNaN(w)||(n.minHeight=w)}if(p&&p.maxHeight)if(p.maxHeight==="inherit")n.maxHeight=a.clientHeight;else{const w=parseInt(p.maxHeight,10);isNaN(w)||(n.maxHeight=w)}if(p&&p.minWidth)if(p.minWidth==="inherit")n.minWidth=a.clientWidth;else{const w=parseInt(p.minWidth,10);isNaN(w)||(n.minWidth=w)}if(p&&p.maxWidth)if(p.maxWidth==="inherit")n.maxWidth=a.clientWidth;else{const w=parseInt(p.maxWidth,10);isNaN(w)||(n.maxWidth=w)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function g(p,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=p,d(w),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${n.minHeight}px`,a.style.minWidth=`${n.minWidth}px`,a.style.maxWidth=`${n.maxWidth}px`,a.style.overflowY="hidden"),y&&(eW(a,"input",u),eW(a,"keydown",h)),u()}return{init:g,resize:u,unObserve(){tW(a,"input",u),tW(a,"keydown",h)}}}function nW(t,e){const n=mz(e),i=e.value.split(`
`);let r=n,o=0;for(let a=0;a<i.length;a++){const u=i[a];a!==0&&(o+=i[a-1].length+1);const h=o+u.length;if(t==="home"?r=o:t==="end"&&(r=h),n<=h)break}Fb(e,r)}function sc(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:e+""}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const loe="ht_editor_visible",Jw="ht_editor_hidden",iW="textEditor",uoe="text";class ph extends Mf{static get EDITOR_TYPE(){return uoe}constructor(e){super(e),sc(this,"eventManager",new fs(this)),sc(this,"autoResize",DY(this.hot.rootDocument)),sc(this,"TEXTAREA",void 0),sc(this,"textareaStyle",void 0),sc(this,"TEXTAREA_PARENT",void 0),sc(this,"textareaParentStyle",void 0),sc(this,"layerClass",void 0),this.eventManager=new fs(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),lC(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,a){const u=this.state;if(super.prepare(e,n,i,r,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=a;h&&!this.isOpened()&&(this.TEXTAREA.value=""),u!==Ln.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ln.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Fb(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),qe(this.TEXTAREA,[["data-hot-input",""],fh(-1)]),pe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),pe(this.TEXTAREA_PARENT,"handsontableInputHolder"),ze(this.TEXTAREA_PARENT,this.layerClass)&&Ue(this.TEXTAREA_PARENT,this.layerClass),pe(this.TEXTAREA_PARENT,Jw),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){PZ()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ue(this.TEXTAREA_PARENT,this.layerClass),pe(this.TEXTAREA_PARENT,Jw)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Ve(e.length-1,i=>{const r=e[i];if(ze(r,"handsontableEditor"))return n=!0,!1}),ze(this.TEXTAREA_PARENT,Jw)&&Ue(this.TEXTAREA_PARENT,Jw),n?(this.layerClass=loe,pe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),pe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ln.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:a,maxHeight:u}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(a,u),maxWidth:o,maxHeight:u},!0)}bindEvents(){Tz()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ln.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ln.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>Ne(this.hot.getSelected()),group:iW},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[u]=a;nW(u,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[u]=a;nW(u,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(iW)}}const coe="base";function Zp(t,e,n,i,r,o,a){const u=a.ariaTags,h=[],d=[],g=[],p=[];a.className&&pe(e,a.className),a.readOnly?(h.push(a.readOnlyCellClassName),u&&p.push(iB())):u&&g.push(iB()[0]),a.valid===!1&&a.invalidCellClassName?(h.push(a.invalidCellClassName),u&&p.push(rB())):(d.push(a.invalidCellClassName),u&&g.push(rB()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&h.push(a.noWordWrapClassName),!o&&a.placeholder&&h.push(a.placeholderCellClassName),Ue(e,d),pe(e,h),Ef(e,g),qe(e,p)}Zp.RENDERER_TYPE=coe;const hoe="text";function yl(t,e,n,i,r,o,a){Zp.apply(this,[t,e,n,i,r,o,a]);let u=o;!u&&a.placeholder&&(u=a.placeholder),u=yn(u),a.trimWhitespace&&(u=u.trim()),Jc(e,u)}yl.RENDERER_TYPE=hoe;const doe="text",LY={CELL_TYPE:doe,editor:ph,renderer:yl};Xo(LY);vt.editors={BaseEditor:Mf};function vt(t,e){const n=new NY(t,e||{},Qx);return n.init(),n}vt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new NY(t,e,Qx)};vt.DefaultSettings=MY();vt.hooks=xe.getSingleton();vt.CellCoords=th;vt.CellRange=Gp;vt.packageName="handsontable";vt.buildDate="24/04/2025 10:59:00";vt.version="15.3.0";vt.languages={dictionaryKeys:xne,getLanguageDictionary:yY,getLanguagesDictionaries:Nne,registerLanguageDictionary:wY,getTranslatedPhrase:CY};function lO(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function foe(t){if(Array.isArray(t))return lO(t)}function goe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bp(t,e,n){return e=WC(e),boe(t,kY()?Reflect.construct(e,n||[],WC(t).constructor):e.apply(t,n))}function cf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rW(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,VY(i.key),i)}}function hf(t,e,n){return e&&rW(t.prototype,e),n&&rW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function moe(t,e,n){return(e=VY(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WC(t){return WC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},WC(t)}function Sp(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uO(t,e)}function kY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kY=function(){return!!t})()}function poe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function voe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oW(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function woe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oW(Object(n),!0).forEach(function(i){moe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oW(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function yoe(t,e){if(t==null)return{};var n,i,r=Coe(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Coe(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function boe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return goe(t)}function uO(t,e){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},uO(t,e)}function Soe(t){return foe(t)||poe(t)||Eoe(t)||voe()}function Roe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function VY(t){var e=Roe(t,"string");return typeof e=="symbol"?e:e+""}function Eoe(t,e){if(t){if(typeof t=="string")return lO(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lO(t,e):void 0}}var Q_=null,Toe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",_oe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",jC="global",Moe="hot-wrapper-editor-container";function Ooe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function cO(t,e){var n=_n.Children.toArray(t),i=_n.Children.count(t),r=null;return i!==0&&(i===1&&n[0].props[e]?r=n[0]:r=n.find(function(o){return o.props[e]!==void 0})),r||null}function $Y(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function BY(t,e){if(typeof t>"u"||e===null)return null;var n=WY(e.props,!1);return n.className="".concat(Moe," ").concat(n.className),A2.createPortal(_n.createElement("div",Object.assign({},n),e),t.body)}function FY(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jC,i=cO(t,"hot-editor"),r=$Y(i);return i?_n.cloneElement(i,{emitEditorInstance:function(a,u){e.get(r)||e.set(r,new Map);var h=e.get(r);h.set(u??jC,a)},editorColumnScope:n,isEditor:!0}):null}function xoe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;n||(n=document),Q_||(Q_=n.createDocumentFragment());var o=r??n.createElement("DIV");Q_.appendChild(o);var a=_n.cloneElement(t,woe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:A2.createPortal(a,o,i),portalContainer:o}}function WY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function Aoe(){return typeof window<"u"}var jY=function(){function t(){cf(this,t)}return hf(t,null,[{key:"getSettings",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.prevProps,o=r===void 0?{}:r,a=i.isInit,u=a===void 0?!1:a,h=i.initOnlySettingKeys,d=h===void 0?[]:h,g=function(M){return!u&&d.includes(M)?o[M]===n[M]:!1},p={};if(n.settings){var w=n.settings;for(var y in w)w.hasOwnProperty(y)&&!g(y)&&(p[y]=w[y])}for(var b in n)b!=="settings"&&b!=="children"&&!g(b)&&n.hasOwnProperty(b)&&(p[b]=n[b]);return p}}])}(),Hoe=function(t){function e(){return cf(this,e),bp(this,e,arguments)}return Sp(e,t),hf(e,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(r){return!i.internalProps.includes(r)}).reduce(function(r,o){return r[o]=i.props[o],r},{})}},{key:"getLocalEditorElement",value:function(){return FY(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),r=this.getLocalEditorElement();this.columnSettings=jY.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),r!==null&&(this.columnSettings.editor=this.props._getEditorClass(r,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),r=BY(i,this.getLocalEditorElement());return _n.createElement(_n.Fragment,null,r)}}])}(_n.Component),Ioe=function(t){function e(){var n;return cf(this,e),n=bp(this,e,arguments),n.state={portals:[]},n}return Sp(e,t),hf(e,[{key:"render",value:function(){return _n.createElement(_n.Fragment,null,this.state.portals)}}])}(_n.Component),Poe="15.3.0";function Noe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var UY={exports:{}},J_,sW;function Doe(){if(sW)return J_;sW=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return J_=t,J_}var eM,aW;function Loe(){if(aW)return eM;aW=1;var t=Doe();function e(){}function n(){}return n.resetWarningCache=e,eM=function(){function r(u,h,d,g,p,w){if(w!==t){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}r.isRequired=r;function o(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return a.PropTypes=a,a},eM}UY.exports=Loe()();var koe=UY.exports,tM=Noe(koe),OH=function(t){function e(){var n;return cf(this,e),n=bp(this,e,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCache=new Map,n.portalContainerCache=new Map,n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Sp(e,t),hf(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(_oe),null)},set:function(i){this.__hotInstance=i}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return Aoe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var r=this;return function(a,u,h,d,g,p,w){var y=r.getRenderedCellCache(),b=r.getPortalContainerCache(),T="".concat(h,"-").concat(d),M=a.guid,I="".concat(M,"-").concat(T),_="".concat(T,"-").concat(M);if(y.has(T)&&(u.innerHTML=y.get(T).innerHTML),u&&!u.getAttribute("ghost-table")){for(var N=r.portalCache.get(_),k=b.get(I);u.firstChild;)u.removeChild(u.firstChild);if(N&&k)u.appendChild(k);else{var $=xoe(i,{TD:u,row:h,col:d,prop:g,value:p,cellProperties:w,isRenderer:!0},u.ownerDocument,_,k),L=$.portal,F=$.portalContainer;b.set(I,F),u.appendChild(F),r.portalCache.set(_,L)}}return y.set(T,u),u}}},{key:"getEditorClass",value:function(i){var r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jC,a=$Y(i),u=(r=this.getEditorCache().get(a))===null||r===void 0?void 0:r.get(o);return this.makeEditorClass(u)}},{key:"makeEditorClass",value:function(i){var r=function(o){function a(u){var h;return cf(this,a),h=bp(this,a,[u]),i.hotCustomEditorInstance=h,h.editorComponent=i,h}return Sp(a,o),hf(a,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(vt.editors.BaseEditor);return Object.getOwnPropertyNames(vt.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(r.prototype[o]=function(){for(var a,u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return(a=i[o]).call.apply(a,[i].concat(h))})}),r}},{key:"getGlobalRendererElement",value:function(){return cO(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return FY(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],u=jY.getSettings(this.props,{prevProps:o,isInit:r,initOnlySettingKeys:a}),h=this.getGlobalRendererElement(),d=this.getGlobalEditorElement();if(u.columns=this.columnSettings.length?this.columnSettings:u.columns,d)u.editor=this.getEditorClass(d,jC);else{var g;this.props.editor||(g=this.props.settings)!==null&&g!==void 0&&g.editor?u.editor=this.props.editor||this.props.settings.editor:u.editor=X1("text")}if(h)u.renderer=this.getRendererWrapper(h),this.componentRendererColumns.set("global",!0);else{var p;this.props.renderer||(p=this.props.settings)!==null&&p!==void 0&&p.renderer?u.renderer=this.props.renderer||this.props.settings.renderer:u.renderer=eO("text")}return u}},{key:"displayAutoSizeWarning",value:function(i){var r,o;this.hotInstance&&((r=this.hotInstance.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&Ooe(Toe)}},{key:"setHotColumnSettings",value:function(i,r){this.columnSettings[r]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:Soe(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,r=this.createNewGlobalSettings(!0);this.hotInstance=new vt.Core(this.hotElementRef,r),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(r)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var r=this.createNewGlobalSettings(!1,i);this.updateHot(r),this.displayAutoSizeWarning(r)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,r=function(g){return g.type===Hoe},o=_n.Children.toArray(this.props.children),a=o.filter(function(d){return r(d)}).map(function(d,g){return _n.cloneElement(d,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:g,_getChildElementByType:cO.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:d.props.children})}),u=WY(this.props),h=BY(this.getOwnerDocument(),this.getGlobalEditorElement());return _n.createElement(_n.Fragment,null,_n.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},u),a),_n.createElement(Ioe,{ref:this.setRenderersPortalManagerRef.bind(this)}),h)}}],[{key:"version",get:function(){return Poe}}])}(_n.Component);OH.propTypes={style:tM.object,id:tM.string,className:tM.string};var Voe=["children"],zY=_n.forwardRef(function(t,e){var n,i=t.children,r=yoe(t,Voe),o=typeof _n.useId=="function"?_n.useId():void 0,a=(n=r.id)!==null&&n!==void 0?n:o;return _n.createElement(OH,Object.assign({id:a},r,{ref:e}),i)});zY.version=OH.version;_n.Component;const lW="handsontableEditor",$oe="handsontable";class xH extends ph{static get EDITOR_TYPE(){return $oe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Fb(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a);const u=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(d,g){const p=this.getSourceData(g.row,g.col);p!==void 0&&u.setValue(p),u.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&ii(h,a.handsontable),this.htOptions=h}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var i;(i=this.htEditor)===null||i===void 0||i.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:lW,relativeToGroup:Pu,position:"before"},r=(o,a)=>{const u=this.htEditor;if(o!==void 0&&(o<0||u.flipped&&o>u.countRows()-1?u.deselectCell():u.selectCell(o,0),u.getData().length))return a.preventDefault(),ps(a),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let u,h;return!a.getSelectedLast()&&a.flipped?u=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(h=a.getSelectedLast()[0],u=Math.max(0,h-1)):(h=a.getSelectedLast()[0],u=h-1)),r(u,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let u,h;if(!a.getSelectedLast()&&!a.flipped)u=0;else if(a.getSelectedLast()){if(a.flipped)u=a.getSelectedLast()[0]+1;else if(!a.flipped){const d=a.countRows()-1;h=a.getSelectedLast()[0],u=Math.min(d,h+1)}}return r(u,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(lW)}}function Boe(t,e){YY(t,e),e.add(t)}function uW(t,e,n){YY(t,e),e.set(t,n)}function YY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ey(t,e,n){return(e=Foe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Foe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:e+""}function Woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nM(t,e){return t.get(hO(t,e))}function hO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const joe="autocomplete";var iM=new WeakMap,cW=new WeakMap,rM=new WeakSet;class AH extends xH{constructor(){super(...arguments),Boe(this,rM),ey(this,"query",null),ey(this,"strippedChoices",[]),ey(this,"rawChoices",[]),uW(this,iM,this.hot.guid.slice(0,9)),uW(this,cW,jb(()=>{this.focus()},100)),ey(this,"sortByRelevance",function(e,n,i){const r=[],o=[],a=e.length;let u=n.length,h,d,g,p;if(a===0){for(g=0;g<u;g++)o.push(g);return o}for(g=0;g<u;g++){if(d=nB(yn(n[g])),i)p=d.indexOf(e);else{const w=this.cellProperties.locale;p=d.toLocaleLowerCase(w).indexOf(e.toLocaleLowerCase(w))}p!==-1&&(h=d.length-p-a,r.push({baseIndex:g,index:p,charsLeft:h,value:d}))}for(r.sort((w,y)=>{if(y.index===-1)return-1;if(w.index===-1)return 1;if(w.index<y.index)return-1;if(y.index<w.index)return 1;if(w.index===y.index){if(w.charsLeft<y.charsLeft)return-1;if(w.charsLeft>y.charsLeft)return 1}return 0}),g=0,u=r.length;g<u;g++)o.push(r[g].baseIndex);return o})}static get EDITOR_TYPE(){return joe}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return Ne(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),pe(this.htContainer,"autocompleteEditor"),pe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[JX(),qX(),oz("listbox"),iZ()])}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[Oo("false"),rZ(`${nM(iM,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.addHook("afterScroll",nM(cW,this)),this.htEditor.updateSettings({colWidths:e?[zn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(u,h,d,g,p,w,y)=>{yl(u,h,d,g,p,w,y);const{filteringCaseSensitive:b,allowHtml:T,locale:M}=this.cellProperties,I=this.query;let _=yn(w),N,k;_&&!T&&(N=b===!0?_.indexOf(I):_.toLocaleLowerCase(M).indexOf(I.toLocaleLowerCase(M)),N!==-1&&(k=_.substr(N,I.length),_=_.replace(k,`<strong>${k}</strong>`))),n&&qe(h,[KX(),...i?[lZ(r)]:[],...i?[uZ(i.indexOf(w)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${g}`]]),h.innerHTML=_},afterSelectionEnd:(u,h)=>{if(n){const d=p=>{qe(p,[Tx()]),qe(this.TEXTAREA,...oZ(p.id))},g=this.htEditor.getCell(u,h,!0);g!==null?d(g):this.htEditor.addHookOnce("afterScrollVertically",()=>{const p=this.htEditor.getCell(u,h,!0);d(p)})}}}),n&&(qe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...tl()),qe(this.htEditor.rootElement,[rz(),sZ("polite"),aZ("text"),["id",`${nM(iM,this)}-listbox-${o}-${a}`]]),qe(this.TEXTAREA,...Oo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[Oo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=mz(this.TEXTAREA),i=wZ(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,u=null,h=e;r&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));const d=Array.isArray(a)?a.length:0;if(o===!1)d&&(u=a[0]);else{const g=[];for(let p=0,w=h.length;p<w&&!(r&&d<=p);p++)d?g.push(h[a[p]]):g.push(h[p]);u=0,h=g}this.strippedChoices=h,h.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(aC([h])),h.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u)),this.hot.listen(),Fb(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let i=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const u=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+u,0)}const r=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-i-n,a=r>o&&i>o+n;return a?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(a?i:o,r),a}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,o=0,a=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),i+=o,r+=1;while(i<e);a=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-a}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),hO(rM,this,hW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),hO(rM,this,hW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(o,a)=>a).reduce((o,a)=>{const u=this.htEditor.getRowHeight(a)||this.htEditor.view.getDefaultRowHeight();return o+u},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=St(e,o=>yn(o));return St(i,o=>n?o:nB(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===We.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===We.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(DZ(e.keyCode)||e.keyCode===We.BACKSPACE||e.keyCode===We.DELETE||e.keyCode===We.INSERT){let n=10;if(e.keyCode===We.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function hW(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+Si(this.hot.rootDocument)})}const Uoe="checkbox";class GY extends Mf{static get EDITOR_TYPE(){return Uoe}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');ze(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const vu=()=>window,Ro=()=>window.document,dO=(t,e)=>window.setTimeout(t,e),Us=function(t,e,n,i){t.addEventListener(e,n,!!i)},Da=function(t,e,n,i){t.removeEventListener(e,n,!!i)},zoe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},zr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},oM=function(t,e){zr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},sM=function(t,e){t.className=zoe((" "+t.className+" ").replace(" "+e+" "," "))},HH=function(t){return/Array/.test(Object.prototype.toString.call(t))},Kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Yoe=function(t){let e=t.getDay();return e===0||e===6},Goe=function(t){return t%4===0&&t%100!==0||t%400===0},dW=function(t,e){return[31,Goe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},ty=function(t){Kr(t)&&t.setHours(0,0,0,0)},ny=function(t,e){return t.getTime()===e.getTime()},UC=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Kr(e[i])?n&&(t[i]=new Date(e[i].getTime())):HH(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=UC({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},fW=function(t,e,n){let i=Ro().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=UC(i,n),t.dispatchEvent(i)},gW=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Ps={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},mW=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},qoe=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},Koe=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,a=7,u=function(w){return(w+a-1)%a};t.setDate(n+o-u(i));let h=new Date(t.getFullYear(),0,r),d=24*60*60*1e3,g=(t.getTime()-h.getTime())/d;return 1+Math.round((g-o+u(h.getDay()))/a)},Xoe=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():Koe(o,r))+"</td>"},Zoe=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Qoe=function(t){return"<tbody>"+t.join("")+"</tbody>"},Joe=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+mW(t,e)+'">'+mW(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},ese=function(t,e,n,i,r,o){let a,u,h,d=t._o,g=n===d.minYear,p=n===d.maxYear,w='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',y,b,T=!0,M=!0;for(h=[],a=0;a<12;a++)h.push('<option value="'+(n===r?a-e:12+a-e)+'"'+(a===i?' selected="selected"':"")+(g&&a<d.minMonth||p&&a>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[a]+"</option>");for(y='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",HH(d.yearRange)?(a=d.yearRange[0],u=d.yearRange[1]+1):(a=n-d.yearRange,u=1+n+d.yearRange),h=[];a<u&&a<=d.maxYear;a++)a>=d.minYear&&h.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return b='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?w+=b+y:w+=y+b,g&&(i===0||d.minMonth>=i)&&(T=!1),p&&(i===11||d.maxMonth<=i)&&(M=!1),e===0&&(w+='<button class="pika-prev'+(T?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(w+='<button class="pika-next'+(M?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),w+="</div>"},tse=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Joe(t)+Qoe(e)+"</table>"};function fO(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||vu().event;let o=r.target||r.srcElement;if(o)if(zr(o,"is-disabled")||(zr(o,"pika-button")&&!zr(o,"is-empty")&&!zr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&dO(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):zr(o,"pika-prev")?e.prevMonth():zr(o,"pika-next")&&e.nextMonth()),zr(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||vu().event;let o=r.target||r.srcElement;o&&(zr(o,"pika-select-month")?e.gotoMonth(o.value):zr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||vu().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),Kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=Ro().activeElement;do if(zr(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=dO(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||vu().event;let o=r.target||r.srcElement,a=o;if(o){!hasEventListeners&&zr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Us(o,"change",e._onChange)));do if(zr(a,"pika-single")||a===n.trigger)return;while(a=a.parentNode);e._v&&o!==n.trigger&&a!==n.trigger&&e.hide()}},e.el=Ro().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Us(e.el,"mousedown",e._onMouseDown,!0),Us(e.el,"touchend",e._onMouseDown,!0),Us(e.el,"change",e._onChange),n.keyboardInput&&Us(Ro(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Ro().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Us(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Kr(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Us(n.trigger,"click",e._onInputClick),Us(n.trigger,"focus",e._onInputFocus),Us(n.trigger,"blur",e._onInputBlur)):this.show()}fO.prototype={config:function(t){this._o||(this._o=UC({},Ps,!0));let e=UC(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Kr(e.minDate)||(e.minDate=!1),Kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),HH(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Ps.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",fW(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Kr(t))return;let n=this._o.minDate,i=this._o.maxDate;Kr(n)&&t<n?t=n:Kr(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),ty(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fW(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=gW(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=gW({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(ty(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Ps.minDate,this._o.minYear=Ps.minYear,this._o.minMonth=Ps.minMonth,this._o.startRange=Ps.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(ty(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Ps.maxDate,this._o.maxYear=Ps.maxYear,this._o.maxMonth=Ps.maxMonth,this._o.endRange=Ps.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,a="",u;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let h=0;h<e.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+ese(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&dO(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,a,u,h,d,g;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=vu().innerWidth||Ro().documentElement.clientWidth,r=vu().innerHeight||Ro().documentElement.clientHeight,o=Ro().body.scrollTop||Ro().documentElement.scrollTop,d=!0,g=!0,h=t.getBoundingClientRect(),a=h.left+vu().pageXOffset,u=h.bottom+vu().pageYOffset,(this._o.reposition&&a+e>i||this._o.position.indexOf("right")>-1&&a-e+t.offsetWidth>0)&&(a=a-e+t.offsetWidth,d=!1),(this._o.reposition&&u+n>r+o||this._o.position.indexOf("top")>-1&&u-n-t.offsetHeight>0)&&(u=u-n-t.offsetHeight,g=!1),a<0&&(a=0),u<0&&(u=0),this.el.style.left=a+"px",this.el.style.top=u+"px",oM(this.el,d?"left-aligned":"right-aligned"),oM(this.el,g?"bottom-aligned":"top-aligned"),sM(this.el,d?"right-aligned":"left-aligned"),sM(this.el,g?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=dW(t,e),a=new Date(t,e,1).getDay(),u=[],h=[];ty(r),i.firstDay>0&&(a-=i.firstDay,a<0&&(a+=7));let d=e===0?11:e-1,g=e===11?0:e+1,p=e===0?t-1:t,w=e===11?t+1:t,y=dW(p,d),b=o+a,T=b;for(;T>7;)T-=7;b+=7-T;let M=!1;for(let I=0,_=0;I<b;I++){let N=new Date(t,e,1+(I-a)),k=Kr(this._d)?ny(N,this._d):!1,$=ny(N,r),L=i.events.indexOf(N.toDateString())!==-1,F=I<a||I>=o+a,he=1+(I-a),le=e,G=t,ye=i.startRange&&ny(i.startRange,N),we=i.endRange&&ny(i.endRange,N),Me=i.startRange&&i.endRange&&i.startRange<N&&N<i.endRange,Ee=i.minDate&&N<i.minDate||i.maxDate&&N>i.maxDate||i.disableWeekends&&Yoe(N)||i.disableDayFn&&i.disableDayFn(N);F&&(I<a?(he=y+he,le=d,G=p):(he=he-o,le=g,G=w));let _e={day:he,month:le,year:G,hasEvent:L,isSelected:k,isToday:$,isDisabled:Ee,isEmpty:F,isStartRange:ye,isEndRange:we,isInRange:Me,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&k&&(M=!0),h.push(qoe(_e)),++_===7&&(i.showWeekNumber&&h.unshift(Xoe(this,I-a,e,t,i.firstWeekOfYearMinDays)),u.push(Zoe(h,i.isRTL,i.pickWholeWeek,M)),h=[],_=0,M=!1)}return tse(i,u,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),sM(this.el,"is-hidden"),this._o.bound&&(Us(Ro(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Da(Ro(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),oM(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Da(this.el,"mousedown",this._onMouseDown,!0),Da(this.el,"touchend",this._onMouseDown,!0),Da(this.el,"change",this._onChange),t.keyboardInput&&Da(Ro(),"keydown",this._onKeyChange),t.field&&(Da(t.field,"change",this._onInputChange),t.bound&&(Da(t.trigger,"click",this._onInputClick),Da(t.trigger,"focus",this._onInputFocus),Da(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function nse(t,e){ise(t,e),e.add(t)}function ise(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pW(t,e,n){return(e=rse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rse(t){var e=ose(t,"string");return typeof e=="symbol"?e:e+""}function ose(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qY="date",vW="dateEditor",sse="DD/MM/YYYY";var iy=new WeakSet;class KY extends ph{constructor(){super(...arguments),nse(this,iy),pW(this,"parentDestroyed",!1),pW(this,"$datePicker",null)}static get EDITOR_TYPE(){return qY}init(){if(typeof Ce!="function")throw new Error("You need to include moment.js to your project.");if(typeof fO!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(Ue(this.datePicker,/ht-theme-.*/g),pe(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),pe(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Ue(this.datePicker,/ht-theme-.*/g),pe(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{ze(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:vW})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vW),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=aM(iy,this,lM).call(this),i=this.hot.view.isMouseDown(),r=e?Mz(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new fO(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Ce),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Ce(o,n,!0).isValid()&&this.$datePicker.setMoment(Ce(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Ce(o,n,!0).isValid()&&this.$datePicker.setMoment(Ce(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ub(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:aM(iy,this,lM).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=a=>{let u=a;isNaN(u.getTime())||(u=Ce(u).format(aM(iy,this,lM).call(this))),this.setValue(u),r&&r(),nl()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ln.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,u=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),d=r.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),g=r.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=u&&this.row<=h&&this.col>=d&&this.col<=g){const p=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+p.top+ni(this.TD)}px`;let w=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?w+=p.right-zn(this.datePicker):w+=p.left,this.datePickerStyle.left=`${w}px`}else this.hideDatepicker()}}function lM(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:sse}const ase="dropdown";class XY extends AH{static get EDITOR_TYPE(){return ase}prepare(e,n,i,r,o,a){a.filter=!1,a.strict=!0,super.prepare(e,n,i,r,o,a)}}const lse="numeric";class ZY extends ph{static get EDITOR_TYPE(){return lse}}function use(t,e,n){return(e=cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cse(t){var e=hse(t,"string");return typeof e=="symbol"?e:e+""}function hse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dse="password";class QY extends ph{constructor(){super(...arguments),use(this,"autoResize",DY(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return dse}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,hl(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const uM="ht_editor_visible",wW="selectEditor",fse="select";class JY extends Mf{static get EDITOR_TYPE(){return fse}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...gh()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),pe(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ze(this.selectWrapper,uM)&&Ue(this.selectWrapper,uM),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a);const u=this.cellProperties.selectOptions;let h;typeof u=="function"?h=this.prepareOptions(u(this.row,this.col,this.prop)):h=this.prepareOptions(u),hl(this.select),ft(h,(d,g)=>{const p=this.hot.rootDocument.createElement("OPTION");p.value=g,Tf(p,d),this.select.appendChild(p)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ln.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",pe(this.selectWrapper,uM)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:wW};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wW)}}const gse="time";class eG extends ph{static get EDITOR_TYPE(){return gse}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a),this.TEXTAREA.dir="ltr"}}function mse(){Yr(Mf),Yr(AH),Yr(GY),Yr(KY),Yr(XY),Yr(xH),Yr(ZY),Yr(QY),Yr(JY),Yr(ph),Yr(eG)}const pse="html";function IH(t,e,n,i,r,o,a){Zp.apply(this,[t,e,n,i,r,o,a]),Tf(e,o??"",!1)}IH.RENDERER_TYPE=pse;const vse="autocomplete";function xf(t,e,n,i,r,o,a){const{rootDocument:u}=t,h=a.allowHtml?IH:yl,d=u.createElement("DIV"),g=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",g&&d.setAttribute(...gh()),d.appendChild(u.createTextNode("▼")),h.apply(this,[t,e,n,i,r,o,a]),e.firstChild||e.appendChild(u.createTextNode(" ")),e.insertBefore(d,e.firstChild),pe(e,"htAutocomplete"),!t.acArrowListener){const p=new fs(t);t.acArrowListener=function(w){ze(w.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},p.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{p.destroy()})}}xf.RENDERER_TYPE=vse;const wse="dropdown";function PH(t,e,n,i,r,o,a){xf.apply(this,[t,e,n,i,r,o,a])}PH.RENDERER_TYPE=wse;const yW=new WeakMap,CW=new WeakMap,yse="htBadValue",df="data-row",ff="data-col",Cse="checkboxRenderer",tG="checkbox";xe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:a,prop:u}=e;if(r===tG){if(i){const{value:h,property:d}=i;let g=n;if(h)g=typeof h=="function"?h(o,a,u,n):h;else if(d){const p=this.getDataAtRowProp(o,d);g=p!==null?p:n}t=g}return t}});function NH(t,e,n,i,r,o,a){const{rootDocument:u}=t,h=t.getSettings().ariaTags;Zp.apply(this,[t,e,n,i,r,o,a]),bse(t);let d=Sse(u);const g=a.label;let p=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),hl(e),o===a.checkedTemplate||yn(o).toLocaleLowerCase(a.locale)===yn(a.checkedTemplate).toLocaleLowerCase(a.locale)?d.checked=!0:o===a.uncheckedTemplate||yn(o).toLocaleLowerCase(a.locale)===yn(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?d.checked=!1:Vn(o)?pe(d,"noValue"):(d.style.display="none",pe(d,yse),p=!0),qe(d,[[df,n],[ff,i]]),h&&qe(d,[mp(d.checked?t.getTranslatedPhrase(EH):t.getTranslatedPhrase(TH)),lz(d.checked),XX()]),!p&&g){let T="";if(g.value)T=typeof g.value=="function"?g.value.call(this,n,i,r,o):g.value;else if(g.property){const I=t.getDataAtRowProp(n,g.property);T=I!==null?I:""}const M=Rse(u,T,g.separated!==!0);g.position==="before"?g.separated?(e.appendChild(M),e.appendChild(d)):(M.appendChild(d),d=M):(!g.position||g.position==="after")&&(g.separated?(e.appendChild(d),e.appendChild(M)):(M.insertBefore(d,M.firstChild),d=M))}(!g||g&&!g.separated)&&e.appendChild(d),p&&e.appendChild(u.createTextNode("#bad-value#")),yW.has(t)||(yW.set(t,!0),w());function w(){const M=t.getShortcutManager().getContext("grid"),I={group:Cse,relativeToGroup:Pu,position:"before"};M.addShortcuts([{keys:[["space"]],callback:()=>(y(),!b()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight.isCell()}},{keys:[["enter"]],callback:()=>(y(),!b()),runOnlyIf:()=>{const _=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(_==null?void 0:_.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(y(!0),!b()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight.isCell()}}],I)}function y(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const M=t.getSelectedRange(),I=[],_=new Map;let N=[],k=0;if(M){for(let $=0;$<M.length;$++){const{row:L,col:F}=M[$].getTopStartCorner(),{row:he,col:le}=M[$].getBottomEndCorner();for(let G=L;G<=he;G+=1)for(let ye=F;ye<=le;ye+=1){const we=t.getCellMeta(G,ye);if(we.hidden)continue;const Me={checkedTemplate:we.checkedTemplate,uncheckedTemplate:we.uncheckedTemplate};if(we.type!=="checkbox"){T===!0&&!we.readOnly&&(_.has(I.length)?_.set(I.length,[..._.get(I.length),[G,ye,null]]):_.set(I.length,[[G,ye,null]]));continue}if(we.readOnly===!0)continue;typeof we.checkedTemplate>"u"&&(we.checkedTemplate=!0),typeof we.uncheckedTemplate>"u"&&(we.uncheckedTemplate=!1);const Ee=t.getDataAtCell(G,ye);T===!1?[we.checkedTemplate,we.checkedTemplate.toString()].includes(Ee)?N.push([G,ye,we.uncheckedTemplate,Me]):[we.uncheckedTemplate,we.uncheckedTemplate.toString(),null,void 0].includes(Ee)&&N.push([G,ye,we.checkedTemplate,Me]):N.push([G,ye,we.uncheckedTemplate,Me]),k+=1}I.push(k),k=0}N.every($=>{let[,,L]=$;return L===N[0][2]})?N=N.map($=>{let[L,F,he]=$;return[L,F,he]}):N=N.map($=>{let[L,F,,he]=$;return[L,F,he.checkedTemplate]}),N.length>0&&I.forEach(($,L)=>{let F=N.splice(0,$);_.size&&_.has(L)&&(F=[...F,..._.get(L)]),t.setDataAtCell(F)})}}function b(){const T=t.getSelectedRange();if(T){for(let M=0;M<T.length;M++){const I=T[M].getTopStartCorner(),_=T[M].getBottomEndCorner();for(let N=I.row;N<=_.row;N++)for(let k=I.col;k<=_.col;k++){if(t.getCellMeta(N,k).readOnly)continue;const L=t.getCell(N,k);if(ul(L)&&L.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}NH.RENDERER_TYPE=tG;function bse(t){let e=CW.get(t);if(!e){const{rootElement:n}=t;e=new fs(t),e.addEventListener(n,"click",i=>Tse(i,t)),e.addEventListener(n,"mouseup",i=>Ese(i,t)),e.addEventListener(n,"change",i=>_se(i,t)),CW.set(t,e)}return e}function Sse(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Rse(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function Ese(t,e){const{target:n}=t;DH(n)&&(!n.hasAttribute(df)||!n.hasAttribute(ff)||setTimeout(e.listen,10))}function Tse(t,e){const{target:n}=t;if(!DH(n)||!n.hasAttribute(df)||!n.hasAttribute(ff))return;const i=parseInt(n.getAttribute(df),10),r=parseInt(n.getAttribute(ff),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function _se(t,e){const{target:n}=t;if(!DH(n)||!n.hasAttribute(df)||!n.hasAttribute(ff))return;const i=parseInt(n.getAttribute(df),10),r=parseInt(n.getAttribute(ff),10),o=e.getCellMeta(i,r);if(!o.readOnly){let a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,a)}}function DH(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Mse="handsontable";function LH(t,e,n,i,r,o,a){xf.apply(this,[t,e,n,i,r,o,a])}LH.RENDERER_TYPE=Mse;var Ose=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xse(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cM,bW;function Ase(){return bW||(bW=1,cM={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),cM}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hM,SW;function nG(){if(SW)return hM;SW=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(h,d,g,p,w,y,b){if(!isNaN(+h))return+h;let T="",M=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(M!==h)return-1*n(M,d,g,p,w,y);for(let L=0;L<t.length;L++){let F=t[L];if(T=h.replace(RegExp(`([0-9 ])(${F.key})$`),"$1"),T!==h)return n(T,d,g,p,w,y)*F.factor}if(T=h.replace("%",""),T!==h)return n(T,d,g,p,w,y)/100;let I=parseFloat(h);if(isNaN(I))return;let _=p(I);if(_&&_!=="."&&(T=h.replace(new RegExp(`${e(_)}$`),""),T!==h))return n(T,d,g,p,w,y);let N={};Object.keys(y).forEach(L=>{N[y[L]]=L});let k=Object.keys(N).sort().reverse(),$=k.length;for(let L=0;L<$;L++){let F=k[L],he=N[F];if(T=h.replace(F,""),T!==h){let le;switch(he){case"thousand":le=Math.pow(10,3);break;case"million":le=Math.pow(10,6);break;case"billion":le=Math.pow(10,9);break;case"trillion":le=Math.pow(10,12);break}return n(T,d,g,p,w,y)*le}}}function i(h,d,g){let p=h.replace(g,"");return p=p.replace(new RegExp(`([0-9])${e(d.thousands)}([0-9])`,"g"),"$1$2"),p=p.replace(d.decimal,"."),p}function r(h,d,g="",p,w,y,b){if(h==="")return;if(h===w)return 0;let T=i(h,d,g);return n(T,d,g,p,w,y)}function o(h,d){if(!(h.indexOf(":")&&d.thousands!==":"))return!1;let p=h.split(":");if(p.length!==3)return!1;let w=+p[0],y=+p[1],b=+p[2];return!isNaN(w)&&!isNaN(y)&&!isNaN(b)}function a(h){let d=h.split(":"),g=+d[0],p=+d[1];return+d[2]+60*p+3600*g}function u(h,d){const g=$H();let p=g.currentDelimiters(),w=g.currentCurrency().symbol,y=g.currentOrdinal(),b=g.getZeroFormat(),T=g.currentAbbreviations(),M;if(typeof h=="string")o(h,p)?M=a(h):M=r(h,p,w,y,b,T);else if(typeof h=="number")M=h;else return;if(M!==void 0)return M}return hM={unformat:u},hM}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var dM,RW;function kH(){if(RW)return dM;RW=1;let t=nG();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},d={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(M,I)=>I.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:M=>M.output==="byte"},characteristic:{type:"number",restriction:M=>M>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(M,I)=>I.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:M=>M>=0,message:"value must be positive"},{restriction:(M,I)=>!I.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:M=>M>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(M,I)=>I.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:M=>M.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function p(M,I){let _=w(M),N=b(I);return _&&N}function w(M){return t.unformat(M)!==void 0}function y(M,I,_,N=!1){let k=Object.keys(M).map($=>{if(!I[$])return console.error(`${_} Invalid key: ${$}`),!1;let L=M[$],F=I[$];if(typeof F=="string"&&(F={type:F}),F.type==="format"){if(!y(L,d,`[Validate ${$}]`,!0))return!1}else if(typeof L!==F.type)return console.error(`${_} ${$} type mismatched: "${F.type}" expected, "${typeof L}" provided`),!1;if(F.restrictions&&F.restrictions.length){let he=F.restrictions.length;for(let le=0;le<he;le++){let{restriction:G,message:ye}=F.restrictions[le];if(!G(L,M))return console.error(`${_} ${$} invalid value: ${ye}`),!1}}return F.restriction&&!F.restriction(L,M)?(console.error(`${_} ${$} invalid value: ${F.message}`),!1):F.validValues&&F.validValues.indexOf(L)===-1?(console.error(`${_} ${$} invalid value: must be among ${JSON.stringify(F.validValues)}, "${L}" provided`),!1):!(F.children&&!y(L,F.children,`[Validate ${$}]`))});return N||k.push(...Object.keys(I).map($=>{let L=I[$];if(typeof L=="string"&&(L={type:L}),L.mandatory){let F=L.mandatory;if(typeof F=="function"&&(F=F(M)),F&&M[$]===void 0)return console.error(`${_} Missing mandatory key "${$}"`),!1}return!0})),k.reduce(($,L)=>$&&L,!0)}function b(M){return y(M,d,"[Validate format]")}function T(M){return y(M,g,"[Validate language]")}return dM={validate:p,validateFormat:b,validateInput:w,validateLanguage:T},dM}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Hse(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Ise(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Pse(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function Nse(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Dse(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function Lse(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function kse(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function Vse(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function $se(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Bse(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Fse(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Wse(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function jse(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Use(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function zse(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Yse(t,e={}){return typeof t!="string"?t:(t=Hse(t,e),t=Ise(t,e),Pse(t,e),Lse(t,e),kse(t,e),jse(t,e),Bse(t,e),Fse(t,e),Vse(t,e),Wse(t,e),$se(t,e),Nse(t,e),Dse(t,e),Use(t,e),zse(t,e),e)}var VH={parseFormat:Yse};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var fM,EW;function $H(){if(EW)return fM;EW=1;const t=Ase(),e=kH(),n=VH;let i={},r,o={},a=null,u={};function h(g){r=g}function d(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>d().bytes||{},i.currentCurrency=()=>d().currency,i.currentAbbreviations=()=>d().abbreviations,i.currentDelimiters=()=>d().delimiters,i.currentOrdinal=()=>d().ordinal,i.currentDefaults=()=>Object.assign({},d().defaults,u),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().timeFormat),i.setDefaults=g=>{g=n.parseFormat(g),e.validateFormat(g)&&(u=g)},i.getZeroFormat=()=>a,i.setZeroFormat=g=>a=typeof g=="string"?g:null,i.hasZeroFormat=()=>a!==null,i.languageData=g=>{if(g){if(o[g])return o[g];throw new Error(`Unknown tag "${g}"`)}return d()},i.registerLanguage=(g,p=!1)=>{if(!e.validateLanguage(g))throw new Error("Invalid language data");o[g.languageTag]=g,p&&h(g.languageTag)},i.setLanguage=(g,p=t.languageTag)=>{if(!o[g]){let w=g.split("-")[0],y=Object.keys(o).find(b=>b.split("-")[0]===w);if(!o[y]){h(p);return}h(y);return}h(g)},i.registerLanguage(t),r=t.languageTag,fM=i,fM}function Gse(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function qse(t,e){t.forEach(n=>{let i;try{i=Gse(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var Kse=t=>({loadLanguagesInNode:e=>qse(e,t)}),iG={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,a="[BigNumber Error] ",u=a+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,g=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],w=1e7,y=1e9;function b(L){var F,he,le,G=R.prototype={constructor:R,toString:null,valueOf:null},ye=new R(1),we=20,Me=4,Ee=-7,_e=21,se=-1e7,fe=1e7,Te=!1,Ge=1,B=0,ue={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},C="0123456789abcdefghijklmnopqrstuvwxyz",S=!0;function R(O,H){var A,q,j,K,ie,W,X,te,Z=this;if(!(Z instanceof R))return new R(O,H);if(H==null){if(O&&O._isBigNumber===!0){Z.s=O.s,!O.c||O.e>fe?Z.c=Z.e=null:O.e<se?Z.c=[Z.e=0]:(Z.e=O.e,Z.c=O.c.slice());return}if((W=typeof O=="number")&&O*0==0){if(Z.s=1/O<0?(O=-O,-1):1,O===~~O){for(K=0,ie=O;ie>=10;ie/=10,K++);K>fe?Z.c=Z.e=null:(Z.e=K,Z.c=[O]);return}te=String(O)}else{if(!i.test(te=String(O)))return le(Z,te,W);Z.s=te.charCodeAt(0)==45?(te=te.slice(1),-1):1}(K=te.indexOf("."))>-1&&(te=te.replace(".","")),(ie=te.search(/e/i))>0?(K<0&&(K=ie),K+=+te.slice(ie+1),te=te.substring(0,ie)):K<0&&(K=te.length)}else{if(_(H,2,C.length,"Base"),H==10&&S)return Z=new R(O),ae(Z,we+Z.e+1,Me);if(te=String(O),W=typeof O=="number"){if(O*0!=0)return le(Z,te,W,H);if(Z.s=1/O<0?(te=te.slice(1),-1):1,R.DEBUG&&te.replace(/^0\.0*|\./,"").length>15)throw Error(u+O)}else Z.s=te.charCodeAt(0)===45?(te=te.slice(1),-1):1;for(A=C.slice(0,H),K=ie=0,X=te.length;ie<X;ie++)if(A.indexOf(q=te.charAt(ie))<0){if(q=="."){if(ie>K){K=X;continue}}else if(!j&&(te==te.toUpperCase()&&(te=te.toLowerCase())||te==te.toLowerCase()&&(te=te.toUpperCase()))){j=!0,ie=-1,K=0;continue}return le(Z,String(O),W,H)}W=!1,te=he(te,H,10,Z.s),(K=te.indexOf("."))>-1?te=te.replace(".",""):K=te.length}for(ie=0;te.charCodeAt(ie)===48;ie++);for(X=te.length;te.charCodeAt(--X)===48;);if(te=te.slice(ie,++X)){if(X-=ie,W&&R.DEBUG&&X>15&&(O>g||O!==o(O)))throw Error(u+Z.s*O);if((K=K-ie-1)>fe)Z.c=Z.e=null;else if(K<se)Z.c=[Z.e=0];else{if(Z.e=K,Z.c=[],ie=(K+1)%d,K<0&&(ie+=d),ie<X){for(ie&&Z.c.push(+te.slice(0,ie)),X-=d;ie<X;)Z.c.push(+te.slice(ie,ie+=d));ie=d-(te=te.slice(ie)).length}else ie-=X;for(;ie--;te+="0");Z.c.push(+te)}}else Z.c=[Z.e=0]}R.clone=b,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=function(O){var H,A;if(O!=null)if(typeof O=="object"){if(O.hasOwnProperty(H="DECIMAL_PLACES")&&(A=O[H],_(A,0,y,H),we=A),O.hasOwnProperty(H="ROUNDING_MODE")&&(A=O[H],_(A,0,8,H),Me=A),O.hasOwnProperty(H="EXPONENTIAL_AT")&&(A=O[H],A&&A.pop?(_(A[0],-1e9,0,H),_(A[1],0,y,H),Ee=A[0],_e=A[1]):(_(A,-1e9,y,H),Ee=-(_e=A<0?-A:A))),O.hasOwnProperty(H="RANGE"))if(A=O[H],A&&A.pop)_(A[0],-1e9,-1,H),_(A[1],1,y,H),se=A[0],fe=A[1];else if(_(A,-1e9,y,H),A)se=-(fe=A<0?-A:A);else throw Error(a+H+" cannot be zero: "+A);if(O.hasOwnProperty(H="CRYPTO"))if(A=O[H],A===!!A)if(A)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=A;else throw Te=!A,Error(a+"crypto unavailable");else Te=A;else throw Error(a+H+" not true or false: "+A);if(O.hasOwnProperty(H="MODULO_MODE")&&(A=O[H],_(A,0,9,H),Ge=A),O.hasOwnProperty(H="POW_PRECISION")&&(A=O[H],_(A,0,y,H),B=A),O.hasOwnProperty(H="FORMAT"))if(A=O[H],typeof A=="object")ue=A;else throw Error(a+H+" not an object: "+A);if(O.hasOwnProperty(H="ALPHABET"))if(A=O[H],typeof A=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(A))S=A.slice(0,10)=="0123456789",C=A;else throw Error(a+H+" invalid: "+A)}else throw Error(a+"Object expected: "+O);return{DECIMAL_PLACES:we,ROUNDING_MODE:Me,EXPONENTIAL_AT:[Ee,_e],RANGE:[se,fe],CRYPTO:Te,MODULO_MODE:Ge,POW_PRECISION:B,FORMAT:ue,ALPHABET:C}},R.isBigNumber=function(O){if(!O||O._isBigNumber!==!0)return!1;if(!R.DEBUG)return!0;var H,A,q=O.c,j=O.e,K=O.s;e:if({}.toString.call(q)=="[object Array]"){if((K===1||K===-1)&&j>=-1e9&&j<=y&&j===o(j)){if(q[0]===0){if(j===0&&q.length===1)return!0;break e}if(H=(j+1)%d,H<1&&(H+=d),String(q[0]).length==H){for(H=0;H<q.length;H++)if(A=q[H],A<0||A>=h||A!==o(A))break e;if(A!==0)return!0}}}else if(q===null&&j===null&&(K===null||K===1||K===-1))return!0;throw Error(a+"Invalid BigNumber: "+O)},R.maximum=R.max=function(){return V(arguments,-1)},R.minimum=R.min=function(){return V(arguments,1)},R.random=function(){var O=9007199254740992,H=Math.random()*O&2097151?function(){return o(Math.random()*O)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(A){var q,j,K,ie,W,X=0,te=[],Z=new R(ye);if(A==null?A=we:_(A,0,y),ie=r(A/d),Te)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(ie*=2));X<ie;)W=q[X]*131072+(q[X+1]>>>11),W>=9e15?(j=crypto.getRandomValues(new Uint32Array(2)),q[X]=j[0],q[X+1]=j[1]):(te.push(W%1e14),X+=2);X=ie/2}else if(crypto.randomBytes){for(q=crypto.randomBytes(ie*=7);X<ie;)W=(q[X]&31)*281474976710656+q[X+1]*1099511627776+q[X+2]*4294967296+q[X+3]*16777216+(q[X+4]<<16)+(q[X+5]<<8)+q[X+6],W>=9e15?crypto.randomBytes(7).copy(q,X):(te.push(W%1e14),X+=7);X=ie/7}else throw Te=!1,Error(a+"crypto unavailable");if(!Te)for(;X<ie;)W=H(),W<9e15&&(te[X++]=W%1e14);for(ie=te[--X],A%=d,ie&&A&&(W=p[d-A],te[X]=o(ie/W)*W);te[X]===0;te.pop(),X--);if(X<0)te=[K=0];else{for(K=-1;te[0]===0;te.splice(0,1),K-=d);for(X=1,W=te[0];W>=10;W/=10,X++);X<d&&(K-=d-X)}return Z.e=K,Z.c=te,Z}}(),R.sum=function(){for(var O=1,H=arguments,A=new R(H[0]);O<H.length;)A=A.plus(H[O++]);return A},he=function(){var O="0123456789";function H(A,q,j,K){for(var ie,W=[0],X,te=0,Z=A.length;te<Z;){for(X=W.length;X--;W[X]*=q);for(W[0]+=K.indexOf(A.charAt(te++)),ie=0;ie<W.length;ie++)W[ie]>j-1&&(W[ie+1]==null&&(W[ie+1]=0),W[ie+1]+=W[ie]/j|0,W[ie]%=j)}return W.reverse()}return function(A,q,j,K,ie){var W,X,te,Z,ce,He,Ie,Qe,st=A.indexOf("."),ot=we,Be=Me;for(st>=0&&(Z=B,B=0,A=A.replace(".",""),Qe=new R(q),He=Qe.pow(A.length-st),B=Z,Qe.c=H($(M(He.c),He.e,"0"),10,j,O),Qe.e=Qe.c.length),Ie=H(A,q,j,ie?(W=C,O):(W=O,C)),te=Z=Ie.length;Ie[--Z]==0;Ie.pop());if(!Ie[0])return W.charAt(0);if(st<0?--te:(He.c=Ie,He.e=te,He.s=K,He=F(He,Qe,ot,Be,j),Ie=He.c,ce=He.r,te=He.e),X=te+ot+1,st=Ie[X],Z=j/2,ce=ce||X<0||Ie[X+1]!=null,ce=Be<4?(st!=null||ce)&&(Be==0||Be==(He.s<0?3:2)):st>Z||st==Z&&(Be==4||ce||Be==6&&Ie[X-1]&1||Be==(He.s<0?8:7)),X<1||!Ie[0])A=ce?$(W.charAt(1),-ot,W.charAt(0)):W.charAt(0);else{if(Ie.length=X,ce)for(--j;++Ie[--X]>j;)Ie[X]=0,X||(++te,Ie=[1].concat(Ie));for(Z=Ie.length;!Ie[--Z];);for(st=0,A="";st<=Z;A+=W.charAt(Ie[st++]));A=$(A,te,W.charAt(0))}return A}}(),F=function(){function O(q,j,K){var ie,W,X,te,Z=0,ce=q.length,He=j%w,Ie=j/w|0;for(q=q.slice();ce--;)X=q[ce]%w,te=q[ce]/w|0,ie=Ie*X+te*He,W=He*X+ie%w*w+Z,Z=(W/K|0)+(ie/w|0)+Ie*te,q[ce]=W%K;return Z&&(q=[Z].concat(q)),q}function H(q,j,K,ie){var W,X;if(K!=ie)X=K>ie?1:-1;else for(W=X=0;W<K;W++)if(q[W]!=j[W]){X=q[W]>j[W]?1:-1;break}return X}function A(q,j,K,ie){for(var W=0;K--;)q[K]-=W,W=q[K]<j[K]?1:0,q[K]=W*ie+q[K]-j[K];for(;!q[0]&&q.length>1;q.splice(0,1));}return function(q,j,K,ie,W){var X,te,Z,ce,He,Ie,Qe,st,ot,Be,Je,gt,Ar,Lo,or,Bt,cn,Tt=q.s==j.s?1:-1,Ft=q.c,it=j.c;if(!Ft||!Ft[0]||!it||!it[0])return new R(!q.s||!j.s||(Ft?it&&Ft[0]==it[0]:!it)?NaN:Ft&&Ft[0]==0||!it?Tt*0:Tt/0);for(st=new R(Tt),ot=st.c=[],te=q.e-j.e,Tt=K+te+1,W||(W=h,te=T(q.e/d)-T(j.e/d),Tt=Tt/d|0),Z=0;it[Z]==(Ft[Z]||0);Z++);if(it[Z]>(Ft[Z]||0)&&te--,Tt<0)ot.push(1),ce=!0;else{for(Lo=Ft.length,Bt=it.length,Z=0,Tt+=2,He=o(W/(it[0]+1)),He>1&&(it=O(it,He,W),Ft=O(Ft,He,W),Bt=it.length,Lo=Ft.length),Ar=Bt,Be=Ft.slice(0,Bt),Je=Be.length;Je<Bt;Be[Je++]=0);cn=it.slice(),cn=[0].concat(cn),or=it[0],it[1]>=W/2&&or++;do{if(He=0,X=H(it,Be,Bt,Je),X<0){if(gt=Be[0],Bt!=Je&&(gt=gt*W+(Be[1]||0)),He=o(gt/or),He>1)for(He>=W&&(He=W-1),Ie=O(it,He,W),Qe=Ie.length,Je=Be.length;H(Ie,Be,Qe,Je)==1;)He--,A(Ie,Bt<Qe?cn:it,Qe,W),Qe=Ie.length,X=1;else He==0&&(X=He=1),Ie=it.slice(),Qe=Ie.length;if(Qe<Je&&(Ie=[0].concat(Ie)),A(Be,Ie,Je,W),Je=Be.length,X==-1)for(;H(it,Be,Bt,Je)<1;)He++,A(Be,Bt<Je?cn:it,Je,W),Je=Be.length}else X===0&&(He++,Be=[0]);ot[Z++]=He,Be[0]?Be[Je++]=Ft[Ar]||0:(Be=[Ft[Ar]],Je=1)}while((Ar++<Lo||Be[0]!=null)&&Tt--);ce=Be[0]!=null,ot[0]||ot.splice(0,1)}if(W==h){for(Z=1,Tt=ot[0];Tt>=10;Tt/=10,Z++);ae(st,K+(st.e=Z+te*d-1)+1,ie,ce)}else st.e=te,st.r=+ce;return st}}();function P(O,H,A,q){var j,K,ie,W,X;if(A==null?A=Me:_(A,0,8),!O.c)return O.toString();if(j=O.c[0],ie=O.e,H==null)X=M(O.c),X=q==1||q==2&&(ie<=Ee||ie>=_e)?k(X,ie):$(X,ie,"0");else if(O=ae(new R(O),H,A),K=O.e,X=M(O.c),W=X.length,q==1||q==2&&(H<=K||K<=Ee)){for(;W<H;X+="0",W++);X=k(X,K)}else if(H-=ie,X=$(X,K,"0"),K+1>W){if(--H>0)for(X+=".";H--;X+="0");}else if(H+=K-W,H>0)for(K+1==W&&(X+=".");H--;X+="0");return O.s<0&&j?"-"+X:X}function V(O,H){for(var A,q,j=1,K=new R(O[0]);j<O.length;j++)q=new R(O[j]),(!q.s||(A=I(K,q))===H||A===0&&K.s===H)&&(K=q);return K}function J(O,H,A){for(var q=1,j=H.length;!H[--j];H.pop());for(j=H[0];j>=10;j/=10,q++);return(A=q+A*d-1)>fe?O.c=O.e=null:A<se?O.c=[O.e=0]:(O.e=A,O.c=H),O}le=function(){var O=/^(-?)0([xbo])(?=\w[\w.]*$)/i,H=/^([^.]+)\.$/,A=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(K,ie,W,X){var te,Z=W?ie:ie.replace(j,"");if(q.test(Z))K.s=isNaN(Z)?null:Z<0?-1:1;else{if(!W&&(Z=Z.replace(O,function(ce,He,Ie){return te=(Ie=Ie.toLowerCase())=="x"?16:Ie=="b"?2:8,!X||X==te?He:ce}),X&&(te=X,Z=Z.replace(H,"$1").replace(A,"0.$1")),ie!=Z))return new R(Z,te);if(R.DEBUG)throw Error(a+"Not a"+(X?" base "+X:"")+" number: "+ie);K.s=null}K.c=K.e=null}}();function ae(O,H,A,q){var j,K,ie,W,X,te,Z,ce=O.c,He=p;if(ce){e:{for(j=1,W=ce[0];W>=10;W/=10,j++);if(K=H-j,K<0)K+=d,ie=H,X=ce[te=0],Z=o(X/He[j-ie-1]%10);else if(te=r((K+1)/d),te>=ce.length)if(q){for(;ce.length<=te;ce.push(0));X=Z=0,j=1,K%=d,ie=K-d+1}else break e;else{for(X=W=ce[te],j=1;W>=10;W/=10,j++);K%=d,ie=K-d+j,Z=ie<0?0:o(X/He[j-ie-1]%10)}if(q=q||H<0||ce[te+1]!=null||(ie<0?X:X%He[j-ie-1]),q=A<4?(Z||q)&&(A==0||A==(O.s<0?3:2)):Z>5||Z==5&&(A==4||q||A==6&&(K>0?ie>0?X/He[j-ie]:0:ce[te-1])%10&1||A==(O.s<0?8:7)),H<1||!ce[0])return ce.length=0,q?(H-=O.e+1,ce[0]=He[(d-H%d)%d],O.e=-H||0):ce[0]=O.e=0,O;if(K==0?(ce.length=te,W=1,te--):(ce.length=te+1,W=He[d-K],ce[te]=ie>0?o(X/He[j-ie]%He[ie])*W:0),q)for(;;)if(te==0){for(K=1,ie=ce[0];ie>=10;ie/=10,K++);for(ie=ce[0]+=W,W=1;ie>=10;ie/=10,W++);K!=W&&(O.e++,ce[0]==h&&(ce[0]=1));break}else{if(ce[te]+=W,ce[te]!=h)break;ce[te--]=0,W=1}for(K=ce.length;ce[--K]===0;ce.pop());}O.e>fe?O.c=O.e=null:O.e<se&&(O.c=[O.e=0])}return O}function ge(O){var H,A=O.e;return A===null?O.toString():(H=M(O.c),H=A<=Ee||A>=_e?k(H,A):$(H,A,"0"),O.s<0?"-"+H:H)}return G.absoluteValue=G.abs=function(){var O=new R(this);return O.s<0&&(O.s=1),O},G.comparedTo=function(O,H){return I(this,new R(O,H))},G.decimalPlaces=G.dp=function(O,H){var A,q,j,K=this;if(O!=null)return _(O,0,y),H==null?H=Me:_(H,0,8),ae(new R(K),O+K.e+1,H);if(!(A=K.c))return null;if(q=((j=A.length-1)-T(this.e/d))*d,j=A[j])for(;j%10==0;j/=10,q--);return q<0&&(q=0),q},G.dividedBy=G.div=function(O,H){return F(this,new R(O,H),we,Me)},G.dividedToIntegerBy=G.idiv=function(O,H){return F(this,new R(O,H),0,1)},G.exponentiatedBy=G.pow=function(O,H){var A,q,j,K,ie,W,X,te,Z,ce=this;if(O=new R(O),O.c&&!O.isInteger())throw Error(a+"Exponent not an integer: "+ge(O));if(H!=null&&(H=new R(H)),W=O.e>14,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!O.c||!O.c[0])return Z=new R(Math.pow(+ge(ce),W?O.s*(2-N(O)):+ge(O))),H?Z.mod(H):Z;if(X=O.s<0,H){if(H.c?!H.c[0]:!H.s)return new R(NaN);q=!X&&ce.isInteger()&&H.isInteger(),q&&(ce=ce.mod(H))}else{if(O.e>9&&(ce.e>0||ce.e<-1||(ce.e==0?ce.c[0]>1||W&&ce.c[1]>=24e7:ce.c[0]<8e13||W&&ce.c[0]<=9999975e7)))return K=ce.s<0&&N(O)?-0:0,ce.e>-1&&(K=1/K),new R(X?1/K:K);B&&(K=r(B/d+2))}for(W?(A=new R(.5),X&&(O.s=1),te=N(O)):(j=Math.abs(+ge(O)),te=j%2),Z=new R(ye);;){if(te){if(Z=Z.times(ce),!Z.c)break;K?Z.c.length>K&&(Z.c.length=K):q&&(Z=Z.mod(H))}if(j){if(j=o(j/2),j===0)break;te=j%2}else if(O=O.times(A),ae(O,O.e+1,1),O.e>14)te=N(O);else{if(j=+ge(O),j===0)break;te=j%2}ce=ce.times(ce),K?ce.c&&ce.c.length>K&&(ce.c.length=K):q&&(ce=ce.mod(H))}return q?Z:(X&&(Z=ye.div(Z)),H?Z.mod(H):K?ae(Z,B,Me,ie):Z)},G.integerValue=function(O){var H=new R(this);return O==null?O=Me:_(O,0,8),ae(H,H.e+1,O)},G.isEqualTo=G.eq=function(O,H){return I(this,new R(O,H))===0},G.isFinite=function(){return!!this.c},G.isGreaterThan=G.gt=function(O,H){return I(this,new R(O,H))>0},G.isGreaterThanOrEqualTo=G.gte=function(O,H){return(H=I(this,new R(O,H)))===1||H===0},G.isInteger=function(){return!!this.c&&T(this.e/d)>this.c.length-2},G.isLessThan=G.lt=function(O,H){return I(this,new R(O,H))<0},G.isLessThanOrEqualTo=G.lte=function(O,H){return(H=I(this,new R(O,H)))===-1||H===0},G.isNaN=function(){return!this.s},G.isNegative=function(){return this.s<0},G.isPositive=function(){return this.s>0},G.isZero=function(){return!!this.c&&this.c[0]==0},G.minus=function(O,H){var A,q,j,K,ie=this,W=ie.s;if(O=new R(O,H),H=O.s,!W||!H)return new R(NaN);if(W!=H)return O.s=-H,ie.plus(O);var X=ie.e/d,te=O.e/d,Z=ie.c,ce=O.c;if(!X||!te){if(!Z||!ce)return Z?(O.s=-H,O):new R(ce?ie:NaN);if(!Z[0]||!ce[0])return ce[0]?(O.s=-H,O):new R(Z[0]?ie:Me==3?-0:0)}if(X=T(X),te=T(te),Z=Z.slice(),W=X-te){for((K=W<0)?(W=-W,j=Z):(te=X,j=ce),j.reverse(),H=W;H--;j.push(0));j.reverse()}else for(q=(K=(W=Z.length)<(H=ce.length))?W:H,W=H=0;H<q;H++)if(Z[H]!=ce[H]){K=Z[H]<ce[H];break}if(K&&(j=Z,Z=ce,ce=j,O.s=-O.s),H=(q=ce.length)-(A=Z.length),H>0)for(;H--;Z[A++]=0);for(H=h-1;q>W;){if(Z[--q]<ce[q]){for(A=q;A&&!Z[--A];Z[A]=H);--Z[A],Z[q]+=h}Z[q]-=ce[q]}for(;Z[0]==0;Z.splice(0,1),--te);return Z[0]?J(O,Z,te):(O.s=Me==3?-1:1,O.c=[O.e=0],O)},G.modulo=G.mod=function(O,H){var A,q,j=this;return O=new R(O,H),!j.c||!O.s||O.c&&!O.c[0]?new R(NaN):!O.c||j.c&&!j.c[0]?new R(j):(Ge==9?(q=O.s,O.s=1,A=F(j,O,0,3),O.s=q,A.s*=q):A=F(j,O,0,Ge),O=j.minus(A.times(O)),!O.c[0]&&Ge==1&&(O.s=j.s),O)},G.multipliedBy=G.times=function(O,H){var A,q,j,K,ie,W,X,te,Z,ce,He,Ie,Qe,st,ot,Be=this,Je=Be.c,gt=(O=new R(O,H)).c;if(!Je||!gt||!Je[0]||!gt[0])return!Be.s||!O.s||Je&&!Je[0]&&!gt||gt&&!gt[0]&&!Je?O.c=O.e=O.s=null:(O.s*=Be.s,!Je||!gt?O.c=O.e=null:(O.c=[0],O.e=0)),O;for(q=T(Be.e/d)+T(O.e/d),O.s*=Be.s,X=Je.length,ce=gt.length,X<ce&&(Qe=Je,Je=gt,gt=Qe,j=X,X=ce,ce=j),j=X+ce,Qe=[];j--;Qe.push(0));for(st=h,ot=w,j=ce;--j>=0;){for(A=0,He=gt[j]%ot,Ie=gt[j]/ot|0,ie=X,K=j+ie;K>j;)te=Je[--ie]%ot,Z=Je[ie]/ot|0,W=Ie*te+Z*He,te=He*te+W%ot*ot+Qe[K]+A,A=(te/st|0)+(W/ot|0)+Ie*Z,Qe[K--]=te%st;Qe[K]=A}return A?++q:Qe.splice(0,1),J(O,Qe,q)},G.negated=function(){var O=new R(this);return O.s=-O.s||null,O},G.plus=function(O,H){var A,q=this,j=q.s;if(O=new R(O,H),H=O.s,!j||!H)return new R(NaN);if(j!=H)return O.s=-H,q.minus(O);var K=q.e/d,ie=O.e/d,W=q.c,X=O.c;if(!K||!ie){if(!W||!X)return new R(j/0);if(!W[0]||!X[0])return X[0]?O:new R(W[0]?q:j*0)}if(K=T(K),ie=T(ie),W=W.slice(),j=K-ie){for(j>0?(ie=K,A=X):(j=-j,A=W),A.reverse();j--;A.push(0));A.reverse()}for(j=W.length,H=X.length,j-H<0&&(A=X,X=W,W=A,H=j),j=0;H;)j=(W[--H]=W[H]+X[H]+j)/h|0,W[H]=h===W[H]?0:W[H]%h;return j&&(W=[j].concat(W),++ie),J(O,W,ie)},G.precision=G.sd=function(O,H){var A,q,j,K=this;if(O!=null&&O!==!!O)return _(O,1,y),H==null?H=Me:_(H,0,8),ae(new R(K),O,H);if(!(A=K.c))return null;if(j=A.length-1,q=j*d+1,j=A[j]){for(;j%10==0;j/=10,q--);for(j=A[0];j>=10;j/=10,q++);}return O&&K.e+1>q&&(q=K.e+1),q},G.shiftedBy=function(O){return _(O,-9007199254740991,g),this.times("1e"+O)},G.squareRoot=G.sqrt=function(){var O,H,A,q,j,K=this,ie=K.c,W=K.s,X=K.e,te=we+4,Z=new R("0.5");if(W!==1||!ie||!ie[0])return new R(!W||W<0&&(!ie||ie[0])?NaN:ie?K:1/0);if(W=Math.sqrt(+ge(K)),W==0||W==1/0?(H=M(ie),(H.length+X)%2==0&&(H+="0"),W=Math.sqrt(+H),X=T((X+1)/2)-(X<0||X%2),W==1/0?H="5e"+X:(H=W.toExponential(),H=H.slice(0,H.indexOf("e")+1)+X),A=new R(H)):A=new R(W+""),A.c[0]){for(X=A.e,W=X+te,W<3&&(W=0);;)if(j=A,A=Z.times(j.plus(F(K,j,te,1))),M(j.c).slice(0,W)===(H=M(A.c)).slice(0,W))if(A.e<X&&--W,H=H.slice(W-3,W+1),H=="9999"||!q&&H=="4999"){if(!q&&(ae(j,j.e+we+2,0),j.times(j).eq(K))){A=j;break}te+=4,W+=4,q=1}else{(!+H||!+H.slice(1)&&H.charAt(0)=="5")&&(ae(A,A.e+we+2,1),O=!A.times(A).eq(K));break}}return ae(A,A.e+we+1,Me,O)},G.toExponential=function(O,H){return O!=null&&(_(O,0,y),O++),P(this,O,H,1)},G.toFixed=function(O,H){return O!=null&&(_(O,0,y),O=O+this.e+1),P(this,O,H)},G.toFormat=function(O,H,A){var q,j=this;if(A==null)O!=null&&H&&typeof H=="object"?(A=H,H=null):O&&typeof O=="object"?(A=O,O=H=null):A=ue;else if(typeof A!="object")throw Error(a+"Argument not an object: "+A);if(q=j.toFixed(O,H),j.c){var K,ie=q.split("."),W=+A.groupSize,X=+A.secondaryGroupSize,te=A.groupSeparator||"",Z=ie[0],ce=ie[1],He=j.s<0,Ie=He?Z.slice(1):Z,Qe=Ie.length;if(X&&(K=W,W=X,X=K,Qe-=K),W>0&&Qe>0){for(K=Qe%W||W,Z=Ie.substr(0,K);K<Qe;K+=W)Z+=te+Ie.substr(K,W);X>0&&(Z+=te+Ie.slice(K)),He&&(Z="-"+Z)}q=ce?Z+(A.decimalSeparator||"")+((X=+A.fractionGroupSize)?ce.replace(new RegExp("\\d{"+X+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):ce):Z}return(A.prefix||"")+q+(A.suffix||"")},G.toFraction=function(O){var H,A,q,j,K,ie,W,X,te,Z,ce,He,Ie=this,Qe=Ie.c;if(O!=null&&(W=new R(O),!W.isInteger()&&(W.c||W.s!==1)||W.lt(ye)))throw Error(a+"Argument "+(W.isInteger()?"out of range: ":"not an integer: ")+ge(W));if(!Qe)return new R(Ie);for(H=new R(ye),te=A=new R(ye),q=X=new R(ye),He=M(Qe),K=H.e=He.length-Ie.e-1,H.c[0]=p[(ie=K%d)<0?d+ie:ie],O=!O||W.comparedTo(H)>0?K>0?H:te:W,ie=fe,fe=1/0,W=new R(He),X.c[0]=0;Z=F(W,H,0,1),j=A.plus(Z.times(q)),j.comparedTo(O)!=1;)A=q,q=j,te=X.plus(Z.times(j=te)),X=j,H=W.minus(Z.times(j=H)),W=j;return j=F(O.minus(A),q,0,1),X=X.plus(j.times(te)),A=A.plus(j.times(q)),X.s=te.s=Ie.s,K=K*2,ce=F(te,q,K,Me).minus(Ie).abs().comparedTo(F(X,A,K,Me).minus(Ie).abs())<1?[te,q]:[X,A],fe=ie,ce},G.toNumber=function(){return+ge(this)},G.toPrecision=function(O,H){return O!=null&&_(O,1,y),P(this,O,H,2)},G.toString=function(O){var H,A=this,q=A.s,j=A.e;return j===null?q?(H="Infinity",q<0&&(H="-"+H)):H="NaN":(O==null?H=j<=Ee||j>=_e?k(M(A.c),j):$(M(A.c),j,"0"):O===10&&S?(A=ae(new R(A),we+j+1,Me),H=$(M(A.c),A.e,"0")):(_(O,2,C.length,"Base"),H=he($(M(A.c),j,"0"),10,O,q,!0)),q<0&&A.c[0]&&(H="-"+H)),H},G.valueOf=G.toJSON=function(){return ge(this)},G._isBigNumber=!0,L!=null&&R.set(L),R}function T(L){var F=L|0;return L>0||L===F?F:F-1}function M(L){for(var F,he,le=1,G=L.length,ye=L[0]+"";le<G;){for(F=L[le++]+"",he=d-F.length;he--;F="0"+F);ye+=F}for(G=ye.length;ye.charCodeAt(--G)===48;);return ye.slice(0,G+1||1)}function I(L,F){var he,le,G=L.c,ye=F.c,we=L.s,Me=F.s,Ee=L.e,_e=F.e;if(!we||!Me)return null;if(he=G&&!G[0],le=ye&&!ye[0],he||le)return he?le?0:-Me:we;if(we!=Me)return we;if(he=we<0,le=Ee==_e,!G||!ye)return le?0:!G^he?1:-1;if(!le)return Ee>_e^he?1:-1;for(Me=(Ee=G.length)<(_e=ye.length)?Ee:_e,we=0;we<Me;we++)if(G[we]!=ye[we])return G[we]>ye[we]^he?1:-1;return Ee==_e?0:Ee>_e^he?1:-1}function _(L,F,he,le){if(L<F||L>he||L!==o(L))throw Error(a+(le||"Argument")+(typeof L=="number"?L<F||L>he?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function N(L){var F=L.c.length-1;return T(L.e/d)==F&&L.c[F]%2!=0}function k(L,F){return(L.length>1?L.charAt(0)+"."+L.slice(1):L)+(F<0?"e":"e+")+F}function $(L,F,he){var le,G;if(F<0){for(G=he+".";++F;G+=he);L=G+L}else if(le=L.length,++F>le){for(G=he,F-=le;--F;G+=he);L+=G}else F<le&&(L=L.slice(0,F)+"."+L.slice(F));return L}n=b(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Ose)})(iG);var rG=iG.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Jo=$H(),Xse=kH(),Zse=VH,Qse=rG,Oi={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Qp={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:oG,decimalSuffixes:zC}=Jo.currentBytes(),BH={general:{scale:1024,suffixes:zC},binary:{scale:1024,suffixes:oG},decimal:{scale:1e3,suffixes:zC}};function Jse(t,e={},n){if(typeof e=="string"&&(e=Zse.parseFormat(e)),!Xse.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",a=eae(t,e,n);return a=yae(a,r),a=Cae(a,o),a}function eae(t,e,n){switch(e.output){case"currency":return e=Vd(e,Jo.currentCurrencyDefaultFormat()),lae(t,e,Jo);case"percent":return e=Vd(e,Jo.currentPercentageDefaultFormat()),aae(t,e,Jo,n);case"byte":return e=Vd(e,Jo.currentByteDefaultFormat()),rae(t,e,Jo,n);case"time":return e=Vd(e,Jo.currentTimeDefaultFormat()),sae(t);case"ordinal":return e=Vd(e,Jo.currentOrdinalDefaultFormat()),oae(t,e,Jo);case"number":default:return Jp({instance:t,providedFormat:e})}}function tae(t){let e=BH.decimal;return iS(t._value,e.suffixes,e.scale).suffix}function nae(t){let e=BH.binary;return iS(t._value,e.suffixes,e.scale).suffix}function iae(t){let e=BH.general;return iS(t._value,e.suffixes,e.scale).suffix}function iS(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let a=Math.pow(n,o),u=Math.pow(n,o+1);if(r>=a&&r<u){i=e[o],t=t/a;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function rae(t,e,n,i){let r=e.base||"binary",o=Object.assign({},Qp,e);const{binarySuffixes:a,decimalSuffixes:u}=n.currentBytes();let d={general:{scale:1024,suffixes:u||zC,marker:"bd"},binary:{scale:1024,suffixes:a||oG,marker:"b"},decimal:{scale:1e3,suffixes:u||zC,marker:"d"}}[r],{value:g,suffix:p}=iS(t._value,d.suffixes,d.scale);return`${Jp({instance:i(g),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${p}`}function oae(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Qp,e),o=Jp({instance:t,providedFormat:e,state:n}),a=i(t._value);return`${o}${r.spaceSeparated?" ":""}${a}`}function sae(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function aae(t,e,n,i){let r=e.prefixSymbol,o=Jp({instance:i(t._value*100),providedFormat:e,state:n}),a=Object.assign({},Qp,e);return r?`%${a.spaceSeparated?" ":""}${o}`:`${o}${a.spaceSeparated?" ":""}%`}function lae(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},Qp,r),a,u="",h=!!o.totalLength||!!o.forceAverage||o.average,d=r.currencyPosition||i.position,g=r.currencySymbol||i.symbol;const p=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),p&&(u=" "),d==="infix"&&(a=u+g+u);let w=Jp({instance:t,providedFormat:r,state:n,decimalSeparator:a});return d==="prefix"&&(t._value<0&&o.negative==="sign"?w=`-${u}${g}${w.slice(1)}`:t._value>0&&o.forceSign?w=`+${u}${g}${w.slice(1)}`:w=g+u+w),(!d||d==="postfix")&&(u=!o.spaceSeparatedAbbreviation&&h?"":u,w=w+u+g),w}function uae({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:a=Math.round}){let u="",h=Math.abs(t),d=-1;if(e&&i[e]&&Oi[e]?(u=i[e],t=t/Oi[e]):h>=Oi.trillion||n&&a(h/Oi.trillion)===1?(u=i.trillion,t=t/Oi.trillion):h<Oi.trillion&&h>=Oi.billion||n&&a(h/Oi.billion)===1?(u=i.billion,t=t/Oi.billion):h<Oi.billion&&h>=Oi.million||n&&a(h/Oi.million)===1?(u=i.million,t=t/Oi.million):(h<Oi.million&&h>=Oi.thousand||n&&a(h/Oi.thousand)===1)&&(u=i.thousand,t=t/Oi.thousand),u&&(u=(r?" ":"")+u),o){let p=t<0,w=t.toString().split(".")[0],y=p?w.length-1:w.length;d=Math.max(o-y,0)}return{value:t,abbreviation:u,mantissaPrecision:d}}function cae({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function ry(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function hae(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,a=""]=i.split(".");if(+r>0)n=o+a+ry(r-a.length);else{let u=".";+o<0?u=`-0${u}`:u=`0${u}`;let h=(ry(-r-1)+Math.abs(o)+a).substr(0,e);h.length<e&&(h+=ry(e-h.length)),n=u+h}return+r>0&&e>0&&(n+=`.${ry(e)}`),n}function dae(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?hae(t,e):new Qse(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function fae(t,e,n,i,r,o){if(i===-1)return t;let a=dae(e,i,o),[u,h=""]=a.toString().split(".");if(h.match(/^0+$/)&&(n||r))return u;let d=h.match(/0+$/);return r&&d?`${u}.${h.toString().slice(0,d.index)}`:a.toString()}function gae(t,e,n,i){let r=t,[o,a]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return a?`${o.replace("0","")}.${a}`:o.replace("0","");const u=e<0&&o.indexOf("-")===0;if(u&&(o=o.slice(1),r=r.slice(1)),o.length<i){let h=i-o.length;for(let d=0;d<h;d++)r=`0${r}`}return u&&(r=`-${r}`),r.toString()}function mae(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function pae(t,e,n,i,r){let o=i.currentDelimiters(),a=o.thousands;r=r||o.decimal;let u=o.thousandsSize||3,h=t.toString(),d=h.split(".")[0],g=h.split(".")[1];const p=e<0&&d.indexOf("-")===0;return n&&(p&&(d=d.slice(1)),mae(d.length,u).forEach((y,b)=>{d=d.slice(0,y+b)+a+d.slice(y+b)}),p&&(d=`-${d}`)),g?h=d+r+g:h=d,h}function vae(t,e){return t+e}function wae(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function yae(t,e){return e+t}function Cae(t,e){return t+e}function Jp({instance:t,providedFormat:e,state:n=Jo,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let a=Object.assign({},Qp,r,e),u=a.totalLength,h=u?0:a.characteristic,d=a.optionalCharacteristic,g=a.forceAverage,p=a.lowPrecision,w=!!u||!!g||a.average,y=u?-1:w&&e.mantissa===void 0?0:a.mantissa,b=u?!1:e.optionalMantissa===void 0?y===-1:a.optionalMantissa,T=a.trimMantissa,M=a.thousandSeparated,I=a.spaceSeparated,_=a.negative,N=a.forceSign,k=a.exponential,$=a.roundingFunction,L="";if(w){let he=uae({value:o,forceAverage:g,lowPrecision:p,abbreviations:n.currentAbbreviations(),spaceSeparated:I,roundingFunction:$,totalLength:u});o=he.value,L+=he.abbreviation,u&&(y=he.mantissaPrecision)}if(k){let he=cae({value:o,characteristicPrecision:h});o=he.value,L=he.abbreviation+L}let F=fae(o.toString(),o,b,y,T,$);return F=gae(F,o,d,h),F=pae(F,o,M,n,i),(w||k)&&(F=vae(F,L)),(N||o<0)&&(F=wae(F,o,_)),F}function Vd(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var bae=t=>({format:(...e)=>Jse(...e,t),getByteUnit:(...e)=>iae(...e,t),getBinaryByteUnit:(...e)=>nae(...e,t),getDecimalByteUnit:(...e)=>tae(...e,t),formatOrDefault:Vd});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const dl=rG;function Sae(t,e,n){let i=new dl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new dl(r),t._value=i.plus(r).toNumber(),t}function sG(t,e,n){let i=new dl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new dl(r),t._value=i.minus(r).toNumber(),t}function Rae(t,e,n){let i=new dl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new dl(r),t._value=i.times(r).toNumber(),t}function Eae(t,e,n){let i=new dl(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new dl(r),t._value=i.dividedBy(r).toNumber(),t}function Tae(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function _ae(t,e,n){let i=n(t._value);return sG(i,e,n),Math.abs(i._value)}var Mae=t=>({add:(e,n)=>Sae(e,n,t),subtract:(e,n)=>sG(e,n,t),multiply:(e,n)=>Rae(e,n,t),divide:(e,n)=>Eae(e,n,t),set:(e,n)=>Tae(e,n,t),difference:(e,n)=>_ae(e,n,t),BigNumber:dl});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Oae="2.5.0",ua=$H(),xae=kH(),Aae=Kse($n),Hae=nG();let ac=bae($n),Lc=Mae($n);const Iae=VH;class aG{constructor(e){this._value=e}clone(){return $n(this._value)}format(e={}){return ac.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Iae.parseFormat(e)),e=ac.formatOrDefault(e,ua.currentCurrencyDefaultFormat()),e.output="currency",ac.format(this,e)}formatTime(e={}){return e.output="time",ac.format(this,e)}binaryByteUnits(){return ac.getBinaryByteUnit(this)}decimalByteUnits(){return ac.getDecimalByteUnit(this)}byteUnits(){return ac.getByteUnit(this)}difference(e){return Lc.difference(this,e)}add(e){return Lc.add(this,e)}subtract(e){return Lc.subtract(this,e)}multiply(e){return Lc.multiply(this,e)}divide(e){return Lc.divide(this,e)}set(e){return Lc.set(this,lG(e))}value(){return this._value}valueOf(){return this._value}}function lG(t){let e=t;return $n.isNumbro(t)?e=t._value:typeof t=="string"?e=$n.unformat(t):isNaN(t)&&(e=NaN),e}function $n(t){return new aG(lG(t))}$n.version=Oae;$n.isNumbro=function(t){return t instanceof aG};$n.language=ua.currentLanguage;$n.registerLanguage=ua.registerLanguage;$n.setLanguage=ua.setLanguage;$n.languages=ua.languages;$n.languageData=ua.languageData;$n.zeroFormat=ua.setZeroFormat;$n.defaultFormat=ua.currentDefaults;$n.setDefaults=ua.setDefaults;$n.defaultCurrencyFormat=ua.currentCurrencyDefaultFormat;$n.validate=xae.validate;$n.loadLanguagesInNode=Aae.loadLanguagesInNode;$n.unformat=Hae.unformat;$n.BigNumber=Lc.BigNumber;var Pae=$n,lc=xse(Pae);const Nae="numeric";function uG(t,e){if(er(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!lc.languages()[i]){const o=i.replace("-",""),a=lc.allLanguages?lc.allLanguages[i]:lc[o];a&&lc.registerLanguage(a)}lc.setLanguage(i),t=lc(t).format(r||"0")}return t}function FH(t,e,n,i,r,o,a){let u=o;if(er(u)){let d=[];if(Array.isArray(a.className))d=a.className;else{var h;const g=(h=a.className)!==null&&h!==void 0?h:"";g.length&&(d=g.split(" "))}u=uG(u,a),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),a.className=d.join(" "),e.dir="ltr"}yl(t,e,n,i,r,u,a)}FH.RENDERER_TYPE=Nae;const Dae="password";function WH(t,e,n,i,r,o,a){yl.apply(this,[t,e,n,i,r,o,a]);const u=a.hashLength||e.innerHTML.length,h=a.hashSymbol||"*";let d="";Ve(u-1,()=>{d+=h}),Tf(e,d)}WH.RENDERER_TYPE=Dae;const Lae="select";function jH(t,e,n,i,r,o,a){yl.apply(this,[t,e,n,i,r,o,a])}jH.RENDERER_TYPE=Lae;const kae="time";function UH(t,e,n,i,r,o,a){yl.apply(this,[t,e,n,i,r,o,a]),e.dir="ltr"}UH.RENDERER_TYPE=kae;function Vae(){vo(xf),vo(Zp),vo(NH),vo(PH),vo(LH),vo(IH),vo(FH),vo(WH),vo(jH),vo(yl),vo(UH)}const $ae="autocomplete";function rS(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,TW(n,e)):TW(n,e)(this.source):e(!0)}rS.VALIDATOR_TYPE=$ae;function TW(t,e){const n=t;return function(i){let r=!1;for(let o=0,a=i.length;o<a;o++)if(n===i[o]){r=!0;break}e(r)}}function Bae(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Fae="date";function zH(t,e){const n=Hz(qY,this.instance);let i=t,r=!0;i==null&&(i="");let o=Ce(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=Ce(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(a=!0,o=!0),a||(r=!1),!a&&o&&(r=!0),a&&!o)if(this.correctFormat===!0){const u=Wae(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),r=!0}else r=!1;e(r)}zH.VALIDATOR_TYPE=Fae;function Wae(t,e){const n=Ce(Bae(t)),i=Ce(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const jae="dropdown";function YH(t,e){rS.apply(this,[t,e])}YH.VALIDATOR_TYPE=jae;const Uae="numeric";function GH(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:er(t))}GH.VALIDATOR_TYPE=Uae;const zae=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Yae="time";function qH(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const a=Ce(r,zae,!0).isValid()?Ce(r):Ce(r,n);let u=a.isValid(),h=Ce(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(u=!0,h=!0),u||(i=!1),!u&&h&&(i=!0),u&&!h)if(this.correctFormat===!0){const d=a.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;e(i)}qH.VALIDATOR_TYPE=Yae;function Gae(){kd(rS),kd(YH),kd(zH),kd(GH),kd(qH)}const qae="autocomplete",Kae={CELL_TYPE:qae,editor:AH,renderer:xf,validator:rS},Xae="checkbox",Zae={CELL_TYPE:Xae,editor:GY,renderer:NH},Qae="date";function cG(t,e,n,i,r,o,a){xf.apply(this,[t,e,n,i,r,o,a])}cG.RENDERER_TYPE=Qae;const Jae="date",ele={CELL_TYPE:Jae,editor:KY,renderer:cG,validator:zH},tle="dropdown",nle={CELL_TYPE:tle,editor:XY,renderer:PH,validator:YH,filter:!1,strict:!0},ile="handsontable",rle={CELL_TYPE:ile,editor:xH,renderer:LH},ole="numeric",sle={CELL_TYPE:ole,editor:ZY,renderer:FH,validator:GH,dataType:"number"},ale="password",lle={CELL_TYPE:ale,editor:QY,renderer:WH,copyable:!1},ule="select",cle={CELL_TYPE:ule,editor:JY,renderer:jH},hle="time",dle={CELL_TYPE:hle,editor:eG,renderer:UH,validator:qH};function fle(){Xo(Kae),Xo(Zae),Xo(ele),Xo(nle),Xo(rle),Xo(sle),Xo(lle),Xo(cle),Xo(LY),Xo(dle)}function gle(t,e){hG(t,e),e.add(t)}function mle(t,e,n){hG(t,e),e.set(t,n)}function hG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ud(t,e,n){return(e=ple(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ple(t){var e=vle(t,"string");return typeof e=="symbol"?e:e+""}function vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cd(t,e){return t.get(dG(t,e))}function dG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _W=new Map([["plugin",PQ],["cell-type",_Y],["editor",Az],["renderer",Vz],["validator",$z]]),fG=Symbol("mainSetting"),wle="base",oy=[];let uc=null;var cc=new WeakMap,MW=new WeakSet;class It{static get PLUGIN_KEY(){return wle}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){gle(this,MW),ud(this,"eventManager",new fs(this)),ud(this,"pluginName",null),ud(this,"pluginsInitializedCallbacks",[]),ud(this,"isPluginsReady",!1),ud(this,"enabled",!1),ud(this,"initialized",!1),mle(this,cc,{}),vl(this,"hot",e,{writable:!1}),uc=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[a,u]=o.split(":");if(!_W.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);_W.get(a)(u)||r.push(` - ${u} (${a})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");oy.push(o)}}if(uc||(uc=kz()),uc.indexOf(this.pluginName)>=0&&uc.splice(uc.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),uc.length===0){if(oy.length>0){const r=[`${oy.join(`
`)}
`,"You have to import and register them manually."].join("");throw oy.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||dt(n))&&i[fG]===e){var r;return Array.isArray(n)?n:(r=n[e])!==null&&r!==void 0?r:i[e]}if(dt(n)){var o;return(o=n[e])!==null&&o!==void 0?o:i[e]}return i[e]}addHook(e,n,i){cd(cc,this)[e]=cd(cc,this)[e]||[];const r=cd(cc,this)[e];this.hot.addHook(e,n,i),r.push(n),cd(cc,this)[e]=r}removeHooks(e){U(cd(cc,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=cd(cc,this);ft(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){U(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=dG(MW,this,yle).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ft(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function yle(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function hc(t,e,n){return(e=Cle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cle(t){var e=ble(t,"string");return typeof e=="symbol"?e:e+""}function ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let gG=class{constructor(e){hc(this,"hot",null),hc(this,"container",null),hc(this,"injected",!1),hc(this,"rows",[]),hc(this,"columns",[]),hc(this,"samples",null),hc(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&pe(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),U(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),U(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{U(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{U(o.strings,a=>{const u=a.col,h=this.hot.getCellMeta(e,u),d=this.hot.getCellRenderer(h),g=n.createElement("td");g.setAttribute("ghost-table",1),d(this.hot,g,e,u,this.hot.colToProp(u),a.value,h),i.appendChild(g)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{U(r.strings,o=>{const a=o.col,u=e.createElement("th");i.push([a,u]),n.appendChild(u)})}),this.table.tHead.appendChild(n),U(i,r=>{const[o,a]=r;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{U(r.strings,o=>{const a=o.row,u=this.hot.getCellMeta(a,e),h=this.hot.getCellRenderer(u),d=n.createElement("td"),g=n.createElement("tr");d.setAttribute("ghost-table",1),h(this.hot,d,a,e,this.hot.colToProp(e),o.value,u),g.appendChild(d),i.appendChild(g)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let a=e+1;a<e+r;a++)o+=this.hot.getColWidth(a);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),a=n.createElement("tbody"),u=n.createElement("colgroup"),h=n.createElement("tr"),d=n.createElement("th");return this.isVertical()&&r.appendChild(u),this.isHorizontal()&&(h.appendChild(d),o.appendChild(h),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&a.appendChild(h),r.appendChild(a),pe(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:a,colGroup:u,tr:h,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return pe(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function sy(t,e,n){return(e=Sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sle(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oS{static get SAMPLE_COUNT(){return 3}constructor(e){sy(this,"samples",null),sy(this,"dataFactory",null),sy(this,"customSampleCount",null),sy(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:oS.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:a}=typeof i=="number"?{from:i,to:i}:i;return Ve(o,a,u=>{const h=this.generateSample(e,n,u);r.set(u,h)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",a=[];return Ve(n.from,n.to,u=>{const h=e==="row"?this.dataFactory(i,u):this.dataFactory(u,i);if(h===!1)return;const{value:d,bundleSeed:g}=h,p=typeof g=="string"&&g.length>0;let w;p?w=g:dt(d)?w=`${Object.keys(d).length}`:Array.isArray(d)?w=`${d.length}`:w=`${yn(d).length}`,r.has(w)||r.set(w,{needed:this.getSampleCount(),strings:[]});const y=r.get(w);y.needed&&(!(a.indexOf(d)>-1)||this.allowDuplicates||p)&&(y.strings.push({value:d,[o]:u}),a.push(d),y.needed-=1)}),r}}function Ele(t,e){mG(t,e),e.add(t)}function gM(t,e,n){mG(t,e),e.set(t,n)}function mG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function im(t,e,n){return(e=Tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tle(t){var e=_le(t,"string");return typeof e=="symbol"?e:e+""}function _le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e){return t.get(Er(t,e))}function YC(t,e,n){return t.set(Er(t,e),n),n}function Er(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("modifyAutoColumnSizeSeed");const mM="autoColumnSize",Mle=10,Ole="autoColumnSize";var KH=new WeakMap,$d=new WeakMap,gf=new WeakMap,Gr=new WeakSet;class Km extends It{static get PLUGIN_KEY(){return mM}static get PLUGIN_PRIORITY(){return Mle}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ele(this,Gr),im(this,"ghostTable",new gG(this.hot)),im(this,"samplesGenerator",new oS((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const a=this.hot.getCellMeta(n,i);let u="";a.spanned||(u=this.hot.getDataAtCell(n,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,a,u)),{value:u,bundleSeed:h}})),im(this,"inProgress",!1),im(this,"measuredColumns",0),im(this,"columnWidthsMap",new Iu),gM(this,KH,!1),gM(this,$d,[]),gM(this,gf,[]),this.hot.columnIndexMapper.registerMap(Ole,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>Er(Gr,this,OW).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[mM]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Er(Gr,e,Hle).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Er(Gr,e,Ile).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Er(Gr,e,Nle).call(e,...r)}),this.addHook("beforeRender",()=>Er(Gr,this,Ale).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>Er(Gr,this,Ple).call(this)),super.enablePlugin()}updatePlugin(){YC(gf,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>Er(Gr,this,OW).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Ve(r.from,r.to,a=>{let u=this.hot.toPhysicalColumn(a);u===null&&(u=a),(i||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&Er(Gr,this,pG).call(this,a,o)}),this.ghostTable.columns.length&&(Er(Gr,this,vG).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){LC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Km.CALCULATION_STEP,r)},e,n),i=i+Km.CALCULATION_STEP+1,i<r?o=DC(a):(LC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},e,n),i=u+1),i<r?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[mM];let n=Km.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return dt(e)&&(n=e.syncLimit,tz(n)?n=Nz(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,lf))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const a=wu($d,this).length;return(a-1<o||wu($d,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),a-1<o?wu($d,this).push(r):wu($d,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function xle(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||Er(Gr,this,pG).call(this,n,e))}),this.ghostTable.columns.length&&(Er(Gr,this,vG).call(this),this.ghostTable.clean())}function pG(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function vG(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Ale(){this.calculateVisibleColumnsWidth(),this.inProgress||(Er(Gr,this,xle).call(this,wu(gf,this)),YC(gf,this,[]))}function Hle(t,e){e||this.recalculateAllColumnsWidth()}function Ile(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);wu(gf,this).push(...e)}function OW(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function Ple(){YC($d,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),YC(KH,this,!0)}function Nle(t){if(!wu(KH,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const a=this.hot.toVisualColumn(o);n.indexOf(a)===-1&&n.push(a)}return n},[]);wu(gf,this).push(...e)}const jc={horizontal:"horizontal",vertical:"vertical"};function Dle(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function Lle(t){const e={};return t===!0?(e.directions=Object.keys(jc),e.autoInsertRow=!0):dt(t)?(Ne(t.autoInsertRow)?t.direction===jc.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ne(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(jc)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function kle(t,e){Vle(t,e),e.add(t)}function Vle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hd(t,e,n){return(e=$le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $le(t){var e=Ble(t,"string");return typeof e=="symbol"?e:e+""}function Ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("modifyAutofillRange");xe.getSingleton().register("beforeAutofill");xe.getSingleton().register("afterAutofill");const xW="autofill",Fle=20,Wle=["fillHandle"],jle="insert_row_below",Ule=200;var dd=new WeakSet;class zle extends It{constructor(){super(...arguments),kle(this,dd),hd(this,"addingStarted",!1),hd(this,"mouseDownOnCellCorner",!1),hd(this,"mouseDragOutside",!1),hd(this,"handleDraggedCells",0),hd(this,"directions",[]),hd(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return xW}static get PLUGIN_PRIORITY(){return Fle}static get SETTING_KEYS(){return[xW,...Wle]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>rm(dd,this,Gle).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>rm(dd,this,Yle).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>rm(dd,this,qle).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:o}]),u=[],h=[],d=[];return U(a,g=>{for(let p=g.startRow;p<=g.endRow;p+=1)u.indexOf(p)===-1&&u.push(p);for(let p=g.startCol;p<=g.endCol;p+=1)h.indexOf(p)===-1&&h.push(p)}),U(u,g=>{const p=[];U(h,w=>{p.push(this.hot.getCopyableData(g,w))}),d.push(p)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),u=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[a.row,a.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,n),Math.max(u.row,i),Math.max(u.col,r)],h),{directionOfDrag:g,startOfDragCoords:p,endOfDragCoords:w}=Dle(h,d,(y,b)=>this.hot._createCellCoords(y,b));if(p&&p.row>-1&&p.col>-1){const y=this.getSelectionData(),b=o.clone(),T=this.hot._createCellRange(p,p,w),M=this.hot.runHooks("beforeAutofill",y,b,T,g);if(M===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let I=M;const _=M;if(["up","left"].indexOf(g)>-1&&!(_.length===1&&_[0].length===0))if(I=[],g==="up"){const N=w.row-p.row+1,k=N%_.length;for(let $=0;$<N;$++)I.push(_[($+(_.length-k))%_.length])}else{const N=w.col-p.col+1,k=N%_[0].length;for(let $=0;$<_.length;$++){I.push([]);for(let L=0;L<N;L++)I[$].push(_[$][(L+(_[$].length-k))%_[$].length])}}this.hot.populateFromArray(p.row,p.col,I,w.row,w.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",I,b,T,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(jc.vertical)&&this.directions.includes(jc.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(jc.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(jc.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(jle,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Ule)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let h=e[1];h<=e[3];h++){const d=n[o][h];if(!Vn(d))return-1}const a=n[o][e[1]-1],u=n[o][e[3]+1];(!Vn(a)||!Vn(u))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...St(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=Wi(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+ni(this.hot.table),r=Wi(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+zn(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>rm(dd,this,Kle).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>rm(dd,this,Xle).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Lle(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Yle(){this.selectAdjacent()&&this.fillIn()}function Gle(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function qle(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Kle(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Xle(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Zle(t,e){wG(t,e),e.add(t)}function AW(t,e,n){wG(t,e),e.set(t,n)}function wG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e,n){return(e=Qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qle(t){var e=Jle(t,"string");return typeof e=="symbol"?e:e+""}function Jle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yG(t,e,n){return t.set(Xs(t,e),n),n}function GC(t,e){return t.get(Xs(t,e))}function Xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pM="autoRowSize",eue=40,tue="autoRowSize";var Rp=new WeakMap,XH=new WeakMap,ja=new WeakSet;class Xm extends It{static get PLUGIN_KEY(){return pM}static get PLUGIN_PRIORITY(){return eue}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Zle(this,ja),fd(this,"headerHeight",null),fd(this,"ghostTable",new gG(this.hot)),fd(this,"samplesGenerator",new oS((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let a;return n>=0?a=this.hot.getDataAtCell(n,i):n===-1&&(a=this.hot.getColHeader(i)),{value:a}})),fd(this,"inProgress",!1),fd(this,"measuredRows",0),fd(this,"rowHeightsMap",new Iu),AW(this,Rp,[]),AW(this,XH,!1),this.hot.rowIndexMapper.registerMap(tue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Xs(ja,this,HW).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[pM];return e===!0||dt(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Xs(ja,e,rue).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Xs(ja,e,oue).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Xs(ja,e,aue).call(e,...r)}),this.addHook("beforeRender",()=>Xs(ja,this,iue).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>Xs(ja,this,sue).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>Xs(ja,this,HW).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(a.get(-1))}Ve(r.from,r.to,a=>{let u=this.hot.toPhysicalRow(a);u===null&&(u=a),(i||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(a,o).forEach((d,g)=>this.ghostTable.addRow(g,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,u)=>{a<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),u)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){LC(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Xm.CALCULATION_STEP,r)},e,n),i=i+Xm.CALCULATION_STEP+1,i<r?o=DC(a):(LC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},e,n),i=u+1),i<r?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[pM];let n=Xm.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return dt(e)&&(n=e.syncLimit,tz(n)?n=Nz(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ve(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function nue(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function iue(){this.calculateVisibleRowsHeight(),this.inProgress||(Xs(ja,this,nue).call(this,GC(Rp,this)),yG(Rp,this,[]))}function HW(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function rue(t,e){e||this.recalculateAllRowsHeight()}function oue(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);GC(Rp,this).push(...e)}function sue(){this.recalculateAllRowsHeight(),yG(XH,this,!0)}function aue(t){if(!GC(XH,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const a=this.hot.toVisualRow(o);n.indexOf(a)===-1&&n.push(a)}return n},[]);GC(Rp,this).push(...e)}const{getListWithInsertedItems:lue,getListWithRemovedItems:uue}=lY("physicallyIndexed");class cue extends mh{constructor(){super(e=>e)}insert(e,n){const i=iA(this.indexedValues,n);this.indexedValues=lue(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=uue(this.indexedValues,e);this.indexedValues=nA(n,e),super.remove(e)}}const{getListWithInsertedItems:hue,getListWithRemovedItems:due}=lY("physicallyIndexed");class fue extends mh{constructor(){super(e=>e)}insert(e,n){this.indexedValues=hue(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=due(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function gue(t,e){mue(t,e),e.add(t)}function mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pue(t,e,n){return(e=vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vue(t){var e=wue(t,"string");return typeof e=="symbol"?e:e+""}function wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IW="bindRowsWithHeaders",Cue=210,bue="loose",PW=new Map([["loose",cue],["strict",fue]]);var NW=new WeakSet;class Sue extends It{constructor(){super(...arguments),gue(this,NW),pue(this,"headerIndexes",null)}static get PLUGIN_KEY(){return IW}static get PLUGIN_PRIORITY(){return Cue}isEnabled(){return!!this.hot.getSettings()[IW]}enablePlugin(){var e;if(this.enabled)return;const n=(e=PW.get(this.getSetting()))!==null&&e!==void 0?e:PW.get(bue);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>yue(NW,this,Rue).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Rue(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Eue(t,e){CG(t,e),e.add(t)}function Tue(t,e,n){CG(t,e),e.set(t,n)}function CG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DW(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Mue(t,"string");return typeof e=="symbol"?e:e+""}function Mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LW(t,e){return t.get(Gd(t,e))}function vM(t,e,n){return t.set(Gd(t,e),n),n}function Gd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fC="collapsibleColumns",Oue=290,xue=["nestedHeaders"],nf="collapsibleIndicator",kW=fC,VW=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var gd=new WeakMap,om=new WeakSet;class Aue extends It{constructor(){super(...arguments),Eue(this,om),DW(this,"nestedHeadersPlugin",null),DW(this,"headerStateManager",null),Tue(this,gd,null)}static get PLUGIN_KEY(){return fC}static get PLUGIN_PRIORITY(){return Oue}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[fC,...xue]}isEnabled(){return!!this.hot.getSettings()[fC]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Nt("You need to configure the Nested Headers plugin in order to use collapsible headers."),vM(gd,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Gd(om,this,Pue).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Gd(om,e,Nue).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Gd(om,e,Hue).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>Gd(om,this,Iue).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),vM(gd,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:a}):this.collapseSection({row:n,col:a}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:kW,relativeToGroup:Pu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kW)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};Ve(0,e-1,a=>{const u=n.childNodes[a],h=i.childNodes[a],d=r?r.childNodes[a]:null;Ve(0,u.childNodes.length-1,g=>{let p=u.childNodes[g].querySelector(`.${nf}`);o(p),h&&h.childNodes[g]&&(p=h.childNodes[g].querySelector(`.${nf}`),o(p)),r&&d&&d.childNodes[g]&&(p=d.childNodes[g].querySelector(`.${nf}`),o(p))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:a,columnIndex:u,isCollapsed:h}=i;if(r===!0&&o>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:u}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!VW.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Zc(e,y=>{let{row:b}=y;return b<0});let r=i.length>0;U(i,y=>{var b;let{row:T,col:M}=y;const{collapsible:I,isCollapsed:_}=(b=this.headerStateManager.getHeaderSettings(T,M))!==null&&b!==void 0?b:{};if(!I||_&&n==="collapse"||!_&&n==="expand")return r=!1,!1});const o=[],a=[];r&&U(i,y=>{let{row:b,col:T}=y;const{colspanCompensation:M,affectedColumns:I,rollbackModification:_}=this.headerStateManager.triggerNodeModification(n,b,T);M>0&&(a.push(...I),o.push(_))});const u=this.getCollapsedColumns();let h=[];n==="collapse"?h=DX([...u,...a]):n==="expand"&&(h=Zc(u,y=>!a.includes(y)));const d=VW.get(n);if(this.hot.runHooks(d.beforeHook,u,h,r)===!1){U(o,y=>{y()});return}this.hot.batchExecution(()=>{U(a,y=>{LW(gd,this).setValueAtIndex(this.hot.toPhysicalColumn(y),d.hideColumn)})},!0);const p=this.getCollapsedColumns().length!==u.length,w=this.hot.getSelectedRangeLast();if(n==="collapse"&&p&&w){const{row:y,col:b}=w.highlight;if((this.hot.rowIndexMapper.isHidden(y)||this.hot.columnIndexMapper.isHidden(b))&&a.includes(b)){const M=y>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1,!0):y,I=b>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(b,1,!0):b;M!==null&&I!==null&&this.hot.selectCell(M,I)}}this.hot.runHooks(d.afterHook,u,h,r,p),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return LW(gd,this).getHiddenIndexes()}destroy(){vM(gd,this,null),super.destroy()}}function Hue(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:a}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},u=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=e.querySelector(`.${nf}`);if(Ef(e,[Oo("")[0]]),u)d||(d=this.hot.rootDocument.createElement("div"),pe(d,nf),e.querySelector("div:first-child").appendChild(d)),Ue(d,["collapsed","expanded"]),a?(pe(d,"collapsed"),Jc(d,"+"),h&&qe(e,...Oo(!1))):(pe(d,"expanded"),Jc(d,"-"),h&&qe(e,...Oo(!0))),h&&qe(d,...gh());else{var g;(g=d)===null||g===void 0||g.remove()}}function Iue(t,e){ze(t.target,nf)&&(ze(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ze(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ps(t))}function Pue(){this.updatePlugin()}function Nue(t,e){e||this.updatePlugin()}function dc(t,e,n){return(e=Due(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Due(t){var e=Lue(t,"string");return typeof e=="symbol"?e:e+""}function Lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kue=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Vue=!1,$ue=!0,Bue=!0;class Fue{constructor(e,n){dc(this,"hot",void 0),dc(this,"sortingStates",new Xb),dc(this,"sortEmptyCells",Vue),dc(this,"indicator",$ue),dc(this,"headerAction",Bue),dc(this,"compareFunctionFactory",void 0),dc(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){dt(e)&&ft(e,(n,i)=>{kue.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return dt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(Ne(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function bG(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:a}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?na:Vn(r)?Vn(o)?na:a&&t==="asc"?Mn:On:Vn(o)?a&&t==="asc"?On:Mn:isNaN(r)&&!isNaN(o)?t==="asc"?On:Mn:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?Mn:On:r>o?t==="asc"?On:Mn:na}}const SG="default";function Wue(t,e,n){return function(i,r){const o=parseFloat(i),a=parseFloat(r),{sortEmptyCells:u}=n;if(o===a||isNaN(o)&&isNaN(a))return na;if(u){if(Vn(i))return t==="asc"?Mn:On;if(Vn(r))return t==="asc"?On:Mn}return isNaN(o)?On:isNaN(a)?Mn:o<a?t==="asc"?Mn:On:o>a?t==="asc"?On:Mn:na}}const jue="numeric";function Uue(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(a,u){const h=Vn(a),d=Vn(u),g=h?r:a,p=d?r:u,w=g===r||g===i,y=p===r||p===i;if(o===!1){if(h&&d===!1)return On;if(h===!1&&d)return Mn}return w===!1&&y?t==="asc"?Mn:On:w&&y===!1?t==="asc"?On:Mn:w===!1&&y===!1?bG(t,e,n)(a,u):g===r&&p===i?t==="asc"?Mn:On:g===i&&p===r?t==="asc"?On:Mn:na}}const zue="checkbox";function Yue(t,e,n){return OG(t,e.dateFormat,n)}const Gue="date";function que(t,e,n){return OG(t,e.timeFormat,n)}const Kue="time",{register:ev,getItem:$W,hasItem:Xue}=vs("sorting.compareFunctionFactory"),{register:RG,getItem:Zue}=vs("sorting.mainSortComparator");function EG(t){return Xue(t)?$W(t):$W(SG)}ev(zue,Uue);ev(Gue,Yue);ev(SG,bG);ev(jue,Wue);ev(Kue,que);const na=0,Mn=-1,On=1;function Que(t,e){const n=Zue(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const qC="asc",KC="desc",TG="colHeader";function Jue(t){if(dt(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[qC,KC].includes(n)}function ece(t){if(t.some(n=>Jue(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function BW(t){if(t!==KC)return t===qC?KC:qC}function _G(t){return t.querySelector(`.${TG}`)}function MG(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function ZH(t,e,n){return t===-1&&e>=0&&eh(n)===!1}function OG(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return na;if(Vn(i))return Vn(r)?na:o&&t==="asc"?Mn:On;if(Vn(r))return o&&t==="asc"?On:Mn;const a=Ce(i,e),u=Ce(r,e);return a.isValid()?u.isValid()?u.isAfter(a)?t==="asc"?Mn:On:u.isBefore(a)?t==="asc"?On:Mn:na:Mn:On}}function tce(t,e){Nt($t`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const nce="ascending",ice="descending",xG="indicatorDisabled",AG="columnSorting",HG="sortAction",IG=new Map([[qC,nce],[KC,ice]]);function rce(t,e,n,i){const r=[AG];if(i&&r.push(HG),n===!1)return r.push(xG),r;const o=t.getSortOrderOfColumn(e);return Ne(o)&&r.push(IG.get(o)),r}function oce(){return Array.from(IG.values()).concat(HG,xG,AG)}function sce(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(u){const h=t[u],d=e[u],g=r[u],p=o[u],w=d.columnSorting;return(w.compareFunctionFactory?w.compareFunctionFactory:EG(d.type))(h,d,w)(g,p)}(0)}}function ace(t,e){lce(t,e),e.add(t)}function lce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ay(t,e,n){return(e=uce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uce(t){var e=cce(t,"string");return typeof e=="symbol"?e:e+""}function cce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XC="columnSorting",hce=50,ZC="append",dce="replace",FW=XC;RG(XC,sce);xe.getSingleton().register("beforeColumnSort");xe.getSingleton().register("afterColumnSort");const sm=new WeakMap;var kc=new WeakSet;class PG extends It{constructor(){super(...arguments),ace(this,kc),ay(this,"columnStatesManager",null),ay(this,"columnMetaCache",null),ay(this,"pluginKey",XC),ay(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return XC}static get PLUGIN_PRIORITY(){return hce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(sm.has(this.hot)&&sm.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),tce(sm.get(this.hot),this.pluginKey);return}this.enabled||(sm.set(this.hot,this.pluginKey),this.columnStatesManager=new Fue(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Iu(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>Bd(kc,this,fce).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Bd(kc,e,mce).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>Bd(kc,this,gO).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Bd(kc,e,gce).call(e,...i)}),this.hot.view&&Bd(kc,this,gO).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=_G(i);MG(n,i)===!1||r===null||this.updateHeaderClasses(r)};sm.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Pu,position:"before",group:FW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FW)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new uY),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ne(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return ece(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...a}=r;return{column:this.hot.toPhysicalColumn(o),...a}};n.initialConfig=St(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...a}=r;return{column:this.hot.toVisualColumn(o),...a}};return Ne(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=St(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(Ne(n)){const r=BW(n);return Ne(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:BW()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ZC;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(r){if(wn(a))return[...o.slice(0,i),...o.slice(i+1)];if(n===ZC)return[...o.slice(0,i),...o.slice(i+1),a];if(n===dce)return[...o.slice(0,i),a,...o.slice(i+1)]}return Ne(a)?o.concat(a):o}getPluginColumnConfig(e){if(dt(e)){const n=e[this.pluginKey];if(dt(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):Ut(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=d=>St(e,g=>this.hot.getDataAtCell(d,g.column));for(let d=0;d<this.getNumberOfRowsToSort(i);d+=1)n.push([this.hot.toPhysicalRow(d)].concat(r(d)));const o=St(n,d=>d[0]);Que(n,this.pluginKey,St(e,d=>d.sortOrder),St(e,d=>this.getFirstCellSettings(d.column)));for(let d=n.length;d<i;d+=1)n.push([d].concat(r(d)));const a=St(n,d=>d[0]),u=new Map(St(o,(d,g)=>[d,a[g]])),h=St(this.hot.rowIndexMapper.getIndexesSequence(),d=>u.has(d)?u.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(dt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||dt(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Ue(e,oce()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];pe(e,rce(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ne(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ze(e.target,TG)}onAfterOnCellMouseDown(e,n){if(ZH(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function gO(){const t=this.getAllSavedSortSettings();if(dt(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function fce(t,e){const n=_G(e);if(MG(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(t);qe(e,...nZ(a?`${a}ending`:"none"))}}function gce(t){t===!0&&this.hot.view&&Bd(kc,this,gO).call(this)}function mce(t,e,n,i){ZH(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function fc(t,e,n){return(e=pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pce(t){var e=vce(t,"string");return typeof e=="symbol"?e:e+""}function vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wce{constructor(e,n){fc(this,"plugin",void 0),fc(this,"hot",void 0),fc(this,"endpoints",[]),fc(this,"settings",void 0),fc(this,"settingsType","array"),fc(this,"currentEndpoint",null),fc(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),U(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();U(o,a=>{r==="row"&&a.destinationRow>=n&&(e==="insert_row"?a.alterRowOffset=i:e==="remove_row"&&(a.alterRowOffset=-1*i)),r==="col"&&a.destinationColumn>=n&&(e==="insert_col"?a.alterColumnOffset=i:e==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const w=()=>(this.hot.removeHook("beforeViewRender",w),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",w);return}const u=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),g=e.indexOf("move_row")===0,p=n;U(d,w=>{u==="row"&&w.destinationRow>=p&&(w.alterRowOffset=h*i),u==="col"&&w.destinationColumn>=p&&(w.alterColumnOffset=h*i)}),this.resetAllEndpoints(d,!g),g?U(d,w=>{this.extendEndpointRanges(w,p,r[0],r.length),this.recreatePhysicalRanges(w),this.clearOffsetInformation(w)}):U(d,w=>{this.shiftEndpointCoordinates(w,p)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){U(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];U(n,o=>{const a=[];if(o[1])for(let u=o[0];u<=o[1];u++)a.push(this.hot.toPhysicalRow(u));else a.push(this.hot.toPhysicalRow(o[0]));r.push(a)}),U(r,o=>{let a=[];U(o,(u,h)=>{h===0?a.push(u):o[h]!==o[h-1]+1&&(a.push(o[h-1]),i.push(a),a=[],a.push(u)),h===o.length-1&&(a.push(u),i.push(a))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,U(e.ranges,i=>{U(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,a=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],U(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],U(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],U(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&U(this.getAllEndpoints(),(a,u)=>{this.hot.propToCol(o[r][1])===a.sourceColumn&&n.indexOf(u)===-1&&n.push(u)})}),U(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let u=0;Number.isInteger(a)&&(u=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(u)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Nt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function wM(t){return t==null||isNaN(t)}function yce(t,e){Cce(t,e),e.add(t)}function Cce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bce(t,e,n){return(e=Sce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sce(t){var e=Rce(t,"string");return typeof e=="symbol"?e:e+""}function Rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ly(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yM="columnSummary",Ece=220;var am=new WeakSet;class Tce extends It{constructor(){super(...arguments),yce(this,am),bce(this,"endpoints",null)}static get PLUGIN_KEY(){return yM}static get PLUGIN_PRIORITY(){return Ece}isEnabled(){return!!this.hot.getSettings()[yM]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[yM],this.endpoints=new wce(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ly(am,e,_ce).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ly(am,e,Oce).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ly(am,e,Mce).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ly(am,e,xce).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return ft(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(r,n),o=wM(o)?null:o,o!==null){const u=(`${o}`.split(".")[1]||[]).length||1;u>a&&(a=u)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**a)/10**a}calculateMinMax(e,n){let i=null;return ft(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,n),a=wM(a)?null:a,r===null)r=a;else if(a!==null)switch(i){case"min":r=Math.min(r,a);break;case"max":r=Math.max(r,a);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=wM(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return ft(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,a=this.countEmpty(r,e.sourceColumn);n+=o,n-=a}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),a="";if(i!==null&&r!==null&&(a=this.hot.getCellMeta(i,r).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error($t`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function _ce(){this.endpoints.initEndpoints()}function Mce(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Oce(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function xce(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Ace(t,e){NG(t,e),e.add(t)}function CM(t,e,n){NG(t,e),e.set(t,n)}function NG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fd(t,e){return t.get(QH(t,e))}function mO(t,e,n){return t.set(QH(t,e),n),n}function QH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QC=new WeakMap,uy=new WeakMap,cy=new WeakMap,WW=new WeakSet;class DG{constructor(){Ace(this,WW),CM(this,QC,!0),CM(this,uy,null),CM(this,cy,new ResizeObserver(e=>QH(WW,this,Hce).call(this,e)))}setObservedElement(e){mO(uy,this,e)}unobserve(){Fd(cy,this).unobserve(Fd(uy,this))}observe(){mO(QC,this,!0),Fd(cy,this).observe(Fd(uy,this))}destroy(){Fd(cy,this).disconnect()}}function Hce(t){if(Fd(QC,this)||!Array.isArray(t)||!t.length){mO(QC,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}Xt(DG,Ai);function gc(t,e,n){Ice(t,e),e.set(t,n)}function Ice(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(LG(t,e))}function La(t,e,n){return t.set(LG(t,e),n),n}function LG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mc=new WeakMap,bM=new WeakMap,ka=new WeakMap,Gl=new WeakMap,ql=new WeakMap,hy=new WeakMap,md=new WeakMap;class Uc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;gc(this,mc,void 0),gc(this,bM,!1),gc(this,ka,null),gc(this,Gl,void 0),gc(this,ql,void 0),gc(this,hy,!0),gc(this,md,new DG),La(mc,this,e),La(bM,this,n),La(Gl,this,this.createEditor()),La(ql,this,qt(Gl,this).style),qt(md,this).setObservedElement(this.getInputElement()),qt(md,this).addLocalHook("resize",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){qt(ql,this).left=`${e}px`,qt(ql,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:zn(this.getInputElement()),height:ni(this.getInputElement())}}observeSize(){qt(md,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){qt(ql,this).display="block",La(hy,this,!1)}hide(){qt(md,this).unobserve(),qt(hy,this)||(qt(ql,this).display="none"),La(hy,this,!0)}isVisible(){return qt(ql,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return qt(mc,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=qt(mc,this).createElement("div"),n=qt(mc,this).createElement("textarea");return e.style.display="none",La(ka,this,qt(mc,this).createElement("div")),qt(ka,this).setAttribute("dir",qt(bM,this)?"rtl":"ltr"),pe(qt(ka,this),Uc.CLASS_EDITOR_CONTAINER),qt(mc,this).body.appendChild(qt(ka,this)),pe(e,Uc.CLASS_EDITOR),pe(n,Uc.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),qt(ka,this).appendChild(e),e}getInputElement(){return qt(Gl,this).querySelector(`.${Uc.CLASS_INPUT}`)}getEditorElement(){return qt(Gl,this)}destroy(){const e=qt(ka,this)?qt(ka,this).parentNode:null;qt(Gl,this).parentNode.removeChild(qt(Gl,this)),La(Gl,this,null),La(ql,this,null),qt(md,this).destroy(),e&&e.removeChild(qt(ka,this))}}Xt(Uc,Ai);function SM(t,e,n){return(e=Pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pce(t){var e=Nce(t,"string");return typeof e=="symbol"?e:e+""}function Nce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dce=250,Lce=250;class kG{constructor(e){SM(this,"wasLastActionShow",!0),SM(this,"showDebounced",null),SM(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Lce)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dce;this.showDebounced=jb(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}Xt(kG,Ai);function kce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Vce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function pc(t,e){const n={};return U(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function su(t,e,n,i,r){U(t,o=>{o.forAll((a,u)=>{a>=0&&u>=0&&$ce(a,u,e,n,i,r)})})}function $ce(t,e,n,i,r,o){const a=r(t,e);let u=i;a.className&&(n==="vertical"?u=kce(a.className,i):u=Vce(a.className,i)),o(t,e,"className",u)}function VG(t){return`<span class="selected">✓</span>${t}`}function gC(t,e){let n=!1;return Array.isArray(t)&&U(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function sS(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const ht="---------";function Bce(){return{name:ht}}const Co="alignment";function Fce(){return{key:Co,name(){return this.getTranslatedPhrase(OA)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Co}:left`,name(){return this.getTranslatedPhrase(xA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${Co}:center`,name(){return this.getTranslatedPhrase(AA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${Co}:right`,name(){return this.getTranslatedPhrase(HA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${Co}:justify`,name(){return this.getTranslatedPhrase(IA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{name:ht},{key:`${Co}:top`,name(){return this.getTranslatedPhrase(PA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${Co}:middle`,name(){return this.getTranslatedPhrase(NA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${Co}:bottom`,name(){return this.getTranslatedPhrase(DA)},callback(){const t=this.getSelectedRange(),e=pc(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),su(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1}]}}}const aS="clear_column";function Wce(){return{key:aS,name(){return this.getTranslatedPhrase(gA)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const tv="col_left";function jce(){return{key:tv,name(){return this.getTranslatedPhrase(lA)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const nv="col_right";function Uce(){return{key:nv,name(){return this.getTranslatedPhrase(uA)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const iv="make_read_only";function zce(){return{key:iv,checkable:!0,ariaChecked(){return gC(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase($C)},name(){let t=this.getTranslatedPhrase($C);return gC(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=VG(t)),t},callback(){const t=this.getSelectedRange(),e=gC(t,(n,i)=>this.getCellMeta(n,i).readOnly);U(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const lS="redo";function Yce(){return{key:lS,name(){return this.getTranslatedPhrase(fA)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const rv="remove_col";function Gce(){return{key:rv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(hA,e)},callback(){this.alter("remove_col",rie(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const uS="remove_row";function qce(){return{key:uS,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(cA,e)},callback(){this.alter("remove_row",oie(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const cS="row_above";function Kce(){return{key:cS,name(){return this.getTranslatedPhrase(sA)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const hS="row_below";function Xce(){return{key:hS,name(){return this.getTranslatedPhrase(aA)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ep="no_items";function Zce(){return{key:Ep,name(){return this.getTranslatedPhrase(oA)},disabled:!0,isCommand:!1}}const dS="undo";function Qce(){return{key:dS,name(){return this.getTranslatedPhrase(dA)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Jce=[cS,hS,tv,nv,aS,uS,rv,dS,lS,iv,Co,ht,Ep],ehe={[ht]:Bce,[Ep]:Zce,[cS]:Kce,[hS]:Xce,[tv]:jce,[nv]:Uce,[aS]:Wce,[uS]:qce,[rv]:Gce,[dS]:Qce,[lS]:Yce,[iv]:zce,[Co]:Fce};function $G(){const t={};return ft(ehe,(e,n)=>{t[n]=e()}),t}function the(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(TA):this.getTranslatedPhrase(EA)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nhe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(_A)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ihe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(MA);return gC(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,mC))?VG(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,mC);t.updateCommentMeta(n,i,{[mC]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function rhe(t,e){BG(t,e),e.add(t)}function pd(t,e,n){BG(t,e),e.set(t,n)}function BG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ohe(t,e,n){return(e=she(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function she(t){var e=ahe(t,"string");return typeof e=="symbol"?e:e+""}function ahe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yu(t,e,n){return t.set(yr(t,e),n),n}function lt(t,e){return t.get(yr(t,e))}function yr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JC="comments",lhe=60,qa="comment",$m="value",FG="style",mC="readOnly",lm=JC,pO=`plugin:${JC}`;var jt=new WeakMap,Gs=new WeakMap,fS=new WeakMap,pC=new WeakMap,vO=new WeakMap,eb=new WeakMap,Br=new WeakSet;class uhe extends It{constructor(){super(...arguments),rhe(this,Br),ohe(this,"range",{}),pd(this,jt,null),pd(this,Gs,null),pd(this,fS,!1),pd(this,pC,!1),pd(this,vO,null),pd(this,eb,"")}static get PLUGIN_KEY(){return JC}static get PLUGIN_PRIORITY(){return lhe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[JC]}enablePlugin(){var e=this;this.enabled||(lt(jt,this)||(yu(jt,this,new Uc(this.hot.rootDocument,this.hot.isRtl())),lt(jt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yr(Br,e,vhe).call(e,...i)})),lt(Gs,this)||yu(Gs,this,new kG(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,a,u)=>yr(Br,this,ghe).call(this,n,u)),this.addHook("afterScroll",()=>yr(Br,this,whe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>yr(Br,this,jW).call(this,n)),this.addHook("beforeCompositionStart",n=>yr(Br,this,jW).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yr(Br,e,yhe).call(e,...i)}),lt(Gs,this).addLocalHook("hide",()=>this.hide()),lt(Gs,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){lt(Gs,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(pO);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();yu(pC,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(pO),this.hot._registerTimeout(()=>{yu(pC,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell()},group:lm}),i.addShortcut({keys:[["Escape"]],callback:()=>{lt(jt,this).setValue(lt(eb,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>lt(jt,this).isVisible()&&lt(jt,this).isFocused(),group:lm}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>lt(jt,this).isVisible()&&lt(jt,this).isFocused(),group:lm}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{lt(jt,this).setValue(lt(jt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:lm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lm)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>yr(Br,this,dhe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>yr(Br,this,che).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>yr(Br,this,fhe).call(this)),this.eventManager.addEventListener(n,"focus",()=>yr(Br,this,phe).call(this)),this.eventManager.addEventListener(n,"blur",()=>yr(Br,this,mhe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>yr(Br,this,hhe).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Qc(e.target,"TD","TBODY");return!!(n&&ze(n,"htCommentCell")&&Qc(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=lt(jt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[$m]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,qa),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,$m)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,$m)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return lt(Gs,this).cancelHiding(),lt(jt,this).setValue((e=r[qa]?r[qa][$m]:null)!==null&&e!==void 0?e:""),lt(jt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){lt(jt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!lt(jt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=this.range.from;let a=n.getRenderableFromVisualIndex(r),u=i.getRenderableFromVisualIndex(o);const h=a===null;lt(jt,this).setPosition(0,0),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const d=a===null,g=u===null;a=a??0,u=u??0;const{rootWindow:p,view:{_wt:w}}=this.hot,{wtTable:y}=w,b=w.getCell({row:a,col:u},!0),T=this.getCommentMeta(r,o,FG);T?lt(jt,this).setSize(T.width,T.height):lt(jt,this).resetSize();const M=g?0:y.getColumnWidth(u),I=h&&!d?ni(b):0,{left:_,top:N,width:k,height:$}=b.getBoundingClientRect(),{width:L,height:F}=lt(jt,this).getSize(),{innerWidth:he,innerHeight:le}=this.hot.rootWindow,G=this.hot.rootDocument.documentElement,ye=Si(this.hot.rootDocument),we=pz(this.hot.rootWindow)?ye:0,Me=vz(this.hot.rootWindow)?ye:0;let Ee=_+p.scrollX+M,_e=N+p.scrollY+I;this.hot.isRtl()&&(Ee-=L+M),this.hot.isLtr()&&_+k+L>he-we?Ee=_+p.scrollX-L-1:this.hot.isRtl()&&Ee<-(G.scrollWidth-G.clientWidth)&&(Ee=_+p.scrollX+M+1),N+F>le-Me&&(_e-=F-$+1),lt(jt,this).setPosition(Ee,_e),lt(jt,this).setReadOnlyState(this.getCommentMeta(r,o,mC)),lt(jt,this).observeSize()}focusEditor(){lt(jt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[qa];let o;r?(o=ir(r),Ub(o,i)):o=i,this.hot.setCellMeta(e,n,qa,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[qa])return r[qa][i]}addToContextMenu(e){e.items.push({name:ht},the(this),nhe(this),ihe(this))}getEditorInputElement(){return lt(jt,this).getInputElement()}destroy(){var e,n;(e=lt(jt,this))===null||e===void 0||e.destroy(),(n=lt(Gs,this))===null||n===void 0||n.destroy(),super.destroy()}}function che(t){if(!(!this.hot.view||!this.hot.view._wt)&&!lt(fS,this)&&!this.targetIsCommentTextArea(t)){const e=Qc(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function hhe(t){t.stopPropagation()}function dhe(t){const{rootDocument:e}=this.hot;if(!(lt(fS,this)||lt(jt,this).isFocused()||ze(t.target,"wtBorder")||lt(vO,this)===t.target||!lt(jt,this)))if(yu(vO,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));lt(Gs,this).show(n)}else Kc(t.target,e)&&!this.targetIsCommentTextArea(t)&&lt(Gs,this).hide()}function fhe(){yu(fS,this,!1)}function ghe(t,e){e[qa]&&e[qa][$m]&&pe(t,e.commentedCellClassName)}function mhe(){yu(eb,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function phe(){yu(eb,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(pO)}function vhe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[FG]:{width:t,height:e}})}function jW(t){lt(jt,this).isFocused()&&ps(t)}function whe(){lt(pC,this)||this.hide()}function yhe(){const t=lt(jt,this).getEditorElement();Ue(t,/ht-theme-.*/g),pe(t,this.hot.getCurrentThemeName())}function RM(t,e,n){return(e=Che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Che(t){var e=bhe(t,"string");return typeof e=="symbol"?e:e+""}function bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WG{constructor(e){RM(this,"hot",void 0),RM(this,"commands",{}),RM(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),a=o[0],u=o.length===2?o[1]:null;let h=this.commands[a];if(!h)throw new Error(`Menu command '${a}' not exists.`);if(u&&h.submenu&&(h=She(u,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||ti(h,"submenu"))return;const d=[];typeof h.callback=="function"&&d.push(h.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),i.unshift(o.join(":")),U(d,g=>g.apply(this.hot,i))}}function She(t,e){let n;return U(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function EM(t,e,n){return(e=Rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rhe(t){var e=Ehe(t,"string");return typeof e=="symbol"?e:e+""}function Ehe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;EM(this,"hot",void 0),EM(this,"predefinedItems",$G()),EM(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,ft(e,(i,r)=>{let o="";i.name===ht?(n[ht]=i,o=ht):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return The(e,this.defaultOrderPattern,this.predefinedItems)}}function The(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),dt(r)?ft(r,(o,a)=>{let u=n[typeof o=="string"?o:a];u||(u=o),dt(o)?ii(u,o):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=a),i.push(u)}):U(r,(o,a)=>{let u=n[o];!u&&Jce.indexOf(o)>=0||(u||(u={name:o,key:`${a}`}),dt(o)&&ii(u,o),u.key===void 0&&(u.key=a),i.push(u))}),i}function Kl(t,e,n){return(e=_he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _he(t){var e=Mhe(t,"string");return typeof e=="symbol"?e:e+""}function Mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ohe{constructor(e,n){Kl(this,"top",void 0),Kl(this,"topRelative",void 0),Kl(this,"left",void 0),Kl(this,"leftRelative",void 0),Kl(this,"scrollTop",void 0),Kl(this,"scrollLeft",void 0),Kl(this,"cellHeight",void 0),Kl(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,a,u,h,d,g;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),u=parseInt(e.left,10),d=e.height||0,g=e.width||0,a=o,h=u,o+=i,u+=r):this.type==="event"&&(o=parseInt(e.pageY,10),u=parseInt(e.pageX,10),d=e.target.clientHeight,g=e.target.clientWidth,a=o-i,h=u-r),this.top=o,this.topRelative=a,this.left=u,this.leftRelative=h,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=d,this.cellWidth=g}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function um(t,e,n){xhe(t,e),e.set(t,n)}function xhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(UG(t,e))}function dy(t,e,n){return t.set(UG(t,e),n),n}function UG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gi=new WeakMap,mr=new WeakMap,pr=new WeakMap,TM=new WeakMap,vd=new WeakMap;class Ahe{constructor(e){um(this,Gi,void 0),um(this,mr,void 0),um(this,pr,void 0),um(this,TM,!1),um(this,vd,{above:0,below:0,left:0,right:0}),dy(TM,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return rt(vd,this)[e]=n,this}setElement(e){return dy(Gi,this,e),this}setParentElement(e){return dy(mr,this,e),this}updatePosition(e){dy(pr,this,new Ohe(e,rt(Gi,this).ownerDocument.defaultView)),rt(TM,this)?(rt(pr,this).fitsBelow(rt(Gi,this))?this.setPositionBelowCursor():rt(pr,this).fitsAbove(rt(Gi,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){rt(Gi,this).dir==="rtl"?rt(pr,this).fitsOnLeft(rt(Gi,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():rt(pr,this).fitsOnRight(rt(Gi,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=rt(vd,this).above+rt(pr,this).top-rt(Gi,this).offsetHeight;if(rt(mr,this)){const i=rt(mr,this).ownerDocument.defaultView.getComputedStyle(rt(mr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=rt(pr,this).top+rt(pr,this).cellHeight-rt(Gi,this).scrollHeight+r+o}rt(Gi,this).style.top=`${e}px`}setPositionBelowCursor(){let e=rt(vd,this).below+rt(pr,this).top+1;if(rt(mr,this)){const i=rt(mr,this).ownerDocument.defaultView.getComputedStyle(rt(mr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=rt(pr,this).top-r-o-1}rt(Gi,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=rt(pr,this).left;if(rt(mr,this)){const n=rt(mr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(rt(mr,this).querySelector(".htCore")).borderRightWidth,10);e+=rt(pr,this).cellWidth+i}else e+=rt(vd,this).right;rt(Gi,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=rt(vd,this).left+rt(pr,this).left-rt(Gi,this).offsetWidth;if(rt(mr,this)){const n=rt(mr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(rt(mr,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}rt(Gi,this).style.left=`${e}px`}}function zG(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let a=Et(e,-1,b()-1);function u(M,I){const _=b()-1;return M<0&&(M=_),M>_&&(M=0),o.has(M)?-1:(o.add(M),i(M,!1)===!1&&(M=u(I===1?++M:--M,I)),M)}function h(M){M>-1&&M<b()&&i(M,!0)!==!1&&(a=M)}function d(){return a}function g(){b()>0&&(o.clear(),a=u(0,1))}function p(){b()>0&&(o.clear(),a=u(b()-1,-1))}function w(){b()>0&&(o.clear(),a=u(++a,1))}function y(){b()>0&&(o.clear(),a=u(--a,-1))}function b(){return Math.max(n(),0)}function T(){o.clear(),a=e,r()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:g,toLastItem:p,toNextItem:w,toPreviousItem:y,getSize:b,clear:T}}function Hhe(t){return St(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function wO(t){return ti(t,"submenu")}function yO(t){return new RegExp(ht,"i").test(t.name)}function vC(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function UW(t){return ti(t,"disableSelection")}function Ihe(t){return ze(t,"htSeparator")}function Phe(t){return ze(t,"htSubmenu")}function Nhe(t){return ze(t,"htDisabled")}function Dhe(t){return ze(t,"htSelectionDisabled")}function Lhe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function YG(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function khe(t,e){let n=t.slice(0);return n.reverse(),n=YG(n,e),n.reverse(),n}function Vhe(t){const e=[];return U(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function $he(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht,n=t.slice(0);return n=YG(n,e),n=khe(n,e),n=Vhe(n),n}function Bhe(t){return t.checkable===!0}function Fhe(t){return zG({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||Ihe(i)||Nhe(i)||Dhe(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Whe(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const GG="menu",zW=GG;function jhe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(Whe(t)),e.forEach(d=>{let{shortcuts:g,contextName:p}=d;r(g,p)});function i(d,g){u(g).addShortcuts(d,{group:GG})}function r(d,g){const p=u(g);d.forEach(w=>{let{keys:y}=w;y.forEach(b=>p.removeShortcutsByKeys(b))}),n.push({shortcuts:d,contextName:g}),i(d,g)}function o(){return[...n]}function a(d){return d?`${zW}:${d}`:zW}function u(d){var g;const p=t.hotMenu.getShortcutManager(),w=a(d);return(g=p.getContext(w))!==null&&g!==void 0?g:p.addContext(w)}function h(d){t.hotMenu.getShortcutManager().setActiveContextName(a(d))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:u,listen:h}}function Uhe(t){return(e,n,i,r,o,a)=>{const u=e.getSourceDataAtRow(i),h=t.rootDocument.createElement("div"),d=typeof a=="function"?a.call(t):a,g=typeof u.ariaLabel=="function"?u.ariaLabel.call(t):u.ariaLabel,p=typeof u.ariaChecked=="function"?u.ariaChecked.call(t):u.ariaChecked;if(hl(n),pe(h,"htItemWrapper"),t.getSettings().ariaTags){const w=!vC(u,t)&&!UW(u)&&!yO(u);qe(n,[...Bhe(u)?[GX(),mp(g),lz(p)]:[YX(),mp(d)],...w?[fh(-1)]:[],...vC(u,t)?[eZ()]:[],...wO(u)?[Oo(!1)]:[]])}n.className="",n.appendChild(h),yO(u)?pe(n,"htSeparator"):typeof u.renderer=="function"?(pe(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(e,h,i,r,o,d))):Tf(h,d),vC(u,t)?pe(n,"htDisabled"):UW(u)?pe(n,"htSelectionDisabled"):wO(u)&&pe(n,"htSubmenu")}}function _M(t,e,n){zhe(t,e),e.set(t,n)}function zhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,n){return(e=Yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yhe(t){var e=Ghe(t,"string");return typeof e=="symbol"?e:e+""}function Ghe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MM(t,e,n){return t.set(qG(t,e),n),n}function vc(t,e){return t.get(qG(t,e))}function qG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const YW=215;var cm=new WeakMap,fy=new WeakMap,gy=new WeakMap;class Af{get tableBorderWidth(){return vc(gy,this)===void 0&&this.hotMenu&&MM(gy,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),vc(gy,this)}constructor(e,n){var i=this;Ns(this,"hot",void 0),Ns(this,"options",void 0),Ns(this,"eventManager",new fs(this)),Ns(this,"container",void 0),Ns(this,"positioner",void 0),Ns(this,"hotMenu",null),Ns(this,"hotSubMenus",{}),Ns(this,"parentMenu",void 0),Ns(this,"menuItems",null),Ns(this,"origOutsideClickDeselects",null),_M(this,cm,void 0),_M(this,fy,void 0),_M(this,gy,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:YW,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Ahe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{if(!o){var a;(a=this.hotMenu)===null||a===void 0||a.useTheme(r)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=sf(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return vc(cm,this)}getKeyboardShortcutsCtrl(){return vc(fy,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=jb(u=>this.openSubMenu(u),300),n=this.options.minWidth||YW;let i=!1,r=Zc(this.menuItems,u=>(u.key===Ep&&(i=!0),Lhe(u,this.hot)));if(r.length<1&&!i)r.push($G()[Ep]);else if(r.length===0)return;r=$he(r,ht);let o=!1;const a={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return Ne(u)&&u<n?n:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Uhe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(u,h)=>{vc(cm,this).setCurrentPage(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},afterOnCellContextMenu:u=>{u.preventDefault(),uB()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,d,g,p)=>{this.hotMenu.view.isMouseDown()&&(p.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!uB()||!eh(u))&&o&&this.hasSelectedItem()&&(nl()||_z()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),MM(cm,this,Fhe(this.hotMenu)),MM(fy,this,jhe(this)),vc(fy,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(vc(cm,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);qe(i,[Oo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Phe(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Af(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&qe(n,[Oo(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&qe(r,[Oo(!1)])}}closeAllSubMenus(){U(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?Hhe(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||yO(e)||vC(e,this.hot)||wO(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=n.hider.style,o=n.holder.style,a=parseInt(r.width,10),u=xr(i,(h,d,g)=>{const w=this.hotMenu.getCell(g,0)?ni(this.hotMenu.getCell(g,0)):0;return h+(d.name===ht?1:w)},0);e.isClassicTheme()?(o.width=`${a+3}px`,o.height=`${u+3}px`):(o.width=`${a}px`,o.height=`${u}px`),r.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(Ut(i)&&(i=i.call(this.hot),i===null||wn(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),pe(r,`htMenu handsontable ${this.options.className}`),i&&pe(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&qe(this.hotMenu.rootElement,[zX(),fh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Kc(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Kc(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ze(e.target,"htCore")&&Kc(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Xt(Af,Ai);function qhe(t,e){Khe(t,e),e.add(t)}function Khe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OM(t,e,n){return(e=Xhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xhe(t){var e=Zhe(t,"string");return typeof e=="symbol"?e:e+""}function Zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function my(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bm="contextMenu",Qhe=70,GW=Bm;xe.getSingleton().register("afterContextMenuDefaultOptions");xe.getSingleton().register("beforeContextMenuShow");xe.getSingleton().register("afterContextMenuShow");xe.getSingleton().register("afterContextMenuHide");xe.getSingleton().register("afterContextMenuExecute");var hm=new WeakSet;class gS extends It{constructor(){super(...arguments),qhe(this,hm),OM(this,"commandExecutor",new WG(this.hot)),OM(this,"itemsFactory",null),OM(this,"menu",null)}static get PLUGIN_KEY(){return Bm}static get PLUGIN_PRIORITY(){return Qhe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[cS,hS,ht,tv,nv,ht,uS,rv,ht,dS,lS,ht,iv,ht,Co]}isEnabled(){return!!this.hot.getSettings()[Bm]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Bm];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Af(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>my(hm,this,ede).call(this)),this.menu.addLocalHook("afterOpen",()=>my(hm,this,tde).call(this)),this.menu.addLocalHook("afterClose",()=>my(hm,this,nde).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>my(hm,this,Jhe).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=sS(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:GW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(GW)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;ft(i,(o,a)=>{const u=["below","right"].includes(a)?o+1:o-1;this.menu.setOffset(a,r?o:u)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new jG(this.hot,gS.DEFAULT_ITEMS);const e=this.hot.getSettings()[Bm],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),U(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Jhe(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ze(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(ze(o,"current")&&ze(o,"wtBorder"))))return;const a=sS(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function ede(){this.hot.runHooks("beforeContextMenuShow",this)}function tde(){this.hot.runHooks("afterContextMenuShow",this)}function nde(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}gS.SEPARATOR={name:ht};function ide(t){return{key:"copy",name(){return this.getTranslatedPhrase(mA)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function rde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Et(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(wA,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ode(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Et(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vA,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function sde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Et(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(pA,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ade(t){return{key:"cut",name(){return this.getTranslatedPhrase(yA)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class lde{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class ude{constructor(){this.clipboardData=new lde}preventDefault(){}composedPath(){return[]}}function cde(t,e){KG(t,e),e.add(t)}function wd(t,e,n){KG(t,e),e.set(t,n)}function KG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xi(t,e){return t.get(qd(t,e))}function yd(t,e,n){return t.set(qd(t,e),n),n}function qd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xl=new WeakMap,xM=new WeakMap,dm=new WeakMap,CO=new WeakMap,bO=new WeakMap,fm=new WeakMap,gm=new WeakSet;class hde{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:a}=e;cde(this,gm),wd(this,Xl,void 0),wd(this,xM,void 0),wd(this,dm,void 0),wd(this,CO,void 0),wd(this,bO,void 0),wd(this,fm,void 0),yd(xM,this,n),yd(dm,this,i),yd(CO,this,r),yd(bO,this,o),yd(fm,this,a)}setSelectedRange(e){yd(Xl,this,e)}getCellsRange(){if(Xi(xM,this).call(this)===0||Xi(dm,this).call(this)===0)return null;const{row:e,col:n}=Xi(Xl,this).getTopStartCorner(),{row:i,col:r}=Xi(Xl,this).getBottomEndCorner(),o=qd(gm,this,dde).call(this,e,i),a=qd(gm,this,AM).call(this,n,r);return{isRangeTrimmed:i!==o||r!==a,startRow:e,startCol:n,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(Xi(dm,this).call(this)===0||Xi(fm,this).call(this)===0)return null;const{col:e}=Xi(Xl,this).getTopStartCorner(),{col:n}=Xi(Xl,this).getBottomEndCorner(),i=qd(gm,this,AM).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Xi(dm,this).call(this)===0||Xi(fm,this).call(this)===0)return null;const{col:e}=Xi(Xl,this).getTopStartCorner(),{col:n}=Xi(Xl,this).getBottomEndCorner(),i=qd(gm,this,AM).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-Xi(fm,this).call(this),startCol:e,endRow:-1,endCol:i}}}function AM(t,e){return Math.min(e,Math.max(t+Xi(bO,this).call(this)-1,t))}function dde(t,e){return Math.min(e,Math.max(t+Xi(CO,this).call(this)-1,t))}function XG(t){const e=[],n=[];return U(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);Ve(r,o,h=>{e.indexOf(h)===-1&&e.push(h)});const a=Math.min(i.startCol,i.endCol),u=Math.max(i.startCol,i.endCol);Ve(a,u,h=>{n.indexOf(h)===-1&&n.push(h)})}),{rows:e,columns:n}}function fde(t,e){ZG(t,e),e.add(t)}function Zl(t,e,n){ZG(t,e),e.set(t,n)}function ZG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mm(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e){return t.get(Tr(t,e))}function Zo(t,e,n){return t.set(Tr(t,e),n),n}function Tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("afterCopyLimit");xe.getSingleton().register("modifyCopyableRange");xe.getSingleton().register("beforeCut");xe.getSingleton().register("afterCut");xe.getSingleton().register("beforePaste");xe.getSingleton().register("afterPaste");xe.getSingleton().register("beforeCopy");xe.getSingleton().register("afterCopy");const HM="copyPaste",pde=80,vde=["fragmentSelection"],qW=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var SO=new WeakMap,RO=new WeakMap,EO=new WeakMap,Cd=new WeakMap,py=new WeakMap,vy=new WeakMap,bd=new WeakMap,tb=new WeakMap,qr=new WeakSet;class wde extends It{constructor(){super(...arguments),fde(this,qr),mm(this,"columnsLimit",1/0),mm(this,"rowsLimit",1/0),mm(this,"pasteMode","overwrite"),mm(this,"uiContainer",this.hot.rootDocument.body),Zl(this,SO,!1),Zl(this,RO,!1),Zl(this,EO,!1),Zl(this,Cd,"cells-only"),Zl(this,py,!1),Zl(this,vy,!1),Zl(this,bd,new hde({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Zl(this,tb,!1),mm(this,"copyableRanges",[])}static get PLUGIN_KEY(){return HM}static get SETTING_KEYS(){return[HM,...vde]}static get PLUGIN_PRIORITY(){return pde}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[HM]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Zo(SO,this,this.getSetting("copyColumnHeaders")),Zo(RO,this,this.getSetting("copyColumnGroupHeaders")),Zo(EO,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>Tr(qr,this,bde).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Tr(qr,i,Sde).call(i,...o)}),this.addHook("afterSelectionEnd",()=>Tr(qr,this,Rde).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),kC()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Tr(qr,i,Ede).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Tr(qr,i,Tde).call(i,...o)}),this.addHook("afterSelection",()=>Tr(qr,this,_de).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Zo(Cd,this,e),Zo(py,this,!0),Tr(qr,this,KW).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Zo(vy,this,!0),Tr(qr,this,KW).call(this,"cut")}getRangedCopyableData(e){return qm(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=XG(e);return U(i,o=>{const a=[];U(r,u=>{o<0?a.push(this.hot.getColHeader(u,o)):a.push(this.hot.getCopyableData(o,u))}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new ude;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Rr(bd,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Rr(Cd,this)==="column-headers-only"?n.set("headers",Rr(bd,this).getMostBottomColumnHeadersRange()):(Rr(Cd,this)==="with-column-headers"?n.set("headers",Rr(bd,this).getMostBottomColumnHeadersRange()):Rr(Cd,this)==="with-column-group-headers"&&n.set("headers",Rr(bd,this).getAllColumnHeadersRange()),n.set("cells",Rr(bd,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:a,endRow:u,endCol:h}=r;return{startRow:o,startCol:a,endRow:u,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:a,endCol:u}=i;this.hot.runHooks("afterCopyLimit",a-r+1,u-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,o=[],{row:a,col:u}=n.getTopStartCorner(),{row:h,col:d}=n.getBottomEndCorner();let g=a,p=u,w=a,y=u;for(;o.length<i||g<=h;){const{skipRowOnPaste:b,visualRow:T}=this.hot.getCellMeta(g,u);if(g=T+1,b===!0)continue;w=T,p=u;const M=[],I=o.length%i;for(;M.length<r||p<=d;){const{skipColumnOnPaste:_,visualCol:N}=this.hot.getCellMeta(a,p);if(p=N+1,_===!0)continue;y=N;const k=M.length%r;M.push(e[I][k])}o.push(M)}return Zo(tb,this,!0),this.hot.populateFromArray(a,u,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,u,w,y]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Rr(py,this)||this.isEditorOpened()||ul(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!lC(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zo(py,this,!1);const o=this.getRangedData(this.copyableRanges),a=Tr(qr,this,yde).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)){const h=qm(o);if(e&&e.clipboardData){const d=kB(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[qW,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",o,this.copyableRanges,a)}Zo(Cd,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Rr(vy,this)||this.isEditorOpened()||ul(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!lC(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zo(vy,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const u=qm(o);if(e&&e.clipboardData){const h=kB(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[qW,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||ul(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!lC(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const g=Rx(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});g&&/(<table)|(<TABLE)/g.test(g)?o=SQ(g,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=cie(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,u,h,d]=this.populateValues(o);this.hot.selectCell(a,u,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function KW(t){if(kC()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&bZ(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function yde(t){const{rows:e}=XG(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Cde(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&Cz(i)}}}function QG(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&bz(i)}}}function bde(t){t.items.push({name:"---------"},ide(this)),Rr(SO,this)&&t.items.push(sde(this)),Rr(RO,this)&&t.items.push(ode(this)),Rr(EO,this)&&t.items.push(rde(this)),t.items.push(ade(this))}function Sde(t,e,n,i,r){Rr(tb,this)&&(r.value=!0),Zo(tb,this,!1)}function Rde(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Ede(){Tr(qr,this,QG).call(this)}function Tde(){Tr(qr,this,Cde).call(this)}function _de(){Tr(qr,this,QG).call(this)}function JG(t,e){return`border_row${t}col${e}`}function Fm(){return{width:1,color:"#000"}}function il(){return{hide:!0}}function Mde(){return{width:1,color:"#000",cornerVisible:!1}}function IM(t){if(Ne(t.start)||Ne(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ne(t.end)||Ne(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function pm(t){return Ne(t.start)&&(t.left=t.start),Ne(t.end)&&(t.right=t.end),t}function PM(t,e){return{id:JG(t,e),border:Mde(),row:t,col:e,top:il(),bottom:il(),start:il(),end:il()}}function Ode(t,e){return ti(e,"border")&&e.border&&(t.border=e.border),ti(e,"top")&&Ne(e.top)&&(e.top?(dt(e.top)||(e.top=Fm()),t.top=e.top):(e.top=il(),t.top=e.top)),ti(e,"bottom")&&Ne(e.bottom)&&(e.bottom?(dt(e.bottom)||(e.bottom=Fm()),t.bottom=e.bottom):(e.bottom=il(),t.bottom=e.bottom)),ti(e,"start")&&Ne(e.start)&&(e.start?(dt(e.start)||(e.start=Fm()),t.start=e.start):(e.start=il(),t.start=e.start)),ti(e,"end")&&Ne(e.end)&&(e.end?(dt(e.end)||(e.end=Fm()),t.end=e.end):(e.end=il(),t.end=e.end)),t}function fl(t,e){let n=!1;return U(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const a=t.getCellMeta(r,o).borders;if(a)if(e){if(!ti(a[e],"hide")||a[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function mS(t){return`<span class="selected">✓</span>${t}`}function xde(t){return t.some(e=>Ne(e.left)||Ne(e.right))}function Ade(t){return t.some(e=>Ne(e.start)||Ne(e.end))}const Hde=new Map([["left","start"],["right","end"]]);function Ide(t){var e;return(e=Hde.get(t))!==null&&e!==void 0?e:t}function Pde(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase($A);return fl(this,"bottom")&&(e=mS(e)),e},callback(e,n){const i=fl(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Nde(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(BA);return fl(this,e)&&(n=mS(n)),n},callback(n,i){const r=fl(this,e);t.prepareBorder(i,e,r)}}}function Dde(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(FA)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!fl(this)}}}function Lde(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(VA);return fl(this,e)&&(n=mS(n)),n},callback(n,i){const r=fl(this,e);t.prepareBorder(i,e,r)}}}function kde(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(kA);return fl(this,"top")&&(e=mS(e)),e},callback(e,n){const i=fl(this,"top");t.prepareBorder(n,"top",i)}}}function Vde(t,e){$de(t,e),e.add(t)}function $de(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bde(t,e,n){return(e=Fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fde(t){var e=Wde(t,"string");return typeof e=="symbol"?e:e+""}function Wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wC="customBorders",jde=90;var NM=new WeakSet;class Ude extends It{constructor(){super(...arguments),Vde(this,NM),Bde(this,"savedBorders",[])}static get PLUGIN_KEY(){return wC}static get PLUGIN_PRIORITY(){return jde}isEnabled(){return!!this.hot.getSettings()[wC]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>XW(NM,this,zde).call(this,e)),this.addHook("init",()=>XW(NM,this,Yde).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=IM(n));const o=uf(e),a=Cp(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});U(e,u=>{a(u).forAll((h,d)=>{U(i,g=>{this.prepareBorderFromCustomAdded(h,d,r,Ide(g))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=uf(e),i=Cp(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return U(e,o=>{i(o).forAll((a,u)=>{U(this.savedBorders,h=>{h.row===a&&h.col===u&&r.push(pm(h))})})}),r}clearBorders(e){e?this.setBorders(e):(U(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||n>=a)return;let u=PM(e,n);i&&(u=Ode(u,i),U(this.hot.selection.highlight.customSelections,h=>{if(u.id===h.settings.id)return Object.assign(h.settings,i),u.id=h.settings.id,u.top=h.settings.top,u.bottom=h.settings.bottom,u.start=h.settings.start,u.end=h.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",pm(u)),this.insertBorderIntoSettings(u,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);Ve(e.from.row,i,o=>{Ve(e.from.col,r,a=>{const u=PM(o,a);let h=0;o===e.from.row&&ti(n,"top")&&(h+=1,u.top=n.top),o===e.to.row&&ti(n,"bottom")&&(h+=1,u.bottom=n.bottom),a===e.from.col&&ti(n,"start")&&(h+=1,u.start=n.start),a===e.to.col&&ti(n,"end")&&(h+=1,u.end=n.end),h>0&&(this.hot.setCellMeta(o,a,"borders",pm(u)),this.insertBorderIntoSettings(u))})})}removeAllBorders(e,n){const i=JG(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=PM(e,n):o=IM(o),r?(o[i]=il(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",pm(o)))):(o[i]=Fm(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",pm(o)))}prepareBorder(e,n,i){U(e,r=>{let{start:o,end:a}=r;if(o.row===a.row&&o.col===a.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":Ve(o.col,a.col,u=>{Ve(o.row,a.row,h=>{this.removeAllBorders(h,u)})});break;case"top":Ve(o.col,a.col,u=>{this.setBorder(o.row,u,n,i)});break;case"bottom":Ve(o.col,a.col,u=>{this.setBorder(a.row,u,n,i)});break;case"start":Ve(o.row,a.row,u=>{this.setBorder(u,o.col,n,i)});break;case"end":Ve(o.row,a.row,u=>{this.setBorder(u,a.col,n,i)});break}})}createCustomBorders(e){U(e,n=>{const i=IM(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return xr([n,i,r,o],(u,h)=>{let d=u;return h&&h.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){const n=St(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){U(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){U(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=St(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):U(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return U(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return U(a,u=>{u.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):U(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=n,a.commit(),i){const u=this.hot.view._wt.selectionManager.getBorderInstances(a);U(u,h=>{h.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[wC];if(Array.isArray(e)){const n=ir(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=xde(e),i=Ade(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function zde(t){this.hot.getSettings()[wC]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(LA)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[kde(this),Lde(this),Pde(this),Nde(this),Dde(this)]}})}function Yde(){this.changeBorderSettings()}function Gde(t,e){qde(t,e),e.add(t)}function qde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DM(t,e,n){return(e=Kde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kde(t){var e=Xde(t,"string");return typeof e=="symbol"?e:e+""}function Xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const QW="dragToScroll",Zde=100;var LM=new WeakSet;class Qde extends It{constructor(){super(...arguments),Gde(this,LM),DM(this,"boundaries",null),DM(this,"callback",null),DM(this,"listening",!1)}static get PLUGIN_KEY(){return QW}static get PLUGIN_PRIORITY(){return Zde}isEnabled(){return!!this.hot.getSettings()[QW]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>ZW(LM,this,JW).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>ZW(LM,this,JW).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=sf(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function JW(t){if(eh(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const a=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,u=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(a+Math.sign(n)*50,u+Math.sign(i)*20)}),this.listen()}function Jde(t,e){e3(t,e),e.add(t)}function efe(t,e,n){e3(t,e),e.set(t,n)}function e3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kM(t,e,n){return(e=tfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tfe(t){var e=nfe(t,"string");return typeof e=="symbol"?e:e+""}function nfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ife(t,e){return t.get(bo(t,e))}function t3(t,e,n){return t.set(bo(t,e),n),n}function bo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("afterDropdownMenuDefaultOptions");xe.getSingleton().register("beforeDropdownMenuShow");xe.getSingleton().register("afterDropdownMenuShow");xe.getSingleton().register("afterDropdownMenuHide");xe.getSingleton().register("afterDropdownMenuExecute");const yC="dropdownMenu",rfe=230,Tp="changeType",VM=yC;var pS=new WeakMap,es=new WeakSet;class vS extends It{static get PLUGIN_KEY(){return yC}static get PLUGIN_PRIORITY(){return rfe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[tv,nv,ht,rv,ht,aS,ht,iv,ht,Co]}constructor(e){super(e),Jde(this,es),kM(this,"commandExecutor",new WG(this.hot)),kM(this,"itemsFactory",null),kM(this,"menu",null),efe(this,pS,!1),this.hot.addHook("afterGetColHeader",(n,i)=>bo(es,this,sfe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[yC]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new jG(this.hot,vS.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return bo(es,e,dfe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return bo(es,e,hfe).call(e,...o)});const n=this.hot.getSettings()[yC],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Af(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>bo(es,this,afe).call(this)),this.menu.addLocalHook("afterOpen",()=>bo(es,this,lfe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>bo(es,this,ufe).call(this,o)),this.menu.addLocalHook("afterClose",()=>bo(es,this,cfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return e.executeCommand.call(e,...a)}),U(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),o=sS(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,r.col,!0).querySelector(`.${Tp}`),u=a.getBoundingClientRect();this.open({left:u.left+o.left,top:u.top+a.offsetHeight+o.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:VM},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:VM}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VM)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>bo(es,this,ofe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),ft(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function n3(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function ofe(t){if(ze(t.target,Tp)){const e=sS(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),t3(pS,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function sfe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${Tp}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=Tp,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(qe(a,[gh(),mp(" ")]),qe(e,[oz("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function afe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function lfe(){this.hot.runHooks("afterDropdownMenuShow",this),bo(es,this,n3).call(this,this.menu)}function ufe(t){bo(es,this,n3).call(this,t)}function cfe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function hfe(t){return ife(pS,this)?null:t}function dfe(t){ze(t.target,Tp)&&t3(pS,this,!0)}vS.SEPARATOR={name:ht};function ej(t,e,n){return(e=ffe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ffe(t){var e=gfe(t,"string");return typeof e=="symbol"?e:e+""}function gfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mfe{constructor(e){ej(this,"hot",void 0),ej(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,a=[];return Ve(e,i,u=>{const h=[];!o.exportHiddenRows&&this._isHiddenRow(u)||(Ve(n,r,d=>{!o.exportHiddenColumns&&this._isHiddenColumn(d)||h.push(this.hot.getDataAtCell(u,d))}),a.push(h))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();Ve(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();Ve(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,a=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),a=Math.min(a,e),{startRow:i,startCol:r,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function tj(t,e,n){return(e=pfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pfe(t){var e=vfe(t,"string");return typeof e=="symbol"?e:e+""}function vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JH{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){tj(this,"dataProvider",void 0),tj(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ra(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=ii(ra(JH.DEFAULT_OPTIONS),n),n=ii(n,e),n.filename=nz(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function wfe(t,e){yfe(t,e),e.add(t)}function yfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nj(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const i3="\r",Cfe='"',bfe=`
`,Sfe="=",Rfe="+",Efe="-",Tfe="@",_fe="	";var $M=new WeakSet;class Mfe extends JH{constructor(){super(...arguments),wfe(this,$M)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let u=e.bom?"\uFEFF":"";return r&&(i=St(i,h=>this._escapeCell(h,{force:!0,sanitizeValue:e.sanitizeValues})),a&&(u+=e.columnDelimiter),u+=i.join(e.columnDelimiter),u+=e.rowDelimiter),U(n,(h,d)=>{d>0&&(u+=e.rowDelimiter),a&&(u+=this._escapeCell(o[d],{sanitizeValue:e.sanitizeValues}),u+=e.columnDelimiter);const g=h.map(p=>this._escapeCell(p,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);u+=g}),u}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=yn(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=nj($M,this,xfe).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=nj($M,this,Ofe).call(this,r)),(n||r.indexOf(i3)>=0||r.indexOf(Cfe)>=0||r.indexOf(bfe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function Ofe(t){return t.startsWith(Sfe)||t.startsWith(Rfe)||t.startsWith(Efe)||t.startsWith(Tfe)||t.startsWith(_fe)||t.startsWith(i3)?`'${t}`:t}function xfe(t,e){return e.test(t)?`'${t}`:t}const Afe="csv",TO={[Afe]:Mfe};function Hfe(t,e,n){return typeof TO[t]=="function"?new TO[t](e,n):null}const Ife="exportFile",Pfe=240;class Nfe extends It{static get PLUGIN_KEY(){return Ife}static get PLUGIN_PRIORITY(){return Pfe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),a=this._createBlob(o),u=r.URL||r.webkitURL,h=i.createElement("a"),d=`${o.options.filename}.${o.options.fileExtension}`;if(h.download!==void 0){const g=u.createObjectURL(a);h.style.display="none",h.setAttribute("href",g),h.setAttribute("download",d),i.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),i.body.removeChild(h),setTimeout(()=>{u.revokeObjectURL(g)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,d)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!TO[e])throw new Error(`Export format type "${e}" is not supported.`);return Hfe(e,new mfe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Sd(t,e,n){return(e=Dfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dfe(t){var e=Lfe(t,"string");return typeof e=="symbol"?e:e+""}function Lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ov{constructor(e,n){let{id:i,stateless:r=!0}=n;Sd(this,"hot",void 0),Sd(this,"id",void 0),Sd(this,"elements",[]),Sd(this,"hidden",!1),Sd(this,"stateId",""),Sd(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Xb)}getElements(){return this.elements}reset(){U(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),U(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Xt(ov,Ai);const _p={};function _u(t,e){if(!_p[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=_p[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function zc(t){if(!_p[t])throw Error(`Filter condition "${t}" does not exist.`);return _p[t].descriptor}function Gn(t,e,n){n.key=t,_p[t]={condition:e,descriptor:n}}const bi="none";function kfe(){return!0}Gn(bi,kfe,{name:Zb,inputsCount:0,showOperators:!1});const Zm="empty";function Vfe(t){return Vn(t.value)}Gn(Zm,Vfe,{name:qA,inputsCount:0,showOperators:!0});const CC="not_empty";function $fe(t,e){return!_u(Zm,e)(t)}Gn(CC,$fe,{name:KA,inputsCount:0,showOperators:!0});const Qm="eq";function Bfe(t,e){let[n]=e;return yn(t.value).toLocaleLowerCase(t.meta.locale)===yn(n)}Gn(Qm,Bfe,{name:XA,inputsCount:1,showOperators:!0});const bC="neq";function Ffe(t,e){return!_u(Qm,e)(t)}Gn(bC,Ffe,{name:ZA,inputsCount:1,showOperators:!0});const r3="gt";function Wfe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Gn(r3,Wfe,{name:nH,inputsCount:1,showOperators:!0});const o3="gte";function jfe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Gn(o3,jfe,{name:iH,inputsCount:1,showOperators:!0});const s3="lt";function Ufe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Gn(s3,Ufe,{name:rH,inputsCount:1,showOperators:!0});const a3="lte";function zfe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Gn(a3,zfe,{name:oH,inputsCount:1,showOperators:!0});const eI="date_after";function Yfe(t,e){let[n]=e;const i=Ce(t.value,t.meta.dateFormat),r=Ce(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}Gn(eI,Yfe,{name:lH,inputsCount:1,showOperators:!0});const tI="date_before";function Gfe(t,e){let[n]=e;const i=Ce(t.value,t.meta.dateFormat),r=Ce(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}Gn(tI,Gfe,{name:uH,inputsCount:1,showOperators:!0});const nb="between";function qfe(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const a=parseFloat(r,10),u=parseFloat(o,10);r=Math.min(a,u),o=Math.max(a,u)}else if(t.meta.type==="date"){const a=_u(tI,[o]),u=_u(eI,[r]);return a(t)&&u(t)}return t.value>=r&&t.value<=o}Gn(nb,qfe,{name:sH,inputsCount:2,showOperators:!0});const l3="not_between";function Kfe(t,e){return!_u(nb,e)(t)}Gn(l3,Kfe,{name:aH,inputsCount:2,showOperators:!0});const u3="begins_with";function Xfe(t,e){let[n]=e;return yn(t.value).toLocaleLowerCase(t.meta.locale).startsWith(yn(n))}Gn(u3,Xfe,{name:QA,inputsCount:1,showOperators:!0});const c3="ends_with";function Zfe(t,e){let[n]=e;return yn(t.value).toLocaleLowerCase(t.meta.locale).endsWith(yn(n))}Gn(c3,Zfe,{name:JA,inputsCount:1,showOperators:!0});const nI="contains";function Qfe(t,e){let[n]=e;return yn(t.value).toLocaleLowerCase(t.meta.locale).indexOf(yn(n))>=0}Gn(nI,Qfe,{name:eH,inputsCount:1,showOperators:!0});const h3="not_contains";function Jfe(t,e){return!_u(nI,e)(t)}Gn(h3,Jfe,{name:tH,inputsCount:1,showOperators:!0});const d3="date_tomorrow";function ege(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(-1,"days").startOf("day"),"d"):!1}Gn(d3,ege,{name:hH,inputsCount:0});const f3="date_today";function tge(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().startOf("day"),"d"):!1}Gn(f3,tge,{name:cH,inputsCount:0});const g3="date_yesterday";function nge(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(1,"days").startOf("day"),"d"):!1}Gn(g3,nge,{name:dH,inputsCount:0});OZ();function ige(t,e){let n=t;return n===""&&(n=`(${e})`),n}function sv(t){const e=new Set(t);return function(n){return e.has(n)}}function iI(t){return t??""}function _O(t){return Array.from(new Set(t)).map(e=>iI(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function ij(t,e,n,i){const r=[],o=t===e;let a;return o||(a=sv(e)),t.forEach(u=>{let h=!1;(o||a(u))&&(h=!0);const d={checked:h,value:u,visualValue:ige(u,n)};i&&i(d),r.push(d)}),r}const Yc="by_value";function rge(t,e){let[n]=e;return n(t.value)}Gn(Yc,rge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[sv(e)]},showOperators:!1});const Mp={};function oge(t){if(!Mp[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Mp[t].func;return function(n,i){return e(n,i)}}function sge(t){return Mp[t].name}function rI(t,e,n){Mp[t]={name:e,func:n}}const Eu="conjunction",age=mH;function lge(t,e){return t.every(n=>n.func(e))}rI(Eu,age,lge);const ib="disjunction",uge=Qb;function cge(t,e){return t.some(n=>n.func(e))}rI(ib,uge,cge);const oI="disjunctionWithExtraCondition",hge=Qb;function dge(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}rI(oI,hge,dge);const fge="numeric",m3="text",gge="date",rj={[fge]:[bi,ht,Zm,CC,ht,Qm,bC,ht,r3,o3,s3,a3,nb,l3],[m3]:[bi,ht,Zm,CC,ht,Qm,bC,ht,u3,c3,ht,nI,h3],[gge]:[bi,ht,Zm,CC,ht,Qm,bC,ht,tI,eI,nb,ht,d3,f3,g3]};function mge(t){const e=[];let n=t;return rj[n]||(n=m3),U(rj[n],i=>{let r;i===ht?r={name:ht}:r=ra(zc(i)),e.push(r)}),e}function vm(t,e,n){return(e=pge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pge(t){var e=vge(t,"string");return typeof e=="symbol"?e:e+""}function vge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BM="built",FM="building",oj=["click","input","keydown","keypress","keyup","focus","blur","change"];let us=class p3{static get DEFAULTS(){return ra({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){vm(this,"hot",void 0),vm(this,"eventManager",new fs(this)),vm(this,"options",void 0),vm(this,"_element",void 0),vm(this,"buildState",void 0),this.hot=e,this.options=ii(p3.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===FM?this._element:this.buildState===BM?(this.update(),this._element):(this.buildState=FM,this.build(),this.buildState=BM,this._element)}isBuilt(){return this.buildState===BM}translateIfPossible(e){return typeof e=="string"&&e.startsWith(rr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=FM),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&pe(this._element,this.options.className),this.options.children.length)U(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),ft(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),U(oj,i=>e(n,i))}else U(oj,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Xt(us,Ai);function wge(t,e){v3(t,e),e.add(t)}function yge(t,e,n){v3(t,e),e.set(t,n)}function v3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wy(t,e){return t.get(sI(t,e))}function Cge(t,e,n){return t.set(sI(t,e),n),n}function sI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rd=new WeakMap,sj=new WeakSet;class Tu extends us{static get DEFAULTS(){return ra({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,ii(Tu.DEFAULTS,n)),wge(this,sj),yge(this,Rd,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>sI(sj,this,bge).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Cge(Rd,this,this._element.firstChild),pe(this._element,"htUIInput"),pe(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wy(Rd,this).type=this.options.type,wy(Rd,this).placeholder=this.translateIfPossible(this.options.placeholder),wy(Rd,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&wy(Rd,this).focus()}}function bge(t){this.options.value=t.target.value}function Sge(t,e){w3(t,e),e.add(t)}function wm(t,e,n){w3(t,e),e.set(t,n)}function w3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ed(t,e,n){return t.set(Jm(t,e),n),n}function bn(t,e){return t.get(Jm(t,e))}function Jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var di=new WeakMap,yy=new WeakMap,Cy=new WeakMap,WM=new WeakMap,by=new WeakMap,Sy=new WeakSet;class Op extends us{static get DEFAULTS(){return ra({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,ii(Op.DEFAULTS,n)),Sge(this,Sy),wm(this,di,null),wm(this,yy,[]),wm(this,Cy,void 0),wm(this,WM,void 0),wm(this,by,void 0),this.registerHooks()}getMenu(){return bn(di,this)}registerHooks(){this.addLocalHook("click",()=>Jm(Sy,this,Tge).call(this))}setItems(e){Ed(yy,this,this.translateNames(e)),bn(di,this)&&bn(di,this).setMenuItems(bn(yy,this))}translateNames(e){return U(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Ed(di,this,new Af(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),bn(di,this).setMenuItems(bn(yy,this));const e=new us(this.hot,{className:"htUISelectCaption"}),n=new us(this.hot,{className:"htUISelectDropdown"});Ed(Cy,this,e),Ed(WM,this,e.element),Ed(by,this,n),this.hot.getSettings().ariaTags&&(qe(n.element,[gh()]),qe(this._element,[rz()])),U([e,n],i=>this._element.appendChild(i.element)),bn(di,this).addLocalHook("select",i=>Jm(Sy,this,Rge).call(this,i)),bn(di,this).addLocalHook("afterClose",()=>Jm(Sy,this,Ege).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=bn(di,this).hot.getTranslatedPhrase(Zb),bn(WM,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();bn(di,this)&&(bn(di,this).open(),bn(di,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),bn(di,this).getNavigator().toFirstItem(),bn(di,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){bn(di,this)&&bn(di,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){bn(di,this)&&(bn(di,this).destroy(),Ed(di,this,null)),bn(Cy,this)&&bn(Cy,this).destroy(),bn(by,this)&&bn(by,this).destroy(),super.destroy()}}function Rge(t){t.name!==ht&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Ege(){this.runLocalHooks("afterClose")}function Tge(){this.openOptions()}function _ge(t,e){Mge(t,e),e.add(t)}function Mge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aj(t,e,n){return(e=Oge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oge(t){var e=xge(t,"string");return typeof e=="symbol"?e:e+""}function xge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lj(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jM=new WeakSet;class MO extends ov{constructor(e,n){super(e,{id:n.id,stateless:!1}),_ge(this,jM),aj(this,"name",""),aj(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Op(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Tu(this.hot,{placeholder:bH})),this.elements.push(new Tu(this.hot,{placeholder:SH})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>lj(jM,this,Age).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),U(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>lj(jM,this,Hge).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ra(e.command);n.name.startsWith(xn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),U(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||zc(bi),n=[];return U(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=zc(e?e.name:bi);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||U(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Op)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Tu)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,a)=>{pe(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&pe(n.parentNode,"border");const u=this.hot.rootDocument.createElement("div");return pe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||U(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[zc(bi)];if(e!==null){const{visualIndex:i}=e;n=mge(this.hot.getDataType(0,i,this.hot.countRows(),i))}U(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Age(t){U(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Hge(t){Yp(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ps(t))}function uj(t,e,n){Ige(t,e),e.set(t,n)}function Ige(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ym(t,e){return t.get(y3(t,e))}function cj(t,e,n){return t.set(y3(t,e),n),n}function y3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Td=new WeakMap,UM=new WeakMap;class rb extends us{static get DEFAULTS(){return ra({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,ii(rb.DEFAULTS,n)),uj(this,Td,void 0),uj(this,UM,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),cj(UM,this,e),cj(Td,this,this._element.firstChild),ym(Td,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ym(UM,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ym(Td,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ym(Td,this).checked=e)}focus(){this.isBuilt()&&ym(Td,this).focus()}}function Pge(t,e){Nge(t,e),e.add(t)}function Nge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dge(t,e,n){return(e=Lge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lge(t){var e=kge(t,"string");return typeof e=="symbol"?e:e+""}function kge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vge(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hj=0;var dj=new WeakSet;class $ge extends ov{constructor(e,n){super(e,{id:n.id,stateless:!1}),Pge(this,dj),Dge(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(pe(n.parentNode,"htFiltersMenuOperators"),U(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[Eu,ib];U(e,n=>{const i=new rb(this.hot,{name:"operator",label:{htmlFor:n,textContent:sge(n)},value:n,checked:n===e[hj],id:n});i.addLocalHook("change",r=>Vge(dj,this,Bge).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error($t`Radio button with index ${e} doesn't exist.`);U(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof rb&&n.isChecked());return e?e.getValue():Eu}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&U(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Eu,n=arguments.length>1?arguments[1]:void 0,i=e;i===oI&&(i=ib),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(hj)}}function Bge(t){this.setState(t.target.value)}function Fge(t,e,n){Wge(t,e),e.set(t,n)}function Wge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zM(t,e){return t.get(C3(t,e))}function jge(t,e,n){return t.set(C3(t,e),n),n}function C3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cm=new WeakMap;class xp extends us{static get DEFAULTS(){return ra({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,ii(xp.DEFAULTS,n)),Fge(this,Cm,void 0)}build(){super.build(),jge(Cm,this,this._element.firstChild)}update(){this.isBuilt()&&(zM(Cm,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&zM(Cm,this).focus()}activate(){zM(Cm,this).click()}}function Uge(t,e){b3(t,e),e.add(t)}function _d(t,e,n){b3(t,e),e.set(t,n)}function b3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(t,e){return t.get(Kd(t,e))}function Yo(t,e,n){return t.set(Kd(t,e),n),n}function Kd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fj="multipleSelect.itemBox";var ts=new WeakMap,Dn=new WeakMap,YM=new WeakMap,Va=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,bm=new WeakSet;class Ap extends us{static get DEFAULTS(){return ra({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,ii(Ap.DEFAULTS,n)),Uge(this,bm),_d(this,ts,[]),_d(this,Dn,void 0),_d(this,YM,void 0),_d(this,Va,void 0),_d(this,Ql,void 0),_d(this,Jl,void 0),Yo(Va,this,new Tu(this.hot,{placeholder:CH,className:"htUIMultipleSelectSearch"})),Yo(Ql,this,new xp(this.hot,{textContent:pH,className:"htUISelectAll"})),Yo(Jl,this,new xp(this.hot,{textContent:vH,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return tt(Dn,this)}registerHooks(){tt(Va,this).addLocalHook("keydown",e=>Kd(bm,this,Yge).call(this,e)),tt(Va,this).addLocalHook("input",e=>Kd(bm,this,zge).call(this,e)),tt(Ql,this).addLocalHook("click",e=>Kd(bm,this,Gge).call(this,e)),tt(Jl,this).addLocalHook("click",e=>Kd(bm,this,qge).call(this,e))}setItems(e){var n;Yo(ts,this,e),(n=tt(Dn,this))===null||n===void 0||n.loadData(tt(ts,this))}setLocale(e){Yo(YM,this,e)}getLocale(){return tt(YM,this)}getItems(){return[...tt(ts,this)]}getValue(){return Xge(tt(ts,this))}getSearchInputElement(){return tt(Va,this)}getSelectAllElement(){return tt(Ql,this)}getClearAllElement(){return tt(Jl,this)}isSelectedAllValues(){return tt(ts,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new us(this.hot,{className:"htUISelectionControls",children:[tt(Ql,this),tt(Jl,this)]});this._element.appendChild(tt(Va,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=o=>{var a;if(!this._element)return;(a=tt(Dn,this))===null||a===void 0||a.destroy(),pe(o,"htUIMultipleSelectHot"),Yo(Dn,this,new this.hot.constructor(o,{data:tt(ts,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,g,p,w,y,b)=>{d.title=b.instance.getDataAtRowProp(g,b.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{tt(Dn,this).listen()},modifyColWidth:d=>{const g=tt(Dn,this).container.scrollWidth-Si(e);return d!==void 0&&d<g?g:d},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),tt(Dn,this).init(),this.hot.addHook("afterSetTheme",(d,g)=>{g||tt(Dn,this).useTheme(d)});const h=tt(Dn,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:fj}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{tt(Dn,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:fj})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&tt(Dn,this).listen()}reset(){tt(Va,this).reset(),tt(Ql,this).reset(),tt(Jl,this).reset()}update(){this.isBuilt()&&(tt(Dn,this).loadData(Kge(tt(ts,this),this.options.value)),super.update())}destroy(){var e;(e=tt(Dn,this))===null||e===void 0||e.destroy(),tt(Va,this).destroy(),tt(Jl,this).destroy(),tt(Ql,this).destroy(),Yo(Va,this,null),Yo(Jl,this,null),Yo(Ql,this,null),Yo(Dn,this,null),Yo(ts,this,null),super.destroy()}}function zge(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...tt(ts,this)]:n=tt(ts,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),tt(Dn,this).loadData(n)}function Yge(t){this.runLocalHooks("keydown",t,this),Sz(Yp,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ps(t),tt(Dn,this).listen(),tt(Dn,this).selectCell(0,0))}function Gge(t){const e=[];t.preventDefault(),tt(Dn,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(sY(n,i)[0])}),tt(Dn,this).setSourceDataAtCell(e)}function qge(t){const e=[];t.preventDefault(),tt(Dn,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(sY(n,i)[0])}),tt(Dn,this).setSourceDataAtCell(e)}function Kge(t,e){const n=sv(e);return t.map(i=>(i.checked=n(i.value),i))}function Xge(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Zge(t,e){Qge(t,e),e.add(t)}function Qge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jge(t,e,n){return(e=eme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eme(t){var e=tme(t,"string");return typeof e=="symbol"?e:e+""}function tme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ry(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sm=new WeakSet;class nme extends ov{constructor(e,n){super(e,{id:n.id,stateless:!1}),Zge(this,Sm),Jge(this,"name",""),this.name=n.name,this.elements.push(new Ap(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ry(Sm,this,ime).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Ry(Sm,this,rme).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Yc){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?bi:Yc},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,a,u)=>{const[h]=Zc(r,p=>p.name===Yc),d={},g=this.hot.getTranslatedPhrase(BC);if(h){const p=a(i,u),w=St(p,_=>_.value),y=new Map(p.map(_=>[_.value,this.hot.getCellMeta(_.meta.visualRow,_.meta.visualCol)])),b=_O(w);o&&(h.args[0]=o);const T=[],M=ij(b,h.args[0],g,_=>{_.checked&&T.push(_.value),Ry(Sm,this,gj).call(this,_,y)}),I=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,I).locale,d.args=[T],d.command=zc(Yc),d.itemsSnapshot=M}else d.args=[],d.command=zc(bi);this.state.setValueAtIndex(i,d)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ap)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,a)=>{pe(n.parentNode,"htFiltersMenuValue");const u=this.hot.rootDocument.createElement("div");return pe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||U(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(BC),n=this._getColumnVisibleValues(),i=n.map(h=>h.value),r=new Map(n.map(h=>[h.value,h.meta])),o=_O(i),a=ij(o,o,e,h=>{Ry(Sm,this,gj).call(this,h,r)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const u=this.hot.getPlugin("filters").getSelectedColumn();u!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,u.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:St(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:iI(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function ime(t){Yp(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ps(t))}function gj(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function rme(t,e){switch(e.type){case"numeric":return uG(t,e);default:return t}}var S3;function ome(t,e){sme(t,e),e.add(t)}function sme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ame(t,e,n){return(e=lme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lme(t){var e=ume(t,"string");return typeof e=="symbol"?e:e+""}function ume(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cme(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mj=new WeakSet;class Hp extends ov{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),ome(this,mj),ame(this,"name",""),this.name=n.name,this.elements.push(new Tu(this.hot,{type:"button",value:wH,className:"htUIButton htUIButtonOK",identifier:Hp.BUTTON_OK})),this.elements.push(new Tu(this.hot,{type:"button",value:yH,className:"htUIButton htUIButtonCancel",identifier:Hp.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){U(this.elements,e=>{e.addLocalHook("click",(n,i)=>cme(mj,this,hme).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(pe(n.parentNode,"htFiltersMenuActionBar"),U(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}S3=Hp;function hme(t,e){e.options.identifier===S3.BUTTON_OK?this.accept():this.cancel()}function GM(t,e,n){return(e=dme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dme(t){var e=fme(t,"string");return typeof e=="symbol"?e:e+""}function fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pj="ConditionCollection.filteringStates";class aI{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;GM(this,"hot",void 0),GM(this,"isMapRegistrable",void 0),GM(this,"filteringStates",new Xb),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(pj,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],a=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Eu;return e.length?oge(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Eu,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=n.args.map(g=>typeof g=="string"?g.toLocaleLowerCase(o):g),u=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==i)throw Error($t`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(wn(Mp[i]))throw new Error($t`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:u,args:a,func:_u(u,a)}]},r):d.push({name:u,args:a,func:_u(u,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(a=>{let{name:u,args:h}=a;return{name:u,args:[...h]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(pj),this.filteringStates=null,this.clearLocalHooks()}}Xt(aI,Ai);function vj(t,e,n){return(e=gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gme(t){var e=mme(t,"string");return typeof e=="symbol"?e:e+""}function mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];vj(this,"conditionCollection",void 0),vj(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return U(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return U(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return U(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function pme(t,e){vme(t,e),e.add(t)}function vme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wc(t,e,n){return(e=wme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wme(t){var e=yme(t,"string");return typeof e=="symbol"?e:e+""}function yme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ey=new WeakSet;class E3{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];pme(this,Ey),wc(this,"hot",void 0),wc(this,"conditionCollection",void 0),wc(this,"columnDataFactory",void 0),wc(this,"changes",[]),wc(this,"grouping",!1),wc(this,"latestEditedColumnPosition",-1),wc(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>qM(Ey,this,Cme).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>qM(Ey,this,bme).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>qM(Ey,this,Sme).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,U(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=r.slice(0,o),u=r.slice(o);u.length&&u[0].column===e&&u.shift();const h=SZ(function(g,p){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const y=new aI(i.hot,!1),b=[].concat(g,w);y.importAllConditions(b);const T=i.columnDataFactory(p);let M;y.isEmpty()?M=T:M=new R3(y,_=>i.columnDataFactory(_)).filter(),M=St(M,_=>_.meta.visualRow);const I=sv(M);return y.destroy(),Zc(T,_=>I(_.meta.visualRow))})(a),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),ft(this,(e,n)=>{this[n]=null})}}function Cme(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function bme(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Sme(){U(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Xt(E3,Ai);function Rme(t){return zG({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof Ap)return i;if(r.element&&!af(r.element))return!1;r.focus()}})}const Rm="filters";function Eme(t,e){let n=-1,i;const r=Rme(e),o=p=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(Rm),r.setCurrentPage(e.indexOf(p))};e.forEach(p=>{p instanceof us&&(p.addLocalHook("click",o(p)),p.addLocalHook("focus",o(p)),p.addLocalHook("afterClose",o(p)))}),h(t);function a(p){const w=i.getKeyboardShortcutsCtrl(),y=p.getKeyboardShortcutsCtrl();r.clear(),y.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:w.getContext(Rm),callback:()=>{p.isSubMenu()&&p.close(),w.listen(Rm)}}]),!p.isSubMenu()&&w.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:b=>{const T=i.getNavigator();T.getCurrentPage()>-1&&(n=T.getCurrentPage()),T.clear(),b.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:b=>{const T=e[r.getCurrentPage()];T instanceof Op&&(T.openOptions(),b.preventDefault()),T instanceof xp&&(T.activate(),b.preventDefault()),T instanceof us||b.preventDefault()}}],Rm)}function u(){i.focus(),i.getKeyboardShortcutsCtrl().listen(Rm)}function h(p){p.addLocalHook("afterSelectionChange",w=>{w.key.startsWith("filter_")||r.clear()}),p.addLocalHook("afterSubmenuOpen",a),p.addLocalHook("afterOpen",a),i=p}function d(){return i}function g(){return n}return{...r,listen:u,setMenu:h,getMenu:d,getLastMenuPage:g}}function Tme(t,e){T3(t,e),e.add(t)}function KM(t,e,n){T3(t,e),e.set(t,n)}function T3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Em(t,e,n){return(e=_me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _me(t){var e=Mme(t,"string");return typeof e=="symbol"?e:e+""}function Mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SC(t,e,n){return t.set(Cr(t,e),n),n}function So(t,e){return t.get(Cr(t,e))}function Cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OO="filters",Ome=250,wj=OO;var Ua=new WeakMap,xO=new WeakMap,Fc=new WeakMap,Fr=new WeakSet;class xme extends It{static get PLUGIN_KEY(){return OO}static get PLUGIN_PRIORITY(){return Ome}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Tme(this,Fr),Em(this,"dropdownMenuPlugin",null),Em(this,"conditionCollection",null),Em(this,"conditionUpdateObserver",null),Em(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Em(this,"filtersRowsMap",null),KM(this,Ua,void 0),KM(this,xO,new WeakSet),KM(this,Fc,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Cr(Fr,n,Lme).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[OO]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Xp),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootDocument.body,r=u=>(u.addLocalHook("accept",()=>Cr(Fr,this,yj).call(this,"accept")),u.addLocalHook("cancel",()=>Cr(Fr,this,yj).call(this,"cancel")),u.addLocalHook("change",h=>Cr(Fr,this,Dme).call(this,u,h)),u),o=()=>`${this.hot.getTranslatedPhrase(fH)}:`,a=()=>`${this.hot.getTranslatedPhrase(gH)}:`;if(!this.components.get("filter_by_condition")){const u=new MO(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});u.addLocalHook("afterClose",()=>Cr(Fr,this,Cj).call(this)),this.components.set("filter_by_condition",r(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new $ge(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const u=new MO(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});u.addLocalHook("afterClose",()=>Cr(Fr,this,Cj).call(this)),this.components.set("filter_by_condition2",r(u))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new nme(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Hp(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new aI(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new E3(this.hot,this.conditionCollection,u=>this.getDataMapAtColumn(u)),this.conditionUpdateObserver.addLocalHook("update",u=>Cr(Fr,this,kme).call(this,u))),this.components.forEach(u=>u.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return Cr(Fr,e,Nme).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>Cr(Fr,this,Pme).call(this)),this.addHook("afterDropdownMenuShow",()=>Cr(Fr,this,Hme).call(this)),this.addHook("afterDropdownMenuHide",()=>Cr(Fr,this,Ime).call(this)),this.addHook("afterChange",u=>Cr(Fr,this,Ame).call(this,u)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!So(Ua,this)&&this.dropdownMenuPlugin.enabled){const u=[{focus:()=>{const d=So(Ua,this).getMenu(),g=d.getNavigator(),p=So(Ua,this).getLastMenuPage();d.focus(),p>0?g.setCurrentPage(p):g.toFirstItem()}},...Array.from(this.components).map(d=>{let[,g]=d;return g.getElements()}).flat()];SC(Ua,this,Eme(this.dropdownMenuPlugin.menu,u));const h=d=>{So(Ua,this).listen(),d.preventDefault(),Yp(d.keyCode,"TAB")&&(d.shiftKey?So(Ua,this).toPreviousItem():So(Ua,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:wj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wj)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Eu;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions(),a=this.hot.runHooks("beforeFilter",o,So(Fc,this));if(a!==!1&&i){const u=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=St(n.filter(),d=>d.meta.visualRow);const h=sv(r);Ve(this.hot.countSourceRows()-1,d=>{h(d)||u.push(d)}),U(u,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),SC(Fc,this,this.exportConditions())}else a!==!1&&!i?(SC(Fc,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(So(Fc,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),a!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return U(this.hot.getSourceDataAtCol(n),(r,o)=>{var a;const{row:u,col:h,visualCol:d,visualRow:g,type:p,instance:w,dateFormat:y,locale:b}=this.hot.getCellMeta(o,n),T=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&a!==void 0?a:r;i.push({meta:{row:u,col:h,visualCol:d,visualRow:g,type:p,instance:w,dateFormat:y,locale:b},value:iI(T)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=_O(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===ib&&n.command.key!==bi&&i.command.key!==bi&&r.command.key!==bi?o=oI:r.command.key!==bi&&(n.command.key===bi||i.command.key===bi)&&(o=Eu),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new R3(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return U(r,a=>{U(n.menuItems,(u,h)=>{u.key===a.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];const h=this.getIndexesOfComponents(...a);e?r.showRows(h):r.hideRows(h),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Ame(t){t&&U(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function Hme(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Ime(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Pme(){const t=this.dropdownMenuPlugin.menu;So(xO,this).has(t)||So(Ua,this).setMenu(t),So(xO,this).add(t)}function Nme(t){t.items.push({name:ht}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function yj(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,u);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(r);d===-1&&(d=void 0),this.conditionCollection.removeConditions(r),o.command.key!==bi&&(this.conditionCollection.addCondition(r,o,h,d),a.command.key!==bi&&this.conditionCollection.addCondition(r,a,h,d)),u.command.key!==bi&&this.conditionCollection.addCondition(r,u,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Dme(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===MO&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function Cj(){this.setListeningDropdownMenu()}function Lme(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?pe(e,"htFiltersActive"):Ue(e,"htFiltersActive")}function kme(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&SC(Fc,this,So(Fc,this).map(u=>(u.column===i&&n.length>0&&u.conditions.forEach(h=>{h.name==="by_value"&&(h.args=[[...r]])}),u)));const o=n.filter(u=>u.name===Yc),a=n.filter(u=>u.name!==Yc);if(o.length>=2||a.length>=3)Nt($t`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const u=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(a[0],i),this.components.get("filter_by_condition2").updateState(a[1],i),this.components.get("filter_operators").updateState(u,i),this.components.get("filter_by_value").updateState(t)}}const _3="internal-use-in-handsontable",AO={licenseKey:_3,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function M3(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Fi])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function O3(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Vme(t){var e;const n=t[Fi],i=O3(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=M3(t);return{...AO,...i,...r}}function $me(t){var e;const n=t[Fi],i=O3(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=M3(t);return{...i,...r}}function Bme(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function wS(){const t="engine_relationship",e=vs(Fi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function lI(){const t="shared_engine_usage",e=vs(Fi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Fme(t){const e=t.getSettings(),n=e[Fi],i=n==null?void 0:n.engine;if(n===!0||wn(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return Wme((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&wn(i.hyperformula)){const o=wS(),a=lI().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),a&&a.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:_3}),(i.getConfig().leapYear1900!==AO.leapYear1900||xx(i.getConfig().nullDate,AO.nullDate)===!1)&&Nt($t`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function Wme(t,e,n){const i=e[Fi],r=Vme(e),o=wS(),a=lI();jme(t,i.functions),Ume(t,i.language);const u=t.buildEmpty(r);return o.set(u,[n]),a.set(u,[n.guid]),zme(u,i.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function bj(t){var e;const n=wS(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function Sj(t,e){if(t){const n=wS(),i=n.get(t),r=lI(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function jme(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(a){Nt(a.message)}})}function Ume(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){Nt(i.message)}}}function zme(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:a}=n;try{t.addNamedExpression(i,r,o,a)}catch(u){Nt(u.message)}}),t.resumeEvaluation())}function Yme(t,e){return(wn(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const x3="DD/MM/YYYY";function Gme(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function qme(t){return Gme(t)?t.substr(1):t}function Kme(t){return typeof t=="string"&&t.startsWith("=")}function uI(t,e){return typeof t=="string"&&e==="date"}function A3(t,e){return Ce(t,e,!0).isValid()}function H3(t,e){return Ce(t,e,!0).format(x3)}function Xme(t,e){return Ce(t,x3,!0).format(e)}function I3(t,e){const i=new Date(Date.UTC(0,0,t+-1));return Ce(i).format(e)}function Zme(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Qme(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const a=o.from>o.to,u=o.to<=r.from;o.from>r.from&&u&&a&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function Jme(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function cI(t,e,n){const i=Qme(t,Zme(t,e,n));return Jme(i)}function yc(t,e,n){epe(t,e),e.set(t,n)}function epe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dn(t,e){return t.get(P3(t,e))}function eu(t,e,n){return t.set(P3(t,e),n),n}function P3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tm=new WeakMap,tu=new WeakMap,Wr=new WeakMap,Ty=new WeakMap,XM=new WeakMap,ZM=new WeakMap,_y=new WeakMap;class Rj{constructor(e,n,i){yc(this,Tm,void 0),yc(this,tu,void 0),yc(this,Wr,void 0),yc(this,Ty,[]),yc(this,XM,[]),yc(this,ZM,void 0),yc(this,_y,[]),eu(Tm,this,e),eu(tu,this,n),eu(Wr,this,i)}setRemovedHfIndexes(e){return eu(_y,this,e.map(n=>{const i=dn(tu,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),dn(_y,this)}getRemovedHfIndexes(){return dn(_y,this)}getHfIndexFromVisualIndex(e){const n=dn(tu,this).getIndexesSequence(),i=dn(tu,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${ds(dn(Tm,this))}s`;dn(Wr,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,a=r.from+1!==r.to;o&&a&&dn(Wr,this).getEngine()[i](dn(Wr,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(eu(XM,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),eu(ZM,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(dn(Wr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=cI(dn(XM,this),dn(ZM,this),dn(tu,this).getNumberOfIndexes());dn(Wr,this).getSheetId()===null?dn(Wr,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${ds(dn(Tm,this))}Order`;return n=>{if(dn(Wr,this).isPerformingUndoRedo())return;const i=dn(tu,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=dn(Ty,this).map(h=>i.indexOf(h)),o=dn(Wr,this).getEngine().getSheetDimensions(dn(Wr,this).getSheetId());let a;dn(Tm,this)==="row"?a=o.height:a=o.width;const u=r.length;for(let h=u;h<a;h+=1)r.push(h);dn(Wr,this).getEngine()[e](dn(Wr,this).getSheetId(),r)}eu(Ty,this,i)}}init(){eu(Ty,this,dn(tu,this).getIndexesSequence())}}function Cc(t,e,n){tpe(t,e),e.set(t,n)}function tpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(t,e){return t.get(N3(t,e))}function bc(t,e,n){return t.set(N3(t,e),n),n}function N3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var My=new WeakMap,Oy=new WeakMap,QM=new WeakMap,JM=new WeakMap,e1=new WeakMap,t1=new WeakMap,n1=new WeakMap;class npe{constructor(e,n,i){Cc(this,My,void 0),Cc(this,Oy,void 0),Cc(this,QM,void 0),Cc(this,JM,!1),Cc(this,e1,!1),Cc(this,t1,null),Cc(this,n1,null),bc(My,this,new Rj("row",e,this)),bc(Oy,this,new Rj("column",n,this)),bc(QM,this,i)}getForAxis(e){return e==="row"?$a(My,this):$a(Oy,this)}setPerformUndo(e){bc(JM,this,e)}setPerformRedo(e){bc(e1,this,e)}isPerformingUndoRedo(){return $a(JM,this)||$a(e1,this)}getSheetId(){return $a(n1,this)}getEngine(){return $a(t1,this)}getPostponeAction(){return $a(QM,this)}setupSyncEndpoint(e,n){bc(t1,this,e),bc(n1,this,n),$a(My,this).init(),$a(Oy,this).init()}}function ipe(t,e){D3(t,e),e.add(t)}function Sc(t,e,n){return(e=rpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rpe(t){var e=ope(t,"string");return typeof e=="symbol"?e:e+""}function ope(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i1(t,e,n){D3(t,e),e.set(t,n)}function D3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mu(t,e,n){return t.set(Ot(t,e),n),n}function Xc(t,e){return t.get(Ot(t,e))}function Ot(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fi="formulas",spe=["maxRows","maxColumns","language"],ape=260;xe.getSingleton().register("afterNamedExpressionAdded");xe.getSingleton().register("afterNamedExpressionRemoved");xe.getSingleton().register("afterSheetAdded");xe.getSingleton().register("afterSheetRemoved");xe.getSingleton().register("afterSheetRenamed");xe.getSingleton().register("afterFormulasValuesUpdate");const Hf=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var gl=new WeakMap,yS=new WeakMap,_m=new WeakMap,Ht=new WeakSet;class lpe extends It{constructor(){var e;super(...arguments),e=this,ipe(this,Ht),i1(this,gl,!1),i1(this,yS,!1),i1(this,_m,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,Epe).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,Tpe).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,_pe).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,Mpe).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,Ope).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ot(Ht,e,xpe).call(e,...i)}]]),Sc(this,"staticRegister",vs("formulas")),Sc(this,"engine",null),Sc(this,"sheetId",null),Sc(this,"sheetName",null),Sc(this,"indexSyncer",null),Sc(this,"rowAxisSyncer",null),Sc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Fi}static get PLUGIN_PRIORITY(){return ape}static get SETTING_KEYS(){return[Fi,...spe]}isEnabled(){return!!this.hot.getSettings()[Fi]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Fme(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Nt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&Ot(Ht,this,ep).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Ej).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Tj).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Ej).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Tj).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,dpe).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,fpe).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,upe).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,gpe).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,_j).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,_j).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,mpe).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,ppe).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,ype).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Cpe).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,vpe).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,wpe).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,bpe).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Spe).call(n,...r)}),this.indexSyncer=new npe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,a)=>{this.rowAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("beforeColumnMove",(i,r,o,a)=>{this.columnAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("afterRowMove",(i,r,o,a,u)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("afterColumnMove",(i,r,o,a,u)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,hpe).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,Rpe).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ot(Ht,n,cpe).call(n,...r)}),Xc(_m,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){Xc(_m,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),Sj(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=$me(this.hot.getSettings());Bme(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[Fi];if(Ne(i)&&Ne(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[Fi].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const o=this.addSheet(r??void 0,this.hot.getSourceDataArray());Ot(Ht,this,ep).call(this,o)}}super.updatePlugin(e)}destroy(){Xc(_m,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Mu(_m,this,null),Sj(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Ne(n)&&!Kte(n))return Nt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Nt("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return Nt(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Ix(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ot(Ht,this,ep).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${ds(Fi)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const a=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(i.has(a)||i.add(a))}),bj(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var a;r.render(),(a=r.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var a;const{row:u,col:h,sheet:d}=(a=o==null?void 0:o.address)!==null&&a!==void 0?a:{};return Ne(d)?`${d}:${u}x${h}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var a,u;const{row:h,col:d}=(a=o.address)!==null&&a!==void 0?a:{};if(Ne(h)===!1||Ne(d)===!1||h>=this.hot.countRows()||d>=this.hot.countCols())return;const g=o==null||(u=o.address)===null||u===void 0?void 0:u.sheet,p=i(o);if(g!==void 0&&!r.has(p)){const w=bj(this.engine).get(g);if(!w)return;w.validateCell(w.getDataAtCell(h,d),w.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){Nt(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return uI(i,o.type)&&(A3(i,o.dateFormat)?i=H3(i,o.dateFormat):Kme(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function ep(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function upe(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let a=this.engine.getCellValue(r);return o.type==="date"&&er(a)&&(a=I3(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return t}function cpe(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),{row:u,col:h}=n.getTopStartCorner(),{row:d,col:g}=n.getBottomEndCorner(),p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},w={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(w)===!1)return!1;const y=this.engine.getFillRangeData(p,w),{row:b,col:T}=p.start,{row:M,col:I}=p.end,_=M-b+1,N=I-T+1;for(let k=0;k<y.length;k+=1)for(let $=0;$<y[k].length;$+=1){const L=y[k][$],F=b+k%_,he=T+$%N,le=this.hot.getCellMeta(F,he);uI(L,le.type)&&(L.startsWith("'")?y[k][$]=L.slice(1):this.isFormulaCellType(F,he,this.sheetId)===!1&&(y[k][$]=Xme(L,le.dateFormat)))}return y}function Ej(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ds(Fi))||Mu(yS,this,wn(this.hot.getSettings().data))}function hpe(){if(Xc(yS,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,i)=>{n.forEach((r,o)=>{const a=this.hot.getCellMeta(i,o,{skipMetaExtension:!0}),u=a.dateFormat;uI(r,a.type)&&(A3(r,u)?t[i][o]=H3(r,u):r.startsWith("=")||(t[i][o]=`'${r}`))})}),Mu(gl,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Mu(gl,this,!1)}function Tj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(ds(Fi)))return;const i=Yme(this.engine,this.hot.getSettings()[Fi].sheetName);if(Ot(Ht,this,ep).call(this,i),n!=="updateSettings")if(Xc(yS,this))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Mu(gl,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Mu(gl,this,!1)}}}function dpe(t,e,n,i){if(i!=="get"||Xc(gl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;const o=this.getCellType(r,e);if(o==="VALUE"||o==="EMPTY"){n.value=qme(n.value);return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let u=this.engine.getCellValue(a);const h=this.hot.getCellMeta(r,e,{skipMetaExtension:!0});h.type==="date"&&er(u)&&(u=I3(u,h.dateFormat)),n.value=typeof u=="object"&&u!==null?u.value:u}function fpe(t,e,n,i){if(i!=="get"||Xc(gl,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null)return;const a=this.getCellType(r,o);if(a==="VALUE"||a==="EMPTY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(h)}function _j(t,e){if(Hf(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[a,u,,h]=o;const d=this.hot.propToCol(u),g=this.hot.toPhysicalRow(a),p=this.hot.toPhysicalColumn(d),w={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};g!==null&&p!==null?this.syncChangeWithEngine(a,d,h):n.push([a,d,h]),i.push({address:w})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(a=>{let[u,h,d]=a;this.syncChangeWithEngine(u,h,d)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function gpe(t,e){if(Hf(e))return;const n=[],i=[];t.forEach(r=>{let[o,a,,u]=r;const h=this.hot.propToCol(a);if(!er(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){Nt(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),n.push(...this.engine.setCellContents(d,u))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function mpe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function ppe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function vpe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function wpe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ype(t,e,n){if(Hf(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Cpe(t,e,n){if(Hf(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function bpe(t,e,n,i){if(Hf(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),o=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function Spe(t,e,n,i){if(Hf(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),o=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function Rpe(t,e,n){var i;Mu(gl,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Mu(gl,this,!1),r.forEach((o,a)=>{o.forEach((u,h)=>{this.engine.setCellContents({col:h,row:n+a,sheet:this.sheetId},[[u]])})})}function Epe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Tpe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function _pe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Mpe(t){this.hot.runHooks("afterSheetAdded",t)}function Ope(t,e){Ot(Ht,this,ep).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function xpe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Ape(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(UA,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let h=i;h<=r;h+=1)o.push(h);t.hideColumns(o);const a=o[o.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Hpe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(zA,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=St(t.getHiddenColumns(),p=>this.toPhysicalColumn(p));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,a=this.columnIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(o),d=a.getNotTrimmedIndexes(),g=[];if(r!==o){const p=o-r+1,w=h-u+1;if(p>w){const y=d.slice(r,o+1);g.push(...y.filter(b=>n.includes(b)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countCols()));else{const p=this.countCols()-1,w=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===w&&p>o&&g.push(...d.slice(o+1))}return U(g,p=>{e.push(this.toVisualColumn(p))}),e.length===0}}}function Ipe(t,e){L3(t,e),e.add(t)}function Ppe(t,e,n){L3(t,e),e.set(t,n)}function L3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rc(t,e){return t.get(lu(t,e))}function Mj(t,e,n){return t.set(lu(t,e),n),n}function lu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeHideColumns");xe.getSingleton().register("afterHideColumns");xe.getSingleton().register("beforeUnhideColumns");xe.getSingleton().register("afterUnhideColumns");const Oj="hiddenColumns",Npe=310;var Ds=new WeakMap,Ec=new WeakSet;class Dpe extends It{constructor(){super(...arguments),Ipe(this,Ec),Ppe(this,Ds,null)}static get PLUGIN_KEY(){return Oj}static get PLUGIN_PRIORITY(){return Npe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[Oj]}enablePlugin(){var e=this;this.enabled||(Mj(Ds,this,new Kb),Rc(Ds,this).addLocalHook("init",()=>lu(Ec,this,Fpe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Rc(Ds,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lu(Ec,e,Bpe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>lu(Ec,this,kpe).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>lu(Ec,this,Lpe).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return lu(Ec,e,$pe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>lu(Ec,this,Vpe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=Rc(Ds,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalColumn(d));U(h,d=>{o[d]=!1}),r=xr(o,(d,g,p)=>(g&&d.push(this.hot.toVisualColumn(p)),d),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&a)!==!1&&(i&&a&&Rc(Ds,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&a,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{Rc(Ds,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return St(Rc(Ds,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Rc(Ds,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){U(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Mj(Ds,this,null),super.destroy()}}function Lpe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function kpe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Vpe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,a)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:a})};return U(t,i=>{let r=!0,o=0;Ve(i.startCol,i.endCol,a=>{this.isHidden(a)?(r||n(i.startRow,i.endRow,o,a-1),r=!0):(r&&(o=a),a===i.endCol&&n(i.startRow,i.endRow,o,a),r=!1)})}),e}function $pe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),pe(e,n)}function Bpe(t){t.items.push({name:ht},Ape(this),Hpe(this))}function Fpe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Wpe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(YA,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let h=i;h<=r;h+=1)o.push(h);t.hideRows(o);const a=o[o.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function jpe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(GA,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=St(t.getHiddenRows(),p=>this.toPhysicalRow(p));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,a=this.rowIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(o),d=a.getNotTrimmedIndexes(),g=[];if(r!==o){const p=o-r+1,w=h-u+1;if(p>w){const y=d.slice(r,o+1);g.push(...y.filter(b=>n.includes(b)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countRows()));else{const p=this.countRows()-1,w=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,-1));h===w&&p>o&&g.push(...d.slice(o+1))}return U(g,p=>{e.push(this.toVisualRow(p))}),e.length===0}}}function Upe(t,e){k3(t,e),e.add(t)}function zpe(t,e,n){k3(t,e),e.set(t,n)}function k3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tc(t,e){return t.get(uu(t,e))}function xj(t,e,n){return t.set(uu(t,e),n),n}function uu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeHideRows");xe.getSingleton().register("afterHideRows");xe.getSingleton().register("beforeUnhideRows");xe.getSingleton().register("afterUnhideRows");const Aj="hiddenRows",Ype=320;var Ls=new WeakMap,_c=new WeakSet;class Gpe extends It{constructor(){super(...arguments),Upe(this,_c),zpe(this,Ls,null)}static get PLUGIN_KEY(){return Aj}static get PLUGIN_PRIORITY(){return Ype}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[Aj]}enablePlugin(){var e=this;this.enabled||(xj(Ls,this,new Kb),Tc(Ls,this).addLocalHook("init",()=>uu(_c,this,Jpe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Tc(Ls,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return uu(_c,e,Qpe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>uu(_c,this,Kpe).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>uu(_c,this,qpe).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return uu(_c,e,Zpe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>uu(_c,this,Xpe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=Tc(Ls,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalRow(d));U(h,d=>{o[d]=!1}),r=xr(o,(d,g,p)=>(g&&d.push(this.hot.toVisualRow(p)),d),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&a)!==!1&&(i&&a&&Tc(Ls,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&a,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{Tc(Ls,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return St(Tc(Ls,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Tc(Ls,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){U(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){xj(Ls,this,null),super.destroy()}}function qpe(t,e){return this.isHidden(e)?0:t}function Kpe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Xpe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,a)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:a})};return U(t,i=>{let r=!0,o=0;Ve(i.startRow,i.endRow,a=>{this.isHidden(a)?(r||n(o,a-1,i.startCol,i.endCol),r=!0):(r&&(o=a),a===i.endRow&&n(o,a,i.startCol,i.endCol),r=!1)})}),e}function Zpe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),pe(e,n)}function Qpe(t){t.items.push({name:ht},Wpe(this),jpe(this))}function Jpe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function eve(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CA)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function tve(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(bA)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function nve(t,e){V3(t,e),e.add(t)}function ive(t,e,n){V3(t,e),e.set(t,n)}function V3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HO(t,e){return t.get(ob(t,e))}function r1(t,e,n){return t.set(ob(t,e),n),n}function ob(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeColumnFreeze");xe.getSingleton().register("afterColumnFreeze");xe.getSingleton().register("beforeColumnUnfreeze");xe.getSingleton().register("afterColumnUnfreeze");const Hj="manualColumnFreeze",rve=110;var Vc=new WeakMap,o1=new WeakSet;class ove extends It{constructor(){super(...arguments),nve(this,o1),ive(this,Vc,!1)}static get PLUGIN_KEY(){return Hj}static get PLUGIN_PRIORITY(){return rve}isEnabled(){return!!this.hot.getSettings()[Hj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>ob(o1,this,sve).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>ob(o1,this,ave).call(this,e,n)),super.enablePlugin())}disablePlugin(){r1(Vc,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;HO(Vc,this)||r1(Vc,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;HO(Vc,this)||r1(Vc,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function sve(t){t.items.push({name:"---------"},eve(this),tve(this))}function ave(t,e){if(HO(Vc,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function xy(t,e,n){return(e=lve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lve(t){var e=uve(t,"string");return typeof e=="symbol"?e:e+""}function uve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const s1=0,Ij=1,Pj=2,Md="px";let $3=class{constructor(e){xy(this,"hot",void 0),xy(this,"_element",null),xy(this,"state",s1),xy(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Pj}build(){this.state===s1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Ij)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=s1}isAppended(){return this.state===Pj}isBuilt(){return this.state>=Ij}setPosition(e,n){er(e)&&(this._element.style.top=e+Md),er(n)&&(this._element.style[this.inlineProperty]=n+Md)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){er(e)&&(this._element.style.width=e+Md),er(n)&&(this._element.style.height=n+Md)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){er(e)&&(this._element.style.marginTop=e+Md),er(n)&&(this._element.style[`margin${ds(this.inlineProperty)}`]=n+Md)}getOffset(){const e=this._element.style,n=`margin${ds(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const cve="ht__manualColumnMove--backlight";let hve=class extends $3{build(){super.build(),pe(this._element,cve)}};const dve="ht__manualColumnMove--guideline";let fve=class extends $3{build(){super.build(),pe(this._element,dve)}};function gve(t,e){B3(t,e),e.add(t)}function Go(t,e,n){B3(t,e),e.set(t,n)}function B3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e,n){return t.set(cu(t,e),n),n}function Le(t,e){return t.get(cu(t,e))}function cu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeColumnMove");xe.getSingleton().register("afterColumnMove");const a1="manualColumnMove",mve=120,Nj="ht__manualColumnMove",sb="show-ui",IO="on-moving--columns",PO="after-selection--columns";var Qi=new WeakMap,du=new WeakMap,rl=new WeakMap,RC=new WeakMap,Cu=new WeakMap,Zi=new WeakMap,Ay=new WeakMap,wo=new WeakMap,Wd=new WeakMap,ab=new WeakMap,tp=new WeakMap,Mc=new WeakSet;class pve extends It{constructor(){super(...arguments),gve(this,Mc),Go(this,Qi,new hve(this.hot)),Go(this,du,new fve(this.hot)),Go(this,rl,[]),Go(this,RC,0),Go(this,Cu,!1),Go(this,Zi,{}),Go(this,Ay,void 0),Go(this,wo,void 0),Go(this,Wd,void 0),Go(this,ab,void 0),Go(this,tp,void 0)}static get PLUGIN_KEY(){return a1}static get PLUGIN_PRIORITY(){return mve}isEnabled(){return!!this.hot.getSettings()[a1]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return cu(Mc,e,vve).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return cu(Mc,e,yve).call(e,...i)}),this.addHook("afterScrollVertically",()=>cu(Mc,this,bve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return cu(Mc,e,Sve).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),pe(this.hot.rootElement,Nj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,Nj),this.unregisterEvents(),Le(Qi,this).destroy(),Le(du,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=Le(Ay,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(_r(Ay,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const a=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,a),a}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return _r(Ay,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||o||a||u)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=xr(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const a=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[a1];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return Ve(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Le(wo,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Le(wo,this)-1);const a=n.hider.offsetWidth,u=n.TBODY.offsetLeft,h=Le(Qi,this).getOffset().start,d=Le(Qi,this).getSize().width;let g=0,p=0;if(this.hot.isRtl()){const b=this.hot.rootWindow,T=zn(this.hot.rootElement),M=b.innerWidth-Le(Wd,this)-T;p=b.innerWidth-Le(Zi,this).eventPageX-M-(i.scrollX===void 0?r:0)}else p=Le(Zi,this).eventPageX-(Le(Wd,this)-(i.scrollX===void 0?r:0));if(Le(ab,this)&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Le(wo,this))&&(o+=r),o+=g,Le(wo,this)<0)Le(tp,this)>0?Le(Zi,this).col=0:Le(Zi,this).col=e>0?e-1:e;else if(Le(Zi,this).TD.offsetWidth/2+o<=p){const b=Le(wo,this)>=Le(RC,this)?Le(RC,this)-1:Le(wo,this);Le(Zi,this).col=b+1,o+=Le(Zi,this).TD.offsetWidth}else Le(Zi,this).col=Le(wo,this);let w=p,y=o;p+d+h>=a?w=a-d-h:p+h<u+g&&(w=u+g+Math.abs(h)),o>=a-1?y=a-1:y===0?y=1:i.scrollX!==void 0&&Le(wo,this)<Le(tp,this)&&(y-=Le(Wd,this)<=i.scrollX?Le(Wd,this):0),Le(Qi,this).setPosition(null,w),Le(du,this).setPosition(null,y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>cu(Mc,this,wve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>cu(Mc,this,Cve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Le(Qi,this).build(),Le(du,this).build()}destroy(){Le(Qi,this).destroy(),Le(du,this).destroy(),super.destroy()}}function vve(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),u=ze(t.target,"sortAction");if(!a||!o||Le(Cu,this)||t.button!==0||u){_r(Cu,this,!1),Le(rl,this).length=0,Ue(this.hot.rootElement,[IO,sb]);return}const h=Le(du,this).isBuilt()&&!Le(du,this).isAppended(),d=Le(Qi,this).isBuilt()&&!Le(Qi,this).isAppended();h&&d&&(Le(du,this).appendTo(r.hider),Le(Qi,this).appendTo(r.hider));const{from:g,to:p}=a,w=Math.min(g.col,p.col),y=Math.max(g.col,p.col);if(e.row<0&&e.col>=w&&e.col<=y){i.column=!0,_r(Cu,this,!0);const b=n.firstChild?VZ(t,n.firstChild).x:t.offsetX;Le(Zi,this).eventPageX=t.pageX,_r(wo,this,e.col),Le(Zi,this).TD=n,Le(Zi,this).col=e.col,_r(rl,this,this.prepareColumnsToMoving(w,y)),_r(ab,this,!!this.hot.getSettings().rowHeaders),_r(RC,this,this.hot.countCols()),_r(tp,this,this.hot.getSettings().fixedColumnsStart),_r(Wd,this,Wi(this.hot.rootElement).left);const T=Le(ab,this)?-1:0,M=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,I=e.col<Le(tp,this),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),N=Math.abs(b-(this.hot.isRtl()?n.offsetWidth:0)),k=this.getColumnsWidth(w,e.col-1)+N,$=this.getColumnsWidth(T,w-1)+(I?_:0)+k;Le(Qi,this).setPosition(M,$),Le(Qi,this).setSize(this.getColumnsWidth(w,y),r.hider.offsetHeight-M),Le(Qi,this).setOffset(null,-k),pe(this.hot.rootElement,IO)}else Ue(this.hot.rootElement,PO),_r(Cu,this,!1),Le(rl,this).length=0}function wve(t){Le(Cu,this)&&(Le(Zi,this).eventPageX=t.pageX,this.refreshPositions())}function yve(t,e,n,i){!this.hot.getSelectedRangeLast()||!Le(Cu,this)||(Le(rl,this).indexOf(e.col)>-1?Ue(this.hot.rootElement,sb):pe(this.hot.rootElement,sb),i.row=!0,i.column=!0,i.cell=!0,_r(wo,this,e.col),Le(Zi,this).TD=n)}function Cve(){const t=Le(Zi,this).col,e=Le(rl,this).length;if(_r(wo,this,void 0),_r(Cu,this,!1),Ue(this.hot.rootElement,[IO,sb,PO]),this.hot.selection.isSelectedByColumnHeader()&&pe(this.hot.rootElement,PO),e<1||t===void 0)return;const n=Le(rl,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(Le(rl,this),t);if(Le(rl,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(i),a=o+e-1;this.hot.selectColumns(o,a)}}function bve(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;Le(Qi,this).setPosition(i),Le(Qi,this).setSize(null,t.hider.offsetHeight-i)}function Sve(){this.moveBySettingsOrLoad()}function Rve(t,e){F3(t,e),e.add(t)}function Li(t,e,n){F3(t,e),e.set(t,n)}function F3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(t,e,n){return t.set(ns(t,e),n),n}function Ae(t,e){return t.get(ns(t,e))}function ns(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lb="manualColumnResize",Eve=130,Dj="manualColumnWidths";var Ka=new WeakMap,Hy=new WeakMap,Xr=new WeakMap,ub=new WeakMap,ea=new WeakMap,Tve=new WeakMap,rf=new WeakMap,Iy=new WeakMap,wr=new WeakMap,za=new WeakMap,oh=new WeakMap,cb=new WeakMap,np=new WeakMap,ip=new WeakMap,Qr=new WeakMap,rp=new WeakMap,ks=new WeakSet;class _ve extends It{static get PLUGIN_KEY(){return lb}static get PLUGIN_PRIORITY(){return Eve}constructor(e){super(e),Rve(this,ks),Li(this,Ka,null),Li(this,Hy,null),Li(this,Xr,[]),Li(this,ub,null),Li(this,ea,null),Li(this,Tve,null),Li(this,rf,null),Li(this,Iy,null),Li(this,wr,this.hot.rootDocument.createElement("DIV")),Li(this,za,this.hot.rootDocument.createElement("DIV")),Li(this,oh,null),Li(this,cb,!1),Li(this,np,0),Li(this,ip,null),Li(this,Qr,void 0),Li(this,rp,void 0),pe(Ae(wr,this),"manualColumnResizer"),pe(Ae(za,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[lb]}enablePlugin(){var e=this;this.enabled||(kn(Qr,this,new Iu),Ae(Qr,this).addLocalHook("init",()=>ns(ks,this,Mve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ae(Qr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ns(ks,e,Pve).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ns(ks,e,Nve).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ns(ks,e,Dve).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){kn(rp,this,Ae(Qr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Dj,Ae(Qr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Dj,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return Ae(Qr,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);Ae(Qr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;kn(Ka,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(Ae(Ka,this)),r=i.col;if(r<0)return;const o=ni(Ae(Ka,this)),a=Ae(Ka,this).getBoundingClientRect(),u=r<n.getSetting("fixedColumnsStart");let h;u&&(h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ae(Ka,this),i.row,i.col)),h||(h=n.wtOverlays.topOverlay.getRelativeCellPosition(Ae(Ka,this),i.row,i.col)),kn(Hy,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),kn(Xr,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();U(g,p=>{const w=p.getTopStartCorner().col,y=p.getBottomEndCorner().col;Ve(w,y,b=>{Ae(Xr,this).includes(b)||Ae(Xr,this).push(b)})})}Ae(Xr,this).includes(Ae(Hy,this))||kn(Xr,this,[Ae(Hy,this)]),kn(Iy,this,h.start-6),kn(rf,this,parseInt(a.width,10)),Ae(wr,this).style.top=`${h.top}px`,Ae(wr,this).style[this.inlineDir]=`${Ae(Iy,this)+Ae(rf,this)}px`,Ae(wr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(Ae(wr,this))}refreshHandlePosition(){Ae(wr,this).style[this.inlineDir]=`${Ae(Iy,this)+Ae(ub,this)}px`}setupGuidePosition(){const e=parseInt(ni(Ae(wr,this)),10),n=parseInt(Ae(wr,this).style.top,10)+e,i=this.hot.view.getTableHeight();pe(Ae(wr,this),"active"),pe(Ae(za,this),"active"),Ae(za,this).style.top=`${n}px`,this.refreshGuidePosition(),Ae(za,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(Ae(za,this))}refreshGuidePosition(){Ae(za,this).style[this.inlineDir]=Ae(wr,this).style[this.inlineDir]}hideHandleAndGuide(){Ue(Ae(wr,this),"active"),Ue(Ae(za,this),"active")}checkIfColumnHeader(e){const n=Qc(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",Ae(ea,this),i,!0);o!==void 0&&kn(ea,this,o),this.setManualSize(i,Ae(ea,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ae(ea,this),i,!0),r&&e()};Ae(np,this)>=2&&(Ae(Xr,this).length>1?(U(Ae(Xr,this),r=>{n(r)}),e()):U(Ae(Xr,this),r=>{n(r,!0)})),kn(np,this,0),kn(ip,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>ns(ks,this,Ove).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>ns(ks,this,xve).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>ns(ks,this,Ave).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ns(ks,this,Hve).call(this)),this.eventManager.addEventListener(Ae(wr,this),"contextmenu",()=>ns(ks,this,Ive).call(this))}destroy(){super.destroy()}}function Mve(){const t=this.hot.getSettings()[lb],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{Ae(Qr,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{Ae(Qr,this).setValueAtIndex(i,n)})},!0),kn(rp,this,t)):t===!0&&Array.isArray(Ae(rp,this))&&this.hot.batchExecution(()=>{Ae(rp,this).forEach((n,i)=>{Ae(Qr,this).setValueAtIndex(i,n)})},!0)}function Ove(t){if(!yz(t.target)&&Ae(cb,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(Ae(oh,this)||this.setupHandlePosition(e))}}function xve(t){t.target.parentNode===this.hot.rootElement&&ze(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Ae(Ka,this)),this.setupGuidePosition(),kn(oh,this,!0),Ae(ip,this)===null&&(kn(ip,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ae(ip,this))),kn(np,this,Ae(np,this)+1),this.startX=t.pageX,kn(ea,this,Ae(rf,this)))}function Ave(t){if(Ae(oh,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();kn(ub,this,Ae(rf,this)+e),U(Ae(Xr,this),n=>{kn(ea,this,this.setManualSize(n,Ae(ub,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Hve(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",Ae(ea,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ae(ea,this),n,!1)};Ae(oh,this)&&(this.hideHandleAndGuide(),kn(oh,this,!1),Ae(ea,this)!==Ae(rf,this)&&(Ae(Xr,this).length>1?(U(Ae(Xr,this),i=>{e(i)}),t()):U(Ae(Xr,this),i=>{e(i,!0)})),this.setupHandlePosition(Ae(Ka,this)))}function Ive(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ae(wr,this)),this.hot.rootElement.removeChild(Ae(za,this)),kn(oh,this,!1),kn(cb,this,!0),this.hot._registerImmediate(()=>{kn(cb,this,!1)})}function Pve(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=Ae(Qr,this).getValueAtIndex(i);this.hot.getSettings()[lb]&&r&&(n=r)}return n}function Nve(t,e){const n=Ae(Qr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Dve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function l1(t,e,n){return(e=Lve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lve(t){var e=kve(t,"string");return typeof e=="symbol"?e:e+""}function kve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u1=0,Lj=1,kj=2,Od="px";let W3=class{constructor(e){l1(this,"hot",void 0),l1(this,"_element",null),l1(this,"state",u1),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=kj}build(){this.state===u1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Lj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=u1}isAppended(){return this.state===kj}isBuilt(){return this.state>=Lj}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Od),n!==void 0&&(this._element.style.left=n+Od)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Od),n&&(this._element.style.height=n+Od)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Od),n&&(this._element.style.marginLeft=n+Od)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Vve="ht__manualRowMove--backlight";class $ve extends W3{build(){super.build(),pe(this._element,Vve)}}const Bve="ht__manualRowMove--guideline";class Fve extends W3{build(){super.build(),pe(this._element,Bve)}}function Wve(t,e){j3(t,e),e.add(t)}function xd(t,e,n){j3(t,e),e.set(t,n)}function j3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gc(t,e,n){return t.set(hu(t,e),n),n}function et(t,e){return t.get(hu(t,e))}function hu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeRowMove");xe.getSingleton().register("afterRowMove");const c1="manualRowMove",jve=140,Vj="ht__manualRowMove",hb="show-ui",NO="on-moving--rows",DO="after-selection--rows";var Ji=new WeakMap,fu=new WeakMap,ol=new WeakMap,bu=new WeakMap,Mr=new WeakMap,Py=new WeakMap,Oc=new WeakSet;class Uve extends It{constructor(){super(...arguments),Wve(this,Oc),xd(this,Ji,new $ve(this.hot)),xd(this,fu,new Fve(this.hot)),xd(this,ol,[]),xd(this,bu,void 0),xd(this,Mr,{}),xd(this,Py,void 0)}static get PLUGIN_KEY(){return c1}static get PLUGIN_PRIORITY(){return jve}isEnabled(){return!!this.hot.getSettings()[c1]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return hu(Oc,e,zve).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return hu(Oc,e,Gve).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>hu(Oc,this,Kve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return hu(Oc,e,Xve).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),pe(this.hot.rootElement,Vj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,Vj),this.unregisterEvents(),et(Ji,this).destroy(),et(fu,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=et(Py,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Gc(Py,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const a=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,a),a}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Gc(Py,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||o||a||u)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=xr(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const a=i.getRenderableFromVisualIndex(o);a!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[c1];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),a=Math.max(i.row,r.row);return Ve(o,a,u=>{n.push(u)}),n}refreshPositions(){const e=et(Mr,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=et(Mr,this).TD,u=this.hot.rootElement,h=Wi(u),d=pp(u),g=o.holder.scrollTop,p=this.hot.rootWindow!==d?d.scrollTop:0,w=h.top-p,y=et(Mr,this).eventPageY-w+g,b=o.hider.offsetHeight,T=o.TBODY.offsetTop,M=et(Ji,this).getOffset().top,I=et(Ji,this).getSize().height,_=a.offsetHeight/2,N=a.offsetHeight;let k=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const $=y>=k+_;this.isFixedRowTop(e.row)&&(k+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?et(Mr,this).row=n>0?n-1:n:$?(et(Mr,this).row=e.row+1,k+=e.row===0?N-1:N):et(Mr,this).row=e.row;let L=y,F=k;y+I+M>=b?L=b-I-M:y+M<T&&(L=T+Math.abs(M)),k>=b-1&&(F=b-1),et(Ji,this).setPosition(L),et(fu,this).setPosition(F)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>hu(Oc,this,Yve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>hu(Oc,this,qve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){et(Ji,this).build(),et(fu,this).build()}destroy(){et(Ji,this).destroy(),et(fu,this).destroy(),super.destroy()}}function zve(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeLast();if(!u||!a||et(bu,this)||t.button!==0){Gc(bu,this,!1),et(ol,this).length=0,Ue(this.hot.rootElement,[NO,hb]);return}const h=et(fu,this).isBuilt()&&!et(fu,this).isAppended(),d=et(Ji,this).isBuilt()&&!et(Ji,this).isAppended();h&&d&&(et(fu,this).appendTo(r.hider),et(Ji,this).appendTo(r.hider));const{from:g,to:p}=u,w=Math.min(g.row,p.row),y=Math.max(g.row,p.row);if(e.col<0&&e.row>=w&&e.row<=y){i.row=!0,Gc(bu,this,!0),et(Mr,this).eventPageY=t.pageY,et(Mr,this).coords=e,et(Mr,this).TD=n,Gc(ol,this,this.prepareRowsToMoving());const b=r.holder.scrollLeft+o.getRowHeaderWidth(),T=this.getRowsHeight(w,e.row-1)+(t.clientY-n.getBoundingClientRect().top);et(Ji,this).setPosition(null,b),et(Ji,this).setSize(r.hider.offsetWidth-b,this.getRowsHeight(w,y)),et(Ji,this).setOffset(-T,null),pe(this.hot.rootElement,NO),this.refreshPositions()}else Ue(this.hot.rootElement,DO),Gc(bu,this,!1),et(ol,this).length=0}function Yve(t){et(bu,this)&&(et(Mr,this).eventPageY=t.pageY,this.refreshPositions())}function Gve(t,e,n,i){!this.hot.getSelectedRangeLast()||!et(bu,this)||(et(ol,this).indexOf(e.row)>-1?Ue(this.hot.rootElement,hb):pe(this.hot.rootElement,hb),i.row=!0,i.column=!0,i.cell=!0,et(Mr,this).coords=e,et(Mr,this).TD=n)}function qve(){const t=et(Mr,this).row,e=et(ol,this).length;if(Gc(bu,this,!1),Ue(this.hot.rootElement,[NO,hb,DO]),this.hot.selection.isSelectedByRowHeader()&&pe(this.hot.rootElement,DO),e<1||t===void 0)return;const n=et(ol,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(et(ol,this),t);if(et(ol,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(i),a=o+e-1;this.hot.selectRows(o,a)}}function Kve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;et(Ji,this).setPosition(null,i),et(Ji,this).setSize(t.hider.offsetWidth-i)}function Xve(){this.moveBySettingsOrLoad()}function Zve(t,e){U3(t,e),e.add(t)}function ki(t,e,n){U3(t,e),e.set(t,n)}function U3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e,n){return t.set(Xa(t,e),n),n}function Oe(t,e){return t.get(Xa(t,e))}function Xa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const db="manualRowResize",Qve=30,$j="manualRowHeights";var qs=new WeakMap,Ny=new WeakMap,Zr=new WeakMap,op=new WeakMap,gu=new WeakMap,hI=new WeakMap,of=new WeakMap,Dy=new WeakMap,Ki=new WeakMap,zs=new WeakMap,sh=new WeakMap,fb=new WeakMap,sp=new WeakMap,ap=new WeakMap,os=new WeakMap,lp=new WeakMap,nu=new WeakSet;class Jve extends It{static get PLUGIN_KEY(){return db}static get PLUGIN_PRIORITY(){return Qve}constructor(e){super(e),Zve(this,nu),ki(this,qs,null),ki(this,Ny,null),ki(this,Zr,[]),ki(this,op,null),ki(this,gu,null),ki(this,hI,null),ki(this,of,null),ki(this,Dy,null),ki(this,Ki,this.hot.rootDocument.createElement("DIV")),ki(this,zs,this.hot.rootDocument.createElement("DIV")),ki(this,sh,!1),ki(this,fb,!1),ki(this,sp,0),ki(this,ap,null),ki(this,os,void 0),ki(this,lp,void 0),pe(Oe(Ki,this),"manualRowResizer"),pe(Oe(zs,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[db]}enablePlugin(){this.enabled||(Tn(os,this,new Iu),Oe(os,this).addLocalHook("init",()=>Xa(nu,this,swe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Oe(os,this)),this.addHook("modifyRowHeight",(e,n)=>Xa(nu,this,owe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Tn(lp,this,Oe(os,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",$j,Oe(os,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",$j,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.view.getDefaultRowHeight());return Oe(os,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return Oe(op,this)}setupHandlePosition(e){Tn(qs,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(Oe(qs,this)),o=r.row;if(o<0)return;const a=zn(Oe(qs,this)),u=Oe(qs,this).getBoundingClientRect(),h=o<i.getSetting("fixedRowsTop"),d=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let g;h?g=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Oe(qs,this),r.row,r.col):d&&(g=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Oe(qs,this),r.row,r.col)),g||(g=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Oe(qs,this),r.row,r.col)),Tn(Ny,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Tn(Zr,this,[]);const p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&p){const w=this.hot.getSelectedRange();U(w,y=>{const b=y.getTopStartCorner().row,T=y.getBottomStartCorner().row;Ve(b,T,M=>{Oe(Zr,this).includes(M)||Oe(Zr,this).push(M)})})}Oe(Zr,this).includes(Oe(Ny,this))||Tn(Zr,this,[Oe(Ny,this)]),Tn(Dy,this,g.top-6),Tn(of,this,parseInt(u.height,10)),Oe(Ki,this).style.top=`${Oe(Dy,this)+Oe(of,this)}px`,Oe(Ki,this).style[this.inlineDir]=`${g.start}px`,Oe(Ki,this).style.width=`${a}px`,this.hot.rootElement.appendChild(Oe(Ki,this))}refreshHandlePosition(){Oe(Ki,this).style.top=`${Oe(Dy,this)+Oe(op,this)}px`}setupGuidePosition(){const e=parseInt(zn(Oe(Ki,this)),10),n=parseInt(Oe(Ki,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();pe(Oe(Ki,this),"active"),pe(Oe(zs,this),"active"),Oe(zs,this).style.top=Oe(Ki,this).style.top,Oe(zs,this).style[this.inlineDir]=`${n}px`,Oe(zs,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Oe(zs,this))}refreshGuidePosition(){Oe(zs,this).style.top=Oe(Ki,this).style.top}hideHandleAndGuide(){Ue(Oe(Ki,this),"active"),Ue(Oe(zs,this),"active")}checkIfRowHeader(e){const n=Qc(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&Oe(gu,this)<n?n:Oe(gu,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&Tn(gu,this,o),this.setManualSize(i,Oe(gu,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};Oe(sp,this)>=2&&(Oe(Zr,this).length>1?(U(Oe(Zr,this),r=>{n(r)}),e()):U(Oe(Zr,this),r=>{n(r,!0)})),Tn(sp,this,0),Tn(ap,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Xa(nu,this,ewe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Xa(nu,this,twe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Xa(nu,this,nwe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Xa(nu,this,iwe).call(this)),this.eventManager.addEventListener(Oe(Ki,this),"contextmenu",()=>Xa(nu,this,rwe).call(this))}destroy(){super.destroy()}}function ewe(t){if(!yz(t.target)&&Oe(fb,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Oe(sh,this)||this.setupHandlePosition(e))}}function twe(t){ze(t.target,"manualRowResizer")&&(this.setupHandlePosition(Oe(qs,this)),this.setupGuidePosition(),Tn(sh,this,!0),Oe(ap,this)===null&&(Tn(ap,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Oe(ap,this))),Tn(sp,this,Oe(sp,this)+1),Tn(hI,this,t.pageY),Tn(gu,this,Oe(of,this)))}function nwe(t){Oe(sh,this)&&(Tn(op,this,Oe(of,this)+(t.pageY-Oe(hI,this))),U(Oe(Zr,this),e=>{Tn(gu,this,this.setManualSize(e,Oe(op,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function iwe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};Oe(sh,this)&&(this.hideHandleAndGuide(),Tn(sh,this,!1),Oe(gu,this)!==Oe(of,this)&&(Oe(Zr,this).length>1?(U(Oe(Zr,this),i=>{e(i)}),t()):U(Oe(Zr,this),i=>{e(i,!0)})),this.setupHandlePosition(Oe(qs,this)))}function rwe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Oe(Ki,this)),this.hot.rootElement.removeChild(Oe(zs,this)),Tn(sh,this,!1),Tn(fb,this,!0),this.hot._registerImmediate(()=>{Tn(fb,this,!1)})}function owe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=Oe(os,this).getValueAtIndex(i);this.hot.getSettings()[db]&&r&&(n=r)}return n}function swe(){const t=this.hot.getSettings()[db],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{Oe(os,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{Oe(os,this).setValueAtIndex(i,n)}),Tn(lp,this,t)):t===!0&&Array.isArray(Oe(lp,this))&&Oe(lp,this).forEach((n,i)=>{Oe(os,this).setValueAtIndex(i,n)})},!0)}var Bj={},Fj;function awe(){if(Fj)return Bj;Fj=1;var t=zb();return t("flatMap"),Bj}awe();var Wj={},jj={},h1,Uj;function lwe(){if(Uj)return h1;Uj=1;var t=oi(),e=ai(),n=sa(),i=XO();return h1=function(r,o){(!o||typeof r!="string")&&e(r);var a=i(r);return n(e(a!==void 0?t(a,r):r))},h1}var zj;function uwe(){if(zj)return jj;zj=1;var t=rn(),e=oi(),n=Or(),i=ai(),r=sa(),o=lwe(),a=JO(),u=eo(),h=Ou(),d=Au(),g=!h&&d("flatMap",TypeError),p=a(function(){for(var w=this.iterator,y=this.mapper,b,T;;){if(T=this.inner)try{if(b=i(e(T.next,T.iterator)),!b.done)return b.value;this.inner=null}catch(M){u(w,"throw",M)}if(b=i(e(this.next,w)),this.done=!!b.done)return;try{this.inner=o(y(b.value,this.counter++),!1)}catch(M){u(w,"throw",M)}}});return t({target:"Iterator",proto:!0,real:!0,forced:h||g},{flatMap:function(y){i(this);try{n(y)}catch(b){u(this,"throw",b)}return g?e(g,this,y):new p(r(this),{mapper:y,inner:null})}}),jj}var Yj;function cwe(){return Yj||(Yj=1,uwe()),Wj}cwe();function hwe(t,e,n){dwe(t,e),e.set(t,n)}function dwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xc(t,e,n){return(e=fwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fwe(t){var e=gwe(t,"string");return typeof e=="symbol"?e:e+""}function gwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gj(t,e){return t.get(z3(t,e))}function Ly(t,e,n){return t.set(z3(t,e),n),n}function z3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ac=new WeakMap;class Ks{constructor(e,n,i,r,o,a){xc(this,"row",void 0),xc(this,"col",void 0),xc(this,"rowspan",void 0),xc(this,"colspan",void 0),xc(this,"removed",!1),xc(this,"cellCoordsFactory",void 0),xc(this,"cellRangeFactory",void 0),hwe(this,Ac,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return $t`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Ly(Ac,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",u=Math.min(n,r),h=Math.max(n,r),d=this[a],g=this[a]+this[o]-1;if(d>=n&&(this[a]+=i),i>0)n<=g&&n>d&&(this[o]+=i);else if(i<0){if(u<=d&&h>=g)return this.removed=!0,Ly(Ac,this,null),!1;if(d>=u&&d<=h){const p=h-d+1,w=Math.abs(i)-p;this[a]-=w+i,this[o]-=p}else if(d<=u&&g>=h)this[o]+=i;else if(d<=u&&g>=u&&g<h){const p=g-u+1;this[o]-=p}}return Ly(Ac,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return Gj(Ac,this)||Ly(Ac,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),Gj(Ac,this)}}function mwe(t,e){pwe(t,e),e.add(t)}function pwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ky(t,e,n){return(e=vwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vwe(t){var e=wwe(t,"string");return typeof e=="symbol"?e:e+""}function wwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iu=new WeakSet;class gb{constructor(e){mwe(this,iu),ky(this,"plugin",void 0),ky(this,"mergedCells",[]),ky(this,"mergedCellsMatrix",new Map),ky(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return $t`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),a=this.mergedCells.length;let u=!1;for(let h=0;h<a;h++){const d=this.mergedCells[h],{row:g,col:p,rowspan:w,colspan:y}=d;if(g>=n&&g+w-1<=r&&p>=i&&p+y-1<=o){u=d;break}}return u}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:a,colspan:u,rowspan:h}=r;for(let d=o;d<o+h;d++)for(let g=a;g<a+u;g++)n.add(`r${d},c${g}`)}),e.filter(r=>{const{row:o,col:a,colspan:u,rowspan:h}=r,d=new Set;let g=!1;for(let p=o;p<o+h;p++){for(let w=a;w<a+u;w++){const y=`r${p},c${w}`;if(n.has(y)){Nt(gb.IS_OVERLAPPING_WARNING(r)),g=!0;break}d.add(y)}if(g)break}return g||n.add(...d),!g})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),u=[];for(let h=i;h<=o;h++)for(let d=r;d<=a;d++){const g=this.get(h,d);g&&(n||!n&&g.row===h&&g.col===d)&&u.push(g)}return u}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,a=e.colspan,u=new Ks(i,r,o,a,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,r),d=n?!1:this.isOverlapping(u);return!h&&!d?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),Hc(iu,this,qj).call(this,u),u):(d&&Nt(gb.IS_OVERLAPPING_WARNING(u)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Hc(iu,this,ywe).call(this,i),i):!1}clear(){U(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;Ve(n,n+r,a=>{Ve(i,i+o,u=>{const h=this.hot.getCell(a,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:a,colspan:u}=i,h=this.hot.view.getActiveOverlayName(),d=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),p=Et(d,r,r+a-1),w=Et(g,o,o+u-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(p,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(w,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Hc(iu,this,Vy).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Hc(iu,this,Vy).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Hc(iu,this,Vy).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Hc(iu,this,Vy).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(a=>{a.shift(r,n),a.removed&&o.push(a)}),o.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{Hc(iu,this,qj).call(this,a)})}}function Vy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let a=r.row;n===1?a<=o.row:a>=o.row;a+=n)for(let u=r.col;n===1?u<=o.col:u>=o.col;u+=n){const h=e==="row"?a:u,d=this.get(a,u);let g=h;d&&(g=n===1?d[e]+d[`${e}span`]-1:d[e]),i.has(h)||i.set(h,new Set),i.get(h).add(g)}return Array.from(new Set(Array.from(i.entries()).filter(a=>{let[,u]=a;return u.size===1}).flatMap(a=>{let[,u]=a;return Array.from(u)})))}function qj(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function ywe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function d1(t,e,n){return(e=Cwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cwe(t){var e=bwe(t,"string");return typeof e=="symbol"?e:e+""}function bwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Swe{constructor(e){d1(this,"plugin",void 0),d1(this,"mergedCellsCollection",void 0),d1(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),a=this.getAutofillSize(e,n,i),[u,h,d,g]=e,w=["up","down"].indexOf(i)>-1?d-u+1:g-h+1,y=Math.floor(a/w)*w,b=a-y,T=this.getFarthestCollection(e,n,i,r);if(T){if(i==="down"){const M=T.row+T.rowspan-u-b;o[2]+M>=this.plugin.hot.countRows()?o[2]-=b:o[2]+=b?M:0}else if(i==="right"){const M=T.col+T.colspan-h-b;o[3]+M>=this.plugin.hot.countCols()?o[3]-=b:o[3]+=b?M:0}else if(i==="up"){const M=d-b-T.row+1;o[0]+M<0?o[0]+=b:o[0]-=b?M:0}else if(i==="left"){const M=g-b-T.col+1;o[1]+M<0?o[1]+=b:o[1]-=b?M:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:a,dragArea:o,cycleLength:w}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),ii(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,a,u]=e,[h,d,g,p]=n;switch(i){case"up":return r-h;case"down":return g-a;case"left":return o-d;case"right":return p-u;default:return null}}getDragArea(e,n,i){const[r,o,a,u]=e,[h,d,g,p]=n;switch(i){case"up":return[h,d,r-1,u];case"down":{const w=this.mergedCellsCollection.get(g,u),y=w?w.rowspan-1:0;return[a+1,o,g+y,u]}case"left":return[h,d,a,o-1];case"right":{const w=this.mergedCellsCollection.get(g,u),y=w?w.colspan-1:0;return[r,u+y,g,p]}default:return null}}getFarthestCollection(e,n,i,r){const[o,a,u,h]=e,d=["up","down"].indexOf(i)>-1,g=d?u:h,p=d?o:a,w=this.getAutofillSize(e,n,i),y=d?u-o+1:h-a+1,b=Math.floor(w/y)*y,T=w-b;let M=null,I=null,_=null;switch(i){case"up":M="includesVertically",_=g-T+1;break;case"left":M="includesHorizontally",_=g-T+1;break;case"down":M="includesVertically",_=p+T-1;break;case"right":M="includesHorizontally",_=p+T-1;break}return U(r,N=>{N[M](_)&&N.isFarther(I,i)&&(I=N)}),I}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(d,g)=>{switch(r){case"up":return d.row-g>=n.from.row;case"down":return d.row+d.rowspan-1+g<=n.to.row;case"left":return d.col-g>=n.from.column;case"right":return d.col+d.colspan-1+g<=n.to.column;default:return null}};let a=0,u=null,h=1;do for(let d=0;d<i.length;d+=1){if(u=i[d],a=h*this.currentFillData.cycleLength,o(u,a))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:u.row-a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:u.row+a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col-a,colspan:u.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col+a,colspan:u.colspan},!0);break}d===i.length-1&&(h+=1)}while(o(u,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return U(e,r=>{const o=r[0],a=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,a,u,h]=r,d=this.plugin.hot._createCellCoords(o,a),g=this.plugin.hot._createCellCoords(u,h),p=this.plugin.hot._createCellRange(d,d,g);if(this.mergedCellsCollection.getWithinRange(p,!0).length===0)return!1;const y=this.mergedCellsCollection.getWithinRange(p,!1);return y.length===0?!0:i==="up"||i==="down"?!y.every(b=>{let{colspan:T}=b;return T===p.getWidth()}):!y.every(b=>{let{rowspan:T}=b;return T===p.getHeight()})}}function f1(t,e,n){return(e=Rwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rwe(t){var e=Ewe(t,"string");return typeof e=="symbol"?e:e+""}function Ewe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Twe{constructor(e){f1(this,"plugin",void 0),f1(this,"hot",void 0),f1(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),u=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const g=this.plugin.mergedCellsCollection.get(e,n);if(!g)return;const p=g.getLastRow(),w=g.getLastColumn();if(o<=g.row&&a<=g.col&&u>=p&&h>=w)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let a=0;a<n.length;a+=1)o[a]=n[a].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function _we(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(RA)}return this.getTranslatedPhrase(SA)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ks.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function up(t,e,n){return(e=Mwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mwe(t){var e=Owe(t,"string");return typeof e=="symbol"?e:e+""}function Owe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kj{constructor(e){up(this,"data",void 0),up(this,"next",null),up(this,"prev",null),this.data=e}}class $y{constructor(){up(this,"first",null),up(this,"last",null)}push(e){const n=new Kj(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new Kj(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function xwe(t,e){Y3(t,e),e.add(t)}function Ic(t,e,n){Y3(t,e),e.set(t,n)}function Y3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(mb(t,e))}function jr(t,e,n){return t.set(mb(t,e),n),n}function mb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vs=new WeakMap,$s=new WeakMap,Bs=new WeakMap,Fs=new WeakMap,LO=new WeakMap,By=new WeakMap,Fy=new WeakMap,g1=new WeakSet;class Awe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;xwe(this,g1),Ic(this,Vs,new $y),Ic(this,$s,new $y),Ic(this,Bs,null),Ic(this,Fs,null),Ic(this,LO,null),Ic(this,By,null),Ic(this,Fy,null),jr(LO,this,n),jr(By,this,i),jr(Fy,this,r)}getCurrentVerticalNode(){return Vt(Fs,this).data}getFirstVerticalNode(){return Vt($s,this).first.data}getNextVerticalNode(){return Vt(Fs,this).next.data}getPrevVerticalNode(){return Vt(Fs,this).prev.data}getCurrentHorizontalNode(){return Vt(Bs,this).data}getFirstHorizontalNode(){return Vt(Vs,this).first.data}getNextHorizontalNode(){return Vt(Bs,this).next.data}getPrevHorizontalNode(){return Vt(Bs,this).prev.data}setPrevNodeAsActive(){jr(Fs,this,Vt(Fs,this).prev),jr(Bs,this,Vt(Bs,this).prev)}setNextNodeAsActive(){jr(Fs,this,Vt(Fs,this).next),jr(Bs,this,Vt(Bs,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;jr(Vs,this,new $y);for(let a=n.row;a<=i.row;a++)if(!Vt(By,this).isHidden(a))for(let u=n.col;u<=i.col;u++){if(Vt(Fy,this).isHidden(u))continue;const h=mb(g1,this,Xj).call(this,e,Vt(Vs,this),r,a,u);h&&jr(Bs,this,h)}Vt(Vs,this).first&&(Vt(Vs,this).first.prev=Vt(Vs,this).last,Vt(Vs,this).last.next=Vt(Vs,this).first);const o=new WeakSet;jr($s,this,new $y);for(let a=n.col;a<=i.col;a++)if(!Vt(Fy,this).isHidden(a))for(let u=n.row;u<=i.row;u++){if(Vt(By,this).isHidden(u))continue;const h=mb(g1,this,Xj).call(this,e,Vt($s,this),o,u,a);h&&jr(Fs,this,h)}Vt($s,this).first&&(Vt($s,this).first.prev=Vt($s,this).last,Vt($s,this).last.next=Vt($s,this).first)}setActiveNode(e,n){return Vt(Vs,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:a,colEnd:u}=i.data;if(e>=r&&e<=o&&n>=a&&n<=u)return jr(Bs,this,i),!1}),Vt($s,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:a,colEnd:u}=i.data;if(e>=r&&e<=o&&n>=a&&n<=u)return jr(Fs,this,i),!1}),this}}function Xj(t,e,n,i,r){const o=t.getTopStartCorner(),a=t.getBottomEndCorner(),u=t.highlight.clone().normalize(),h=Vt(LO,this).call(this,i,r);if(h&&n.has(h))return null;const d={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(h){if(n.add(h),h.row<o.row||h.row+h.rowspan-1>a.row||h.col<o.col||h.col+h.colspan-1>a.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const g=e.push(d);return i===u.row&&r===u.col||h&&u.row>=h.row&&u.row<=h.row+h.rowspan-1&&u.col>=h.col&&u.col<=h.col+h.colspan-1?g:null}function G3(t,e,n){const{view:i,rowIndexMapper:r}=t,o=i.getStylesHandler(),a=i.getDefaultRowHeight();let u=0;for(let d=e;d<e+n;d++)if(!r.isHidden(d)){var h;u+=(h=t.getRowHeight(d))!==null&&h!==void 0?h:a,d===0&&!o.isClassicTheme()&&(u+=1)}return u}function Hwe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function o(){}function a(u,h,d){const g=t.mergedCellsCollection.get(h,d);if(!dt(g)){u.removeAttribute("rowspan"),u.removeAttribute("colspan"),kC()&&r.has(h)&&!e.getSettings().rowHeaders&&(u.style.height=`${r.get(h)}px`,r.delete(h)),u.style.display="";return}const{row:p,col:w,colspan:y,rowspan:b}=g,[T,M]=t.translateMergedCellToRenderable(p,b,w,y),I=t.getSetting("virtualized");if(kC()&&w===0&&!e.getSettings().rowHeaders){const G=G3(e,p,b);r.set(h,G/b)}const _=n.getRenderableFromVisualIndex(h),N=i.getRenderableFromVisualIndex(d),k=T-_+1,$=M-N+1;let L=n.getNearestNotHiddenIndex(p,1),F=i.getNearestNotHiddenIndex(w,1);if(I){const G=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(G)||(L=Math.max(L,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(G)||(F=Math.max(F,e.getFirstRenderedVisibleColumn()))}const he=Math.min(b,k),le=Math.min(y,$);L===h&&F===d?(u.setAttribute("rowspan",he),u.setAttribute("colspan",le)):(u.removeAttribute("rowspan"),u.removeAttribute("colspan"),u.style.display="none")}return{before:o,after:a}}function Iwe(t,e){q3(t,e),e.add(t)}function Wy(t,e,n){q3(t,e),e.set(t,n)}function q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m1(t,e,n){return(e=Pwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pwe(t){var e=Nwe(t,"string");return typeof e=="symbol"?e:e+""}function Nwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ip(t,e,n){return t.set(Wt(t,e),n),n}function nn(t,e){return t.get(Wt(t,e))}function Wt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}xe.getSingleton().register("beforeMergeCells");xe.getSingleton().register("afterMergeCells");xe.getSingleton().register("beforeUnmergeCells");xe.getSingleton().register("afterUnmergeCells");const kO="mergeCells",Dwe=150,Zj=kO;var _o=new WeakMap,Mo=new WeakMap,ta=new WeakMap,Qj=new WeakMap,Kt=new WeakSet;class Lwe extends It{constructor(){super(...arguments),Iwe(this,Kt),m1(this,"mergedCellsCollection",null),m1(this,"autofillCalculations",null),m1(this,"selectionCalculations",null),Wy(this,_o,null),Wy(this,Mo,{row:0,col:0}),Wy(this,ta,new Awe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Wy(this,Qj,Hwe(this))}static get PLUGIN_KEY(){return kO}static get PLUGIN_PRIORITY(){return Dwe}static get DEFAULT_SETTINGS(){return{[fG]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[kO]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new gb(this),this.autofillCalculations=new Swe(this),this.selectionCalculations=new Twe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,kwe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,$we).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Bwe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Fwe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Wwe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,e2).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,e2).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Uwe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,zwe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Ywe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Jj).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Jj).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Vwe).call(e,...i)}),this.addHook("afterRenderer",function(){return nn(Qj,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,jwe).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Gwe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,qwe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Kwe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Xwe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Zwe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Qwe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,Jwe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,eye).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,tye).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,nye).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,iye).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,rye).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,oye).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wt(Kt,e,sye).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!Ez())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let a=r+1;a<r+o;a++)n.push(a)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(r);a&&(a.style.background=NC(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=NC(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ks.containsNegativeValues(e)?(Nt(Ks.NEGATIVE_VALUES_WARNING(e)),!1):Ks.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Nt(Ks.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ks.isSingleCell(e)?(Nt(Ks.IS_SINGLE_CELL(e)),!1):Ks.containsZeroSpan(e)?(Nt(Ks.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:a,rowspan:u,colspan:h}=r,d=this.hot._createCellCoords(o,a),g=this.hot._createCellCoords(o+u-1,a+h-1),p=this.hot._createCellRange(d,d,g);this.mergeRange(p,!0,!0);for(let w=o;w<o+u;w++)for(let y=a;y<a+h;y++)(w!==o||y!==a)&&i.push([w,y,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},u=[];let h=null;return this.canMergeRange(a,n)?(this.hot.runHooks("beforeMergeCells",e,n),Ve(0,a.rowspan-1,g=>{Ve(0,a.colspan-1,p=>{let w=null;u[g]||(u[g]=[]),g===0&&p===0?w=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+g,a.col+p,"hidden",!0),u[g][p]=w})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,n)?(i?h=[a.row,a.col,u]:this.hot.populateFromArray(a.row,a.col,u,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,n),h):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),U(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),Ve(0,r.rowspan-1,o=>{Ve(0,r.colspan-1,a=>{this.hot.removeCellMeta(r.row+o,r.col+a,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+a,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:Zj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Zj)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(r,o);if(dt(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.row,1));if(u<e.startRow){e.startRow=u,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(r,o);if(dt(a)){const u=a.row+a.rowspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(o,r);if(dt(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.col,1));if(u<e.startColumn){e.startColumn=u,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(o,r);if(dt(a)){const u=a.col+a.colspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let u,h;n===0?u=o.getNearestNotHiddenIndex(e,1):u=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?h=a.getNearestNotHiddenIndex(i,1):h=a.getNearestNotHiddenIndex(i+r-1,-1);const d=e>=0?o.getRenderableFromVisualIndex(u):e,g=i>=0?a.getRenderableFromVisualIndex(h):i;return[d,g]}}function kwe(){this.generateFromSettings(),this.hot.render()}function Vwe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function $we(t){nn(Mo,this).row=t.row,nn(Mo,this).col=t.col}function Bwe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;nn(_o,this)&&(r.getRenderableFromVisualIndex(nn(_o,this).row)!==null&&(n.row=nn(_o,this).row),i.getRenderableFromVisualIndex(nn(_o,this).col)!==null&&(n.col=nn(_o,this).col),Ip(_o,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const a=o.col,u=o.col+o.colspan-1;if(t.col<0){const g=n.col>=a&&n.col<=u?a-1:u,p=i.getNearestNotHiddenIndex(g,-1);p===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(p,n.col)-1,1)}else if(t.col>0){const g=n.col>=a&&n.col<=u?u+1:a,p=i.getNearestNotHiddenIndex(g,1);p===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,p)-1,1)}const h=o.row,d=o.row+o.rowspan-1;if(t.row<0){const g=n.row>=h&&n.row<=d?h-1:d,p=r.getNearestNotHiddenIndex(g,-1);p===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(p,n.row)-1,1)}else if(t.row>0){const g=n.row>=h&&n.row<=d?d+1:h,p=r.getNearestNotHiddenIndex(g,1);p===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,p)-1,1)}}function Fwe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,a=(u,h)=>{n.expand(this.hot._createCellCoords(u,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(u=n.getTopStartCorner().col);const h=r.getNearestNotHiddenIndex(u,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(t.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(u=n.getBottomEndCorner().col);const h=r.getNearestNotHiddenIndex(u,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(t.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(u=n.getTopStartCorner().row);const h=o.getNearestNotHiddenIndex(u,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(t.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(u=n.getBottomStartCorner().row);const h=o.getNearestNotHiddenIndex(u,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function Wwe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Ip(_o,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Ip(_o,this,e.clone()),n&&e.assign(n)}function Jj(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:a,colspan:u,rowspan:h}=r,d=o,g=a,p=o+h-1,w=a+u-1;if(i==="render"&&this.getSetting("virtualized")){const y=this.hot.view.getActiveOverlayName(),b=["top","top_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleRow(),T=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleColumn();return[Et(b,d,p),Et(T,g,w),Et(this.hot.getLastRenderedVisibleRow(),d,p),Et(this.hot.getLastRenderedVisibleColumn(),g,w)]}return[d,g,p,w]}function jwe(t){t.items.push({name:"---------"},_we(this))}function e2(){Ip(_o,this,null)}function Uwe(){if(nn(_o,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=nn(_o,this).clone().normalize();nn(ta,this).setActiveNode(i.row,i.col),nn(Mo,this).row>0||nn(Mo,this).col>0?nn(ta,this).setPrevNodeAsActive():(n==="E-W"&&nn(Mo,this).col<0||e==="S-N"&&nn(Mo,this).row<0)&&nn(ta,this).setNextNodeAsActive()}function zwe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let o=null,a=null;if(nn(Mo,this).col<0){const{rowEnd:u,colEnd:h}=nn(ta,this).getPrevHorizontalNode();a=i.getNearestNotHiddenIndex(h,-1),o=r.getNearestNotHiddenIndex(u,-1)}else if(nn(Mo,this).col>0){const{rowStart:u,colStart:h}=nn(ta,this).getNextHorizontalNode();a=i.getNearestNotHiddenIndex(h,1),o=r.getNearestNotHiddenIndex(u,1)}else if(nn(Mo,this).row<0){const{rowEnd:u,colEnd:h}=nn(ta,this).getPrevVerticalNode();a=i.getNearestNotHiddenIndex(h,-1),o=r.getNearestNotHiddenIndex(u,-1)}else if(nn(Mo,this).row>0){const{rowStart:u,colStart:h}=nn(ta,this).getNextVerticalNode();a=i.getNearestNotHiddenIndex(h,1),o=r.getNearestNotHiddenIndex(u,1)}if(o!==null||a!==null){const u=this.hot._createCellCoords(o,a),h=this.mergedCellsCollection.get(u.row,u.col),d=this.hot.selection.highlight.getFocus();t=u.row,e=u.col,h?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):n.highlight.assign(u),d.clear(),d.add(u).commit()}nn(ta,this).setActiveNode(t,e),Ip(Mo,this,{row:0,col:0})}function Ywe(){this.hot.getSelectedRangeLast().isHeader()||nn(ta,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Gwe(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function qwe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Kwe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Xwe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,a)}function Zwe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Qwe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Jwe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function eye(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function tye(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function nye(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);U(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function iye(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function rye(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function oye(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),u=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(a,a,u))}function sye(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const w=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(w.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(w.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const a=this.hot._createCellCoords(e,i),u=this.hot._createCellCoords(e,r),h=this.hot._createCellRange(a,a,u),d=this.mergedCellsCollection.getWithinRange(h,!0),g=d.reduce((w,y)=>{let{rowspan:b}=y;return Math.max(w,b)},1);let p=0;return d.length>1&&d[0].rowspan<g&&(p=g-d[0].rowspan),d.forEach(w=>{let{rowspan:y}=w,b=0;n==="top"||n==="top_inline_start_corner"?b=Math.min(g,this.hot.view.countNotHiddenFixedRowsTop()-e):b=y-p,t=Math.max(t??0,G3(this.hot,e,b))}),t}function aye(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function a(u){const h=t[u],d=e[u],g=r[u],p=o[u],w=d.multiColumnSorting,b=(w.compareFunctionFactory?w.compareFunctionFactory:EG(d.type))(h,d,w)(g,p);if(b===na){const T=u+1;if(typeof e[T]<"u")return a(T)}return b}(0)}}const K3="sort";function lye(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${K3}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function uye(t){const e=t.className.split(" "),n=new RegExp(`^${K3}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function cye(t,e,n){return(e=hye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hye(t){var e=dye(t,"string");return typeof e=="symbol"?e:e+""}function dye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pb="multiColumnSorting",fye=170,t2=pb;RG(pb,aye);class gye extends PG{constructor(){super(...arguments),cye(this,"pluginKey",pb)}static get PLUGIN_KEY(){return pb}static get PLUGIN_PRIORITY(){return fye}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,ZC)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Pu,position:"before",group:t2})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(t2)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),Ue(e,uye(e)),this.enabled!==!1&&pe(e,lye(...i))}onAfterOnCellMouseDown(e,n){ZH(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,ZC))):this.sort(this.getColumnNextConfig(n.col)))}}function n2(t,e,n){return(e=mye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mye(t){var e=pye(t,"string");return typeof e=="symbol"?e:e+""}function pye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vye="multipleSelectionHandles",wye=160;class yye extends It{constructor(){super(...arguments),n2(this,"dragged",[]),n2(this,"lastSetCell",null)}static get PLUGIN_KEY(){return vye}static get PLUGIN_PRIORITY(){return wye}isEnabled(){return nl()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(ze(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(ze(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(ze(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(ze(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let a,u,h,d,g,p;if(e.dragged.length===0)return;const w=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!w||w===e.lastSetCell||((w.nodeName==="TD"||w.nodeName==="TH")&&(a=e.hot.getCoords(w),a.col===-1&&(a.col=0),u=e.hot.getSelectedRangeLast(),h=u.getWidth(),d=u.getHeight(),g=u.getDirection(),h===1&&d===1&&e.hot.selection.setRangeEnd(a),p=e.getCurrentRangeCoords(u,a,e.touchStartRange.direction,g,e.dragged[0]),p.start!==null&&e.hot.selection.setRangeStart(p.start),e.hot.selection.setRangeEnd(p.end),e.lastSetCell=w),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const a=e.getTopStartCorner(),u=e.getBottomEndCorner(),h=e.getBottomStartCorner(),d=e.getTopEndCorner();let g={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?g={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SE-NW":o==="bottom"&&(g={start:this.hot._createCellCoords(u.row,n.col),end:this.hot._createCellCoords(n.row,a.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?g={start:n,end:h}:g.end=n;break;case"NW-SE":o==="top"?g={start:n,end:u}:g.end=n;break;case"SE-NW":o==="top"?g={start:n,end:a}:g.end=n;break;case"SW-NE":o==="top"?g={start:n,end:d}:g.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,u.col)};break;case"SW-NE":o==="top"?g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,u.col)}:g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(a.row,n.col)};break;case"SE-NW":o==="bottom"?g={start:this.hot._createCellCoords(n.row,d.col),end:this.hot._createCellCoords(a.row,n.col)}:o==="top"&&(g={start:h,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(g.end=n);break;case"SE-NW":o==="top"?g.end=n:g={start:n,end:a};break}break}return g}isDragged(){return this.dragged.length>0}}function VO(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:a,isRoot:u,isPlaceholder:h,headerClassNames:d}}function X3(){return{label:"",isPlaceholder:!0}}function Cye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;U(t,r=>{const o=[];let a=0;n.push(o),U(r,u=>{const h=VO();if(dt(u)){const{label:g,colspan:p,headerClassName:w}=u;h.label=yn(g),typeof p=="number"&&p>1&&(h.colspan=p,h.origColspan=p),typeof w=="string"&&(h.headerClassNames=[...w.split(" ")])}else h.label=yn(u);a+=h.origColspan;let d=!1;if(a>=e&&(h.colspan=h.origColspan-(a-e),h.origColspan=h.colspan,d=!0),o.push(h),h.colspan>1)for(let g=0;g<h.colspan-1;g++)o.push(X3());return!d})});const i=Math.max(...St(n,r=>r.length));return U(n,r=>{if(r.length<i){const o=St(new Array(i-r.length),()=>VO());r.splice(r.length,0,...o)}}),n}function p1(t,e,n){bye(t,e),e.set(t,n)}function bye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(t,e){return t.get(Z3(t,e))}function Mm(t,e,n){return t.set(Z3(t,e),n),n}function Z3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const i2=["label","collapsible"];var Ba=new WeakMap,Pc=new WeakMap,v1=new WeakMap;class Sye{constructor(){p1(this,Ba,[]),p1(this,Pc,0),p1(this,v1,1/0)}setColumnsLimit(e){Mm(v1,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Mm(Ba,this,Cye(e,qo(v1,this))),Mm(Pc,this,qo(Ba,this).length)}getData(){return qo(Ba,this)}mergeWith(e){U(e,n=>{let{row:i,col:r,...o}=n;const a=this.getHeaderSettings(i,r);a!==null&&ii(a,o,i2)})}map(e){U(qo(Ba,this),n=>{U(n,i=>{const r=e({...i});dt(r)&&ii(i,r,i2)})})}getHeaderSettings(e,n){var i;if(e>=qo(Pc,this)||e<0)return null;const r=qo(Ba,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=qo(Pc,this)||e<0)return r;const o=qo(Ba,this)[e];let a=0;for(let u=n;u<o.length;u++){const h=o[u];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=h.colspan,r.push(h),h.colspan>1&&(u+=h.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return qo(Pc,this)}getColumnsCount(){return qo(Pc,this)>0?qo(Ba,this)[0].length:0}clear(){Mm(Ba,this,[]),Mm(Pc,this,0)}}function w1(t,e,n){return(e=Rye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rye(t){var e=Eye(t,"string");return typeof e=="symbol"?e:e+""}function Eye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Q3="DF-pre-order";function J3(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=J3.call(this.childs[i],t,e)}return n}const Tye="DF-post-order";function eq(t,e){for(let n=0;n<this.childs.length;n++)if(eq.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const tq="BF";function _ye(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const Mye=tq,r2=new Map([[Q3,J3],[Tye,eq],[tq,_ye]]);class vb{constructor(e){w1(this,"data",{}),w1(this,"parent",null),w1(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new vb({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mye;if(!r2.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);r2.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function y1(t,e,n){Oye(t,e),e.set(t,n)}function Oye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e){return t.get(nq(t,e))}function xye(t,e,n){return t.set(nq(t,e),n),n}function nq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ad=new WeakMap,Nc=new WeakMap,Hd=new WeakMap;class Aye{constructor(e){y1(this,Ad,new Map),y1(this,Nc,new Map),y1(this,Hd,null),xye(Hd,this,e)}getRoots(){return Array.from(qi(Ad,this).values())}getRootByColumn(e){let n;return qi(Nc,this).has(e)&&(n=qi(Ad,this).get(qi(Nc,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-qi(Nc,this).get(n);let o=0,a;return i.walkDown(u=>{const{data:{origColspan:h,headerLevel:d}}=u;if(e===d){if(r>=o&&r<=o+h-1)return a=u,a.data.isRoot=n===a.data.columnIndex,!1;o+=h}}),a}rebuildTreeIndex(){let e=0;qi(Nc,this).clear(),U(qi(Ad,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)qi(Nc,this).set(r,e);e+=i})}buildTree(){this.clear();const e=qi(Hd,this).getColumnsCount();let n=0;for(;n<e;){const i=qi(Hd,this).getHeaderSettings(0,n),r=new vb;qi(Ad,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=qi(Hd,this).getHeadersSettings(i,n,r);i+=1,U(o,a=>{const u={...a,headerLevel:i-1,columnIndex:n};let h;i===1?(e.data=u,h=e):(h=new vb(u),e.addChild(h)),i<qi(Hd,this).getLayersCount()&&this.buildLeaves(h,n,i,a.origColspan),n+=a.origColspan})}clear(){qi(Ad,this).clear(),qi(Nc,this).clear()}}function iq(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function wb(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function yb(t){return wb(t,"origColspan")===t.data.origColspan}function dI(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yb(t))return dI(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let a=0;if(r.length>0)U(r,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;a+=h.colspan,iq(u,d=>{o.add(d)})});else{const{colspan:u,origColspan:h,columnIndex:d}=e;a=h-u;for(let g=1;g<h;g++)o.add(d+g)}return t.walkUp(u=>{const{data:h}=u;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):yb(u)&&(h.isCollapsed=wb(u,"isCollapsed"))}),{rollbackModification:()=>fI(t),affectedColumns:Array.from(o),colspanCompensation:a}}function fI(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yb(t))return fI(i[0]);n.isCollapsed=!0;const o=i.slice(1),a=new Set;if(o.length>0)U(o,h=>{iq(h,d=>{a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:g}=d;g.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=n;for(let g=1;g<h;g++){const p=d+g;a.add(p)}}const u=n.colspan-((e=wb(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:d}=h;d.colspan-=u,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):yb(h)&&(d.isCollapsed=wb(h,"isCollapsed"))}),{rollbackModification:()=>dI(t),affectedColumns:Array.from(a),colspanCompensation:u}}function Hye(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Iye(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const o2=new Map([["collapse",fI],["expand",dI],["hide-column",Hye],["show-column",Iye]]);function Pye(t,e,n){if(!o2.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return o2.get(t)(e,n)}function jy(t){const e=[];return U(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:a,headerLevel:u,crossHiddenColumns:h}=r,d=Dye(e,u);let g=!1;for(let p=a;p<a+o;p++)if(h.includes(p)||g)d.push(X3());else{const y=Nye(r);y.isRoot=!0,d.push(y),g=!0}})}),e}function Nye(t){const{crossHiddenColumns:e,...n}=VO(t);return n}function Dye(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function C1(t,e,n){Lye(t,e),e.set(t,n)}function Lye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e,n){return t.set(rq(t,e),n),n}function Sn(t,e){return t.get(rq(t,e))}function rq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ws=new WeakMap,vr=new WeakMap,Dc=new WeakMap;class kye{constructor(){C1(this,Ws,new Sye),C1(this,vr,new Aye(Sn(Ws,this))),C1(this,Dc,[[]])}setState(e){Sn(Ws,this).setData(e);let n=!1;try{Sn(vr,this).buildTree()}catch{Sn(vr,this).clear(),Sn(Ws,this).clear(),n=!0}return Om(Dc,this,jy(Sn(vr,this).getRoots())),n}setColumnsLimit(e){Sn(Ws,this).setColumnsLimit(e)}mergeStateWith(e){const n=St(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});Sn(Ws,this).mergeWith(n),Sn(vr,this).buildTree(),Om(Dc,this,jy(Sn(vr,this).getRoots()))}mapState(e){Sn(Ws,this).map(e),Sn(vr,this).buildTree(),Om(Dc,this,jy(Sn(vr,this).getRoots()))}mapNodes(e){return xr(Sn(vr,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Sn(vr,this).getNode(n,i);let o;return r&&(o=Pye(e,r,i),Om(Dc,this,jy(Sn(vr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Sn(Dc,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Sn(vr,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let a=e;a<=n;a++){const u=Sn(vr,this).getRootByColumn(a);if(!u)break;r=!0,u.walkDown(h=>{const{columnIndex:d,headerLevel:g,origColspan:p,isHidden:w}=h.data;w||p<=i&&d>=e&&d+p-1<=n&&(o===null||g<o)&&(o=g)},Q3)}return r&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var a;const{isRoot:u}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(u)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let a=n+1;for(;a<this.getColumnsCount();){var u;const{isRoot:h}=(u=this.getHeaderSettings(e,a))!==null&&u!==void 0?u:{isRoot:!0};if(h)break;a+=1}return a-1}getLayersCount(){return Sn(Ws,this).getLayersCount()}getColumnsCount(){return Sn(Ws,this).getColumnsCount()}clear(){Om(Dc,this,[]),Sn(Ws,this).clear(),Sn(vr,this).clear()}}function xm(t,e,n){return(e=Vye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vye(t){var e=$ye(t,"string");return typeof e=="symbol"?e:e+""}function $ye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bye{constructor(e,n){xm(this,"hot",void 0),xm(this,"nestedHeaderSettingsGetter",void 0),xm(this,"layersCount",0),xm(this,"container",void 0),xm(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),a=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(a,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const d=n.createElement("tr");for(let g=0;g<u;g++){let p=i.getVisualFromRenderableIndex(g);p===null&&(p=g);const w=n.createElement("th"),y=this.nestedHeaderSettingsGetter(h,p);if(y&&(!y.isPlaceholder||y.isHidden)){let b=y.label;a&&(b+='<button class="changeType"></button>'),Tf(w,b),w.colSpan=y.colspan,d.appendChild(w)}}o.appendChild(d)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function Fye(t,e){oq(t,e),e.add(t)}function s2(t,e,n){return(e=Wye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wye(t){var e=jye(t,"string");return typeof e=="symbol"?e:e+""}function jye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Am(t,e,n){oq(t,e),e.set(t,n)}function oq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){return t.set(Rn(t,e),n),n}function bt(t,e){return t.get(Rn(t,e))}function Rn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const a2="nestedHeaders",Uye=280;var zt=new WeakMap,ru=new WeakMap,cp=new WeakMap,CS=new WeakMap,Cb=new WeakMap,Pn=new WeakSet;class zye extends It{constructor(){super(...arguments),Fye(this,Pn),Am(this,zt,new kye),Am(this,ru,null),Am(this,cp,null),Am(this,CS,!1),Am(this,Cb,null),s2(this,"ghostTable",new Bye(this.hot,(e,n)=>this.getHeaderSettings(e,n))),s2(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return a2}static get PLUGIN_PRIORITY(){return Uye}isEnabled(){return!!this.hot.getSettings()[a2]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Nt($t`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Rn(Pn,this,aCe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,lCe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Kye).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Xye).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Zye).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Qye).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Jye).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,eCe).call(e,...r)}),this.addHook("afterSelection",()=>Rn(Pn,this,Uy).call(this)),this.addHook("afterSelectionFocusSet",()=>Rn(Pn,this,Uy).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Yye).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Rn(Pn,this,nCe).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,rCe).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,oCe).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,Gye).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,qye).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,tCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,iCe).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Rn(Pn,e,sCe).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Rn(Pn,this,Uy).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Rn(Pn,this,Uy).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();bt(zt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=bt(zt,this).setState(e)),this.detectedOverlappedHeaders&&Nt($t`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";bt(zt,this).triggerColumnModification(r,i)}),!bt(ru,this)&&this.enabled&&sl(ru,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:a}=i;if(r==="replace"){const u=a===!0?"hide-column":"show-column";bt(zt,this).triggerColumnModification(u,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),bt(zt,this).clear(),bt(ru,this).unsubscribe(),sl(ru,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return bt(zt,this)}getLayersCount(){return bt(zt,this).getLayersCount()}getHeaderSettings(e,n){return bt(zt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<n;a++){const u=i.childNodes[a];if(!u)break;const h=r.childNodes[a],d=o?o.childNodes[a]:null;for(let g=0,p=u.childNodes.length;g<p;g++)u.childNodes[g].removeAttribute("colspan"),Ue(u.childNodes[g],"hiddenHeader"),h&&h.childNodes[g]&&(h.childNodes[g].removeAttribute("colspan"),Ue(h.childNodes[g],"hiddenHeader")),o&&d&&d.childNodes[g]&&(d.childNodes[g].removeAttribute("colspan"),Ue(d.childNodes[g],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var a;const{columnIndexMapper:u,view:h}=this.hot;let d=u.getVisualFromRenderableIndex(r);d===null&&(d=r),o.removeAttribute("colspan"),Ue(o,"hiddenHeader"),Ue(o,"hiddenHeaderText");const{colspan:g,isHidden:p,isPlaceholder:w,headerClassNames:y}=(a=bt(zt,this).getHeaderSettings(e,d))!==null&&a!==void 0?a:{};if(w||p)pe(o,"hiddenHeader");else if(g>1){var b,T,M;const{wtOverlays:I}=h._wt,_=(b=I.topInlineStartCornerOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(o),N=(T=I.inlineStartOverlay)===null||T===void 0?void 0:T.clone.wtTable.THEAD.contains(o);((M=I.topOverlay)===null||M===void 0?void 0:M.clone.wtTable.THEAD.contains(o))&&d<i&&pe(o,"hiddenHeaderText");const $=_||N?Math.min(g,i-r):g;$>1&&o.setAttribute("colspan",$)}if(this.hot.view.appendColHeader(d,o,function(){return n.getColumnHeaderValue(...arguments)},e),!w&&!p){const I=o.querySelector("div.relative");I&&y&&y.length>0&&(Ue(I,this.hot.getColumnMeta(d).headerClassName),pe(I,y))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=bt(zt,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){sl(zt,this,null),bt(ru,this)!==null&&(bt(ru,this).unsubscribe(),sl(ru,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return bt(zt,this).getHeaderTreeNodeData(e.row,e.col)}}function Uy(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=bt(zt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=r,o.visualCellRange.from.col=r,o.visualCellRange.to.col=r,o.commit()}}function Yye(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),u=o?r.row:(n=bt(Cb,this))===null||n===void 0?void 0:n.row,h=a?t:r.col,d=u<0&&h>=0;if(sl(Cb,this,null),!d)return t;const g=this.hot.getFirstFullyVisibleColumn(),p=this.hot.getLastFullyVisibleColumn(),w=p-g+1,y=bt(zt,this).findLeftMostColumnIndex(u,h),b=bt(zt,this).findRightMostColumnIndex(u,h),T=b-y+1;if(y<g&&b>p)return y;if(a){let M=null;return y>=g&&b>p?T>w?(e.value="start",M=y):(e.value="end",M=b):y<g&&b<=p&&(T>w?(e.value="end",M=b):(e.value="start",M=y)),M}return y<=g?y:b}function Gye(t,e,n){const i=bt(zt,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:a}=n,{isRoot:u,colspan:h}=bt(zt,this).getHeaderSettings(e,t);if(o===Wx){if(!u)return i.columnIndex}else if(o===Zz&&(h>a-r||!u))return null;return t}function qye(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:a,startCol:u,endRow:h,endCol:d}=e[o],g=h-a+1,p=u-d+1;if(a>=0||p===1)break;for(let w=u;w<=d;w++)for(let y=a;y<=h;y++){var r;const b=g+y,T=w-u;if(T===0)continue;((r=bt(zt,this).getHeaderTreeNodeData(y,w))===null||r===void 0?void 0:r.isRoot)===!1&&(t[b][T]="")}}}function Kye(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Xye(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;sl(cp,this,e.clone()),sl(CS,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:u}=n,h=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,a,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,a+u-1,e.row):o.push(a,a+u-1,e.row):(Hx(t)||eh(t)&&h||kZ(t))&&o.push(a,a+u-1,e.row),i.selectColumns(...o)}function Zye(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:a}=r,u=this.hot.getSelectedRangeLast(),h=u.getTopStartCorner(),d=u.getBottomEndCorner(),{from:g}=u;i.column=!0,i.cell=!0;const p=[],w=Et(e.row,-1/0,-1);e.col<g.col?p.push(d.col,o,w):e.col>g.col?p.push(h.col,o+a-1,w):p.push(o,o+a-1,w),this.hot.selection.selectColumns(...p)}function Qye(){sl(CS,this,!1)}function Jye(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!bt(CS,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=bt(zt,this).getHeaderTreeNodeData(bt(cp,this).row,bt(cp,this).col);if(e.setHighlight(bt(cp,this)),o>e.getWidth()||r<n||r+o-1>i){const a=bt(zt,this).findTopMostEntireHeaderLevel(Et(n,r,r+o-1),Et(i,r,r+o-1));e.highlight.row=a,e.highlight.col=e.from.col}}function eCe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=bt(zt,this).findLeftMostColumnIndex(n.row,n.col),o=bt(zt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const a=e.col>=r&&e.col<=o?r-1:o,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);u===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,e.col)-1,1)}else if(t.col>0){const a=e.col>=r&&e.col<=o?o+1:r,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);u===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,u)-1,1)}}function tCe(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});sl(Cb,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function nCe(t){if(bt(zt,this).getLayersCount()>0){t.length=0;for(let e=0;e<bt(zt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function iCe(t){const e=bt(zt,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=bt(zt,this).findLeftMostColumnIndex(r,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),er(a)&&a<t.startColumn){n=a;break}}t.startColumn=i?bt(zt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function rCe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function oCe(t,e,n){var i;const{label:r}=(i=bt(zt,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function sCe(t,e){if(t<0)return this.hot.getCell(t,bt(zt,this).findLeftMostColumnIndex(t,e),!0)}function aCe(){this.updatePlugin()}function lCe(t,e){e||this.updatePlugin()}function Hm(t,e,n){return(e=uCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uCe(t){var e=cCe(t,"string");return typeof e=="symbol"?e:e+""}function cCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hCe{constructor(e,n){Hm(this,"hot",void 0),Hm(this,"data",null),Hm(this,"plugin",void 0),Hm(this,"parentReference",new WeakMap),Hm(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ve(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&U(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,a=n;if(isNaN(a)&&a.end)return a;let u=e;return u||(u={__children:this.data},o=!0,a-=1),i!=null&&a===i?{result:u,end:!0}:r!=null&&u===r?{result:a,end:!0}:(a+=1,u.__children&&U(u.__children,h=>{if(this.parentReference.set(h,o?null:u),a=this.readTreeNodes(h,a,i,r),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ft(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(U(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const u=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",u,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(u,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",u,1),o=u}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(Ve(e[0],e[2],w=>{const y=this.translateTrimmedRow(w);r.push(this.getDataObject(y))}),Ve(0,r.length-2,w=>{this.detachFromParent(r[w],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),a=this.countChildren(i),u=this.getRowIndexWithinParent(i),h=this.getRowParent(i),d=this.getRowParent(h),g=this.getRowIndex(d);let p=null;if(this.hot.runHooks("beforeDetachChild",h,i),u!=null){const w=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,w,this.plugin.pluginName),h.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,w,this.plugin.pluginName),d){p=g+this.countChildren(d);const y=this.getChild(d,this.countChildren(d)-1),b=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",b+1,a+1,this.plugin.pluginName),d.__children.push(i)}else p=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",p-2,a+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",p-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];U(i,o=>{r.push(this.getDataObject(o))}),U(r,o=>{const a=this.getRowIndexWithinParent(o),u=this.getRowParent(o);u===null?this.data.splice(a,1):u.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,a=e;r&&r.__children&&r.__children.length===0?(o=r,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(a,n,...i):o.__children.splice(a,n):i?this.data.splice(a,n,...i):this.data.splice(a,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),a=this.getRowParent(e),u=this.getRowIndexWithinParent(e),h=a.__children.slice(u,u+1),d=e>n;let g=o?this.getRowParent(n-1):this.getRowParent(n);g==null&&(g=this.getRowParent(n-1)),g==null&&(g=this.getDataObject(n-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(n),g.__children=[]);const p=o||i||r?g.__children.length:this.getRowIndexWithinParent(n),w=a===g;g.__children.splice(p,0,h[0]),a.__children.splice(u+(d&&w?1:0),1),this.syncRowWithRawSource(a),w||this.syncRowWithRawSource(g)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function l2(t,e,n){return(e=dCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dCe(t){var e=fCe(t,"string");return typeof e=="symbol"?e:e+""}function fCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gI{constructor(e,n){l2(this,"hot",void 0),l2(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Zs extends gI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),a=n.getElementsByTagName("DIV")[0],u=a.querySelector("span.rowHeader"),h=a.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(U(h,g=>{g&&a.removeChild(g)}),pe(n,Zs.CSS_CLASSES.indicatorContainer),r){const{rootDocument:g}=this.hot,p=u.cloneNode(!0);a.innerHTML="",Ve(0,r-1,()=>{const w=g.createElement("SPAN");pe(w,Zs.CSS_CLASSES.emptyIndicator),a.appendChild(w)}),a.appendChild(p)}if(this.dataManager.hasChildren(o)){const g=this.hot.rootDocument.createElement("DIV");d&&qe(g,[gh()]),pe(n,Zs.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(pe(g,`${Zs.CSS_CLASSES.button} ${Zs.CSS_CLASSES.expandButton}`),d&&qe(n,[Oo(!1)])):(pe(g,`${Zs.CSS_CLASSES.button} ${Zs.CSS_CLASSES.collapseButton}`),d&&qe(n,[Oo(!0)])),a.appendChild(g)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let r=11;i.isClassicTheme()||(r=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class gCe extends gI{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),U(i.lastCollapsedRows,(u,h)=>{u>=r&&u<o&&(i.lastCollapsedRows[h]=u+a)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{Ve(r,r+o-1,a=>{const u=this.lastCollapsedRows.indexOf(a);u>-1&&this.lastCollapsedRows.splice(u,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,u=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&U(o.__children,h=>{r.push(this.dataManager.getRowIndex(h))}),u=this.collapseRows(r,!0,!1),i&&this.trimRows(u),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),u}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];U(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return U(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);U(r.__children,o=>{const a=this.dataManager.getRowIndex(o);n.push(a),this.collapseChildRows(a,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return U(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);U(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const a=this.dataManager.getRowIndex(o);n.push(a),this.expandChildRows(a,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,u=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&U(o.__children,h=>{const d=this.dataManager.getRowIndex(h);r.push(d)}),u=this.expandRows(r,!0,!1),i&&this.untrimRows(u),n&&this.renderAndAdjust(),u}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];U(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];U(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];U(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{U(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{U(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&U(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);ze(e.target,Zs.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),ps(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function mCe(t,e,n){pCe(t,e),e.set(t,n)}function pCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vCe(t,e,n){return(e=wCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wCe(t){var e=yCe(t,"string");return typeof e=="symbol"?e:e+""}function yCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CCe(t,e){return t.get(bCe(t,e))}function bCe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var u2=new WeakMap;class SCe extends gI{constructor(){super(...arguments),vCe(this,"dataManager",this.plugin.dataManager),mCe(this,u2,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(WA)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(jA)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ve(0,e.items.length-1,i=>{if(i===0)return U(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ve(0,e.items.length-1,n=>{const i=CCe(u2,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function zy(t,e,n){return(e=RCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RCe(t){var e=ECe(t,"string");return typeof e=="symbol"?e:e+""}function ECe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TCe{constructor(e){zy(this,"plugin",void 0),zy(this,"hot",void 0),zy(this,"dataManager",void 0),zy(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const a=i===this.hot.countRows(),u=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let h=!0;const d=e.map(b=>{if(!h)return!1;const T=this.dataManager.translateTrimmedRow(b);return h=this.shouldAllowMoving(T,u),T}),g=d.indexOf(u)===-1;if(!h||!g)return!1;const p=this.getBaseParent(d),w=this.getTargetParent(a,u),y=p===w;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(w),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,u,y),this.moveRows(d,u,w),this.dataManager.rewriteCache(),this.moveCellsMeta(d,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let a=!1;return wn(r)&&(Nt($t`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),a=!0),a}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let a=null;e[i-1]<n?a=this.dataManager.translateTrimmedRow(n-i):a=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),h=this.dataManager.getRowIndex(u);r=this.dataManager.untranslateTrimmedRow(h),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function _Ce(t,e){sq(t,e),e.add(t)}function c2(t,e,n){sq(t,e),e.set(t,n)}function sq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b1(t,e,n){return(e=MCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MCe(t){var e=OCe(t,"string");return typeof e=="symbol"?e:e+""}function OCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EC(t,e){return t.get(gi(t,e))}function bb(t,e,n){return t.set(gi(t,e),n),n}function gi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sb="nestedRows",xCe=300,h2=Sb,ACe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var bS=new WeakMap,Id=new WeakMap,Ci=new WeakSet;class HCe extends It{constructor(){super(...arguments),_Ce(this,Ci),b1(this,"dataManager",null),b1(this,"headersUI",null),b1(this,"collapsedRowsMap",null),c2(this,bS,!1),c2(this,Id,!1)}static get PLUGIN_KEY(){return Sb}static get PLUGIN_PRIORITY(){return xCe}isEnabled(){return!!this.hot.getSettings()[Sb]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Xp),this.dataManager=new hCe(this,this.hot),this.collapsingUI=new gCe(this,this.hot),this.headersUI=new Zs(this,this.hot),this.contextMenuUI=new SCe(this,this.hot),this.rowMoveController=new TCe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,zCe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,YCe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,NCe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,DCe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,LCe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,PCe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,$Ce).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,VCe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,BCe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,FCe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,WCe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,jCe).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,kCe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,UCe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gi(Ci,e,ICe).call(e,...i)}),this.addHook("beforeLoadData",n=>gi(Ci,this,d2).call(this,n)),this.addHook("beforeUpdateData",n=>gi(Ci,this,d2).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:h2,relativeToGroup:Pu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(h2)}disableCoreAPIModifiers(){bb(Id,this,!0)}enableCoreAPIModifiers(){bb(Id,this,!1)}onModifyRowData(e){if(!EC(Id,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!EC(Id,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return EC(Id,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function ICe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function PCe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function NCe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),bb(bS,this,!0),this.dataManager.getData().slice()}function DCe(t){return this.contextMenuUI.appendOptions(t)}function LCe(t,e){this.headersUI.appendLevelIndicators(t,e)}function kCe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function VCe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{bb(bS,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function $Ce(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(a)&&a.forEach(u=>r.add(this.dataManager.getRowIndex(u))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function BCe(){this.collapsingUI.collapsedRowsStash.stash()}function FCe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function WCe(){this.collapsingUI.collapsedRowsStash.stash()}function jCe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function UCe(){this.dataManager.rewriteCache()}function zCe(){this.headersUI.updateRowHeaderWidth()}function YCe(t,e){EC(bS,this)&&(e.skipRender=!0)}function d2(t){if(!Xte(t)){Ix(ACe),this.hot.getSettings()[Sb]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function S1(t,e,n){return(e=GCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GCe(t){var e=qCe(t,"string");return typeof e=="symbol"?e:e+""}function qCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KCe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;S1(this,"rootWindow",void 0),S1(this,"prefix",void 0),S1(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){U(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function XCe(t,e,n){return(e=ZCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZCe(t){var e=QCe(t,"string");return typeof e=="symbol"?e:e+""}function QCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}xe.getSingleton().register("persistentStateSave");xe.getSingleton().register("persistentStateLoad");xe.getSingleton().register("persistentStateReset");const f2="persistentState",JCe=0;class ebe extends It{constructor(){super(...arguments),XCe(this,"storage",void 0)}static get PLUGIN_KEY(){return f2}static get PLUGIN_PRIORITY(){return JCe}isEnabled(){return!!this.hot.getSettings()[f2]}enablePlugin(){this.enabled||(this.storage||(this.storage=new KCe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function tbe(t,e){nbe(t,e),e.add(t)}function nbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R1(t,e,n){return(e=ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ibe(t){var e=rbe(t,"string");return typeof e=="symbol"?e:e+""}function rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g2(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const E1="search",obe=190,sbe="htSearchResult",abe=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},lbe=function(t,e,n){return wn(t)||t===null||!t.toLocaleLowerCase||t.length===0||wn(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var T1=new WeakSet;class ube extends It{constructor(){super(...arguments),tbe(this,T1),R1(this,"callback",abe),R1(this,"queryMethod",lbe),R1(this,"searchResultClass",sbe)}static get PLUGIN_KEY(){return E1}static get PLUGIN_PRIORITY(){return obe}isEnabled(){return this.hot.getSettings()[E1]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[E1];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return g2(T1,e,m2).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return g2(T1,e,m2).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),a=[],u=this.hot;return Ve(0,r-1,h=>{Ve(0,o-1,d=>{const g=this.hot.getDataAtCell(h,d),p=this.hot.getCellMeta(h,d),w=p.search.callback||n,b=(p.search.queryMethod||i)(e,g,p);if(b){const T={row:h,col:d,data:g};a.push(T)}w&&w(u,h,d,g,b)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){dt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function m2(t,e,n,i,r,o){const a=o.className||[];let u=[];typeof a=="string"?u=a.split(" "):u.push(...a),this.isEnabled()&&o.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),o.className=u.join(" ")}function Yy(t,e,n){return(e=cbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cbe(t){var e=hbe(t,"string");return typeof e=="symbol"?e:e+""}function hbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aq{constructor(e){Yy(this,"viewportWidth",void 0),Yy(this,"overwriteColumnWidthFn",void 0),Yy(this,"baseWidths",new Map),Yy(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class dbe extends aq{calculate(){const e=Array.from(this.baseWidths).reduce((p,w)=>{let[,y]=w;return p+y},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let a=this.viewportWidth,u=0;if(this.baseWidths.forEach((p,w)=>{const y=Math.round(p*i),b=this.overwriteColumnWidthFn(y,w);y===b&&y>=lf?(r.push([w,b]),u+=b):y!==b&&(r.push([w,b]),o.push(w),a-=b)}),a<=lf){this.stretchedWidths.clear();return}const h=a/u;let d=-1,g=0;r.forEach((p,w)=>{let[y,b]=p,T=b;o.includes(y)||(T=Math.round(b*h)),this.stretchedWidths.set(y,T),d=y,w<r.length-1&&(g+=T)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(d,Math.round(this.viewportWidth-g))}}function p2(t,e,n){fbe(t,e),e.set(t,n)}function fbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _1(t,e){return t.get(lq(t,e))}function Gy(t,e,n){return t.set(lq(t,e),n),n}function lq(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qy=new WeakMap,Im=new WeakMap;class gbe extends aq{constructor(){super(...arguments),p2(this,qy,0),p2(this,Im,-1)}prepare(e){super.prepare(e),Gy(qy,this,0),Gy(Im,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Gy(Im,this,e),Gy(qy,this,n)}calculate(){if(_1(Im,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+_1(qy,this),0);this.stretchedWidths.set(_1(Im,this),n)}}function mbe(t,e){uq(t,e),e.add(t)}function Ky(t,e,n){uq(t,e),e.set(t,n)}function uq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){return t.get(Xd(t,e))}function M1(t,e,n){return t.set(Xd(t,e),n),n}function Xd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pbe="stretchColumns";var Bi=new WeakMap,Pd=new WeakMap,O1=new WeakMap,Xy=new WeakMap,Pm=new WeakSet;class vbe{constructor(e){mbe(this,Pm),Ky(this,Bi,void 0),Ky(this,Pd,void 0),Ky(this,O1,new Map([["all",new dbe(Xd(Pm,this,v2).bind(this))],["last",new gbe(Xd(Pm,this,v2).bind(this))]])),Ky(this,Xy,"none"),M1(Bi,this,e),M1(Pd,this,Nn(Bi,this).columnIndexMapper.createAndRegisterIndexMap(pbe,"physicalIndexToValue"))}useStrategy(e){M1(Xy,this,Nn(O1,this).has(e)?e:"none")}refreshStretching(){if(Nn(Xy,this)==="none"){Nn(Pd,this).clear();return}Nn(Bi,this).batchExecution(()=>{Nn(Pd,this).clear();const e=Nn(O1,this).get(Nn(Xy,this));let i=Nn(Bi,this).view.getViewportWidth();Xd(Pm,this,wbe).call(this)&&(i-=Si(Nn(Bi,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<Nn(Bi,this).countCols();r++)Nn(Bi,this).columnIndexMapper.isHidden(Nn(Bi,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,Xd(Pm,this,ybe).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,a]=r;Nn(Pd,this).setValueAtIndex(Nn(Bi,this).toPhysicalColumn(o),a)})},!0)}getStretchedWidth(e){return Nn(Pd,this).getValueAtIndex(Nn(Bi,this).toPhysicalColumn(e))}}function wbe(){const{view:t}=Nn(Bi,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Nn(Bi,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let r=0,o=!1;for(let u=0;u<n;u++){var a;if(r+=((a=Nn(Bi,this).getRowHeight(u))!==null&&a!==void 0?a:i)+(u===0?1:0),r>e){o=!0;break}}return o}function ybe(t){var e;return(e=Nn(Bi,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:lf}function v2(t,e){return Nn(Bi,this).runHooks("beforeStretchingColumnWidth",t,e)}function Cbe(t,e){cq(t,e),e.add(t)}function x1(t,e,n){cq(t,e),e.set(t,n)}function cq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A1(t,e,n){return t.set(Rb(t,e),n),n}function Ya(t,e){return t.get(Rb(t,e))}function Rb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bbe="stretchColumns",Sbe=155;var jd=new WeakMap,Zy=new WeakMap,Nm=new WeakMap,H1=new WeakSet;class Rbe extends It{constructor(){super(...arguments),Cbe(this,H1),x1(this,jd,new vbe(this.hot)),x1(this,Zy,null),x1(this,Nm,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Ya(Zy,this)!==null&&Ya(Zy,this)!==r.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),A1(Zy,this,r.width)})})}))}static get PLUGIN_KEY(){return bbe}static get PLUGIN_PRIORITY(){return Sbe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ya(jd,this).useStrategy(this.hot.getSettings().stretchH),Ya(Nm,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rb(H1,e,Tbe).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rb(H1,e,Ebe).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Ya(jd,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ya(Nm,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ya(jd,this).getStretchedWidth(e)}destroy(){Ya(Nm,this).disconnect(),A1(Nm,this,null),A1(jd,this,null),super.destroy()}}function Ebe(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function Tbe(t){t&&Ya(jd,this).refreshStretching()}function _be(t,e){Mbe(t,e),e.add(t)}function Mbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qy(t,e,n){return(e=Obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Obe(t){var e=xbe(t,"string");return typeof e=="symbol"?e:e+""}function xbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Abe="touchScroll",Hbe=200;var Jy=new WeakSet;class Ibe extends It{constructor(){super(...arguments),_be(this,Jy),Qy(this,"scrollbars",[]),Qy(this,"clones",[]),Qy(this,"lockedCollection",!1),Qy(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Abe}static get PLUGIN_PRIORITY(){return Hbe}static get SETTING_KEYS(){return!0}isEnabled(){return Rz()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>I1(Jy,this,Pbe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>I1(Jy,this,Nbe).call(this)),this.addHook("afterMomentumScroll",()=>I1(Jy,this,Dbe).call(this))}}function Pbe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function Nbe(){this.freezeOverlays=!0,U(this.clones,t=>{pe(t,"hide-tween")})}function Dbe(){this.freezeOverlays=!1,U(this.clones,t=>{Ue(t,"hide-tween"),pe(t,"show-tween")}),this.hot._registerTimeout(()=>{U(this.clones,t=>{Ue(t,"show-tween")})},400),U(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Lbe(t,e){kbe(t,e),e.add(t)}function kbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vbe(t,e,n){return(e=$be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $be(t){var e=Bbe(t,"string");return typeof e=="symbol"?e:e+""}function Bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fbe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TC="trimRows",Wbe=330;var w2=new WeakSet;class jbe extends It{constructor(){super(...arguments),Lbe(this,w2),Vbe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return TC}static get PLUGIN_PRIORITY(){return Wbe}isEnabled(){return!!this.hot.getSettings()[TC]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Xp),this.trimmedRowsMap.addLocalHook("init",()=>Fbe(w2,this,Ube).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[TC];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),U(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;i&&a&&(U(e,h=>{o[h]=!1}),r=xr(o,(h,d,g)=>(d&&h.push(g),h),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&a)!==!1&&(i&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&a,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function Ube(){const t=this.hot.getSettings()[TC];Array.isArray(t)&&this.hot.batchExecution(()=>{U(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function zbe(t,e,n){return(e=Ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ybe(t){var e=Gbe(t,"string");return typeof e=="symbol"?e:e+""}function Gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Do{constructor(e){zbe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function eC(t,e,n){return(e=qbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qbe(t){var e=Kbe(t,"string");return typeof e=="symbol"?e:e+""}function Kbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mI extends Do{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),eC(this,"stateBefore",void 0),eC(this,"range",void 0),eC(this,"type",void 0),eC(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,a)=>{n.done(()=>new mI({stateBefore:i,range:r,type:o,alignment:a}))})}undo(e,n){U(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){su(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,a)=>e.setCellMeta(i,r,o,a)),e.addHookOnce("afterViewRender",n),e.render()}}function y2(t,e,n){return(e=Xbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xbe(t){var e=Zbe(t,"string");return typeof e=="symbol"?e:e+""}function Zbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pI extends Do{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),y2(this,"columns",void 0),y2(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new pI({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),cI(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:u}=o;a<u&&(u-=1),i.moveColumn(u,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function C2(t,e,n){return(e=Qbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qbe(t){var e=Jbe(t,"string");return typeof e=="symbol"?e:e+""}function Jbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vI extends Do{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),C2(this,"previousSortState",void 0),C2(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{o&&n.done(()=>new vI({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function b2(t,e,n){return(e=eSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eSe(t){var e=tSe(t,"string");return typeof e=="symbol"?e:e+""}function tSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wI extends Do{constructor(e){let{index:n,amount:i}=e;super("insert_col"),b2(this,"index",void 0),b2(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new wI({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function S2(t,e,n){return(e=nSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nSe(t){var e=iSe(t,"string");return typeof e=="symbol"?e:e+""}function iSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yI extends Do{constructor(e){let{index:n,amount:i}=e;super("insert_row"),S2(this,"index",void 0),S2(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new yI({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function tC(t,e,n){return(e=rSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CI extends Do{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),tC(this,"changes",void 0),tC(this,"selected",void 0),tC(this,"countCols",void 0),tC(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(h=>{const[,,d,g]=h;return d!==g}))return;const u=()=>{const h=i.reduce((g,p)=>(g.push([...p]),g),[]);h.forEach(g=>{g[1]=e.propToCol(g[1])});const d=o>1?this.getSelected():[[h[0][0],h[0][1]]];return new CI({changes:h,selected:d,countCols:e.countCols(),countRows:e.countRows()})};n.done(u,r)})}undo(e,n){const i=ir(this.changes);for(let a=0,u=i.length;a<u;a++)i[a].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const i=ir(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function R2(t,e,n){return(e=sSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sSe(t){var e=aSe(t,"string");return typeof e=="symbol"?e:e+""}function aSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bI extends Do{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),R2(this,"conditionsStack",void 0),R2(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new bI({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function lSe(t,e,n){return(e=uSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uSe(t){var e=cSe(t,"string");return typeof e=="symbol"?e:e+""}function cSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SI extends Do{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),lSe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),a=i.getBottomEndCorner(),u=e.getData(o.row,o.col,a.row,a.col);n.done(()=>new SI({data:u,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function hq(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],a=o.length,u=[];return Ve(i,r,h=>{Ve(e,n,d=>{const g=t.getCellMeta(d,h);if(Object.keys(g).length!==a){const p=Object.fromEntries(Object.entries(g).filter(w=>{let[y]=w;return o.includes(y)===!1}));u.push([g.visualRow,g.visualCol,p])}})}),u}function Fa(t,e,n){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hSe(t){var e=dSe(t,"string");return typeof e=="symbol"?e:e+""}function dSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RI extends Do{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:a,columnPositions:u,rowPositions:h,fixedColumnsStart:d,removedCellMetas:g}=e;super("remove_col"),Fa(this,"index",void 0),Fa(this,"indexes",void 0),Fa(this,"data",void 0),Fa(this,"amount",void 0),Fa(this,"headers",void 0),Fa(this,"columnPositions",void 0),Fa(this,"rowPositions",void 0),Fa(this,"fixedColumnsStart",void 0),Fa(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=a,this.columnPositions=u.slice(0),this.rowPositions=h.slice(0),this.fixedColumnsStart=d,this.removedCellMetas=g}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,a)=>{const u=()=>{const h=e.getSourceDataArray(),d=(e.countCols()+i)%e.countCols(),g=d+r-1,p=[],w=[],y=[];return Ve(h.length-1,b=>{const T=[],M=h[b];Ve(d,g,I=>{T.push(M[e.toPhysicalColumn(I)])}),p.push(T)}),Ve(r-1,b=>{y.push(e.toPhysicalColumn(d+b))}),Array.isArray(e.getSettings().colHeaders)&&Ve(r-1,b=>{w.push(e.getSettings().colHeaders[e.toPhysicalColumn(d+b)]||null)}),new RI({index:d,indexes:y,data:p,amount:r,headers:w,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:hq(e,0,e.countRows(),d,g)})};n.done(u,a)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(g,p,w)=>w[this.indexes.indexOf(r[p])],a=this.data.length,u=[];for(let g=0;g<a;g++)u.push(St(this.data[g],o));const h=St(this.headers,o),d=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),U(e.getSourceDataArray(),(g,p)=>{U(r,(w,y)=>{g[w]=u[p][y],d.push([p,w,g[w]])})}),typeof this.headers<"u"&&U(h,(g,p)=>{e.getSettings().colHeaders[r[p]]=g}),this.removedCellMetas.forEach(g=>{let[p,w,y]=g;e.setCellMetaObject(p,w,y)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(d,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Nd(t,e,n){return(e=fSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fSe(t){var e=gSe(t,"string");return typeof e=="symbol"?e:e+""}function gSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EI extends Do{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:a,removedCellMetas:u}=e;super("remove_row"),Nd(this,"index",void 0),Nd(this,"data",void 0),Nd(this,"fixedRowsBottom",void 0),Nd(this,"fixedRowsTop",void 0),Nd(this,"rowIndexesSequence",void 0),Nd(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=a,this.removedCellMetas=u}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,a)=>{const u=()=>{const h=e.toPhysicalRow(i),d=h+r-1,g=ir(e.getSourceData(h,0,h+r-1,e.countSourceCols()-1));return new EI({index:h,data:g,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:hq(e,h,d,0,e.countCols()-1)})};n.done(u,a)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,a)=>{Object.keys(o).forEach(u=>{const h=parseInt(u,10);r.push([this.index+a,isNaN(h)?u:h,o[u]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[a,u,h]=o;e.setCellMetaObject(a,u,h)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function E2(t,e,n){return(e=mSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mSe(t){var e=pSe(t,"string");return typeof e=="symbol"?e:e+""}function pSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TI extends Do{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),E2(this,"rows",void 0),E2(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new TI({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),cI(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:u}=o;a<u&&(u-=1),i.moveRow(u,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function vSe(t,e,n){return(e=wSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wSe(t){var e=ySe(t,"string");return typeof e=="symbol"?e:e+""}function ySe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _I extends Do{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),vSe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new _I({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function CSe(t,e){[mI,pI,vI,wI,yI,CI,bI,SI,RI,EI,TI,_I].forEach(n=>n.startRegisteringEvents(t,e))}function bSe(t,e){SSe(t,e),e.add(t)}function SSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P1(t,e,n){return(e=RSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RSe(t){var e=ESe(t,"string");return typeof e=="symbol"?e:e+""}function ESe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const T2="undoRedo",TSe="undoRedo",_Se=1e3;xe.getSingleton().register("beforeUndo");xe.getSingleton().register("afterUndo");xe.getSingleton().register("beforeRedo");xe.getSingleton().register("afterRedo");const _2=new Set;var nC=new WeakSet;class MSe extends It{static get PLUGIN_KEY(){return TSe}static get PLUGIN_PRIORITY(){return _Se}static get SETTING_KEYS(){return!0}constructor(e){super(e),bSe(this,nC),P1(this,"doneActions",[]),P1(this,"undoneActions",[]),P1(this,"ignoreNewActions",!1),CSe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return N1(nC,e,OSe).call(e,...i)}),this.registerShortcuts(),N1(nC,this,xSe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),N1(nC,this,ASe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:T2};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(T2)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const a=e(),u=this.undoneActions.slice();this.doneActions.push(a),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",u),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",u,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=ir(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=ir(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function OSe(t,e){e==="loadData"&&this.clear()}function xSe(){const t=e=>{_2.has(e)||(Nt($t`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),_2.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function ASe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function HSe(){Mt(Km),Mt(zle),Mt(Xm),Mt(Sue),Mt(Aue),Mt(PG),Mt(Tce),Mt(uhe),Mt(gS),Mt(wde),Mt(Ude),Mt(Qde),Mt(vS),Mt(Nfe),Mt(xme),Mt(lpe),Mt(Dpe),Mt(Gpe),Mt(ove),Mt(pve),Mt(_ve),Mt(Uve),Mt(Jve),Mt(Lwe),Mt(gye),Mt(yye),Mt(zye),Mt(HCe),Mt(ebe),Mt(ube),Mt(Rbe),Mt(Ibe),Mt(jbe),Mt(MSe)}function ISe(){mse(),Vae(),Gae(),fle(),HSe()}ISe();const PSe=({checkpoints:t,onCheckpointChange:e,onAddCheckpoint:n,onRowMove:i})=>{const r=un.useRef(null),o=t.map(d=>[d.id,d.name,d.type,d.distance,d.pace,d.interval,d.restTime,d.date||"",d.arrivalTime||"",d.departureTime||""]),a=[{title:"No",data:0,readOnly:!0,width:60,className:"htCenter"},{title:"場所",data:1,type:"text",width:150},{title:"区分",data:2,type:"dropdown",source:["","集合","スタート","コンビニ","観光","休憩","ゴール","銭湯","打上げ"],width:100,strict:!1,allowInvalid:!1,className:"htCenter"},{title:"距離(km)",data:3,type:"numeric",numericFormat:{pattern:"0.00"},width:100,validator:(d,g)=>{g(d>=0)}},{title:"ペース(分/km)",data:4,type:"numeric",numericFormat:{pattern:"0.0"},width:120},{title:"間隔(km)",data:5,type:"numeric",numericFormat:{pattern:"0.00"},width:100,readOnly:!0,className:"htCenter htDimmed"},{title:"休憩(分)",data:6,type:"numeric",numericFormat:{pattern:"0"},width:100},{title:"日付",data:7,readOnly:!0,width:100,className:"htCenter htDimmed"},{title:"到着",data:8,readOnly:!0,width:100,className:"htCenter htDimmed"},{title:"出発",data:9,readOnly:!0,width:100,className:"htCenter htDimmed"}],u=d=>{d&&d.forEach(([g,p,w,y])=>{if(w!==y&&g!==null&&p!==null){const b=t[g];if(!b)return;const M={1:"name",2:"type",3:"distance",4:"pace",5:"interval",6:"restTime"}[p];M&&e(b.id,M,y)}})},h=d=>{const g=t[d];return g?g.hasError?"has-error":g.type==="ゴール"?"goal-row":g.type==="集合"?"meeting-row":g.type==="スタート"?"start-row":"":""};return Re.jsxs("div",{className:"handsontable-container relative z-10",children:[Re.jsx("style",{children:`
        .handsontable-container {
          margin: 20px 0;
          position: relative;
          z-index: 10;
        }
        
        .has-error {
          background-color: #fef2f2 !important;
        }
        
        .goal-row {
          background-color: #fefce8 !important;
        }
        
        .meeting-row {
          background-color: #f0fdf4 !important;
        }
        
        .start-row {
          background-color: #eff6ff !important;
        }
        
        .htDimmed {
          background-color: #f9fafb !important;
          color: #6b7280 !important;
        }
      `}),Re.jsx(zY,{ref:r,data:o,columns:a,colHeaders:!0,rowHeaders:!0,width:"100%",height:"600",licenseKey:"non-commercial-and-evaluation",stretchH:"all",columnSorting:!1,contextMenu:["row_above","row_below","remove_row","col_left","col_right"],manualRowMove:!0,manualColumnMove:!0,manualColumnResize:!0,manualRowResize:!1,afterChange:u,beforeRemoveRow:d=>d>=2,beforeColumnMove:d=>!d.includes(0),beforeRowMove:(d,g)=>{const p=d.some(y=>y<2),w=g<2;return!(p||w)},afterCreateRow:()=>{n()},afterRowMove:(d,g)=>{console.log("Row moved:",d,"to",g),i&&i(d,g)},afterColumnMove:(d,g)=>{console.log("Column moved:",d,"to",g)},cells:d=>({className:h(d)})}),Re.jsx("div",{className:"mt-4 space-x-2",children:Re.jsx("button",{onClick:n,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"チェックポイント追加"})})]})};class ss{static async initialize(){if(!this.isInitialized)try{await this.loadDefaultPresets(),this.loadCustomPresets(),this.isInitialized=!0}catch(e){console.warn("プリセットの初期化に失敗しました:",e),this.isInitialized=!0}}static async loadDefaultPresets(){try{const e="/running-schedule-planner/",n=await fetch(`${e}presets/presets-index.json`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=(await n.json()).presets.map(async a=>{const u=a.startsWith("/")?`${e}${a.slice(1)}`:`${e}${a}`,h=await fetch(u);if(!h.ok)throw new Error(`Failed to load preset: ${u}`);return await h.json()}),o=await Promise.all(r);this.defaultPresets=o}catch(e){console.warn("デフォルトプリセットの読み込みに失敗しました:",e),this.defaultPresets=[{id:"default-fallback",name:"デフォルト設定",description:"システムデフォルト設定",category:"training",config:{id:"default-fallback",name:"デフォルト設定",description:"システムデフォルト設定",startDateTime:"2025-06-07T08:30",checkpoints:[{id:0,name:"集合地点",type:"集合",distance:0,pace:0,interval:0,restTime:0},{id:1,name:"スタート地点",type:"スタート",distance:0,pace:0,interval:0,restTime:30},{id:2,name:"チェックポイント1",type:"",distance:5,pace:10,interval:0,restTime:10},{id:3,name:"ゴール地点",type:"ゴール",distance:10,pace:10,interval:0,restTime:0}]}}]}}static async getAvailablePresets(){await this.initialize();const e=Array.from(this.customConfigs.values());return[...this.defaultPresets,...e]}static async getPresetsByCategory(e){const n=await this.getAvailablePresets();return e?n.filter(i=>i.category===e):n}static async getPresetById(e){return(await this.getAvailablePresets()).find(i=>i.id===e)}static saveCustomPreset(e){if(this.customConfigs.set(e.id,e),typeof localStorage<"u"){const n=Array.from(this.customConfigs.values());localStorage.setItem("customRunningConfigs",JSON.stringify(n))}}static loadCustomPresets(){if(typeof localStorage<"u"){const e=localStorage.getItem("customRunningConfigs");if(e)try{JSON.parse(e).forEach(i=>{this.customConfigs.set(i.id,i)})}catch(n){console.warn("カスタム設定の読み込みに失敗しました:",n)}}}static deleteCustomPreset(e){const n=this.customConfigs.delete(e);if(n&&typeof localStorage<"u"){const i=Array.from(this.customConfigs.values());localStorage.setItem("customRunningConfigs",JSON.stringify(i))}return n}static exportConfig(e){return JSON.stringify(e,null,2)}static importConfig(e){try{const n=JSON.parse(e);return this.validateConfig(n),n}catch{throw new Error("設定ファイルの形式が正しくありません")}}static validateConfig(e){if(!e.id||!e.name||!Array.isArray(e.checkpoints))throw new Error("必要な設定項目が不足しています")}}ww(ss,"customConfigs",new Map),ww(ss,"defaultPresets",[]),ww(ss,"isInitialized",!1);const NSe=({currentConfig:t,onConfigChange:e})=>{const[n,i]=un.useState(!1),[r,o]=un.useState([]),[a,u]=un.useState("all"),[h,d]=un.useState(!1),[g,p]=un.useState(!1),[w,y]=un.useState(""),[b,T]=un.useState(""),[M,I]=un.useState("");un.useEffect(()=>{_()},[]);const _=async()=>{try{const G=await ss.getAvailablePresets();o(G)}catch(G){console.warn("プリセットの読み込みに失敗しました:",G),o([])}},N=[{value:"all",label:"すべて"},{value:"street-run",label:"街ラン"},{value:"marathon",label:"マラソン"},{value:"training",label:"トレーニング"},{value:"custom",label:"カスタム"}],k=a==="all"?r:r.filter(G=>G.category===a),$=G=>{e(G.config),i(!1)},L=async()=>{if(!w.trim())return;const G={id:`custom-${Date.now()}`,name:w,description:b,category:"custom",config:{...t,id:`custom-${Date.now()}`,name:w,description:b}};ss.saveCustomPreset(G),await _(),d(!1),y(""),T("")},F=async G=>{confirm("この設定を削除しますか？")&&(ss.deleteCustomPreset(G),await _())},he=()=>{const G=ss.exportConfig(t),ye=new Blob([G],{type:"application/json"}),we=URL.createObjectURL(ye),Me=document.createElement("a");Me.href=we,Me.download=`${t.name}.json`,document.body.appendChild(Me),Me.click(),document.body.removeChild(Me),URL.revokeObjectURL(we)},le=()=>{try{const G=ss.importConfig(M);e(G),p(!1),I("")}catch(G){alert("設定ファイルの読み込みに失敗しました: "+G)}};return Re.jsxs("div",{className:"relative",children:[Re.jsxs("button",{onClick:()=>i(!n),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[Re.jsx(WK,{className:"w-4 h-4"}),"設定を選択"]}),n&&Re.jsxs("div",{className:`absolute top-12 right-0 w-80 md:w-96 max-w-[calc(100vw-1rem)] bg-white border border-gray-300 rounded-lg shadow-lg z-[9999] 
                       origin-top-right mr-0`,children:[Re.jsxs("div",{className:"p-4 border-b border-gray-200",children:[Re.jsx("h3",{className:"text-lg font-semibold mb-3",children:"スケジュール設定"}),Re.jsxs("div",{className:"mb-3",children:[Re.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"カテゴリ"}),Re.jsx("select",{value:a,onChange:G=>u(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-1 text-sm",children:N.map(G=>Re.jsx("option",{value:G.value,children:G.label},G.value))})]}),Re.jsxs("div",{className:"flex gap-2 mb-3",children:[Re.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-1 px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:[Re.jsx(BK,{className:"w-3 h-3"}),"保存"]}),Re.jsxs("button",{onClick:he,className:"flex items-center gap-1 px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:[Re.jsx(LK,{className:"w-3 h-3"}),"エクスポート"]}),Re.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-1 px-2 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700",children:[Re.jsx(YK,{className:"w-3 h-3"}),"インポート"]})]})]}),Re.jsx("div",{className:"max-h-64 overflow-y-auto",children:k.map(G=>{var ye;return Re.jsxs("div",{className:"p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer flex justify-between items-start",children:[Re.jsxs("div",{onClick:()=>$(G),className:"flex-1",children:[Re.jsx("div",{className:"font-medium text-sm",children:G.name}),Re.jsx("div",{className:"text-xs text-gray-600 mt-1",children:G.description}),Re.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[G.config.checkpoints.length,"箇所 |",((ye=G.config.checkpoints[G.config.checkpoints.length-1])==null?void 0:ye.distance)||0,"km"]})]}),G.category==="custom"&&Re.jsx("button",{onClick:async we=>{we.stopPropagation(),await F(G.id)},className:"text-red-500 hover:text-red-700 ml-2",children:Re.jsx(UK,{className:"w-4 h-4"})})]},G.id)})}),Re.jsx("div",{className:"p-2 border-t border-gray-200",children:Re.jsx("button",{onClick:()=>i(!1),className:"w-full px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"閉じる"})})]}),h&&Re.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000]",children:Re.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[Re.jsx("h3",{className:"text-lg font-semibold mb-4",children:"設定を保存"}),Re.jsxs("div",{className:"space-y-4",children:[Re.jsxs("div",{children:[Re.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"設定名"}),Re.jsx("input",{type:"text",value:w,onChange:G=>y(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 山手線一周ラン"})]}),Re.jsxs("div",{children:[Re.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"説明"}),Re.jsx("textarea",{value:b,onChange:G=>T(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 h-20",placeholder:"この設定の説明を入力してください"})]})]}),Re.jsxs("div",{className:"flex gap-2 mt-6",children:[Re.jsx("button",{onClick:L,className:"flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700",children:"保存"}),Re.jsx("button",{onClick:()=>d(!1),className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"キャンセル"})]})]})}),g&&Re.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000]",children:Re.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[Re.jsx("h3",{className:"text-lg font-semibold mb-4",children:"設定をインポート"}),Re.jsx("div",{className:"space-y-4",children:Re.jsxs("div",{children:[Re.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"JSON設定データ"}),Re.jsx("textarea",{value:M,onChange:G=>I(G.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 h-32",placeholder:"JSONデータを貼り付けてください"})]})}),Re.jsxs("div",{className:"flex gap-2 mt-6",children:[Re.jsx("button",{onClick:le,className:"flex-1 bg-purple-600 text-white py-2 rounded hover:bg-purple-700",children:"インポート"}),Re.jsx("button",{onClick:()=>p(!1),className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"キャンセル"})]})]})})]})},DSe=()=>{var y;const[t,e]=un.useState({id:"default",name:"デフォルト設定",description:"",startDateTime:"2025-06-07T08:30",checkpoints:[{id:0,name:"新しいチェックポイント",type:"集合",distance:0,pace:0,interval:0,restTime:0}]}),[n,i]=un.useState(t.startDateTime),[r,o]=un.useState(t.checkpoints),[a,u]=un.useState(!1);un.useEffect(()=>{(async()=>{try{await ss.initialize();const T=await ss.getPresetById("tokyo-street-run-2025")||await ss.getPresetById("default-fallback");T!=null&&T.config&&e(T.config),u(!0)}catch(T){console.warn("設定の初期化に失敗しました:",T),u(!0)}})()},[]),un.useEffect(()=>{i(t.startDateTime),o(t.checkpoints)},[t.id]),un.useEffect(()=>{if(a&&t.id){const b=JSON.stringify(r.map(M=>({id:M.id,name:M.name,type:M.type,distance:M.distance,pace:M.pace,interval:M.interval,restTime:M.restTime}))),T=JSON.stringify(t.checkpoints);(b!==T||n!==t.startDateTime)&&e(M=>({...M,startDateTime:n,checkpoints:r.map(I=>({id:I.id,name:I.name,type:I.type,distance:I.distance,pace:I.pace,interval:I.interval,restTime:I.restTime}))}))}},[r,n,a]);const h=b=>{e(b)},d=ZK(n,r);if(!a)return Re.jsx("div",{className:"container mx-auto px-4 py-8 text-center",children:Re.jsxs("div",{className:"inline-flex items-center",children:[Re.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),Re.jsx("span",{children:"設定を読み込み中..."})]})});const g=()=>{const b=Math.max(...r.map(T=>T.id))+1;o(T=>[...T,{id:b,name:"新しいチェックポイント",type:"",distance:0,pace:10,interval:0,restTime:5}])},p=(b,T,M)=>{o(I=>{const _=I.map(N=>N.id===b?{...N,[T]:["distance","pace","interval","restTime"].includes(T)?Number(M):M}:N);if(T==="distance"){const N=_.findIndex(k=>k.id===b);if(N>1&&N<_.length-1){const k=_[N+1];if(k){const $=Number((k.distance-Number(M)).toFixed(2));$>0&&(_[N+1]={...k,interval:$})}}}return _})},w=(b,T)=>{o(M=>{const I=[...M];return b.forEach(_=>{const N=T>_?T-1:T;KK(I,_,N)}),I})};return Re.jsxs("div",{className:"max-w-7xl mx-auto p-4 relative",children:[Re.jsxs("div",{className:"mb-6 relative z-20",children:[Re.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Re.jsxs("h1",{className:"text-2xl font-bold text-blue-700 flex items-center gap-2",children:[Re.jsx(VK,{className:"w-6 h-6"}),t.name]}),Re.jsx(NSe,{currentConfig:t,onConfigChange:h})]}),t.description&&Re.jsx("p",{className:"text-gray-600 mb-4",children:t.description}),Re.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[Re.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"スタート日時"}),Re.jsx("input",{type:"datetime-local",value:n,onChange:b=>{i(b.target.value)},className:"w-48"})]})]}),Re.jsx("div",{className:"relative z-10",children:Re.jsx(PSe,{checkpoints:d,onCheckpointChange:p,onAddCheckpoint:g,onRowMove:w})}),Re.jsxs("div",{className:"mt-6 space-y-4",children:[Re.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[Re.jsx("h3",{className:"font-semibold mb-2",children:"使い方："}),Re.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[Re.jsx("li",{children:"• スタート日時を設定してください（日付をまたぐ長時間イベントにも対応）"}),Re.jsx("li",{children:"• 各チェックポイントの距離、ペース、間隔、休憩時間を個別に設定できます"}),Re.jsx("li",{children:"• 到着・出発時刻は自動計算されます（月/日 時:分 形式で表示）"}),Re.jsx("li",{children:"• 集合時間、スタート時間、ゴール時間を区別して管理できます"}),Re.jsx("li",{children:"• 休憩時間0分の場合は出発時刻が表示されません"}),Re.jsx("li",{children:"• 行を右クリックして行の追加・削除ができます"}),Re.jsx("li",{children:"• 行番号をドラッグして行の順序を変更できます（集合・スタート行は移動不可）"}),Re.jsx("li",{children:"• 列ヘッダーをドラッグして列の順序を変更できます（No列は移動不可）"}),Re.jsx("li",{children:"• 列の境界をドラッグして列幅を調整できます"})]})]}),Re.jsxs("div",{className:"bg-amber-50 border border-amber-200 p-4 rounded-lg",children:[Re.jsx("h3",{className:"font-semibold text-amber-800 mb-2",children:"計算例："}),Re.jsxs("p",{className:"text-sm text-amber-700",children:["総距離: ",((y=r[r.length-3])==null?void 0:y.distance)||0,"km | 推定総時間: ",(()=>{const b=d[d.length-3];return b&&b.date&&b.arrivalTime?XK(n,{date:b.date,arrivalTime:b.arrivalTime}):"計算中..."})()]})]})]})]})};function LSe(){return Re.jsx("div",{className:"min-h-screen bg-white",children:Re.jsx(DSe,{})})}xK.createRoot(document.getElementById("root")).render(Re.jsx(un.StrictMode,{children:Re.jsx(LSe,{})}))});export default kSe();
